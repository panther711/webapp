{"version":3,"file":"index.prod.js","mappings":"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","sources":["webpack://tinode-webapp/./node_modules/base64-js/index.js","webpack://tinode-webapp/./node_modules/buffer/index.js","webpack://tinode-webapp/./node_modules/ebml-block/index.js","webpack://tinode-webapp/./node_modules/ebml-block/lib/buffer-reader.js","webpack://tinode-webapp/./node_modules/ebml-block/lib/vint.js","webpack://tinode-webapp/./node_modules/ebml/lib/ebml/tools.js","webpack://tinode-webapp/./node_modules/ieee754/index.js","webpack://tinode-webapp/./node_modules/int64-buffer/int64-buffer.js","webpack://tinode-webapp/./node_modules/matroska/lib/schema.js","webpack://tinode-webapp/./node_modules/ts-ebml/lib/EBMLDecoder.js","webpack://tinode-webapp/./node_modules/ts-ebml/lib/EBMLEncoder.js","webpack://tinode-webapp/./node_modules/ts-ebml/lib/EBMLReader.js","webpack://tinode-webapp/./node_modules/ts-ebml/lib/index.js","webpack://tinode-webapp/./node_modules/ts-ebml/lib/tools.js","webpack://tinode-webapp/./node_modules/ts-ebml/node_modules/events/events.js","webpack://tinode-webapp/webpack/bootstrap","webpack://tinode-webapp/webpack/runtime/compat get default export","webpack://tinode-webapp/webpack/runtime/define property getters","webpack://tinode-webapp/webpack/runtime/global","webpack://tinode-webapp/webpack/runtime/hasOwnProperty shorthand","webpack://tinode-webapp/external var \"React\"","webpack://tinode-webapp/external var \"ReactDOM\"","webpack://tinode-webapp/external var \"ReactIntl\"","webpack://tinode-webapp/./node_modules/@firebase/util/dist/index.esm2017.js","webpack://tinode-webapp/./node_modules/@firebase/component/dist/esm/index.esm2017.js","webpack://tinode-webapp/./node_modules/@firebase/logger/dist/esm/index.esm2017.js","webpack://tinode-webapp/./node_modules/idb/build/wrap-idb-value.js","webpack://tinode-webapp/./node_modules/idb/build/index.js","webpack://tinode-webapp/./node_modules/@firebase/app/dist/esm/index.esm2017.js","webpack://tinode-webapp/./node_modules/firebase/app/dist/index.esm.js","webpack://tinode-webapp/./node_modules/@firebase/installations/dist/esm/index.esm2017.js","webpack://tinode-webapp/./node_modules/@firebase/messaging/dist/esm/index.esm2017.js","webpack://tinode-webapp/external var \"Tinode\"","webpack://tinode-webapp/./src/widgets/alert.jsx","webpack://tinode-webapp/./src/version.js","webpack://tinode-webapp/./src/config.js","webpack://tinode-webapp/./src/widgets/context-menu.jsx","webpack://tinode-webapp/./src/widgets/contact-badges.jsx","webpack://tinode-webapp/./src/lib/strformat.js","webpack://tinode-webapp/./src/lib/utils.js","webpack://tinode-webapp/./src/widgets/letter-tile.jsx","webpack://tinode-webapp/./src/widgets/unread-badge.jsx","webpack://tinode-webapp/./src/lib/blob-helpers.js","webpack://tinode-webapp/./src/widgets/audio-player.jsx","webpack://tinode-webapp/./src/widgets/call-message.jsx","webpack://tinode-webapp/./src/widgets/call-status.jsx","webpack://tinode-webapp/./src/widgets/lazy-image.jsx","webpack://tinode-webapp/./src/widgets/file-progress.jsx","webpack://tinode-webapp/./src/widgets/uploading-image.jsx","webpack://tinode-webapp/./src/lib/formatters.js","webpack://tinode-webapp/./src/widgets/contact.jsx","webpack://tinode-webapp/./src/widgets/contact-action.jsx","webpack://tinode-webapp/./src/widgets/contact-list.jsx","webpack://tinode-webapp/./src/widgets/search-contacts.jsx","webpack://tinode-webapp/./src/widgets/forward-dialog.jsx","webpack://tinode-webapp/./src/widgets/badge-list.jsx","webpack://tinode-webapp/./src/constants.js","webpack://tinode-webapp/./src/widgets/call-incoming.jsx","webpack://tinode-webapp/./src/widgets/load-spinner.jsx","webpack://tinode-webapp/./src/widgets/avatar-upload.jsx","webpack://tinode-webapp/./src/widgets/checkbox.jsx","webpack://tinode-webapp/./src/widgets/menu-cancel.jsx","webpack://tinode-webapp/./src/widgets/error-panel.jsx","webpack://tinode-webapp/./src/widgets/chip.jsx","webpack://tinode-webapp/./src/widgets/chip-input.jsx","webpack://tinode-webapp/./src/widgets/group-manager.jsx","webpack://tinode-webapp/./src/widgets/permissions-editor.jsx","webpack://tinode-webapp/./src/widgets/cropper.jsx","webpack://tinode-webapp/./src/widgets/avatar-crop.jsx","webpack://tinode-webapp/./src/widgets/visible-password.jsx","webpack://tinode-webapp/./src/widgets/in-place-edit.jsx","webpack://tinode-webapp/./src/widgets/tag-manager.jsx","webpack://tinode-webapp/./src/widgets/topic-desc-edit.jsx","webpack://tinode-webapp/./src/widgets/topic-common.jsx","webpack://tinode-webapp/./src/widgets/topic-security.jsx","webpack://tinode-webapp/./src/views/info-view.jsx","webpack://tinode-webapp/./src/widgets/call-panel.jsx","webpack://tinode-webapp/./src/widgets/attachment.jsx","webpack://tinode-webapp/./src/widgets/received-marker.jsx","webpack://tinode-webapp/./src/widgets/chat-message.jsx","webpack://tinode-webapp/./src/widgets/audio-recorder.jsx","webpack://tinode-webapp/./src/widgets/send-message.jsx","webpack://tinode-webapp/./src/widgets/doc-preview.jsx","webpack://tinode-webapp/./src/widgets/group-subs.jsx","webpack://tinode-webapp/./src/widgets/image-preview.jsx","webpack://tinode-webapp/./src/widgets/invitation.jsx","webpack://tinode-webapp/./src/views/logo-view.jsx","webpack://tinode-webapp/./src/widgets/meta-message.jsx","webpack://tinode-webapp/./src/lib/navigation.js","webpack://tinode-webapp/./src/views/messages-view.jsx","webpack://tinode-webapp/./src/widgets/button-back.jsx","webpack://tinode-webapp/./src/widgets/menu-contacts.jsx","webpack://tinode-webapp/./src/widgets/menu-start.jsx","webpack://tinode-webapp/./src/widgets/side-navbar.jsx","webpack://tinode-webapp/./src/views/account-settings-view.jsx","webpack://tinode-webapp/./src/views/contacts-view.jsx","webpack://tinode-webapp/./src/lib/local-storage.js","webpack://tinode-webapp/./src/views/create-account-view.jsx","webpack://tinode-webapp/./src/views/acc-notifications-view.jsx","webpack://tinode-webapp/./src/views/acc-security-view.jsx","webpack://tinode-webapp/./src/views/acc-support-view.jsx","webpack://tinode-webapp/./src/views/login-view.jsx","webpack://tinode-webapp/./src/widgets/new-topic-by-id.jsx","webpack://tinode-webapp/./src/widgets/new-topic-group.jsx","webpack://tinode-webapp/./src/views/new-topic-view.jsx","webpack://tinode-webapp/./src/views/password-reset-view.jsx","webpack://tinode-webapp/./src/widgets/host-selector.jsx","webpack://tinode-webapp/./src/views/settings-view.jsx","webpack://tinode-webapp/./src/views/validation-view.jsx","webpack://tinode-webapp/./src/views/sidepanel-view.jsx","webpack://tinode-webapp/./src/lib/host-name.js","webpack://tinode-webapp/./src/views/tinode-web.jsx","webpack://tinode-webapp/./src/index.js"],"sourcesContent":["'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar customInspectSymbol =\n  (typeof Symbol === 'function' && typeof Symbol['for'] === 'function') // eslint-disable-line dot-notation\n    ? Symbol['for']('nodejs.util.inspect.custom') // eslint-disable-line dot-notation\n    : null\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\nvar K_MAX_LENGTH = 0x7fffffff\nexports.kMaxLength = K_MAX_LENGTH\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Print warning and recommend using `buffer` v4.x which has an Object\n *               implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * We report that the browser does not support typed arrays if the are not subclassable\n * using __proto__. Firefox 4-29 lacks support for adding new properties to `Uint8Array`\n * (See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438). IE 10 lacks support\n * for __proto__ and has a buggy typed array implementation.\n */\nBuffer.TYPED_ARRAY_SUPPORT = typedArraySupport()\n\nif (!Buffer.TYPED_ARRAY_SUPPORT && typeof console !== 'undefined' &&\n    typeof console.error === 'function') {\n  console.error(\n    'This browser lacks typed array (Uint8Array) support which is required by ' +\n    '`buffer` v5.x. Use `buffer` v4.x if you require old browser support.'\n  )\n}\n\nfunction typedArraySupport () {\n  // Can typed array instances can be augmented?\n  try {\n    var arr = new Uint8Array(1)\n    var proto = { foo: function () { return 42 } }\n    Object.setPrototypeOf(proto, Uint8Array.prototype)\n    Object.setPrototypeOf(arr, proto)\n    return arr.foo() === 42\n  } catch (e) {\n    return false\n  }\n}\n\nObject.defineProperty(Buffer.prototype, 'parent', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.buffer\n  }\n})\n\nObject.defineProperty(Buffer.prototype, 'offset', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.byteOffset\n  }\n})\n\nfunction createBuffer (length) {\n  if (length > K_MAX_LENGTH) {\n    throw new RangeError('The value \"' + length + '\" is invalid for option \"size\"')\n  }\n  // Return an augmented `Uint8Array` instance\n  var buf = new Uint8Array(length)\n  Object.setPrototypeOf(buf, Buffer.prototype)\n  return buf\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new TypeError(\n        'The \"string\" argument must be of type string. Received type number'\n      )\n    }\n    return allocUnsafe(arg)\n  }\n  return from(arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\nfunction from (value, encodingOrOffset, length) {\n  if (typeof value === 'string') {\n    return fromString(value, encodingOrOffset)\n  }\n\n  if (ArrayBuffer.isView(value)) {\n    return fromArrayView(value)\n  }\n\n  if (value == null) {\n    throw new TypeError(\n      'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n      'or Array-like Object. Received type ' + (typeof value)\n    )\n  }\n\n  if (isInstance(value, ArrayBuffer) ||\n      (value && isInstance(value.buffer, ArrayBuffer))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof SharedArrayBuffer !== 'undefined' &&\n      (isInstance(value, SharedArrayBuffer) ||\n      (value && isInstance(value.buffer, SharedArrayBuffer)))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'number') {\n    throw new TypeError(\n      'The \"value\" argument must not be of type number. Received type number'\n    )\n  }\n\n  var valueOf = value.valueOf && value.valueOf()\n  if (valueOf != null && valueOf !== value) {\n    return Buffer.from(valueOf, encodingOrOffset, length)\n  }\n\n  var b = fromObject(value)\n  if (b) return b\n\n  if (typeof Symbol !== 'undefined' && Symbol.toPrimitive != null &&\n      typeof value[Symbol.toPrimitive] === 'function') {\n    return Buffer.from(\n      value[Symbol.toPrimitive]('string'), encodingOrOffset, length\n    )\n  }\n\n  throw new TypeError(\n    'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n    'or Array-like Object. Received type ' + (typeof value)\n  )\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(value, encodingOrOffset, length)\n}\n\n// Note: Change prototype *after* Buffer.from is defined to workaround Chrome bug:\n// https://github.com/feross/buffer/pull/148\nObject.setPrototypeOf(Buffer.prototype, Uint8Array.prototype)\nObject.setPrototypeOf(Buffer, Uint8Array)\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be of type number')\n  } else if (size < 0) {\n    throw new RangeError('The value \"' + size + '\" is invalid for option \"size\"')\n  }\n}\n\nfunction alloc (size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpreted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(size).fill(fill, encoding)\n      : createBuffer(size).fill(fill)\n  }\n  return createBuffer(size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(size, fill, encoding)\n}\n\nfunction allocUnsafe (size) {\n  assertSize(size)\n  return createBuffer(size < 0 ? 0 : checked(size) | 0)\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(size)\n}\n\nfunction fromString (string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('Unknown encoding: ' + encoding)\n  }\n\n  var length = byteLength(string, encoding) | 0\n  var buf = createBuffer(length)\n\n  var actual = buf.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    buf = buf.slice(0, actual)\n  }\n\n  return buf\n}\n\nfunction fromArrayLike (array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  var buf = createBuffer(length)\n  for (var i = 0; i < length; i += 1) {\n    buf[i] = array[i] & 255\n  }\n  return buf\n}\n\nfunction fromArrayView (arrayView) {\n  if (isInstance(arrayView, Uint8Array)) {\n    var copy = new Uint8Array(arrayView)\n    return fromArrayBuffer(copy.buffer, copy.byteOffset, copy.byteLength)\n  }\n  return fromArrayLike(arrayView)\n}\n\nfunction fromArrayBuffer (array, byteOffset, length) {\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\"offset\" is outside of buffer bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\"length\" is outside of buffer bounds')\n  }\n\n  var buf\n  if (byteOffset === undefined && length === undefined) {\n    buf = new Uint8Array(array)\n  } else if (length === undefined) {\n    buf = new Uint8Array(array, byteOffset)\n  } else {\n    buf = new Uint8Array(array, byteOffset, length)\n  }\n\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(buf, Buffer.prototype)\n\n  return buf\n}\n\nfunction fromObject (obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    var buf = createBuffer(len)\n\n    if (buf.length === 0) {\n      return buf\n    }\n\n    obj.copy(buf, 0, 0, len)\n    return buf\n  }\n\n  if (obj.length !== undefined) {\n    if (typeof obj.length !== 'number' || numberIsNaN(obj.length)) {\n      return createBuffer(0)\n    }\n    return fromArrayLike(obj)\n  }\n\n  if (obj.type === 'Buffer' && Array.isArray(obj.data)) {\n    return fromArrayLike(obj.data)\n  }\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < K_MAX_LENGTH` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= K_MAX_LENGTH) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + K_MAX_LENGTH.toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return b != null && b._isBuffer === true &&\n    b !== Buffer.prototype // so Buffer.isBuffer(Buffer.prototype) will be false\n}\n\nBuffer.compare = function compare (a, b) {\n  if (isInstance(a, Uint8Array)) a = Buffer.from(a, a.offset, a.byteLength)\n  if (isInstance(b, Uint8Array)) b = Buffer.from(b, b.offset, b.byteLength)\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError(\n      'The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array'\n    )\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!Array.isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (isInstance(buf, Uint8Array)) {\n      if (pos + buf.length > buffer.length) {\n        Buffer.from(buf).copy(buffer, pos)\n      } else {\n        Uint8Array.prototype.set.call(\n          buffer,\n          buf,\n          pos\n        )\n      }\n    } else if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    } else {\n      buf.copy(buffer, pos)\n    }\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (ArrayBuffer.isView(string) || isInstance(string, ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    throw new TypeError(\n      'The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. ' +\n      'Received type ' + typeof string\n    )\n  }\n\n  var len = string.length\n  var mustMatch = (arguments.length > 2 && arguments[2] === true)\n  if (!mustMatch && len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) {\n          return mustMatch ? -1 : utf8ToBytes(string).length // assume utf8\n        }\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coercion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// This property is used by `Buffer.isBuffer` (and the `is-buffer` npm package)\n// to detect a Buffer instance. It's not possible to use `instanceof Buffer`\n// reliably in a browserify context because there could be multiple different\n// copies of the 'buffer' package in use. This method works even for Buffer\n// instances that were created from another copy of the `buffer` package.\n// See: https://github.com/feross/buffer/issues/154\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.toLocaleString = Buffer.prototype.toString\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  str = this.toString('hex', 0, max).replace(/(.{2})/g, '$1 ').trim()\n  if (this.length > max) str += ' ... '\n  return '<Buffer ' + str + '>'\n}\nif (customInspectSymbol) {\n  Buffer.prototype[customInspectSymbol] = Buffer.prototype.inspect\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (isInstance(target, Uint8Array)) {\n    target = Buffer.from(target, target.offset, target.byteLength)\n  }\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError(\n      'The \"target\" argument must be one of type Buffer or Uint8Array. ' +\n      'Received type ' + (typeof target)\n    )\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset // Coerce to Number.\n  if (numberIsNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [val], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  var strLen = string.length\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (numberIsNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset >>> 0\n    if (isFinite(length)) {\n      length = length >>> 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return asciiWrite(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF)\n      ? 4\n      : (firstByte > 0xDF)\n          ? 3\n          : (firstByte > 0xBF)\n              ? 2\n              : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += hexSliceLookupTable[buf[i]]\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  // If bytes.length is odd, the last 8 bits must be ignored (same as node.js)\n  for (var i = 0; i < bytes.length - 1; i += 2) {\n    res += String.fromCharCode(bytes[i] + (bytes[i + 1] * 256))\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf = this.subarray(start, end)\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(newBuf, Buffer.prototype)\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUintLE =\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUintBE =\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUint8 =\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUint16LE =\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUint16BE =\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUint32LE =\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUint32BE =\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUintLE =\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUintBE =\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUint8 =\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeUint16LE =\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint16BE =\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint32LE =\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset + 3] = (value >>> 24)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 1] = (value >>> 8)\n  this[offset] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeUint32BE =\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    var limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    var limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 3] = (value >>> 24)\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!Buffer.isBuffer(target)) throw new TypeError('argument should be a Buffer')\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('Index out of range')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n\n  if (this === target && typeof Uint8Array.prototype.copyWithin === 'function') {\n    // Use built-in when available, missing from IE11\n    this.copyWithin(targetStart, start, end)\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, end),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if ((encoding === 'utf8' && code < 128) ||\n          encoding === 'latin1') {\n        // Fast path: If `val` fits into a single byte, use that numeric value.\n        val = code\n      }\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  } else if (typeof val === 'boolean') {\n    val = Number(val)\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : Buffer.from(val, encoding)\n    var len = bytes.length\n    if (len === 0) {\n      throw new TypeError('The value \"' + val +\n        '\" is invalid for argument \"value\"')\n    }\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node takes equal signs as end of the Base64 encoding\n  str = str.split('=')[0]\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = str.trim().replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\n// ArrayBuffer or Uint8Array objects from other contexts (i.e. iframes) do not pass\n// the `instanceof` check but they should be treated as of that type.\n// See: https://github.com/feross/buffer/issues/166\nfunction isInstance (obj, type) {\n  return obj instanceof type ||\n    (obj != null && obj.constructor != null && obj.constructor.name != null &&\n      obj.constructor.name === type.name)\n}\nfunction numberIsNaN (obj) {\n  // For IE11 support\n  return obj !== obj // eslint-disable-line no-self-compare\n}\n\n// Create lookup table for `toString('hex')`\n// See: https://github.com/feross/buffer/issues/219\nvar hexSliceLookupTable = (function () {\n  var alphabet = '0123456789abcdef'\n  var table = new Array(256)\n  for (var i = 0; i < 16; ++i) {\n    var i16 = i * 16\n    for (var j = 0; j < 16; ++j) {\n      table[i16 + j] = alphabet[i] + alphabet[j]\n    }\n  }\n  return table\n})()\n","var BufferReader = require('./lib/buffer-reader')\n\nvar XIPH_LACING = 1\nvar EBML_LACING = 3\nvar FIXED_SIZE_LACING = 2\n\nmodule.exports = function (buffer) {\n  var block = {}\n  var reader = new BufferReader(buffer)\n\n  block.trackNumber = reader.nextUIntV()\n  block.timecode = reader.nextInt16BE()\n\n  var flags = reader.nextUInt8()\n\n  block.invisible = !!(flags & 0x8)\n\n  // only valid for SimpleBlock\n  block.keyframe = !!(flags & 0x80)\n  block.discardable = !!(flags & 0x1)\n\n  var lacing = (flags & 0x6) >> 1\n\n  block.frames = readLacedData(reader, lacing)\n\n  return block\n}\n\nfunction readLacedData (reader, lacing) {\n  if (!lacing) return [reader.nextBuffer()]\n\n  var i, frameSize\n  var frames = []\n  var framesNum = reader.nextUInt8() + 1 // number of frames\n\n  if (lacing === FIXED_SIZE_LACING) {\n    // remaining data should be divisible by the number of frames\n    if (reader.length % framesNum !== 0) throw new Error('Fixed-Size Lacing Error')\n\n    frameSize = reader.length / framesNum\n    for (i = 0; i < framesNum; i++) {\n      frames.push(reader.nextBuffer(frameSize))\n    }\n    return frames\n  }\n\n  var frameSizes = []\n\n  if (lacing === XIPH_LACING) {\n    for (i = 0; i < framesNum - 1; i++) {\n      var val\n      frameSize = 0\n      do {\n        val = reader.nextUInt8()\n        frameSize += val\n      } while (val === 0xff)\n      frameSizes.push(frameSize)\n    }\n  } else if (lacing === EBML_LACING) {\n    // first frame\n    frameSize = reader.nextUIntV()\n    frameSizes.push(frameSize)\n\n    // middle frames\n    for (i = 1; i < framesNum - 1; i++) {\n      frameSize += reader.nextIntV()\n      frameSizes.push(frameSize)\n    }\n  }\n\n  for (i = 0; i < framesNum - 1; i++) {\n    frames.push(reader.nextBuffer(frameSizes[i]))\n  }\n\n  // last frame (remaining buffer)\n  frames.push(reader.nextBuffer())\n\n  return frames\n}\n","var vint = require('./vint')\n\nfunction BufferReader (buffer) {\n  this.buffer = buffer\n  this.offset = 0\n}\n\n// a super limited subset of the node buffer API\nBufferReader.prototype.nextInt16BE = function () {\n  var value = this.buffer.readInt16BE(this.offset)\n  this.offset += 2\n  return value\n}\n\nBufferReader.prototype.nextUInt8 = function () {\n  var value = this.buffer.readUInt8(this.offset)\n  this.offset += 1\n  return value\n}\n\n// EBML variable sized integers\nBufferReader.prototype.nextUIntV = function () {\n  var v = vint(this.buffer, this.offset)\n  this.offset += v.length\n  return v.value\n}\n\nBufferReader.prototype.nextIntV = function () {\n  var v = vint(this.buffer, this.offset, true)\n  this.offset += v.length\n  return v.value\n}\n\n// buffer slice\nBufferReader.prototype.nextBuffer = function (length) {\n  var buffer = length\n    ? this.buffer.slice(this.offset, this.offset + length)\n    : this.buffer.slice(this.offset)\n  this.offset += length || this.length\n  return buffer\n}\n\n// remaining bytes to read\nObject.defineProperty(BufferReader.prototype, 'length', {\n  get: function () { return this.buffer.length - this.offset }\n})\n\nmodule.exports = BufferReader\n","// https://github.com/themasch/node-ebml/blob/master/lib/ebml/tools.js\nmodule.exports = function (buffer, start, signed) {\n  start = start || 0\n  for (var length = 1; length <= 8; length++) {\n    if (buffer[start] >= Math.pow(2, 8 - length)) {\n      break\n    }\n  }\n  if (length > 8) {\n    throw new Error('Unrepresentable length: ' + length + ' ' +\n      buffer.toString('hex', start, start + length))\n  }\n  if (start + length > buffer.length) {\n    return null\n  }\n  var i\n  var value = buffer[start] & (1 << (8 - length)) - 1\n  for (i = 1; i < length; i++) {\n    if (i === 7) {\n      if (value >= Math.pow(2, 53 - 8) && buffer[start + 7] > 0) {\n        return {\n          length: length,\n          value: -1\n        }\n      }\n    }\n    value *= Math.pow(2, 8)\n    value += buffer[start + i]\n  }\n  if (signed) {\n    value -= Math.pow(2, length * 7 - 1) - 1\n  }\n  return {\n    length: length,\n    value: value\n  }\n}\n","var tools = {\n    readVint: function(buffer, start) {\n        start = start || 0;\n        for (var length = 1; length <= 8; length++) {\n            if (buffer[start] >= Math.pow(2, 8 - length)) {\n                break;\n            }\n        }\n        if (length > 8) {\n            throw new Error(\"Unrepresentable length: \" + length + \" \" +\n                buffer.toString('hex', start, start + length));\n        }\n        if (start + length > buffer.length) {\n            return null;\n        }\n        var value = buffer[start] & (1 << (8 - length)) - 1;\n        for (var i = 1; i < length; i++) {\n            if (i === 7) {\n                if (value >= Math.pow(2, 53 - 8) && buffer[start + 7] > 0) {\n                    return {\n                        length: length,\n                        value: -1\n                    };\n                }\n            }\n            value *= Math.pow(2, 8);\n            value += buffer[start + i];\n        }\n        return {\n            length: length,\n            value: value\n        };\n    },\n\n    writeVint: function(value) {\n        if (value < 0 || value > Math.pow(2, 53)) {\n            throw new Error(\"Unrepresentable value: \" + value);\n        }\n        for (var length = 1; length <= 8; length++) {\n            if (value < Math.pow(2, 7 * length) - 1) {\n                break;\n            }\n        }\n        var buffer = new Buffer(length);\n        for (var i = 1; i <= length; i++) {\n            var b = value & 0xFF;\n            buffer[length - i] = b;\n            value -= b;\n            value /= Math.pow(2, 8);\n        }\n        buffer[0] = buffer[0] | (1 << (8 - length));\n        return buffer;\n    }\n};\n\nmodule.exports = tools;\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","// int64-buffer.js\n\n/*jshint -W018 */ // Confusing use of '!'.\n/*jshint -W030 */ // Expected an assignment or function call and instead saw an expression.\n/*jshint -W093 */ // Did you mean to return a conditional instead of an assignment?\n\nvar Uint64BE, Int64BE, Uint64LE, Int64LE;\n\n!function(exports) {\n  // constants\n\n  var UNDEFINED = \"undefined\";\n  var BUFFER = (UNDEFINED !== typeof Buffer) && Buffer;\n  var UINT8ARRAY = (UNDEFINED !== typeof Uint8Array) && Uint8Array;\n  var ARRAYBUFFER = (UNDEFINED !== typeof ArrayBuffer) && ArrayBuffer;\n  var ZERO = [0, 0, 0, 0, 0, 0, 0, 0];\n  var isArray = Array.isArray || _isArray;\n  var BIT32 = 4294967296;\n  var BIT24 = 16777216;\n\n  // storage class\n\n  var storage; // Array;\n\n  // generate classes\n\n  Uint64BE = factory(\"Uint64BE\", true, true);\n  Int64BE = factory(\"Int64BE\", true, false);\n  Uint64LE = factory(\"Uint64LE\", false, true);\n  Int64LE = factory(\"Int64LE\", false, false);\n\n  // class factory\n\n  function factory(name, bigendian, unsigned) {\n    var posH = bigendian ? 0 : 4;\n    var posL = bigendian ? 4 : 0;\n    var pos0 = bigendian ? 0 : 3;\n    var pos1 = bigendian ? 1 : 2;\n    var pos2 = bigendian ? 2 : 1;\n    var pos3 = bigendian ? 3 : 0;\n    var fromPositive = bigendian ? fromPositiveBE : fromPositiveLE;\n    var fromNegative = bigendian ? fromNegativeBE : fromNegativeLE;\n    var proto = Int64.prototype;\n    var isName = \"is\" + name;\n    var _isInt64 = \"_\" + isName;\n\n    // properties\n    proto.buffer = void 0;\n    proto.offset = 0;\n    proto[_isInt64] = true;\n\n    // methods\n    proto.toNumber = toNumber;\n    proto.toString = toString;\n    proto.toJSON = toNumber;\n    proto.toArray = toArray;\n\n    // add .toBuffer() method only when Buffer available\n    if (BUFFER) proto.toBuffer = toBuffer;\n\n    // add .toArrayBuffer() method only when Uint8Array available\n    if (UINT8ARRAY) proto.toArrayBuffer = toArrayBuffer;\n\n    // isUint64BE, isInt64BE\n    Int64[isName] = isInt64;\n\n    // CommonJS\n    exports[name] = Int64;\n\n    return Int64;\n\n    // constructor\n    function Int64(buffer, offset, value, raddix) {\n      if (!(this instanceof Int64)) return new Int64(buffer, offset, value, raddix);\n      return init(this, buffer, offset, value, raddix);\n    }\n\n    // isUint64BE, isInt64BE\n    function isInt64(b) {\n      return !!(b && b[_isInt64]);\n    }\n\n    // initializer\n    function init(that, buffer, offset, value, raddix) {\n      if (UINT8ARRAY && ARRAYBUFFER) {\n        if (buffer instanceof ARRAYBUFFER) buffer = new UINT8ARRAY(buffer);\n        if (value instanceof ARRAYBUFFER) value = new UINT8ARRAY(value);\n      }\n\n      // Int64BE() style\n      if (!buffer && !offset && !value && !storage) {\n        // shortcut to initialize with zero\n        that.buffer = newArray(ZERO, 0);\n        return;\n      }\n\n      // Int64BE(value, raddix) style\n      if (!isValidBuffer(buffer, offset)) {\n        var _storage = storage || Array;\n        raddix = offset;\n        value = buffer;\n        offset = 0;\n        buffer = new _storage(8);\n      }\n\n      that.buffer = buffer;\n      that.offset = offset |= 0;\n\n      // Int64BE(buffer, offset) style\n      if (UNDEFINED === typeof value) return;\n\n      // Int64BE(buffer, offset, value, raddix) style\n      if (\"string\" === typeof value) {\n        fromString(buffer, offset, value, raddix || 10);\n      } else if (isValidBuffer(value, raddix)) {\n        fromArray(buffer, offset, value, raddix);\n      } else if (\"number\" === typeof raddix) {\n        writeInt32(buffer, offset + posH, value); // high\n        writeInt32(buffer, offset + posL, raddix); // low\n      } else if (value > 0) {\n        fromPositive(buffer, offset, value); // positive\n      } else if (value < 0) {\n        fromNegative(buffer, offset, value); // negative\n      } else {\n        fromArray(buffer, offset, ZERO, 0); // zero, NaN and others\n      }\n    }\n\n    function fromString(buffer, offset, str, raddix) {\n      var pos = 0;\n      var len = str.length;\n      var high = 0;\n      var low = 0;\n      if (str[0] === \"-\") pos++;\n      var sign = pos;\n      while (pos < len) {\n        var chr = parseInt(str[pos++], raddix);\n        if (!(chr >= 0)) break; // NaN\n        low = low * raddix + chr;\n        high = high * raddix + Math.floor(low / BIT32);\n        low %= BIT32;\n      }\n      if (sign) {\n        high = ~high;\n        if (low) {\n          low = BIT32 - low;\n        } else {\n          high++;\n        }\n      }\n      writeInt32(buffer, offset + posH, high);\n      writeInt32(buffer, offset + posL, low);\n    }\n\n    function toNumber() {\n      var buffer = this.buffer;\n      var offset = this.offset;\n      var high = readInt32(buffer, offset + posH);\n      var low = readInt32(buffer, offset + posL);\n      if (!unsigned) high |= 0; // a trick to get signed\n      return high ? (high * BIT32 + low) : low;\n    }\n\n    function toString(radix) {\n      var buffer = this.buffer;\n      var offset = this.offset;\n      var high = readInt32(buffer, offset + posH);\n      var low = readInt32(buffer, offset + posL);\n      var str = \"\";\n      var sign = !unsigned && (high & 0x80000000);\n      if (sign) {\n        high = ~high;\n        low = BIT32 - low;\n      }\n      radix = radix || 10;\n      while (1) {\n        var mod = (high % radix) * BIT32 + low;\n        high = Math.floor(high / radix);\n        low = Math.floor(mod / radix);\n        str = (mod % radix).toString(radix) + str;\n        if (!high && !low) break;\n      }\n      if (sign) {\n        str = \"-\" + str;\n      }\n      return str;\n    }\n\n    function writeInt32(buffer, offset, value) {\n      buffer[offset + pos3] = value & 255;\n      value = value >> 8;\n      buffer[offset + pos2] = value & 255;\n      value = value >> 8;\n      buffer[offset + pos1] = value & 255;\n      value = value >> 8;\n      buffer[offset + pos0] = value & 255;\n    }\n\n    function readInt32(buffer, offset) {\n      return (buffer[offset + pos0] * BIT24) +\n        (buffer[offset + pos1] << 16) +\n        (buffer[offset + pos2] << 8) +\n        buffer[offset + pos3];\n    }\n  }\n\n  function toArray(raw) {\n    var buffer = this.buffer;\n    var offset = this.offset;\n    storage = null; // Array\n    if (raw !== false && offset === 0 && buffer.length === 8 && isArray(buffer)) return buffer;\n    return newArray(buffer, offset);\n  }\n\n  function toBuffer(raw) {\n    var buffer = this.buffer;\n    var offset = this.offset;\n    storage = BUFFER;\n    if (raw !== false && offset === 0 && buffer.length === 8 && Buffer.isBuffer(buffer)) return buffer;\n    var dest = new BUFFER(8);\n    fromArray(dest, 0, buffer, offset);\n    return dest;\n  }\n\n  function toArrayBuffer(raw) {\n    var buffer = this.buffer;\n    var offset = this.offset;\n    var arrbuf = buffer.buffer;\n    storage = UINT8ARRAY;\n    if (raw !== false && offset === 0 && (arrbuf instanceof ARRAYBUFFER) && arrbuf.byteLength === 8) return arrbuf;\n    var dest = new UINT8ARRAY(8);\n    fromArray(dest, 0, buffer, offset);\n    return dest.buffer;\n  }\n\n  function isValidBuffer(buffer, offset) {\n    var len = buffer && buffer.length;\n    offset |= 0;\n    return len && (offset + 8 <= len) && (\"string\" !== typeof buffer[offset]);\n  }\n\n  function fromArray(destbuf, destoff, srcbuf, srcoff) {\n    destoff |= 0;\n    srcoff |= 0;\n    for (var i = 0; i < 8; i++) {\n      destbuf[destoff++] = srcbuf[srcoff++] & 255;\n    }\n  }\n\n  function newArray(buffer, offset) {\n    return Array.prototype.slice.call(buffer, offset, offset + 8);\n  }\n\n  function fromPositiveBE(buffer, offset, value) {\n    var pos = offset + 8;\n    while (pos > offset) {\n      buffer[--pos] = value & 255;\n      value /= 256;\n    }\n  }\n\n  function fromNegativeBE(buffer, offset, value) {\n    var pos = offset + 8;\n    value++;\n    while (pos > offset) {\n      buffer[--pos] = ((-value) & 255) ^ 255;\n      value /= 256;\n    }\n  }\n\n  function fromPositiveLE(buffer, offset, value) {\n    var end = offset + 8;\n    while (offset < end) {\n      buffer[offset++] = value & 255;\n      value /= 256;\n    }\n  }\n\n  function fromNegativeLE(buffer, offset, value) {\n    var end = offset + 8;\n    value++;\n    while (offset < end) {\n      buffer[offset++] = ((-value) & 255) ^ 255;\n      value /= 256;\n    }\n  }\n\n  // https://github.com/retrofox/is-array\n  function _isArray(val) {\n    return !!val && \"[object Array]\" == Object.prototype.toString.call(val);\n  }\n\n}(typeof exports === 'object' && typeof exports.nodeName !== 'string' ? exports : (this || {}));\n","/*jslint node: true, vars: true, nomen: true */\n'use strict';\n\nvar byEbmlID = {\n\t0x80: {\n\t\tname: \"ChapterDisplay\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\twebm: true,\n\t\tdescription: \"Contains all possible strings to use for the chapter display.\"\n\t},\n\t0x83: {\n\t\tname: \"TrackType\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tdescription: \"The `TrackType` defines the type of each frame found in the Track. The value **SHOULD** be stored on 1 octet.\"\n\t},\n\t0x85: {\n\t\tname: \"ChapString\",\n\t\tcppname: \"ChapterString\",\n\t\tlevel: 5,\n\t\ttype: \"8\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\tdescription: \"Contains the string to use as the chapter atom.\"\n\t},\n\t0x86: {\n\t\tname: \"CodecID\",\n\t\tlevel: 3,\n\t\ttype: \"s\",\n\t\tmandatory: true,\n\t\tdescription: \"An ID corresponding to the codec, see [@!MatroskaCodec] for more info.\"\n\t},\n\t0x88: {\n\t\tname: \"FlagDefault\",\n\t\tcppname: \"TrackFlagDefault\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"1\",\n\t\trange: \"0-1\",\n\t\tdescription: \"Set if that track (audio, video or subs) **SHOULD** be eligible for automatic selection by the player; see (#default-track-selection) for more details.\"\n\t},\n\t0x89: {\n\t\tname: \"ChapterTrackUID\",\n\t\tcppname: \"ChapterTrackNumber\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\trange: \"not 0\",\n\t\tdescription: \"UID of the Track to apply this chapter to. In the absence of a control track, choosing this chapter will select the listed Tracks and deselect unlisted tracks. Absence of this Element indicates that the Chapter **SHOULD** be applied to any currently used Tracks.\"\n\t},\n\t0x8e: {\n\t\tname: \"Slices\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tmaxver: 0,\n\t\tdescription: \"Contains slices description.\"\n\t},\n\t0x8f: {\n\t\tname: \"ChapterTrack\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tdescription: \"List of tracks on which the chapter applies. If this Element is not present, all tracks apply\"\n\t},\n\t0x91: {\n\t\tname: \"ChapterTimeStart\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\tdescription: \"Timestamp of the start of Chapter, expressed in Matroska Ticks -- ie in nanoseconds; see (#timestamp-ticks).\"\n\t},\n\t0x92: {\n\t\tname: \"ChapterTimeEnd\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\twebm: true,\n\t\tdescription: \"Timestamp of the end of Chapter timestamp excluded, expressed in Matroska Ticks -- ie in nanoseconds; see (#timestamp-ticks). The value **MUST** be greater than or equal to the `ChapterTimeStart` of the same `ChapterAtom`.\"\n\t},\n\t0x96: {\n\t\tname: \"CueRefTime\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 2,\n\t\tdescription: \"Timestamp of the referenced Block, expressed in Matroska Ticks -- ie in nanoseconds; see (#timestamp-ticks).\"\n\t},\n\t0x97: {\n\t\tname: \"CueRefCluster\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"The Segment Position of the Cluster containing the referenced Block.\"\n\t},\n\t0x98: {\n\t\tname: \"ChapterFlagHidden\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if a chapter is hidden. Hidden chapters **SHOULD NOT** be available to the user interface (but still to Control Tracks; see (#chapterflaghidden) on Chapter flags).\"\n\t},\n\t0x9a: {\n\t\tname: \"FlagInterlaced\",\n\t\tcppname: \"VideoFlagInterlaced\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 2,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Specify whether the video frames in this track are interlaced or not.\"\n\t},\n\t0x9b: {\n\t\tname: \"BlockDuration\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tdescription: \"The duration of the Block, expressed in Track Ticks; see (#timestamp-ticks). The BlockDuration Element can be useful at the end of a Track to define the duration of the last frame (as there is no subsequent Block available), or when there is a break in a track like for subtitle tracks.\"\n\t},\n\t0x9c: {\n\t\tname: \"FlagLacing\",\n\t\tcppname: \"TrackFlagLacing\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"1\",\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if the track **MAY** contain blocks using lacing. When set to 0 all blocks **MUST** have their lacing flags set to No lacing; see (#block-lacing) on Block Lacing.\"\n\t},\n\t0x9d: {\n\t\tname: \"FieldOrder\",\n\t\tcppname: \"VideoFieldOrder\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\t\"default\": \"2\",\n\t\tdescription: \"Specify the field ordering of video frames in this track.\"\n\t},\n\t0x9f: {\n\t\tname: \"Channels\",\n\t\tcppname: \"AudioChannels\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"1\",\n\t\trange: \"not 0\",\n\t\tdescription: \"Numbers of channels in the track.\"\n\t},\n\t0xa0: {\n\t\tname: \"BlockGroup\",\n\t\tlevel: 2,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\tdescription: \"Basic container of information containing a single Block and information specific to that Block.\"\n\t},\n\t0xa1: {\n\t\tname: \"Block\",\n\t\tlevel: 3,\n\t\ttype: \"b\",\n\t\tmandatory: true,\n\t\tdescription: \"Block containing the actual data to be rendered and a timestamp relative to the Cluster Timestamp; see (#block-structure) on Block Structure.\"\n\t},\n\t0xa2: {\n\t\tname: \"BlockVirtual\",\n\t\tlevel: 3,\n\t\ttype: \"b\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"A Block with no data. It **MUST** be stored in the stream at the place the real Block would be in display order. \"\n\t},\n\t0xa3: {\n\t\tname: \"SimpleBlock\",\n\t\tlevel: 2,\n\t\ttype: \"b\",\n\t\tmultiple: true,\n\t\tminver: 2,\n\t\twebm: true,\n\t\tdivx: true,\n\t\tdescription: \"Similar to Block, see (#block-structure), but without all the extra information, mostly used to reduced overhead when no extra feature is needed; see (#simpleblock-structure) on SimpleBlock Structure.\"\n\t},\n\t0xa4: {\n\t\tname: \"CodecState\",\n\t\tlevel: 3,\n\t\ttype: \"b\",\n\t\tminver: 2,\n\t\tdescription: \"The new codec state to use. Data interpretation is private to the codec. This information **SHOULD** always be referenced by a seek entry.\"\n\t},\n\t0xa5: {\n\t\tname: \"BlockAdditional\",\n\t\tlevel: 5,\n\t\ttype: \"b\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\tdescription: \"Interpreted by the codec as it wishes (using the BlockAddID).\"\n\t},\n\t0xa6: {\n\t\tname: \"BlockMore\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\twebm: true,\n\t\tdescription: \"Contain the BlockAdditional and some parameters.\"\n\t},\n\t0xa7: {\n\t\tname: \"Position\",\n\t\tcppname: \"ClusterPosition\",\n\t\tlevel: 2,\n\t\ttype: \"u\",\n\t\tdescription: \"The Segment Position of the Cluster in the Segment (0 in live streams). It might help to resynchronise offset on damaged streams.\"\n\t},\n\t0xaa: {\n\t\tname: \"CodecDecodeAll\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tmaxver: 0,\n\t\t\"default\": \"1\",\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if the codec can decode potentially damaged data.\"\n\t},\n\t0xab: {\n\t\tname: \"PrevSize\",\n\t\tcppname: \"ClusterPrevSize\",\n\t\tlevel: 2,\n\t\ttype: \"u\",\n\t\tdescription: \"Size of the previous Cluster, in octets. Can be useful for backward playing.\"\n\t},\n\t0xae: {\n\t\tname: \"TrackEntry\",\n\t\tlevel: 2,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\tdescription: \"Describes a track with all Elements.\"\n\t},\n\t0xaf: {\n\t\tname: \"EncryptedBlock\",\n\t\tlevel: 2,\n\t\ttype: \"b\",\n\t\tmultiple: true,\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"Similar to SimpleBlock, see (#simpleblock-structure), but the data inside the Block are Transformed (encrypt and/or signed).\"\n\t},\n\t0xb0: {\n\t\tname: \"PixelWidth\",\n\t\tcppname: \"VideoPixelWidth\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\trange: \"not 0\",\n\t\tdescription: \"Width of the encoded video frames in pixels.\"\n\t},\n\t0xb2: {\n\t\tname: \"CueDuration\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"The duration of the block, expressed in Segment Ticks which is based on TimestampScale; see (#timestamp-ticks). If missing, the track's DefaultDuration does not apply and no duration information is available in terms of the cues.\"\n\t},\n\t0xb3: {\n\t\tname: \"CueTime\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tdescription: \"Absolute timestamp of the seek point, expressed in Matroska Ticks -- ie in nanoseconds; see (#timestamp-ticks).\"\n\t},\n\t0xb5: {\n\t\tname: \"SamplingFrequency\",\n\t\tcppname: \"AudioSamplingFreq\",\n\t\tlevel: 4,\n\t\ttype: \"f\",\n\t\tmandatory: true,\n\t\t\"default\": \"0x1.f4p+12\",\n\t\trange: \"> 0x0p+0\",\n\t\tdescription: \"Sampling frequency in Hz.\"\n\t},\n\t0xb6: {\n\t\tname: \"ChapterAtom\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\twebm: true,\n\t\tdescription: \"Contains the atom information to use as the chapter atom (apply to all tracks).\"\n\t},\n\t0xb7: {\n\t\tname: \"CueTrackPositions\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\tdescription: \"Contain positions for different tracks corresponding to the timestamp.\"\n\t},\n\t0xb9: {\n\t\tname: \"FlagEnabled\",\n\t\tcppname: \"TrackFlagEnabled\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 2,\n\t\twebm: true,\n\t\t\"default\": \"1\",\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if the track is usable. It is possible to turn a not usable track into a usable track using chapter codecs or control tracks.\"\n\t},\n\t0xba: {\n\t\tname: \"PixelHeight\",\n\t\tcppname: \"VideoPixelHeight\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\trange: \"not 0\",\n\t\tdescription: \"Height of the encoded video frames in pixels.\"\n\t},\n\t0xbb: {\n\t\tname: \"CuePoint\",\n\t\tlevel: 2,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\tdescription: \"Contains all information relative to a seek point in the Segment.\"\n\t},\n\t0xbf: {\n\t\tname: \"CRC-32\",\n\t\tlevel: -1,\n\t\ttype: \"b\",\n\t\tminver: 1,\n\t\twebm: false,\n\t\tdescription: \"The CRC is computed on all the data of the Master element it's in. The CRC element should be the first in it's parent master for easier reading. All level 1 elements should include a CRC-32. The CRC in use is the IEEE CRC32 Little Endian.\",\n\t\tcrc: true\n\t},\n\t0xc0: {\n\t\tname: \"TrickTrackUID\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdivx: true,\n\t\tdescription: \"The TrackUID of the Smooth FF/RW video in the paired EBML structure corresponding to this video track. See [@?DivXTrickTrack].\"\n\t},\n\t0xc1: {\n\t\tname: \"TrickTrackSegmentUID\",\n\t\tlevel: 3,\n\t\ttype: \"b\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdivx: true,\n\t\tdescription: \"The SegmentUID of the Segment containing the track identified by TrickTrackUID. See [@?DivXTrickTrack].\"\n\t},\n\t0xc4: {\n\t\tname: \"TrickMasterTrackSegmentUID\",\n\t\tlevel: 3,\n\t\ttype: \"b\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdivx: true,\n\t\tdescription: \"The SegmentUID of the Segment containing the track identified by MasterTrackUID. See [@?DivXTrickTrack].\"\n\t},\n\t0xc6: {\n\t\tname: \"TrickTrackFlag\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdivx: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Set to 1 if this video track is a Smooth FF/RW track. If set to 1, MasterTrackUID and MasterTrackSegUID should must be present and BlockGroups for this track must contain ReferenceFrame structures. Otherwise, TrickTrackUID and TrickTrackSegUID must be present if this track has a corresponding Smooth FF/RW track. See [@?DivXTrickTrack].\"\n\t},\n\t0xc7: {\n\t\tname: \"TrickMasterTrackUID\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdivx: true,\n\t\tdescription: \"The TrackUID of the video track in the paired EBML structure that corresponds to this Smooth FF/RW track. See [@?DivXTrickTrack].\"\n\t},\n\t0xc8: {\n\t\tname: \"ReferenceFrame\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdivx: true,\n\t\tdescription: \"Contains information about the last reference frame. See [@?DivXTrickTrack].\"\n\t},\n\t0xc9: {\n\t\tname: \"ReferenceOffset\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdivx: true,\n\t\tdescription: \"The relative offset, in bytes, from the previous BlockGroup element for this Smooth FF/RW video track to the containing BlockGroup element. See [@?DivXTrickTrack].\"\n\t},\n\t0xca: {\n\t\tname: \"ReferenceTimestamp\",\n\t\tcppname: \"ReferenceTimeCode\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdivx: true,\n\t\tdescription: \"The timestamp of the BlockGroup pointed to by ReferenceOffset, expressed in Track Ticks; see (#timestamp-ticks). See [@?DivXTrickTrack].\"\n\t},\n\t0xcb: {\n\t\tname: \"BlockAdditionID\",\n\t\tcppname: \"SliceBlockAddID\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The ID of the BlockAdditional Element (0 is the main Block).\"\n\t},\n\t0xcc: {\n\t\tname: \"LaceNumber\",\n\t\tcppname: \"SliceLaceNumber\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"The reverse number of the frame in the lace (0 is the last frame, 1 is the next to last, etc). Being able to interpret this Element is not **REQUIRED** for playback.\"\n\t},\n\t0xcd: {\n\t\tname: \"FrameNumber\",\n\t\tcppname: \"SliceFrameNumber\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The number of the frame to generate from this lace with this delay (allow you to generate many frames from the same Block/Frame).\"\n\t},\n\t0xce: {\n\t\tname: \"Delay\",\n\t\tcppname: \"SliceDelay\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The delay to apply to the Element, expressed in Track Ticks; see (#timestamp-ticks).\"\n\t},\n\t0xcf: {\n\t\tname: \"SliceDuration\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The duration to apply to the Element, expressed in Track Ticks; see (#timestamp-ticks).\"\n\t},\n\t0xd7: {\n\t\tname: \"TrackNumber\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\trange: \"not 0\",\n\t\tdescription: \"The track number as used in the Block Header (using more than 127 tracks is not encouraged, though the design allows an unlimited number).\"\n\t},\n\t0xdb: {\n\t\tname: \"CueReference\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\tminver: 2,\n\t\tdescription: \"The Clusters containing the referenced Blocks.\"\n\t},\n\t0xe0: {\n\t\tname: \"Video\",\n\t\tcppname: \"TrackVideo\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tdescription: \"Video settings.\"\n\t},\n\t0xe1: {\n\t\tname: \"Audio\",\n\t\tcppname: \"TrackAudio\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tdescription: \"Audio settings.\"\n\t},\n\t0xe2: {\n\t\tname: \"TrackOperation\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tminver: 3,\n\t\tdescription: \"Operation that needs to be applied on tracks to create this virtual track. For more details look at (#track-operation).\"\n\t},\n\t0xe3: {\n\t\tname: \"TrackCombinePlanes\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tminver: 3,\n\t\tdescription: \"Contains the list of all video plane tracks that need to be combined to create this 3D track\"\n\t},\n\t0xe4: {\n\t\tname: \"TrackPlane\",\n\t\tlevel: 5,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\tminver: 3,\n\t\tdescription: \"Contains a video plane track that need to be combined to create this 3D track\"\n\t},\n\t0xe5: {\n\t\tname: \"TrackPlaneUID\",\n\t\tlevel: 6,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 3,\n\t\trange: \"not 0\",\n\t\tdescription: \"The trackUID number of the track representing the plane.\"\n\t},\n\t0xe6: {\n\t\tname: \"TrackPlaneType\",\n\t\tlevel: 6,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 3,\n\t\tdescription: \"The kind of plane this track corresponds to.\"\n\t},\n\t0xe7: {\n\t\tname: \"Timestamp\",\n\t\tcppname: \"ClusterTimecode\",\n\t\tlevel: 2,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tdescription: \"Absolute timestamp of the cluster, expressed in Segment Ticks which is based on TimestampScale; see (#timestamp-ticks).\"\n\t},\n\t0xe8: {\n\t\tname: \"TimeSlice\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"Contains extra time information about the data contained in the Block. Being able to interpret this Element is not **REQUIRED** for playback.\"\n\t},\n\t0xe9: {\n\t\tname: \"TrackJoinBlocks\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tminver: 3,\n\t\tdescription: \"Contains the list of all tracks whose Blocks need to be combined to create this virtual track\"\n\t},\n\t0xea: {\n\t\tname: \"CueCodecState\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 2,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The Segment Position of the Codec State corresponding to this Cue Element. 0 means that the data is taken from the initial Track Entry.\"\n\t},\n\t0xeb: {\n\t\tname: \"CueRefCodecState\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The Segment Position of the Codec State corresponding to this referenced Element. 0 means that the data is taken from the initial Track Entry.\"\n\t},\n\t0xec: {\n\t\tname: \"Void\",\n\t\tlevel: -1,\n\t\ttype: \"b\",\n\t\tminver: 1,\n\t\tdescription: \"Used to void damaged data, to avoid unexpected behaviors when using damaged data. The content is discarded. Also used to reserve space in a sub-element for later use.\"\n\t},\n\t0xed: {\n\t\tname: \"TrackJoinUID\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\tminver: 3,\n\t\trange: \"not 0\",\n\t\tdescription: \"The trackUID number of a track whose blocks are used to create this virtual track.\"\n\t},\n\t0xee: {\n\t\tname: \"BlockAddID\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\t\"default\": \"1\",\n\t\trange: \"not 0\",\n\t\tdescription: \"An ID to identify the BlockAdditional level. If BlockAddIDType of the corresponding block is 0, this value is also the value of BlockAddIDType for the meaning of the content of BlockAdditional.\"\n\t},\n\t0xf0: {\n\t\tname: \"CueRelativePosition\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"The relative position inside the Cluster of the referenced SimpleBlock or BlockGroup with 0 being the first possible position for an Element inside that Cluster.\"\n\t},\n\t0xf1: {\n\t\tname: \"CueClusterPosition\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tdescription: \"The Segment Position of the Cluster containing the associated Block.\"\n\t},\n\t0xf7: {\n\t\tname: \"CueTrack\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\trange: \"not 0\",\n\t\tdescription: \"The track for which a position is given.\"\n\t},\n\t0xfa: {\n\t\tname: \"ReferencePriority\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"This frame is referenced and has the specified cache priority. In cache only a frame of the same or higher priority can replace this frame. A value of 0 means the frame is not referenced.\"\n\t},\n\t0xfb: {\n\t\tname: \"ReferenceBlock\",\n\t\tlevel: 3,\n\t\ttype: \"i\",\n\t\tmultiple: true,\n\t\tdescription: \"A timestamp value, relative to the timestamp of the Block in this BlockGroup, expressed in Track Ticks; see (#timestamp-ticks). This is used to reference other frames necessary to decode this frame. The relative value **SHOULD** correspond to a valid `Block` this `Block` depends on. Historically Matroska Writer didn't write the actual `Block(s)` this `Block` depends on, but *some* `Block` in the past.  The value \\\"0\\\" **MAY** also be used to signify this `Block` cannot be decoded on its own, but without knownledge of which `Block` is necessary. In this case, other `ReferenceBlock` **MUST NOT** be found in the same `BlockGroup`.  If the `BlockGroup` doesn't have any `ReferenceBlock` element, then the `Block` it contains can be decoded without using any other `Block` data.\"\n\t},\n\t0xfd: {\n\t\tname: \"ReferenceVirtual\",\n\t\tlevel: 3,\n\t\ttype: \"i\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"The Segment Position of the data that would otherwise be in position of the virtual block.\"\n\t},\n\t0x41a4: {\n\t\tname: \"BlockAddIDName\",\n\t\tlevel: 4,\n\t\ttype: \"s\",\n\t\tminver: 4,\n\t\tdescription: \"A human-friendly name describing the type of BlockAdditional data, as defined by the associated Block Additional Mapping.\"\n\t},\n\t0x41e4: {\n\t\tname: \"BlockAdditionMapping\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\tminver: 4,\n\t\tdescription: \"Contains elements that extend the track format, by adding content either to each frame, with BlockAddID ((#blockaddid-element)), or to the track as a whole with BlockAddIDExtraData.\"\n\t},\n\t0x41e7: {\n\t\tname: \"BlockAddIDType\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Stores the registered identifier of the Block Additional Mapping to define how the BlockAdditional data should be handled.\"\n\t},\n\t0x41ed: {\n\t\tname: \"BlockAddIDExtraData\",\n\t\tlevel: 4,\n\t\ttype: \"b\",\n\t\tminver: 4,\n\t\tdescription: \"Extra binary data that the BlockAddIDType can use to interpret the BlockAdditional data. The interpretation of the binary data depends on the BlockAddIDType value and the corresponding Block Additional Mapping.\"\n\t},\n\t0x41f0: {\n\t\tname: \"BlockAddIDValue\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\trange: \">=2\",\n\t\tdescription: \"If the track format extension needs content beside frames, the value refers to the BlockAddID ((#blockaddid-element)), value being described. To keep MaxBlockAdditionID as low as possible, small values **SHOULD** be used.\"\n\t},\n\t0x4254: {\n\t\tname: \"ContentCompAlgo\",\n\t\tlevel: 6,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The compression algorithm used.\"\n\t},\n\t0x4255: {\n\t\tname: \"ContentCompSettings\",\n\t\tlevel: 6,\n\t\ttype: \"b\",\n\t\tdescription: \"Settings that might be needed by the decompressor. For Header Stripping (`ContentCompAlgo`=3), the bytes that were removed from the beginning of each frames of the track.\"\n\t},\n\t0x4282: {\n\t\tname: \"DocType\",\n\t\tlevel: 1,\n\t\ttype: \"s\",\n\t\tmandatory: true,\n\t\t\"default\": \"matroska\",\n\t\tminver: 1,\n\t\tdescription: \"A string that describes the type of document that follows this EBML header. 'matroska' in our case or 'webm' for webm files.\"\n\t},\n\t0x4285: {\n\t\tname: \"DocTypeReadVersion\",\n\t\tlevel: 1,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": 1,\n\t\tminver: 1,\n\t\tdescription: \"The minimum DocType version an interpreter has to support to read this file.\"\n\t},\n\t0x4286: {\n\t\tname: \"EBMLVersion\",\n\t\tlevel: 1,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": 1,\n\t\tminver: 1,\n\t\tdescription: \"The version of EBML parser used to create the file.\"\n\t},\n\t0x4287: {\n\t\tname: \"DocTypeVersion\",\n\t\tlevel: 1,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": 1,\n\t\tminver: 1,\n\t\tdescription: \"The version of DocType interpreter used to create the file.\"\n\t},\n\t0x42f2: {\n\t\tname: \"EBMLMaxIDLength\",\n\t\tlevel: 1,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"4\",\n\t\trange: \">=4\"\n\t},\n\t0x42f3: {\n\t\tname: \"EBMLMaxSizeLength\",\n\t\tlevel: 1,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"8\",\n\t\trange: \"not 0\"\n\t},\n\t0x42f7: {\n\t\tname: \"EBMLReadVersion\",\n\t\tlevel: 1,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": 1,\n\t\tminver: 1,\n\t\tdescription: \"The minimum EBML version a parser has to support to read this file.\"\n\t},\n\t0x437c: {\n\t\tname: \"ChapLanguage\",\n\t\tcppname: \"ChapterLanguage\",\n\t\tlevel: 5,\n\t\ttype: \"s\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\twebm: true,\n\t\t\"default\": \"eng\",\n\t\tdescription: \"A language corresponding to the string, in the bibliographic ISO-639-2 form [@!ISO639-2]. This Element **MUST** be ignored if a ChapLanguageIETF Element is used within the same ChapterDisplay Element.\"\n\t},\n\t0x437d: {\n\t\tname: \"ChapLanguageIETF\",\n\t\tlevel: 5,\n\t\ttype: \"s\",\n\t\tmultiple: true,\n\t\tminver: 4,\n\t\tdescription: \"Specifies a language corresponding to the ChapString in the format defined in [@!BCP47] and using the IANA Language Subtag Registry [@!IANALangRegistry]. If a ChapLanguageIETF Element is used, then any ChapLanguage and ChapCountry Elements used in the same ChapterDisplay **MUST** be ignored.\"\n\t},\n\t0x437e: {\n\t\tname: \"ChapCountry\",\n\t\tcppname: \"ChapterCountry\",\n\t\tlevel: 5,\n\t\ttype: \"s\",\n\t\tmultiple: true,\n\t\twebm: true,\n\t\tdescription: \"A country corresponding to the string, using the same 2 octets country-codes as in Internet domains [@!IANADomains] based on [@!ISO3166-1] alpha-2 codes. This Element **MUST** be ignored if a ChapLanguageIETF Element is used within the same ChapterDisplay Element.\"\n\t},\n\t0x4444: {\n\t\tname: \"SegmentFamily\",\n\t\tlevel: 2,\n\t\ttype: \"b\",\n\t\tmultiple: true,\n\t\tdescription: \"A randomly generated unique ID that all Segments of a Linked Segment **MUST** share (128 bits).\"\n\t},\n\t0x4461: {\n\t\tname: \"DateUTC\",\n\t\tlevel: 2,\n\t\ttype: \"d\",\n\t\tdescription: \"The date and time that the Segment was created by the muxing application or library.\"\n\t},\n\t0x447a: {\n\t\tname: \"TagLanguage\",\n\t\tcppname: \"TagLangue\",\n\t\tlevel: 4,\n\t\ttype: \"s\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\t\"default\": \"und\",\n\t\tdescription: \"Specifies the language of the tag specified, in the Matroska languages form; see (#language-codes) on language codes. This Element **MUST** be ignored if the TagLanguageIETF Element is used within the same SimpleTag Element.\"\n\t},\n\t0x447b: {\n\t\tname: \"TagLanguageIETF\",\n\t\tlevel: 4,\n\t\ttype: \"s\",\n\t\tminver: 4,\n\t\tdescription: \"Specifies the language used in the TagString according to [@!BCP47] and using the IANA Language Subtag Registry [@!IANALangRegistry]. If this Element is used, then any TagLanguage Elements used in the same SimpleTag **MUST** be ignored.\"\n\t},\n\t0x4484: {\n\t\tname: \"TagDefault\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\t\"default\": \"1\",\n\t\trange: \"0-1\",\n\t\tdescription: \"A boolean value to indicate if this is the default/original language to use for the given tag.\"\n\t},\n\t0x4485: {\n\t\tname: \"TagBinary\",\n\t\tlevel: 4,\n\t\ttype: \"b\",\n\t\twebm: true,\n\t\tdescription: \"The values of the Tag, if it is binary. Note that this cannot be used in the same SimpleTag as TagString.\"\n\t},\n\t0x4487: {\n\t\tname: \"TagString\",\n\t\tlevel: 4,\n\t\ttype: \"8\",\n\t\twebm: true,\n\t\tdescription: \"The value of the Tag.\"\n\t},\n\t0x4489: {\n\t\tname: \"Duration\",\n\t\tlevel: 2,\n\t\ttype: \"f\",\n\t\trange: \"> 0x0p+0\",\n\t\tdescription: \"Duration of the Segment, expressed in Segment Ticks which is based on TimestampScale; see (#timestamp-ticks).\"\n\t},\n\t0x44b4: {\n\t\tname: \"TagDefaultBogus\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\t\"default\": \"1\",\n\t\trange: \"0-1\",\n\t\tdescription: \"A variant of the TagDefault element with a bogus Element ID; see (#tagdefault-element).\"\n\t},\n\t0x450d: {\n\t\tname: \"ChapProcessPrivate\",\n\t\tcppname: \"ChapterProcessPrivate\",\n\t\tlevel: 5,\n\t\ttype: \"b\",\n\t\tdescription: \"Some optional data attached to the ChapProcessCodecID information. For ChapProcessCodecID = 1, it is the \\\"DVD level\\\" equivalent; see (#menu-features) on DVD menus.\"\n\t},\n\t0x4598: {\n\t\tname: \"ChapterFlagEnabled\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"1\",\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if the chapter is enabled. It can be enabled/disabled by a Control Track. When disabled, the movie **SHOULD** skip all the content between the TimeStart and TimeEnd of this chapter; see (#chapter-flags) on Chapter flags.\"\n\t},\n\t0x45a3: {\n\t\tname: \"TagName\",\n\t\tlevel: 4,\n\t\ttype: \"8\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\tdescription: \"The name of the Tag that is going to be stored.\"\n\t},\n\t0x45b9: {\n\t\tname: \"EditionEntry\",\n\t\tlevel: 2,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\twebm: true,\n\t\tdescription: \"Contains all information about a Segment edition.\"\n\t},\n\t0x45bc: {\n\t\tname: \"EditionUID\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\trange: \"not 0\",\n\t\tdescription: \"A unique ID to identify the edition. It's useful for tagging an edition.\"\n\t},\n\t0x45bd: {\n\t\tname: \"EditionFlagHidden\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if an edition is hidden. Hidden editions **SHOULD NOT** be available to the user interface (but still to Control Tracks; see (#chapter-flags) on Chapter flags).\"\n\t},\n\t0x45db: {\n\t\tname: \"EditionFlagDefault\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if the edition **SHOULD** be used as the default one.\"\n\t},\n\t0x45dd: {\n\t\tname: \"EditionFlagOrdered\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if the chapters can be defined multiple times and the order to play them is enforced; see (#editionflagordered).\"\n\t},\n\t0x465c: {\n\t\tname: \"FileData\",\n\t\tlevel: 3,\n\t\ttype: \"b\",\n\t\tmandatory: true,\n\t\tdescription: \"The data of the file.\"\n\t},\n\t0x4660: {\n\t\tname: \"FileMimeType\",\n\t\tcppname: \"MimeType\",\n\t\tlevel: 3,\n\t\ttype: \"s\",\n\t\tmandatory: true,\n\t\tdescription: \"MIME type of the file.\"\n\t},\n\t0x4661: {\n\t\tname: \"FileUsedStartTime\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdivx: true,\n\t\tdescription: \"The timestamp at which this optimized font attachment comes into context, expressed in Segment Ticks which is based on TimestampScale. See [@?DivXWorldFonts].\"\n\t},\n\t0x4662: {\n\t\tname: \"FileUsedEndTime\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdivx: true,\n\t\tdescription: \"The timestamp at which this optimized font attachment goes out of context, expressed in Segment Ticks which is based on TimestampScale. See [@?DivXWorldFonts].\"\n\t},\n\t0x466e: {\n\t\tname: \"FileName\",\n\t\tlevel: 3,\n\t\ttype: \"8\",\n\t\tmandatory: true,\n\t\tdescription: \"Filename of the attached file.\"\n\t},\n\t0x4675: {\n\t\tname: \"FileReferral\",\n\t\tlevel: 3,\n\t\ttype: \"b\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"A binary value that a track/codec can refer to when the attachment is needed.\"\n\t},\n\t0x467e: {\n\t\tname: \"FileDescription\",\n\t\tlevel: 3,\n\t\ttype: \"8\",\n\t\tdescription: \"A human-friendly name for the attached file.\"\n\t},\n\t0x46ae: {\n\t\tname: \"FileUID\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\trange: \"not 0\",\n\t\tdescription: \"Unique ID representing the file, as random as possible.\"\n\t},\n\t0x47e1: {\n\t\tname: \"ContentEncAlgo\",\n\t\tlevel: 6,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The encryption algorithm used. The value \\\"0\\\" means that the contents have not been encrypted.\"\n\t},\n\t0x47e2: {\n\t\tname: \"ContentEncKeyID\",\n\t\tlevel: 6,\n\t\ttype: \"b\",\n\t\twebm: true,\n\t\tdescription: \"For public key algorithms this is the ID of the public key the the data was encrypted with.\"\n\t},\n\t0x47e3: {\n\t\tname: \"ContentSignature\",\n\t\tlevel: 6,\n\t\ttype: \"b\",\n\t\tmaxver: 0,\n\t\tdescription: \"A cryptographic signature of the contents.\"\n\t},\n\t0x47e4: {\n\t\tname: \"ContentSigKeyID\",\n\t\tlevel: 6,\n\t\ttype: \"b\",\n\t\tmaxver: 0,\n\t\tdescription: \"This is the ID of the private key the data was signed with.\"\n\t},\n\t0x47e5: {\n\t\tname: \"ContentSigAlgo\",\n\t\tlevel: 6,\n\t\ttype: \"u\",\n\t\tmaxver: 0,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The algorithm used for the signature.\"\n\t},\n\t0x47e6: {\n\t\tname: \"ContentSigHashAlgo\",\n\t\tlevel: 6,\n\t\ttype: \"u\",\n\t\tmaxver: 0,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The hash algorithm used for the signature.\"\n\t},\n\t0x47e7: {\n\t\tname: \"ContentEncAESSettings\",\n\t\tlevel: 6,\n\t\ttype: \"m\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"Settings describing the encryption algorithm used. If `ContentEncAlgo` != 5 this **MUST** be ignored.\"\n\t},\n\t0x47e8: {\n\t\tname: \"AESSettingsCipherMode\",\n\t\tlevel: 7,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"The AES cipher mode used in the encryption.\"\n\t},\n\t0x4d80: {\n\t\tname: \"MuxingApp\",\n\t\tlevel: 2,\n\t\ttype: \"8\",\n\t\tmandatory: true,\n\t\tdescription: \"Muxing application or library (example: \\\"libmatroska-0.4.3\\\").\"\n\t},\n\t0x4dbb: {\n\t\tname: \"Seek\",\n\t\tlevel: 2,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\tdescription: \"Contains a single seek entry to an EBML Element.\"\n\t},\n\t0x5031: {\n\t\tname: \"ContentEncodingOrder\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Tells when this modification was used during encoding/muxing starting with 0 and counting upwards. The decoder/demuxer has to start with the highest order number it finds and work its way down. This value has to be unique over all ContentEncodingOrder Elements in the TrackEntry that contains this ContentEncodingOrder element.\"\n\t},\n\t0x5032: {\n\t\tname: \"ContentEncodingScope\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\t\"default\": \"1\",\n\t\tdescription: \"A bit field that describes which Elements have been modified in this way. Values (big-endian) can be OR'ed.\"\n\t},\n\t0x5033: {\n\t\tname: \"ContentEncodingType\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"A value describing what kind of transformation is applied.\"\n\t},\n\t0x5034: {\n\t\tname: \"ContentCompression\",\n\t\tlevel: 5,\n\t\ttype: \"m\",\n\t\tdescription: \"Settings describing the compression used. This Element **MUST** be present if the value of ContentEncodingType is 0 and absent otherwise. Each block **MUST** be decompressable even if no previous block is available in order not to prevent seeking.\"\n\t},\n\t0x5035: {\n\t\tname: \"ContentEncryption\",\n\t\tlevel: 5,\n\t\ttype: \"m\",\n\t\twebm: true,\n\t\tdescription: \"Settings describing the encryption used. This Element **MUST** be present if the value of `ContentEncodingType` is 1 (encryption) and **MUST** be ignored otherwise.\"\n\t},\n\t0x535f: {\n\t\tname: \"CueRefNumber\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\t\"default\": \"1\",\n\t\trange: \"not 0\",\n\t\tdescription: \"Number of the referenced Block of Track X in the specified Cluster.\"\n\t},\n\t0x536e: {\n\t\tname: \"Name\",\n\t\tcppname: \"TrackName\",\n\t\tlevel: 3,\n\t\ttype: \"8\",\n\t\tdescription: \"A human-readable track name.\"\n\t},\n\t0x5378: {\n\t\tname: \"CueBlockNumber\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\trange: \"not 0\",\n\t\tdescription: \"Number of the Block in the specified Cluster.\"\n\t},\n\t0x537f: {\n\t\tname: \"TrackOffset\",\n\t\tlevel: 3,\n\t\ttype: \"i\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\t\"default\": \"0\",\n\t\tdescription: \"A value to add to the Block's Timestamp, expressed in Matroska Ticks -- ie in nanoseconds; see (#timestamp-ticks). This can be used to adjust the playback offset of a track.\"\n\t},\n\t0x53ab: {\n\t\tname: \"SeekID\",\n\t\tlevel: 3,\n\t\ttype: \"b\",\n\t\tmandatory: true,\n\t\tdescription: \"The binary ID corresponding to the Element name.\"\n\t},\n\t0x53ac: {\n\t\tname: \"SeekPosition\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tdescription: \"The Segment Position of the Element.\"\n\t},\n\t0x53b8: {\n\t\tname: \"StereoMode\",\n\t\tcppname: \"VideoStereoMode\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 3,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Stereo-3D video mode. There are some more details in (#multi-planar-and-3d-videos).\"\n\t},\n\t0x53b9: {\n\t\tname: \"OldStereoMode\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmaxver: 0,\n\t\tdescription: \"DEPRECATED, DO NOT USE. Bogus StereoMode value used in old versions of libmatroska.\"\n\t},\n\t0x53c0: {\n\t\tname: \"AlphaMode\",\n\t\tcppname: \"VideoAlphaMode\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 3,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Indicate whether the BlockAdditional Element with BlockAddID of \\\"1\\\" contains Alpha data, as defined by to the Codec Mapping for the `CodecID`. Undefined values **SHOULD NOT** be used as the behavior of known implementations is different (considered either as 0 or 1).\"\n\t},\n\t0x54aa: {\n\t\tname: \"PixelCropBottom\",\n\t\tcppname: \"VideoPixelCropBottom\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The number of video pixels to remove at the bottom of the image.\"\n\t},\n\t0x54b0: {\n\t\tname: \"DisplayWidth\",\n\t\tcppname: \"VideoDisplayWidth\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\trange: \"not 0\",\n\t\tdescription: \"Width of the video frames to display. Applies to the video frame after cropping (PixelCrop* Elements).\"\n\t},\n\t0x54b2: {\n\t\tname: \"DisplayUnit\",\n\t\tcppname: \"VideoDisplayUnit\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"How DisplayWidth & DisplayHeight are interpreted.\"\n\t},\n\t0x54b3: {\n\t\tname: \"AspectRatioType\",\n\t\tcppname: \"VideoAspectRatio\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Specify the possible modifications to the aspect ratio.\"\n\t},\n\t0x54ba: {\n\t\tname: \"DisplayHeight\",\n\t\tcppname: \"VideoDisplayHeight\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\trange: \"not 0\",\n\t\tdescription: \"Height of the video frames to display. Applies to the video frame after cropping (PixelCrop* Elements).\"\n\t},\n\t0x54bb: {\n\t\tname: \"PixelCropTop\",\n\t\tcppname: \"VideoPixelCropTop\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The number of video pixels to remove at the top of the image.\"\n\t},\n\t0x54cc: {\n\t\tname: \"PixelCropLeft\",\n\t\tcppname: \"VideoPixelCropLeft\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The number of video pixels to remove on the left of the image.\"\n\t},\n\t0x54dd: {\n\t\tname: \"PixelCropRight\",\n\t\tcppname: \"VideoPixelCropRight\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The number of video pixels to remove on the right of the image.\"\n\t},\n\t0x55aa: {\n\t\tname: \"FlagForced\",\n\t\tcppname: \"TrackFlagForced\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\trange: \"0-1\",\n\t\tdescription: \"Applies only to subtitles. Set if that track **SHOULD** be eligible for automatic selection by the player if it matches the user's language preference, even if the user's preferences would normally not enable subtitles with the selected audio track; this can be used for tracks containing only translations of foreign-language audio or onscreen text. See (#default-track-selection) for more details.\"\n\t},\n\t0x55ab: {\n\t\tname: \"FlagHearingImpaired\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if that track is suitable for users with hearing impairments, set to 0 if it is unsuitable for users with hearing impairments.\"\n\t},\n\t0x55ac: {\n\t\tname: \"FlagVisualImpaired\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if that track is suitable for users with visual impairments, set to 0 if it is unsuitable for users with visual impairments.\"\n\t},\n\t0x55ad: {\n\t\tname: \"FlagTextDescriptions\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if that track contains textual descriptions of video content, set to 0 if that track does not contain textual descriptions of video content.\"\n\t},\n\t0x55ae: {\n\t\tname: \"FlagOriginal\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if that track is in the content's original language, set to 0 if it is a translation.\"\n\t},\n\t0x55af: {\n\t\tname: \"FlagCommentary\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\trange: \"0-1\",\n\t\tdescription: \"Set to 1 if that track contains commentary, set to 0 if it does not contain commentary.\"\n\t},\n\t0x55b0: {\n\t\tname: \"Colour\",\n\t\tcppname: \"VideoColour\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"Settings describing the colour format.\"\n\t},\n\t0x55b1: {\n\t\tname: \"MatrixCoefficients\",\n\t\tcppname: \"VideoColourMatrix\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"2\",\n\t\tdescription: \"The Matrix Coefficients of the video used to derive luma and chroma values from red, green, and blue color primaries. For clarity, the value and meanings for MatrixCoefficients are adopted from Table 4 of ISO/IEC 23001-8:2016 or ITU-T H.273.\"\n\t},\n\t0x55b2: {\n\t\tname: \"BitsPerChannel\",\n\t\tcppname: \"VideoBitsPerChannel\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Number of decoded bits per channel. A value of 0 indicates that the BitsPerChannel is unspecified.\"\n\t},\n\t0x55b3: {\n\t\tname: \"ChromaSubsamplingHorz\",\n\t\tcppname: \"VideoChromaSubsampHorz\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"The amount of pixels to remove in the Cr and Cb channels for every pixel not removed horizontally. Example: For video with 4:2:0 chroma subsampling, the ChromaSubsamplingHorz **SHOULD** be set to 1.\"\n\t},\n\t0x55b4: {\n\t\tname: \"ChromaSubsamplingVert\",\n\t\tcppname: \"VideoChromaSubsampVert\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"The amount of pixels to remove in the Cr and Cb channels for every pixel not removed vertically. Example: For video with 4:2:0 chroma subsampling, the ChromaSubsamplingVert **SHOULD** be set to 1.\"\n\t},\n\t0x55b5: {\n\t\tname: \"CbSubsamplingHorz\",\n\t\tcppname: \"VideoCbSubsampHorz\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"The amount of pixels to remove in the Cb channel for every pixel not removed horizontally. This is additive with ChromaSubsamplingHorz. Example: For video with 4:2:1 chroma subsampling, the ChromaSubsamplingHorz **SHOULD** be set to 1 and CbSubsamplingHorz **SHOULD** be set to 1.\"\n\t},\n\t0x55b6: {\n\t\tname: \"CbSubsamplingVert\",\n\t\tcppname: \"VideoCbSubsampVert\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"The amount of pixels to remove in the Cb channel for every pixel not removed vertically. This is additive with ChromaSubsamplingVert.\"\n\t},\n\t0x55b7: {\n\t\tname: \"ChromaSitingHorz\",\n\t\tcppname: \"VideoChromaSitHorz\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"How chroma is subsampled horizontally.\"\n\t},\n\t0x55b8: {\n\t\tname: \"ChromaSitingVert\",\n\t\tcppname: \"VideoChromaSitVert\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"How chroma is subsampled vertically.\"\n\t},\n\t0x55b9: {\n\t\tname: \"Range\",\n\t\tcppname: \"VideoColourRange\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Clipping of the color ranges.\"\n\t},\n\t0x55ba: {\n\t\tname: \"TransferCharacteristics\",\n\t\tcppname: \"VideoColourTransferCharacter\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"2\",\n\t\tdescription: \"The transfer characteristics of the video. For clarity, the value and meanings for TransferCharacteristics are adopted from Table 3 of ISO/IEC 23091-4 or ITU-T H.273.\"\n\t},\n\t0x55bb: {\n\t\tname: \"Primaries\",\n\t\tcppname: \"VideoColourPrimaries\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"2\",\n\t\tdescription: \"The colour primaries of the video. For clarity, the value and meanings for Primaries are adopted from Table 2 of ISO/IEC 23091-4 or ITU-T H.273.\"\n\t},\n\t0x55bc: {\n\t\tname: \"MaxCLL\",\n\t\tcppname: \"VideoColourMaxCLL\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"Maximum brightness of a single pixel (Maximum Content Light Level) in candelas per square meter (cd/m^2^).\"\n\t},\n\t0x55bd: {\n\t\tname: \"MaxFALL\",\n\t\tcppname: \"VideoColourMaxFALL\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"Maximum brightness of a single full frame (Maximum Frame-Average Light Level) in candelas per square meter (cd/m^2^).\"\n\t},\n\t0x55d0: {\n\t\tname: \"MasteringMetadata\",\n\t\tcppname: \"VideoColourMasterMeta\",\n\t\tlevel: 5,\n\t\ttype: \"m\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"SMPTE 2086 mastering data.\"\n\t},\n\t0x55d1: {\n\t\tname: \"PrimaryRChromaticityX\",\n\t\tcppname: \"VideoRChromaX\",\n\t\tlevel: 6,\n\t\ttype: \"f\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\trange: \"0-1\",\n\t\tdescription: \"Red X chromaticity coordinate, as defined by CIE 1931.\"\n\t},\n\t0x55d2: {\n\t\tname: \"PrimaryRChromaticityY\",\n\t\tcppname: \"VideoRChromaY\",\n\t\tlevel: 6,\n\t\ttype: \"f\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\trange: \"0-1\",\n\t\tdescription: \"Red Y chromaticity coordinate, as defined by CIE 1931.\"\n\t},\n\t0x55d3: {\n\t\tname: \"PrimaryGChromaticityX\",\n\t\tcppname: \"VideoGChromaX\",\n\t\tlevel: 6,\n\t\ttype: \"f\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\trange: \"0-1\",\n\t\tdescription: \"Green X chromaticity coordinate, as defined by CIE 1931.\"\n\t},\n\t0x55d4: {\n\t\tname: \"PrimaryGChromaticityY\",\n\t\tcppname: \"VideoGChromaY\",\n\t\tlevel: 6,\n\t\ttype: \"f\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\trange: \"0-1\",\n\t\tdescription: \"Green Y chromaticity coordinate, as defined by CIE 1931.\"\n\t},\n\t0x55d5: {\n\t\tname: \"PrimaryBChromaticityX\",\n\t\tcppname: \"VideoBChromaX\",\n\t\tlevel: 6,\n\t\ttype: \"f\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\trange: \"0-1\",\n\t\tdescription: \"Blue X chromaticity coordinate, as defined by CIE 1931.\"\n\t},\n\t0x55d6: {\n\t\tname: \"PrimaryBChromaticityY\",\n\t\tcppname: \"VideoBChromaY\",\n\t\tlevel: 6,\n\t\ttype: \"f\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\trange: \"0-1\",\n\t\tdescription: \"Blue Y chromaticity coordinate, as defined by CIE 1931.\"\n\t},\n\t0x55d7: {\n\t\tname: \"WhitePointChromaticityX\",\n\t\tcppname: \"VideoWhitePointChromaX\",\n\t\tlevel: 6,\n\t\ttype: \"f\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\trange: \"0-1\",\n\t\tdescription: \"White X chromaticity coordinate, as defined by CIE 1931.\"\n\t},\n\t0x55d8: {\n\t\tname: \"WhitePointChromaticityY\",\n\t\tcppname: \"VideoWhitePointChromaY\",\n\t\tlevel: 6,\n\t\ttype: \"f\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\trange: \"0-1\",\n\t\tdescription: \"White Y chromaticity coordinate, as defined by CIE 1931.\"\n\t},\n\t0x55d9: {\n\t\tname: \"LuminanceMax\",\n\t\tcppname: \"VideoLuminanceMax\",\n\t\tlevel: 6,\n\t\ttype: \"f\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\trange: \">= 0x0p+0\",\n\t\tdescription: \"Maximum luminance. Represented in candelas per square meter (cd/m^2^).\"\n\t},\n\t0x55da: {\n\t\tname: \"LuminanceMin\",\n\t\tcppname: \"VideoLuminanceMin\",\n\t\tlevel: 6,\n\t\ttype: \"f\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\trange: \">= 0x0p+0\",\n\t\tdescription: \"Minimum luminance. Represented in candelas per square meter (cd/m^2^).\"\n\t},\n\t0x55ee: {\n\t\tname: \"MaxBlockAdditionID\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The maximum value of BlockAddID ((#blockaddid-element)). A value 0 means there is no BlockAdditions ((#blockadditions-element)) for this track.\"\n\t},\n\t0x5654: {\n\t\tname: \"ChapterStringUID\",\n\t\tlevel: 4,\n\t\ttype: \"8\",\n\t\tminver: 3,\n\t\twebm: true,\n\t\tdescription: \"A unique string ID to identify the Chapter. Use for WebVTT cue identifier storage [@!WebVTT].\"\n\t},\n\t0x56aa: {\n\t\tname: \"CodecDelay\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"CodecDelay is The codec-built-in delay, expressed in Matroska Ticks -- ie in nanoseconds; see (#timestamp-ticks). It represents the amount of codec samples that will be discarded by the decoder during playback. This timestamp value **MUST** be subtracted from each frame timestamp in order to get the timestamp that will be actually played. The value **SHOULD** be small so the muxing of tracks with the same actual timestamp are in the same Cluster.\"\n\t},\n\t0x56bb: {\n\t\tname: \"SeekPreRoll\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"After a discontinuity, SeekPreRoll is the duration of the data the decoder **MUST** decode before the decoded data is valid, expressed in Matroska Ticks -- ie in nanoseconds; see (#timestamp-ticks).\"\n\t},\n\t0x5741: {\n\t\tname: \"WritingApp\",\n\t\tlevel: 2,\n\t\ttype: \"8\",\n\t\tmandatory: true,\n\t\tdescription: \"Writing application (example: \\\"mkvmerge-0.3.3\\\").\"\n\t},\n\t0x5854: {\n\t\tname: \"SilentTracks\",\n\t\tcppname: \"ClusterSilentTracks\",\n\t\tlevel: 2,\n\t\ttype: \"m\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"The list of tracks that are not used in that part of the stream. It is useful when using overlay tracks on seeking or to decide what track to use.\"\n\t},\n\t0x58d7: {\n\t\tname: \"SilentTrackNumber\",\n\t\tcppname: \"ClusterSilentTrackNumber\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmultiple: true,\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"One of the track number that are not used from now on in the stream. It could change later if not specified as silent in a further Cluster.\"\n\t},\n\t0x61a7: {\n\t\tname: \"AttachedFile\",\n\t\tcppname: \"Attached\",\n\t\tlevel: 2,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\tdescription: \"An attached file.\"\n\t},\n\t0x6240: {\n\t\tname: \"ContentEncoding\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\twebm: true,\n\t\tdescription: \"Settings for one content encoding like compression or encryption.\"\n\t},\n\t0x6264: {\n\t\tname: \"BitDepth\",\n\t\tcppname: \"AudioBitDepth\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\trange: \"not 0\",\n\t\tdescription: \"Bits per sample, mostly used for PCM.\"\n\t},\n\t0x63a2: {\n\t\tname: \"CodecPrivate\",\n\t\tlevel: 3,\n\t\ttype: \"b\",\n\t\tdescription: \"Private data only known to the codec.\"\n\t},\n\t0x63c0: {\n\t\tname: \"Targets\",\n\t\tcppname: \"TagTargets\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\tdescription: \"Specifies which other elements the metadata represented by the Tag applies to. If empty or not present, then the Tag describes everything in the Segment.\"\n\t},\n\t0x63c3: {\n\t\tname: \"ChapterPhysicalEquiv\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tdescription: \"Specify the physical equivalent of this ChapterAtom like \\\"DVD\\\" (60) or \\\"SIDE\\\" (50); see (#physical-types) for a complete list of values.\"\n\t},\n\t0x63c4: {\n\t\tname: \"TagChapterUID\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmultiple: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"A unique ID to identify the Chapter(s) the tags belong to.\"\n\t},\n\t0x63c5: {\n\t\tname: \"TagTrackUID\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmultiple: true,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"A unique ID to identify the Track(s) the tags belong to.\"\n\t},\n\t0x63c6: {\n\t\tname: \"TagAttachmentUID\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmultiple: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"A unique ID to identify the Attachment(s) the tags belong to.\"\n\t},\n\t0x63c9: {\n\t\tname: \"TagEditionUID\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmultiple: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"A unique ID to identify the EditionEntry(s) the tags belong to.\"\n\t},\n\t0x63ca: {\n\t\tname: \"TargetType\",\n\t\tcppname: \"TagTargetType\",\n\t\tlevel: 4,\n\t\ttype: \"s\",\n\t\twebm: true,\n\t\tdescription: \"An informational string that can be used to display the logical level of the target like \\\"ALBUM\\\", \\\"TRACK\\\", \\\"MOVIE\\\", \\\"CHAPTER\\\", etc ; see Section 6.4 of [@!MatroskaTags].\"\n\t},\n\t0x6532: {\n\t\tname: \"SignedElement\",\n\t\tlevel: 2,\n\t\ttype: \"b\",\n\t\tmultiple: true,\n\t\twebm: false,\n\t\tdescription: \"An element ID whose data will be used to compute the signature.\"\n\t},\n\t0x6624: {\n\t\tname: \"TrackTranslate\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\tdescription: \"The mapping between this `TrackEntry` and a track value in the given Chapter Codec.\"\n\t},\n\t0x66a5: {\n\t\tname: \"TrackTranslateTrackID\",\n\t\tlevel: 4,\n\t\ttype: \"b\",\n\t\tmandatory: true,\n\t\tdescription: \"The binary value used to represent this `TrackEntry` in the chapter codec data. The format depends on the `ChapProcessCodecID` used; see (#chapprocesscodecid-element).\"\n\t},\n\t0x66bf: {\n\t\tname: \"TrackTranslateCodec\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tdescription: \"This `TrackTranslate` applies to this chapter codec of the given chapter edition(s); see (#chapprocesscodecid-element).\"\n\t},\n\t0x66fc: {\n\t\tname: \"TrackTranslateEditionUID\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmultiple: true,\n\t\tdescription: \"Specify a chapter edition UID on which this `TrackTranslate` applies.\"\n\t},\n\t0x67c8: {\n\t\tname: \"SimpleTag\",\n\t\tcppname: \"TagSimple\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\twebm: true,\n\t\tdescription: \"Contains general information about the target.\"\n\t},\n\t0x68ca: {\n\t\tname: \"TargetTypeValue\",\n\t\tcppname: \"TagTargetTypeValue\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\t\"default\": \"50\",\n\t\tdescription: \"A number to indicate the logical level of the target.\"\n\t},\n\t0x6911: {\n\t\tname: \"ChapProcessCommand\",\n\t\tcppname: \"ChapterProcessCommand\",\n\t\tlevel: 5,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\tdescription: \"Contains all the commands associated to the Atom.\"\n\t},\n\t0x6922: {\n\t\tname: \"ChapProcessTime\",\n\t\tcppname: \"ChapterProcessTime\",\n\t\tlevel: 6,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tdescription: \"Defines when the process command **SHOULD** be handled\"\n\t},\n\t0x6924: {\n\t\tname: \"ChapterTranslate\",\n\t\tlevel: 2,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\tdescription: \"The mapping between this `Segment` and a segment value in the given Chapter Codec.\"\n\t},\n\t0x6933: {\n\t\tname: \"ChapProcessData\",\n\t\tcppname: \"ChapterProcessData\",\n\t\tlevel: 6,\n\t\ttype: \"b\",\n\t\tmandatory: true,\n\t\tdescription: \"Contains the command information. The data **SHOULD** be interpreted depending on the ChapProcessCodecID value. For ChapProcessCodecID = 1, the data correspond to the binary DVD cell pre/post commands; see (#menu-features) on DVD menus.\"\n\t},\n\t0x6944: {\n\t\tname: \"ChapProcess\",\n\t\tcppname: \"ChapterProcess\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\tdescription: \"Contains all the commands associated to the Atom.\"\n\t},\n\t0x6955: {\n\t\tname: \"ChapProcessCodecID\",\n\t\tcppname: \"ChapterProcessCodecID\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Contains the type of the codec used for the processing. A value of 0 means native Matroska processing (to be defined), a value of 1 means the DVD command set is used; see (#menu-features) on DVD menus. More codec IDs can be added later.\"\n\t},\n\t0x69a5: {\n\t\tname: \"ChapterTranslateID\",\n\t\tlevel: 3,\n\t\ttype: \"b\",\n\t\tmandatory: true,\n\t\tdescription: \"The binary value used to represent this Segment in the chapter codec data. The format depends on the ChapProcessCodecID used; see (#chapprocesscodecid-element).\"\n\t},\n\t0x69bf: {\n\t\tname: \"ChapterTranslateCodec\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tdescription: \"This `ChapterTranslate` applies to this chapter codec of the given chapter edition(s); see (#chapprocesscodecid-element).\"\n\t},\n\t0x69fc: {\n\t\tname: \"ChapterTranslateEditionUID\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmultiple: true,\n\t\tdescription: \"Specify a chapter edition UID on which this `ChapterTranslate` applies.\"\n\t},\n\t0x6d80: {\n\t\tname: \"ContentEncodings\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\twebm: true,\n\t\tdescription: \"Settings for several content encoding mechanisms like compression or encryption.\"\n\t},\n\t0x6de7: {\n\t\tname: \"MinCache\",\n\t\tcppname: \"TrackMinCache\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"The minimum number of frames a player **SHOULD** be able to cache during playback. If set to 0, the reference pseudo-cache system is not used.\"\n\t},\n\t0x6df8: {\n\t\tname: \"MaxCache\",\n\t\tcppname: \"TrackMaxCache\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tdescription: \"The maximum cache size necessary to store referenced frames in and the current frame. 0 means no cache is needed.\"\n\t},\n\t0x6e67: {\n\t\tname: \"ChapterSegmentUID\",\n\t\tlevel: 4,\n\t\ttype: \"b\",\n\t\trange: \">0\",\n\t\tdescription: \"The SegmentUID of another Segment to play during this chapter.\"\n\t},\n\t0x6ebc: {\n\t\tname: \"ChapterSegmentEditionUID\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\trange: \"not 0\",\n\t\tdescription: \"The EditionUID to play from the Segment linked in ChapterSegmentUID. If ChapterSegmentEditionUID is undeclared, then no Edition of the linked Segment is used; see (#medium-linking) on medium-linking Segments.\"\n\t},\n\t0x6fab: {\n\t\tname: \"TrackOverlay\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmultiple: true,\n\t\tdescription: \"Specify that this track is an overlay track for the Track specified (in the u-integer). That means when this track has a gap, see (#silenttracks-element) on SilentTracks, the overlay track **SHOULD** be used instead. The order of multiple TrackOverlay matters, the first one is the one that **SHOULD** be used. If not found it **SHOULD** be the second, etc.\"\n\t},\n\t0x7373: {\n\t\tname: \"Tag\",\n\t\tlevel: 2,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: true,\n\t\twebm: true,\n\t\tdescription: \"A single metadata descriptor.\"\n\t},\n\t0x7384: {\n\t\tname: \"SegmentFilename\",\n\t\tlevel: 2,\n\t\ttype: \"8\",\n\t\tdescription: \"A filename corresponding to this Segment.\"\n\t},\n\t0x73a4: {\n\t\tname: \"SegmentUID\",\n\t\tlevel: 2,\n\t\ttype: \"b\",\n\t\trange: \"not 0\",\n\t\tdescription: \"A randomly generated unique ID to identify the Segment amongst many others (128 bits).\"\n\t},\n\t0x73c4: {\n\t\tname: \"ChapterUID\",\n\t\tlevel: 4,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\twebm: true,\n\t\trange: \"not 0\",\n\t\tdescription: \"A unique ID to identify the Chapter.\"\n\t},\n\t0x73c5: {\n\t\tname: \"TrackUID\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\trange: \"not 0\",\n\t\tdescription: \"A unique ID to identify the Track.\"\n\t},\n\t0x7446: {\n\t\tname: \"AttachmentLink\",\n\t\tcppname: \"TrackAttachmentLink\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tmaxver: 3,\n\t\trange: \"not 0\",\n\t\tdescription: \"The UID of an attachment that is used by this codec.\"\n\t},\n\t0x75a1: {\n\t\tname: \"BlockAdditions\",\n\t\tlevel: 3,\n\t\ttype: \"m\",\n\t\twebm: true,\n\t\tdescription: \"Contain additional blocks to complete the main one. An EBML parser that has no knowledge of the Block structure could still see and use/skip these data.\"\n\t},\n\t0x75a2: {\n\t\tname: \"DiscardPadding\",\n\t\tlevel: 3,\n\t\ttype: \"i\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"Duration of the silent data added to the Block, expressed in Matroska Ticks -- ie in nanoseconds; see (#timestamp-ticks) (padding at the end of the Block for positive value, at the beginning of the Block for negative value). The duration of DiscardPadding is not calculated in the duration of the TrackEntry and **SHOULD** be discarded during playback.\"\n\t},\n\t0x7670: {\n\t\tname: \"Projection\",\n\t\tcppname: \"VideoProjection\",\n\t\tlevel: 4,\n\t\ttype: \"m\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"Describes the video projection details. Used to render spherical, VR videos or flipping videos horizontally/vertically.\"\n\t},\n\t0x7671: {\n\t\tname: \"ProjectionType\",\n\t\tcppname: \"VideoProjectionType\",\n\t\tlevel: 5,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"0\",\n\t\tdescription: \"Describes the projection used for this video track.\"\n\t},\n\t0x7672: {\n\t\tname: \"ProjectionPrivate\",\n\t\tcppname: \"VideoProjectionPrivate\",\n\t\tlevel: 5,\n\t\ttype: \"b\",\n\t\tminver: 4,\n\t\twebm: true,\n\t\tdescription: \"Private data that only applies to a specific projection.  *  If `ProjectionType` equals 0 (Rectangular), then this element must not be present. *  If `ProjectionType` equals 1 (Equirectangular), then this element must be present and contain the same binary data that would be stored inside an ISOBMFF Equirectangular Projection Box ('equi'). *  If `ProjectionType` equals 2 (Cubemap), then this element must be present and contain the same binary data that would be stored inside an ISOBMFF Cubemap Projection Box ('cbmp'). *  If `ProjectionType` equals 3 (Mesh), then this element must be present and contain the same binary data that would be stored inside an ISOBMFF Mesh Projection Box ('mshp').\"\n\t},\n\t0x7673: {\n\t\tname: \"ProjectionPoseYaw\",\n\t\tcppname: \"VideoProjectionPoseYaw\",\n\t\tlevel: 5,\n\t\ttype: \"f\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"0x0p+0\",\n\t\trange: \">= -0xB4p+0, <= 0xB4p+0\",\n\t\tdescription: \"Specifies a yaw rotation to the projection.  Value represents a clockwise rotation, in degrees, around the up vector. This rotation must be applied before any `ProjectionPosePitch` or `ProjectionPoseRoll` rotations. The value of this element **MUST** be in the -180 to 180 degree range, both included.  Setting `ProjectionPoseYaw` to 180 or -180 degrees, with the `ProjectionPoseRoll` and `ProjectionPosePitch` set to 0 degrees flips the image horizontally.\"\n\t},\n\t0x7674: {\n\t\tname: \"ProjectionPosePitch\",\n\t\tcppname: \"VideoProjectionPosePitch\",\n\t\tlevel: 5,\n\t\ttype: \"f\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"0x0p+0\",\n\t\trange: \">= -0x5Ap+0, <= 0x5Ap+0\",\n\t\tdescription: \"Specifies a pitch rotation to the projection.  Value represents a counter-clockwise rotation, in degrees, around the right vector. This rotation must be applied after the `ProjectionPoseYaw` rotation and before the `ProjectionPoseRoll` rotation. The value of this element **MUST** be in the -90 to 90 degree range, both included.\"\n\t},\n\t0x7675: {\n\t\tname: \"ProjectionPoseRoll\",\n\t\tcppname: \"VideoProjectionPoseRoll\",\n\t\tlevel: 5,\n\t\ttype: \"f\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\twebm: true,\n\t\t\"default\": \"0x0p+0\",\n\t\trange: \">= -0xB4p+0, <= 0xB4p+0\",\n\t\tdescription: \"Specifies a roll rotation to the projection.  Value represents a counter-clockwise rotation, in degrees, around the forward vector. This rotation must be applied after the `ProjectionPoseYaw` and `ProjectionPosePitch` rotations. The value of this element **MUST** be in the -180 to 180 degree range, both included.  Setting `ProjectionPoseRoll` to 180 or -180 degrees, the `ProjectionPoseYaw` to 180 or -180 degrees with `ProjectionPosePitch` set to 0 degrees flips the image vertically.  Setting `ProjectionPoseRoll` to 180 or -180 degrees, with the `ProjectionPoseYaw` and `ProjectionPosePitch` set to 0 degrees flips the image horizontally and vertically.\"\n\t},\n\t0x78b5: {\n\t\tname: \"OutputSamplingFrequency\",\n\t\tcppname: \"AudioOutputSamplingFreq\",\n\t\tlevel: 4,\n\t\ttype: \"f\",\n\t\trange: \"> 0x0p+0\",\n\t\tdescription: \"Real output sampling frequency in Hz (used for SBR techniques).\"\n\t},\n\t0x7ba9: {\n\t\tname: \"Title\",\n\t\tlevel: 2,\n\t\ttype: \"8\",\n\t\twebm: true,\n\t\tdescription: \"General name of the Segment.\"\n\t},\n\t0x7d7b: {\n\t\tname: \"ChannelPositions\",\n\t\tcppname: \"AudioPosition\",\n\t\tlevel: 4,\n\t\ttype: \"b\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"Table of horizontal angles for each successive channel.\"\n\t},\n\t0x7e5b: {\n\t\tname: \"SignatureElements\",\n\t\tlevel: 1,\n\t\ttype: \"m\",\n\t\twebm: false,\n\t\tdescription: \"Contains elements that will be used to compute the signature.\"\n\t},\n\t0x7e7b: {\n\t\tname: \"SignatureElementList\",\n\t\tlevel: 2,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\twebm: false,\n\t\ti: \"Cluster|Block|BlockAdditional\",\n\t\tdescription: \"A list consists of a number of consecutive elements that represent one case where data is used in signature. Ex:  means that the BlockAdditional of all Blocks in all Clusters is used for encryption.\"\n\t},\n\t0x7e8a: {\n\t\tname: \"SignatureAlgo\",\n\t\tlevel: 2,\n\t\ttype: \"u\",\n\t\twebm: false,\n\t\tdescription: \"Signature algorithm used (1=RSA, 2=elliptic).\"\n\t},\n\t0x7e9a: {\n\t\tname: \"SignatureHash\",\n\t\tlevel: 2,\n\t\ttype: \"u\",\n\t\twebm: false,\n\t\tdescription: \"Hash algorithm used (1=SHA1-160, 2=MD5).\"\n\t},\n\t0x7ea5: {\n\t\tname: \"SignaturePublicKey\",\n\t\tlevel: 2,\n\t\ttype: \"b\",\n\t\twebm: false,\n\t\tdescription: \"The public key to use with the algorithm (in the case of a PKI-based signature).\"\n\t},\n\t0x7eb5: {\n\t\tname: \"Signature\",\n\t\tlevel: 2,\n\t\ttype: \"b\",\n\t\twebm: false,\n\t\tdescription: \"The signature of the data (until a new.\"\n\t},\n\t0x22b59c: {\n\t\tname: \"Language\",\n\t\tcppname: \"TrackLanguage\",\n\t\tlevel: 3,\n\t\ttype: \"s\",\n\t\tmandatory: true,\n\t\t\"default\": \"eng\",\n\t\tdescription: \"Specifies the language of the track in the Matroska languages form; see (#language-codes) on language codes. This Element **MUST** be ignored if the LanguageIETF Element is used in the same TrackEntry.\"\n\t},\n\t0x22b59d: {\n\t\tname: \"LanguageIETF\",\n\t\tlevel: 3,\n\t\ttype: \"s\",\n\t\tminver: 4,\n\t\tdescription: \"Specifies the language of the track according to [@!BCP47] and using the IANA Language Subtag Registry [@!IANALangRegistry]. If this Element is used, then any Language Elements used in the same TrackEntry **MUST** be ignored.\"\n\t},\n\t0x23314f: {\n\t\tname: \"TrackTimestampScale\",\n\t\tcppname: \"TrackTimecodeScale\",\n\t\tlevel: 3,\n\t\ttype: \"f\",\n\t\tmandatory: true,\n\t\tmaxver: 3,\n\t\t\"default\": \"0x1p+0\",\n\t\trange: \"> 0x0p+0\",\n\t\tdescription: \"DEPRECATED, DO NOT USE. The scale to apply on this track to work at normal speed in relation with other tracks (mostly used to adjust video speed when the audio length differs).\"\n\t},\n\t0x234e7a: {\n\t\tname: \"DefaultDecodedFieldDuration\",\n\t\tcppname: \"TrackDefaultDecodedFieldDuration\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\tminver: 4,\n\t\trange: \"not 0\",\n\t\tdescription: \"The period between two successive fields at the output of the decoding process, expressed in Matroska Ticks -- ie in nanoseconds; see (#timestamp-ticks). see (#defaultdecodedfieldduration) for more information\"\n\t},\n\t0x2383e3: {\n\t\tname: \"FrameRate\",\n\t\tcppname: \"VideoFrameRate\",\n\t\tlevel: 4,\n\t\ttype: \"f\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\trange: \"> 0x0p+0\",\n\t\tdescription: \"Number of frames per second. This value is Informational only. It is intended for constant frame rate streams, and **SHOULD NOT** be used for a variable frame rate TrackEntry.\"\n\t},\n\t0x23e383: {\n\t\tname: \"DefaultDuration\",\n\t\tcppname: \"TrackDefaultDuration\",\n\t\tlevel: 3,\n\t\ttype: \"u\",\n\t\trange: \"not 0\",\n\t\tdescription: \"Number of nanoseconds per frame, expressed in Matroska Ticks -- ie in nanoseconds; see (#timestamp-ticks) (frame in the Matroska sense -- one Element put into a (Simple)Block).\"\n\t},\n\t0x258688: {\n\t\tname: \"CodecName\",\n\t\tlevel: 3,\n\t\ttype: \"8\",\n\t\tdescription: \"A human-readable string specifying the codec.\"\n\t},\n\t0x26b240: {\n\t\tname: \"CodecDownloadURL\",\n\t\tlevel: 3,\n\t\ttype: \"s\",\n\t\tmultiple: true,\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"A URL to download about the codec used.\"\n\t},\n\t0x2ad7b1: {\n\t\tname: \"TimestampScale\",\n\t\tcppname: \"TimecodeScale\",\n\t\tlevel: 2,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\t\"default\": \"1000000\",\n\t\trange: \"not 0\",\n\t\tdescription: \"Base unit for Segment Ticks and Track Ticks, in nanoseconds. A TimestampScale value of 1.000.000 means scaled timestamps in the Segment are expressed in milliseconds; see (#timestamps) on how to interpret timestamps.\"\n\t},\n\t0x2ad7b2: {\n\t\tname: \"TimecodeScaleDenominator\",\n\t\tlevel: 2,\n\t\ttype: \"u\",\n\t\tmandatory: true,\n\t\tminver: 4,\n\t\t\"default\": \"1000000000\",\n\t\tdescription: \"Timestamp scale numerator, see TimecodeScale.\"\n\t},\n\t0x2eb524: {\n\t\tname: \"UncompressedFourCC\",\n\t\tcppname: \"VideoColourSpace\",\n\t\tlevel: 4,\n\t\ttype: \"b\",\n\t\tdescription: \"Specify the uncompressed pixel format used for the Track's data as a FourCC. This value is similar in scope to the biCompression value of AVI's `BITMAPINFO` [@?AVIFormat]. See the YUV video formats [@?FourCC-YUV] and RGB video formats [@?FourCC-RGB] for common values.\"\n\t},\n\t0x2fb523: {\n\t\tname: \"GammaValue\",\n\t\tcppname: \"VideoGamma\",\n\t\tlevel: 4,\n\t\ttype: \"f\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\trange: \"> 0x0p+0\",\n\t\tdescription: \"Gamma Value.\"\n\t},\n\t0x3a9697: {\n\t\tname: \"CodecSettings\",\n\t\tlevel: 3,\n\t\ttype: \"8\",\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"A string describing the encoding setting used.\"\n\t},\n\t0x3b4040: {\n\t\tname: \"CodecInfoURL\",\n\t\tlevel: 3,\n\t\ttype: \"s\",\n\t\tmultiple: true,\n\t\tminver: 0,\n\t\tmaxver: 0,\n\t\tdescription: \"A URL to find information about the codec used.\"\n\t},\n\t0x3c83ab: {\n\t\tname: \"PrevFilename\",\n\t\tlevel: 2,\n\t\ttype: \"8\",\n\t\tdescription: \"A filename corresponding to the file of the previous Linked Segment.\"\n\t},\n\t0x3cb923: {\n\t\tname: \"PrevUID\",\n\t\tlevel: 2,\n\t\ttype: \"b\",\n\t\tdescription: \"A unique ID to identify the previous Segment of a Linked Segment (128 bits).\"\n\t},\n\t0x3e83bb: {\n\t\tname: \"NextFilename\",\n\t\tlevel: 2,\n\t\ttype: \"8\",\n\t\tdescription: \"A filename corresponding to the file of the next Linked Segment.\"\n\t},\n\t0x3eb923: {\n\t\tname: \"NextUID\",\n\t\tlevel: 2,\n\t\ttype: \"b\",\n\t\tdescription: \"A unique ID to identify the next Segment of a Linked Segment (128 bits).\"\n\t},\n\t0x1043a770: {\n\t\tname: \"Chapters\",\n\t\tlevel: 1,\n\t\ttype: \"m\",\n\t\twebm: true,\n\t\tdescription: \"A system to define basic menus and partition data. For more detailed information, look at the Chapters explanation in (#chapters).\"\n\t},\n\t0x114d9b74: {\n\t\tname: \"SeekHead\",\n\t\tlevel: 1,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\tdescription: \"Contains the Segment Position of other Top-Level Elements.\"\n\t},\n\t0x1254c367: {\n\t\tname: \"Tags\",\n\t\tlevel: 1,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\twebm: true,\n\t\tdescription: \"Element containing metadata describing Tracks, Editions, Chapters, Attachments, or the Segment as a whole. A list of valid tags can be found in [@!MatroskaTags].\"\n\t},\n\t0x1549a966: {\n\t\tname: \"Info\",\n\t\tlevel: 1,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tdescription: \"Contains general information about the Segment.\"\n\t},\n\t0x1654ae6b: {\n\t\tname: \"Tracks\",\n\t\tlevel: 1,\n\t\ttype: \"m\",\n\t\tdescription: \"A Top-Level Element of information with many tracks described.\"\n\t},\n\t0x18538067: {\n\t\tname: \"Segment\",\n\t\tlevel: 0,\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tdescription: \"The Root Element that contains all other Top-Level Elements (Elements defined only at Level 1). A Matroska file is composed of 1 Segment.\"\n\t},\n\t0x1941a469: {\n\t\tname: \"Attachments\",\n\t\tlevel: 1,\n\t\ttype: \"m\",\n\t\tdescription: \"Contain attached files.\"\n\t},\n\t0x1a45dfa3: {\n\t\tname: \"EBML\",\n\t\tlevel: \"0\",\n\t\ttype: \"m\",\n\t\tmandatory: true,\n\t\tmultiple: false,\n\t\tminver: 1,\n\t\tdescription: \"Set the EBML characteristics of the data to follow. Each EBML document has to start with this.\"\n\t},\n\t0x1b538667: {\n\t\tname: \"SignatureSlot\",\n\t\tlevel: 1,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\twebm: false,\n\t\tdescription: \"Contain signature of some (coming) elements in the stream.\"\n\t},\n\t0x1c53bb6b: {\n\t\tname: \"Cues\",\n\t\tlevel: 1,\n\t\ttype: \"m\",\n\t\tdescription: \"A Top-Level Element to speed seeking access. All entries are local to the Segment.\"\n\t},\n\t0x1f43b675: {\n\t\tname: \"Cluster\",\n\t\tlevel: 1,\n\t\ttype: \"m\",\n\t\tmultiple: true,\n\t\tdescription: \"The Top-Level Element containing the (monolithic) Block structure.\"\n\t}\n};\n\nvar byName = {};\n\nvar schema = {\n\tbyEbmlID: byEbmlID,\n\tbyName: byName\n}\n\nfor ( var ebmlID in byEbmlID) {\n\tvar desc = byEbmlID[ebmlID];\n\tbyName[desc.name.replace('-', '_')] = parseInt(ebmlID, 10);\n}\n\nmodule.exports = schema;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tools_1 = require(\"./tools\");\nvar int64_buffer_1 = require(\"int64-buffer\");\nvar tools = require(\"./tools\");\nvar schema = require(\"matroska/lib/schema\");\nvar byEbmlID = schema.byEbmlID;\n// https://www.matroska.org/technical/specs/index.html\nvar State;\n(function (State) {\n    State[State[\"STATE_TAG\"] = 1] = \"STATE_TAG\";\n    State[State[\"STATE_SIZE\"] = 2] = \"STATE_SIZE\";\n    State[State[\"STATE_CONTENT\"] = 3] = \"STATE_CONTENT\";\n})(State || (State = {}));\nvar EBMLDecoder = (function () {\n    function EBMLDecoder() {\n        this._buffer = new tools_1.Buffer(0);\n        this._tag_stack = [];\n        this._state = State.STATE_TAG;\n        this._cursor = 0;\n        this._total = 0;\n        this._schema = byEbmlID;\n        this._result = [];\n    }\n    EBMLDecoder.prototype.decode = function (chunk) {\n        this.readChunk(chunk);\n        var diff = this._result;\n        this._result = [];\n        return diff;\n    };\n    EBMLDecoder.prototype.readChunk = function (chunk) {\n        // 読みかけの(読めなかった) this._buffer と 新しい chunk を合わせて読み直す\n        this._buffer = tools.concat([this._buffer, new tools_1.Buffer(chunk)]);\n        while (this._cursor < this._buffer.length) {\n            // console.log(this._cursor, this._total, this._tag_stack);\n            if (this._state === State.STATE_TAG && !this.readTag()) {\n                break;\n            }\n            if (this._state === State.STATE_SIZE && !this.readSize()) {\n                break;\n            }\n            if (this._state === State.STATE_CONTENT && !this.readContent()) {\n                break;\n            }\n        }\n    };\n    EBMLDecoder.prototype.getSchemaInfo = function (tagNum) {\n        return this._schema[tagNum] || {\n            name: \"unknown\",\n            level: -1,\n            type: \"unknown\",\n            description: \"unknown\"\n        };\n    };\n    /**\n     * vint された parsing tag\n     * @return - return false when waiting for more data\n     */\n    EBMLDecoder.prototype.readTag = function () {\n        // tag.length が buffer の外にある\n        if (this._cursor >= this._buffer.length) {\n            return false;\n        }\n        // read ebml id vint without first byte\n        var tag = tools_1.readVint(this._buffer, this._cursor);\n        // tag が読めなかった\n        if (tag == null) {\n            return false;\n        }\n        // >>>>>>>>>\n        // tag 識別子\n        //const tagStr = this._buffer.toString(\"hex\", this._cursor, this._cursor + tag.length);\n        //const tagNum = parseInt(tagStr, 16);\n        // 上と等価\n        var buf = this._buffer.slice(this._cursor, this._cursor + tag.length);\n        var tagNum = buf.reduce(function (o, v, i, arr) { return o + v * Math.pow(16, 2 * (arr.length - 1 - i)); }, 0);\n        var schema = this.getSchemaInfo(tagNum);\n        var tagObj = {\n            EBML_ID: tagNum.toString(16),\n            schema: schema,\n            type: schema.type,\n            name: schema.name,\n            level: schema.level,\n            tagStart: this._total,\n            tagEnd: this._total + tag.length,\n            sizeStart: this._total + tag.length,\n            sizeEnd: null,\n            dataStart: null,\n            dataEnd: null,\n            dataSize: null,\n            data: null\n        };\n        // | tag: vint | size: vint | data: Buffer(size) |\n        this._tag_stack.push(tagObj);\n        // <<<<<<<<\n        // ポインタを進める\n        this._cursor += tag.length;\n        this._total += tag.length;\n        // 読み込み状態変更\n        this._state = State.STATE_SIZE;\n        return true;\n    };\n    /**\n     * vint された現在のタグの内容の大きさを読み込む\n     * @return - return false when waiting for more data\n     */\n    EBMLDecoder.prototype.readSize = function () {\n        // tag.length が buffer の外にある\n        if (this._cursor >= this._buffer.length) {\n            return false;\n        }\n        // read ebml datasize vint without first byte\n        var size = tools_1.readVint(this._buffer, this._cursor);\n        // まだ読めない\n        if (size == null) {\n            return false;\n        }\n        // >>>>>>>>>\n        // current tag の data size 決定\n        var tagObj = this._tag_stack[this._tag_stack.length - 1];\n        tagObj.sizeEnd = tagObj.sizeStart + size.length;\n        tagObj.dataStart = tagObj.sizeEnd;\n        tagObj.dataSize = size.value;\n        if (size.value === -1) {\n            // unknown size\n            tagObj.dataEnd = -1;\n            if (tagObj.type === \"m\") {\n                tagObj.unknownSize = true;\n            }\n        }\n        else {\n            tagObj.dataEnd = tagObj.sizeEnd + size.value;\n        }\n        // <<<<<<<<\n        // ポインタを進める\n        this._cursor += size.length;\n        this._total += size.length;\n        this._state = State.STATE_CONTENT;\n        return true;\n    };\n    /**\n     * データ読み込み\n     */\n    EBMLDecoder.prototype.readContent = function () {\n        var tagObj = this._tag_stack[this._tag_stack.length - 1];\n        // master element は子要素を持つので生データはない\n        if (tagObj.type === 'm') {\n            // console.log('content should be tags');\n            tagObj.isEnd = false;\n            this._result.push(tagObj);\n            this._state = State.STATE_TAG;\n            // この Mastert Element は空要素か\n            if (tagObj.dataSize === 0) {\n                // 即座に終了タグを追加\n                var elm = Object.assign({}, tagObj, { isEnd: true });\n                this._result.push(elm);\n                this._tag_stack.pop(); // スタックからこのタグを捨てる\n            }\n            return true;\n        }\n        // waiting for more data\n        if (this._buffer.length < this._cursor + tagObj.dataSize) {\n            return false;\n        }\n        // タグの中身の生データ\n        var data = this._buffer.slice(this._cursor, this._cursor + tagObj.dataSize);\n        // 読み終わったバッファを捨てて読み込んでいる部分のバッファのみ残す\n        this._buffer = this._buffer.slice(this._cursor + tagObj.dataSize);\n        tagObj.data = data;\n        // >>>>>>>>>\n        switch (tagObj.type) {\n            //case \"m\": break;\n            // Master-Element - contains other EBML sub-elements of the next lower level\n            case \"u\":\n                tagObj.value = data.readUIntBE(0, data.length);\n                break;\n            // Unsigned Integer - Big-endian, any size from 1 to 8 octets\n            case \"i\":\n                tagObj.value = data.readIntBE(0, data.length);\n                break;\n            // Signed Integer - Big-endian, any size from 1 to 8 octets\n            case \"f\":\n                tagObj.value = tagObj.dataSize === 4 ? data.readFloatBE(0) :\n                    tagObj.dataSize === 8 ? data.readDoubleBE(0) :\n                        (console.warn(\"cannot read \" + tagObj.dataSize + \" octets float. failback to 0\"), 0);\n                break;\n            // Float - Big-endian, defined for 4 and 8 octets (32, 64 bits)\n            case \"s\":\n                tagObj.value = data.toString(\"ascii\");\n                break; // ascii\n            //  Printable ASCII (0x20 to 0x7E), zero-padded when needed\n            case \"8\":\n                tagObj.value = data.toString(\"utf8\");\n                break;\n            //  Unicode string, zero padded when needed (RFC 2279)\n            case \"b\":\n                tagObj.value = data;\n                break;\n            // Binary - not interpreted by the parser\n            case \"d\":\n                tagObj.value = tools_1.convertEBMLDateToJSDate(new int64_buffer_1.Int64BE(data).toNumber());\n                break;\n        }\n        if (tagObj.value === null) {\n            throw new Error(\"unknown tag type:\" + tagObj.type);\n        }\n        this._result.push(tagObj);\n        // <<<<<<<<\n        // ポインタを進める\n        this._total += tagObj.dataSize;\n        // タグ待ちモードに変更\n        this._state = State.STATE_TAG;\n        this._cursor = 0;\n        this._tag_stack.pop(); // remove the object from the stack\n        while (this._tag_stack.length > 0) {\n            var topEle = this._tag_stack[this._tag_stack.length - 1];\n            // 親が不定長サイズなので閉じタグは期待できない\n            if (topEle.dataEnd < 0) {\n                this._tag_stack.pop(); // 親タグを捨てる\n                return true;\n            }\n            // 閉じタグの来るべき場所まで来たかどうか\n            if (this._total < topEle.dataEnd) {\n                break;\n            }\n            // 閉じタグを挿入すべきタイミングが来た\n            if (topEle.type !== \"m\") {\n                throw new Error(\"parent element is not master element\");\n            }\n            var elm = Object.assign({}, topEle, { isEnd: true });\n            this._result.push(elm);\n            this._tag_stack.pop();\n        }\n        return true;\n    };\n    return EBMLDecoder;\n}());\nexports.default = EBMLDecoder;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tools = require(\"./tools\");\nvar tools_1 = require(\"./tools\");\nvar schema = require(\"matroska/lib/schema\");\nvar byEbmlID = schema.byEbmlID;\nvar EBMLEncoder = (function () {\n    function EBMLEncoder() {\n        this._schema = byEbmlID;\n        this._buffers = [];\n        this._stack = [];\n    }\n    EBMLEncoder.prototype.encode = function (elms) {\n        var _this = this;\n        return tools.concat(elms.reduce(function (lst, elm) {\n            return lst.concat(_this.encodeChunk(elm));\n        }, [])).buffer;\n    };\n    EBMLEncoder.prototype.encodeChunk = function (elm) {\n        if (elm.type === \"m\") {\n            if (!elm.isEnd) {\n                this.startTag(elm);\n            }\n            else {\n                this.endTag(elm);\n            }\n        }\n        else {\n            this.writeTag(elm);\n        }\n        return this.flush();\n    };\n    EBMLEncoder.prototype.flush = function () {\n        var ret = this._buffers;\n        this._buffers = [];\n        return ret;\n    };\n    EBMLEncoder.prototype.getSchemaInfo = function (tagName) {\n        var tagNums = Object.keys(this._schema).map(Number);\n        for (var i = 0; i < tagNums.length; i++) {\n            var tagNum = tagNums[i];\n            if (this._schema[tagNum].name === tagName) {\n                return new tools_1.Buffer(tagNum.toString(16), 'hex');\n            }\n        }\n        return null;\n    };\n    EBMLEncoder.prototype.writeTag = function (elm) {\n        var tagName = elm.name;\n        var tagId = this.getSchemaInfo(tagName);\n        var tagData = elm.data;\n        if (tagId == null) {\n            throw new Error('No schema entry found for ' + tagName);\n        }\n        var data = tools.encodeTag(tagId, tagData);\n        /**\n         * 親要素が閉じタグあり(isEnd)なら閉じタグが来るまで待つ(children queに入る)\n         */\n        if (this._stack.length > 0) {\n            var last = this._stack[this._stack.length - 1];\n            last.children.push({\n                tagId: tagId,\n                elm: elm,\n                children: [],\n                data: data\n            });\n            return;\n        }\n        this._buffers = this._buffers.concat(data);\n        return;\n    };\n    EBMLEncoder.prototype.startTag = function (elm) {\n        var tagName = elm.name;\n        var tagId = this.getSchemaInfo(tagName);\n        if (tagId == null) {\n            throw new Error('No schema entry found for ' + tagName);\n        }\n        /**\n         * 閉じタグ不定長の場合はスタックに積まずに即時バッファに書き込む\n         */\n        if (elm.unknownSize) {\n            var data = tools.encodeTag(tagId, new tools_1.Buffer(0), elm.unknownSize);\n            this._buffers = this._buffers.concat(data);\n            return;\n        }\n        var tag = {\n            tagId: tagId,\n            elm: elm,\n            children: [],\n            data: null\n        };\n        if (this._stack.length > 0) {\n            this._stack[this._stack.length - 1].children.push(tag);\n        }\n        this._stack.push(tag);\n    };\n    EBMLEncoder.prototype.endTag = function (elm) {\n        var tagName = elm.name;\n        var tag = this._stack.pop();\n        if (tag == null) {\n            throw new Error(\"EBML structure is broken\");\n        }\n        if (tag.elm.name !== elm.name) {\n            throw new Error(\"EBML structure is broken\");\n        }\n        var childTagDataBuffers = tag.children.reduce(function (lst, child) {\n            if (child.data === null) {\n                throw new Error(\"EBML structure is broken\");\n            }\n            return lst.concat(child.data);\n        }, []);\n        var childTagDataBuffer = tools.concat(childTagDataBuffers);\n        if (tag.elm.type === \"m\") {\n            tag.data = tools.encodeTag(tag.tagId, childTagDataBuffer, tag.elm.unknownSize);\n        }\n        else {\n            tag.data = tools.encodeTag(tag.tagId, childTagDataBuffer);\n        }\n        if (this._stack.length < 1) {\n            this._buffers = this._buffers.concat(tag.data);\n        }\n    };\n    return EBMLEncoder;\n}());\nexports.default = EBMLEncoder;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar events_1 = require(\"events\");\nvar tools = require(\"./tools\");\n/**\n * This is an informal code for reference.\n * EBMLReader is a class for getting information to enable seeking Webm recorded by MediaRecorder.\n * So please do not use for regular WebM files.\n */\nvar EBMLReader = (function (_super) {\n    __extends(EBMLReader, _super);\n    function EBMLReader() {\n        var _this = _super.call(this) || this;\n        _this.logGroup = \"\";\n        _this.hasLoggingStarted = false;\n        _this.metadataloaded = false;\n        _this.chunks = [];\n        _this.stack = [];\n        _this.segmentOffset = 0;\n        _this.last2SimpleBlockVideoTrackTimecode = [0, 0];\n        _this.last2SimpleBlockAudioTrackTimecode = [0, 0];\n        _this.lastClusterTimecode = 0;\n        _this.lastClusterPosition = 0;\n        _this.timecodeScale = 1000000; // webm default TimecodeScale is 1ms\n        _this.metadataSize = 0;\n        _this.metadatas = [];\n        _this.cues = [];\n        _this.firstVideoBlockRead = false;\n        _this.firstAudioBlockRead = false;\n        _this.currentTrack = { TrackNumber: -1, TrackType: -1, DefaultDuration: null, CodecDelay: null };\n        _this.trackTypes = [];\n        _this.trackDefaultDuration = [];\n        _this.trackCodecDelay = [];\n        _this.trackInfo = { type: \"nothing\" };\n        _this.ended = false;\n        _this.logging = false;\n        _this.use_duration_every_simpleblock = false;\n        _this.use_webp = false;\n        _this.use_segment_info = true;\n        _this.drop_default_duration = true;\n        return _this;\n    }\n    /**\n     * emit final state.\n     */\n    EBMLReader.prototype.stop = function () {\n        this.ended = true;\n        this.emit_segment_info();\n        // clean up any unclosed Master Elements at the end of the stream.\n        while (this.stack.length) {\n            this.stack.pop();\n            if (this.logging) {\n                console.groupEnd();\n            }\n        }\n        // close main group if set, logging is enabled, and has actually logged anything.\n        if (this.logging && this.hasLoggingStarted && this.logGroup) {\n            console.groupEnd();\n        }\n    };\n    /**\n     * emit chunk info\n     */\n    EBMLReader.prototype.emit_segment_info = function () {\n        var data = this.chunks;\n        this.chunks = [];\n        if (!this.metadataloaded) {\n            this.metadataloaded = true;\n            this.metadatas = data;\n            var videoTrackNum = this.trackTypes.indexOf(1); // find first video track\n            var audioTrackNum = this.trackTypes.indexOf(2); // find first audio track\n            this.trackInfo = videoTrackNum >= 0 && audioTrackNum >= 0 ? { type: \"both\", trackNumber: videoTrackNum }\n                : videoTrackNum >= 0 ? { type: \"video\", trackNumber: videoTrackNum }\n                    : audioTrackNum >= 0 ? { type: \"audio\", trackNumber: audioTrackNum }\n                        : { type: \"nothing\" };\n            if (!this.use_segment_info) {\n                return;\n            }\n            this.emit(\"metadata\", { data: data, metadataSize: this.metadataSize });\n        }\n        else {\n            if (!this.use_segment_info) {\n                return;\n            }\n            var timecode = this.lastClusterTimecode;\n            var duration = this.duration;\n            var timecodeScale = this.timecodeScale;\n            this.emit(\"cluster\", { timecode: timecode, data: data });\n            this.emit(\"duration\", { timecodeScale: timecodeScale, duration: duration });\n        }\n    };\n    EBMLReader.prototype.read = function (elm) {\n        var _this = this;\n        var drop = false;\n        if (this.ended) {\n            // reader is finished\n            return;\n        }\n        if (elm.type === \"m\") {\n            // 閉じタグの自動挿入\n            if (elm.isEnd) {\n                this.stack.pop();\n            }\n            else {\n                var parent_1 = this.stack[this.stack.length - 1];\n                if (parent_1 != null && parent_1.level >= elm.level) {\n                    // 閉じタグなしでレベルが下がったら閉じタグを挿入\n                    this.stack.pop();\n                    // From http://w3c.github.io/media-source/webm-byte-stream-format.html#webm-media-segments\n                    // This fixes logging for webm streams with Cluster of unknown length and no Cluster closing elements.\n                    if (this.logging) {\n                        console.groupEnd();\n                    }\n                    parent_1.dataEnd = elm.dataEnd;\n                    parent_1.dataSize = elm.dataEnd - parent_1.dataStart;\n                    parent_1.unknownSize = false;\n                    var o = Object.assign({}, parent_1, { name: parent_1.name, type: parent_1.type, isEnd: true });\n                    this.chunks.push(o);\n                }\n                this.stack.push(elm);\n            }\n        }\n        if (elm.type === \"m\" && elm.name == \"Segment\") {\n            if (this.segmentOffset != 0) {\n                console.warn(\"Multiple segments detected!\");\n            }\n            this.segmentOffset = elm.dataStart;\n            this.emit(\"segment_offset\", this.segmentOffset);\n        }\n        else if (elm.type === \"b\" && elm.name === \"SimpleBlock\") {\n            var _a = tools.ebmlBlock(elm.data), timecode = _a.timecode, trackNumber = _a.trackNumber, frames_1 = _a.frames;\n            if (this.trackTypes[trackNumber] === 1) {\n                if (!this.firstVideoBlockRead) {\n                    this.firstVideoBlockRead = true;\n                    if (this.trackInfo.type === \"both\" || this.trackInfo.type === \"video\") {\n                        var CueTime = this.lastClusterTimecode + timecode;\n                        this.cues.push({ CueTrack: trackNumber, CueClusterPosition: this.lastClusterPosition, CueTime: CueTime });\n                        this.emit(\"cue_info\", { CueTrack: trackNumber, CueClusterPosition: this.lastClusterPosition, CueTime: this.lastClusterTimecode });\n                        this.emit(\"cue\", { CueTrack: trackNumber, CueClusterPosition: this.lastClusterPosition, CueTime: CueTime });\n                    }\n                }\n                this.last2SimpleBlockVideoTrackTimecode = [this.last2SimpleBlockVideoTrackTimecode[1], timecode];\n            }\n            else if (this.trackTypes[trackNumber] === 2) {\n                if (!this.firstAudioBlockRead) {\n                    this.firstAudioBlockRead = true;\n                    if (this.trackInfo.type === \"audio\") {\n                        var CueTime = this.lastClusterTimecode + timecode;\n                        this.cues.push({ CueTrack: trackNumber, CueClusterPosition: this.lastClusterPosition, CueTime: CueTime });\n                        this.emit(\"cue_info\", { CueTrack: trackNumber, CueClusterPosition: this.lastClusterPosition, CueTime: this.lastClusterTimecode });\n                        this.emit(\"cue\", { CueTrack: trackNumber, CueClusterPosition: this.lastClusterPosition, CueTime: CueTime });\n                    }\n                }\n                this.last2SimpleBlockAudioTrackTimecode = [this.last2SimpleBlockAudioTrackTimecode[1], timecode];\n            }\n            if (this.use_duration_every_simpleblock) {\n                this.emit(\"duration\", { timecodeScale: this.timecodeScale, duration: this.duration });\n            }\n            if (this.use_webp) {\n                frames_1.forEach(function (frame) {\n                    var startcode = frame.slice(3, 6).toString(\"hex\");\n                    if (startcode !== \"9d012a\") {\n                        return;\n                    }\n                    ; // VP8 の場合\n                    var webpBuf = tools.VP8BitStreamToRiffWebPBuffer(frame);\n                    var webp = new Blob([webpBuf], { type: \"image/webp\" });\n                    var currentTime = _this.duration;\n                    _this.emit(\"webp\", { currentTime: currentTime, webp: webp });\n                });\n            }\n        }\n        else if (elm.type === \"m\" && elm.name === \"Cluster\" && elm.isEnd === false) {\n            this.firstVideoBlockRead = false;\n            this.firstAudioBlockRead = false;\n            this.emit_segment_info();\n            this.emit(\"cluster_ptr\", elm.tagStart);\n            this.lastClusterPosition = elm.tagStart;\n        }\n        else if (elm.type === \"u\" && elm.name === \"Timecode\") {\n            this.lastClusterTimecode = elm.value;\n        }\n        else if (elm.type === \"u\" && elm.name === \"TimecodeScale\") {\n            this.timecodeScale = elm.value;\n        }\n        else if (elm.type === \"m\" && elm.name === \"TrackEntry\") {\n            if (elm.isEnd) {\n                this.trackTypes[this.currentTrack.TrackNumber] = this.currentTrack.TrackType;\n                this.trackDefaultDuration[this.currentTrack.TrackNumber] = this.currentTrack.DefaultDuration;\n                this.trackCodecDelay[this.currentTrack.TrackNumber] = this.currentTrack.CodecDelay;\n            }\n            else {\n                this.currentTrack = { TrackNumber: -1, TrackType: -1, DefaultDuration: null, CodecDelay: null };\n            }\n        }\n        else if (elm.type === \"u\" && elm.name === \"TrackType\") {\n            this.currentTrack.TrackType = elm.value;\n        }\n        else if (elm.type === \"u\" && elm.name === \"TrackNumber\") {\n            this.currentTrack.TrackNumber = elm.value;\n        }\n        else if (elm.type === \"u\" && elm.name === \"CodecDelay\") {\n            this.currentTrack.CodecDelay = elm.value;\n        }\n        else if (elm.type === \"u\" && elm.name === \"DefaultDuration\") {\n            // media source api は DefaultDuration を計算するとバグる。\n            // https://bugs.chromium.org/p/chromium/issues/detail?id=606000#c22\n            // chrome 58 ではこれを回避するために DefaultDuration 要素を抜き取った。\n            // chrome 58 以前でもこのタグを抜き取ることで回避できる\n            if (this.drop_default_duration) {\n                console.warn(\"DefaultDuration detected!, remove it\");\n                drop = true;\n            }\n            else {\n                this.currentTrack.DefaultDuration = elm.value;\n            }\n        }\n        else if (elm.name === \"unknown\") {\n            console.warn(elm);\n        }\n        if (!this.metadataloaded && elm.dataEnd > 0) {\n            this.metadataSize = elm.dataEnd;\n        }\n        if (!drop) {\n            this.chunks.push(elm);\n        }\n        if (this.logging) {\n            this.put(elm);\n        }\n    };\n    Object.defineProperty(EBMLReader.prototype, \"duration\", {\n        /**\n         * DefaultDuration が定義されている場合は最後のフレームのdurationも考慮する\n         * 単位 timecodeScale\n         *\n         * !!! if you need duration with seconds !!!\n         * ```js\n         * const nanosec = reader.duration * reader.timecodeScale;\n         * const sec = nanosec / 1000 / 1000 / 1000;\n         * ```\n         */\n        get: function () {\n            if (this.trackInfo.type === \"nothing\") {\n                console.warn(\"no video, no audio track\");\n                return 0;\n            }\n            // defaultDuration は 生の nano sec\n            var defaultDuration = 0;\n            // nanoseconds\n            var codecDelay = 0;\n            var lastTimecode = 0;\n            var _defaultDuration = this.trackDefaultDuration[this.trackInfo.trackNumber];\n            if (typeof _defaultDuration === \"number\") {\n                defaultDuration = _defaultDuration;\n            }\n            else {\n                // https://bugs.chromium.org/p/chromium/issues/detail?id=606000#c22\n                // default duration がないときに使う delta\n                if (this.trackInfo.type === \"both\") {\n                    if (this.last2SimpleBlockAudioTrackTimecode[1] > this.last2SimpleBlockVideoTrackTimecode[1]) {\n                        // audio diff\n                        defaultDuration = (this.last2SimpleBlockAudioTrackTimecode[1] - this.last2SimpleBlockAudioTrackTimecode[0]) * this.timecodeScale;\n                        // audio delay\n                        var delay = this.trackCodecDelay[this.trackTypes.indexOf(2)]; // 2 => audio\n                        if (typeof delay === \"number\") {\n                            codecDelay = delay;\n                        }\n                        // audio timecode\n                        lastTimecode = this.last2SimpleBlockAudioTrackTimecode[1];\n                    }\n                    else {\n                        // video diff\n                        defaultDuration = (this.last2SimpleBlockVideoTrackTimecode[1] - this.last2SimpleBlockVideoTrackTimecode[0]) * this.timecodeScale;\n                        // video delay\n                        var delay = this.trackCodecDelay[this.trackTypes.indexOf(1)]; // 1 => video\n                        if (typeof delay === \"number\") {\n                            codecDelay = delay;\n                        }\n                        // video timecode\n                        lastTimecode = this.last2SimpleBlockVideoTrackTimecode[1];\n                    }\n                }\n                else if (this.trackInfo.type === \"video\") {\n                    defaultDuration = (this.last2SimpleBlockVideoTrackTimecode[1] - this.last2SimpleBlockVideoTrackTimecode[0]) * this.timecodeScale;\n                    var delay = this.trackCodecDelay[this.trackInfo.trackNumber]; // 2 => audio\n                    if (typeof delay === \"number\") {\n                        codecDelay = delay;\n                    }\n                    lastTimecode = this.last2SimpleBlockVideoTrackTimecode[1];\n                }\n                else if (this.trackInfo.type === \"audio\") {\n                    defaultDuration = (this.last2SimpleBlockAudioTrackTimecode[1] - this.last2SimpleBlockAudioTrackTimecode[0]) * this.timecodeScale;\n                    var delay = this.trackCodecDelay[this.trackInfo.trackNumber]; // 1 => video\n                    if (typeof delay === \"number\") {\n                        codecDelay = delay;\n                    }\n                    lastTimecode = this.last2SimpleBlockAudioTrackTimecode[1];\n                } // else { not reached }\n            }\n            // convert to timecodescale\n            var duration_nanosec = ((this.lastClusterTimecode + lastTimecode) * this.timecodeScale) + defaultDuration - codecDelay;\n            var duration = duration_nanosec / this.timecodeScale;\n            return Math.floor(duration);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    EBMLReader.prototype.addListener = function (event, listener) {\n        return _super.prototype.addListener.call(this, event, listener);\n    };\n    EBMLReader.prototype.put = function (elm) {\n        if (!this.hasLoggingStarted) {\n            this.hasLoggingStarted = true;\n            if (this.logging && this.logGroup) {\n                console.groupCollapsed(this.logGroup);\n            }\n        }\n        if (elm.type === \"m\") {\n            if (elm.isEnd) {\n                console.groupEnd();\n            }\n            else {\n                console.group(elm.name + \":\" + elm.tagStart);\n            }\n        }\n        else if (elm.type === \"b\") {\n            // for debug\n            //if(elm.name === \"SimpleBlock\"){\n            //const o = EBML.tools.ebmlBlock(elm.value);\n            //console.log(elm.name, elm.type, o.trackNumber, o.timecode);\n            //}else{\n            console.log(elm.name, elm.type);\n            //}\n        }\n        else {\n            console.log(elm.name, elm.tagStart, elm.type, elm.value);\n        }\n    };\n    return EBMLReader;\n}(events_1.EventEmitter));\nexports.default = EBMLReader;\n;\n;\n;\n;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EBMLDecoder_1 = require(\"./EBMLDecoder\");\nexports.Decoder = EBMLDecoder_1.default;\nvar EBMLEncoder_1 = require(\"./EBMLEncoder\");\nexports.Encoder = EBMLEncoder_1.default;\nvar EBMLReader_1 = require(\"./EBMLReader\");\nexports.Reader = EBMLReader_1.default;\nvar tools = require(\"./tools\");\nexports.tools = tools;\nvar version = require(\"../package.json\").version;\nexports.version = version;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/// <reference types=\"node\"/>\nvar int64_buffer_1 = require(\"int64-buffer\");\nvar EBMLEncoder_1 = require(\"./EBMLEncoder\");\nvar _Buffer = require(\"buffer/\");\nvar _tools = require(\"ebml/lib/ebml/tools\");\nvar _block = require(\"ebml-block\");\nexports.Buffer = _Buffer.Buffer;\nexports.readVint = _tools.readVint;\nexports.writeVint = _tools.writeVint;\nexports.ebmlBlock = _block;\nfunction readBlock(buf) {\n    return exports.ebmlBlock(new exports.Buffer(buf));\n}\nexports.readBlock = readBlock;\n/**\n  * @param end - if end === false then length is unknown\n  */\nfunction encodeTag(tagId, tagData, unknownSize) {\n    if (unknownSize === void 0) { unknownSize = false; }\n    return concat([\n        tagId,\n        unknownSize ?\n            new exports.Buffer('01ffffffffffffff', 'hex') :\n            exports.writeVint(tagData.length),\n        tagData\n    ]);\n}\nexports.encodeTag = encodeTag;\n/**\n * @return - SimpleBlock to WebP Filter\n */\nfunction WebPFrameFilter(elms) {\n    return WebPBlockFilter(elms).reduce(function (lst, elm) {\n        var o = exports.ebmlBlock(elm.data);\n        return o.frames.reduce(function (lst, frame) {\n            // https://developers.Blob.com/speed/webp/docs/riff_container\n            var webpBuf = VP8BitStreamToRiffWebPBuffer(frame);\n            var webp = new Blob([webpBuf], { type: \"image/webp\" });\n            return lst.concat(webp);\n        }, lst);\n    }, []);\n}\nexports.WebPFrameFilter = WebPFrameFilter;\n/**\n * WebP ファイルにできる SimpleBlock の パスフィルタ\n */\nfunction WebPBlockFilter(elms) {\n    return elms.reduce(function (lst, elm) {\n        if (elm.type !== \"b\") {\n            return lst;\n        }\n        if (elm.name !== \"SimpleBlock\") {\n            return lst;\n        }\n        var o = exports.ebmlBlock(elm.data);\n        var hasWebP = o.frames.some(function (frame) {\n            // https://tools.ietf.org/html/rfc6386#section-19.1\n            var startcode = frame.slice(3, 6).toString(\"hex\");\n            return startcode === \"9d012a\";\n        });\n        if (!hasWebP) {\n            return lst;\n        }\n        return lst.concat(elm);\n    }, []);\n}\nexports.WebPBlockFilter = WebPBlockFilter;\n/**\n * @param frame - VP8 BitStream のうち startcode をもつ frame\n * @return - WebP ファイルの ArrayBuffer\n */\nfunction VP8BitStreamToRiffWebPBuffer(frame) {\n    var VP8Chunk = createRIFFChunk(\"VP8 \", frame);\n    var WebPChunk = concat([\n        new exports.Buffer(\"WEBP\", \"ascii\"),\n        VP8Chunk\n    ]);\n    return createRIFFChunk(\"RIFF\", WebPChunk);\n}\nexports.VP8BitStreamToRiffWebPBuffer = VP8BitStreamToRiffWebPBuffer;\n/**\n * RIFF データチャンクを作る\n */\nfunction createRIFFChunk(FourCC, chunk) {\n    var chunkSize = new exports.Buffer(4);\n    chunkSize.writeUInt32LE(chunk.byteLength, 0);\n    return concat([\n        new exports.Buffer(FourCC.substr(0, 4), \"ascii\"),\n        chunkSize,\n        chunk,\n        new exports.Buffer(chunk.byteLength % 2 === 0 ? 0 : 1) // padding\n    ]);\n}\nexports.createRIFFChunk = createRIFFChunk;\n/* Original Metadata\n\n m  0\tEBML\n u  1\t  EBMLVersion 1\n u  1\t  EBMLReadVersion 1\n u  1\t  EBMLMaxIDLength 4\n u  1\t  EBMLMaxSizeLength 8\n s  1\t  DocType webm\n u  1\t  DocTypeVersion 4\n u  1\t  DocTypeReadVersion 2\n m  0\tSegment\n m  1\t  Info                                segmentContentStartPos, all CueClusterPositions provided in info.cues will be relative to here and will need adjusted\n u  2\t    TimecodeScale 1000000\n 8  2\t    MuxingApp Chrome\n 8  2\t    WritingApp Chrome\n m  1\t  Tracks                              tracksStartPos\n m  2\t    TrackEntry\n u  3\t      TrackNumber 1\n u  3\t      TrackUID 31790271978391090\n u  3\t      TrackType 2\n s  3\t      CodecID A_OPUS\n b  3\t      CodecPrivate <Buffer 19>\n m  3\t      Audio\n f  4\t        SamplingFrequency 48000\n u  4\t        Channels 1\n m  2\t    TrackEntry\n u  3\t      TrackNumber 2\n u  3\t      TrackUID 24051277436254136\n u  3\t      TrackType 1\n s  3\t      CodecID V_VP8\n m  3\t      Video\n u  4\t        PixelWidth 1024\n u  4\t        PixelHeight 576\n m  1\t  Cluster                             clusterStartPos\n u  2\t    Timecode 0\n b  2\t    SimpleBlock track:2 timecode:0\tkeyframe:true\tinvisible:false\tdiscardable:false\tlacing:1\n*/\n/* Desired Metadata\n\n m\t0 EBML\n u\t1   EBMLVersion 1\n u\t1   EBMLReadVersion 1\n u\t1   EBMLMaxIDLength 4\n u\t1   EBMLMaxSizeLength 8\n s\t1   DocType webm\n u\t1   DocTypeVersion 4\n u\t1   DocTypeReadVersion 2\n m\t0 Segment\n m\t1   SeekHead                            -> This is SeekPosition 0, so all SeekPositions can be calculated as (bytePos - segmentContentStartPos), which is 44 in this case\n m\t2     Seek\n b\t3       SeekID                          -> Buffer([0x15, 0x49, 0xA9, 0x66])  Info\n u\t3       SeekPosition                    -> infoStartPos =\n m\t2     Seek\n b\t3       SeekID                          -> Buffer([0x16, 0x54, 0xAE, 0x6B])  Tracks\n u\t3       SeekPosition { tracksStartPos }\n m\t2     Seek\n b\t3       SeekID                          -> Buffer([0x1C, 0x53, 0xBB, 0x6B])  Cues\n u\t3       SeekPosition { cuesStartPos }\n m\t1   Info\n f\t2     Duration 32480                    -> overwrite, or insert if it doesn't exist\n u\t2     TimecodeScale 1000000\n 8\t2     MuxingApp Chrome\n 8\t2     WritingApp Chrome\n m\t1   Tracks\n m\t2     TrackEntry\n u\t3       TrackNumber 1\n u\t3       TrackUID 31790271978391090\n u\t3       TrackType 2\n s\t3       CodecID A_OPUS\n b\t3       CodecPrivate <Buffer 19>\n m\t3       Audio\n f\t4         SamplingFrequency 48000\n u\t4         Channels 1\n m\t2     TrackEntry\n u\t3       TrackNumber 2\n u\t3       TrackUID 24051277436254136\n u\t3       TrackType 1\n s\t3       CodecID V_VP8\n m\t3       Video\n u\t4         PixelWidth 1024\n u\t4         PixelHeight 576\n m  1   Cues                                -> cuesStartPos\n m  2     CuePoint\n u  3       CueTime 0\n m  3       CueTrackPositions\n u  4         CueTrack 1\n u  4         CueClusterPosition 3911\n m  2     CuePoint\n u  3       CueTime 600\n m  3       CueTrackPositions\n u  4         CueTrack 1\n u  4         CueClusterPosition 3911\n m  1   Cluster\n u  2     Timecode 0\n b  2     SimpleBlock track:2 timecode:0\tkeyframe:true\tinvisible:false\tdiscardable:false\tlacing:1\n*/\n/**\n * convert the metadata from a streaming webm bytestream to a seekable file by inserting Duration, Seekhead and Cues\n * @param originalMetadata - orginal metadata (everything before the clusters start) from media recorder\n * @param duration - Duration (TimecodeScale)\n * @param cues - cue points for clusters\n */\nfunction makeMetadataSeekable(originalMetadata, duration, cuesInfo) {\n    // extract the header, we can reuse this as-is\n    var header = extractElement(\"EBML\", originalMetadata);\n    var headerSize = encodedSizeOfEbml(header);\n    //console.error(\"Header size: \" + headerSize);\n    //printElementIds(header);\n    // After the header comes the Segment open tag, which in this implementation is always 12 bytes (4 byte id, 8 byte 'unknown length')\n    // After that the segment content starts. All SeekPositions and CueClusterPosition must be relative to segmentContentStartPos\n    var segmentContentStartPos = headerSize + 12;\n    //console.error(\"segmentContentStartPos: \" + segmentContentStartPos);    \n    // find the original metadata size, and adjust it for header size and Segment start element so we can keep all positions relative to segmentContentStartPos\n    var originalMetadataSize = originalMetadata[originalMetadata.length - 1].dataEnd - segmentContentStartPos;\n    //console.error(\"Original Metadata size: \" + originalMetadataSize);\n    //printElementIds(originalMetadata);\n    // extract the segment info, remove the potentially existing Duration element, and add our own one.\n    var info = extractElement(\"Info\", originalMetadata);\n    removeElement(\"Duration\", info);\n    info.splice(1, 0, { name: \"Duration\", type: \"f\", data: createFloatBuffer(duration, 8) });\n    var infoSize = encodedSizeOfEbml(info);\n    //console.error(\"Info size: \" + infoSize);\n    //printElementIds(info);  \n    // extract the track info, we can re-use this as is\n    var tracks = extractElement(\"Tracks\", originalMetadata);\n    var tracksSize = encodedSizeOfEbml(tracks);\n    //console.error(\"Tracks size: \" + tracksSize);\n    //printElementIds(tracks);  \n    var seekHeadSize = 47; // Initial best guess, but could be slightly larger if the Cues element is huge.\n    var seekHead = [];\n    var cuesSize = 5 + cuesInfo.length * 15; // very rough initial approximation, depends a lot on file size and number of CuePoints                   \n    var cues = [];\n    var lastSizeDifference = -1; // \n    // The size of SeekHead and Cues elements depends on how many bytes the offsets values can be encoded in.\n    // The actual offsets in CueClusterPosition depend on the final size of the SeekHead and Cues elements\n    // We need to iteratively converge to a stable solution.\n    var maxIterations = 10;\n    var _loop_1 = function (i) {\n        // SeekHead starts at 0\n        var infoStart = seekHeadSize; // Info comes directly after SeekHead\n        var tracksStart = infoStart + infoSize; // Tracks comes directly after Info\n        var cuesStart = tracksStart + tracksSize; // Cues starts directly after \n        var newMetadataSize = cuesStart + cuesSize; // total size of metadata  \n        // This is the offset all CueClusterPositions should be adjusted by due to the metadata size changing.\n        var sizeDifference = newMetadataSize - originalMetadataSize;\n        // console.error(`infoStart: ${infoStart}, infoSize: ${infoSize}`);\n        // console.error(`tracksStart: ${tracksStart}, tracksSize: ${tracksSize}`);\n        // console.error(`cuesStart: ${cuesStart}, cuesSize: ${cuesSize}`);\n        // console.error(`originalMetadataSize: ${originalMetadataSize}, newMetadataSize: ${newMetadataSize}, sizeDifference: ${sizeDifference}`); \n        // create the SeekHead element\n        seekHead = [];\n        seekHead.push({ name: \"SeekHead\", type: \"m\", isEnd: false });\n        seekHead.push({ name: \"Seek\", type: \"m\", isEnd: false });\n        seekHead.push({ name: \"SeekID\", type: \"b\", data: new exports.Buffer([0x15, 0x49, 0xA9, 0x66]) }); // Info\n        seekHead.push({ name: \"SeekPosition\", type: \"u\", data: createUIntBuffer(infoStart) });\n        seekHead.push({ name: \"Seek\", type: \"m\", isEnd: true });\n        seekHead.push({ name: \"Seek\", type: \"m\", isEnd: false });\n        seekHead.push({ name: \"SeekID\", type: \"b\", data: new exports.Buffer([0x16, 0x54, 0xAE, 0x6B]) }); // Tracks\n        seekHead.push({ name: \"SeekPosition\", type: \"u\", data: createUIntBuffer(tracksStart) });\n        seekHead.push({ name: \"Seek\", type: \"m\", isEnd: true });\n        seekHead.push({ name: \"Seek\", type: \"m\", isEnd: false });\n        seekHead.push({ name: \"SeekID\", type: \"b\", data: new exports.Buffer([0x1C, 0x53, 0xBB, 0x6B]) }); // Cues\n        seekHead.push({ name: \"SeekPosition\", type: \"u\", data: createUIntBuffer(cuesStart) });\n        seekHead.push({ name: \"Seek\", type: \"m\", isEnd: true });\n        seekHead.push({ name: \"SeekHead\", type: \"m\", isEnd: true });\n        seekHeadSize = encodedSizeOfEbml(seekHead);\n        //console.error(\"SeekHead size: \" + seekHeadSize);\n        //printElementIds(seekHead);  \n        // create the Cues element\n        cues = [];\n        cues.push({ name: \"Cues\", type: \"m\", isEnd: false });\n        cuesInfo.forEach(function (_a) {\n            var CueTrack = _a.CueTrack, CueClusterPosition = _a.CueClusterPosition, CueTime = _a.CueTime;\n            cues.push({ name: \"CuePoint\", type: \"m\", isEnd: false });\n            cues.push({ name: \"CueTime\", type: \"u\", data: createUIntBuffer(CueTime) });\n            cues.push({ name: \"CueTrackPositions\", type: \"m\", isEnd: false });\n            cues.push({ name: \"CueTrack\", type: \"u\", data: createUIntBuffer(CueTrack) });\n            //console.error(`CueClusterPosition: ${CueClusterPosition}, Corrected to: ${CueClusterPosition - segmentContentStartPos}  , offset by ${sizeDifference} to become ${(CueClusterPosition - segmentContentStartPos) + sizeDifference - segmentContentStartPos}`);\n            // EBMLReader returns CueClusterPosition with absolute byte offsets. The Cues section expects them as offsets from the first level 1 element of the Segment, so we need to adjust it.\n            CueClusterPosition -= segmentContentStartPos;\n            // We also need to adjust to take into account the change in metadata size from when EBMLReader read the original metadata.\n            CueClusterPosition += sizeDifference;\n            cues.push({ name: \"CueClusterPosition\", type: \"u\", data: createUIntBuffer(CueClusterPosition) });\n            cues.push({ name: \"CueTrackPositions\", type: \"m\", isEnd: true });\n            cues.push({ name: \"CuePoint\", type: \"m\", isEnd: true });\n        });\n        cues.push({ name: \"Cues\", type: \"m\", isEnd: true });\n        cuesSize = encodedSizeOfEbml(cues);\n        //console.error(\"Cues size: \" + cuesSize);   \n        //console.error(\"Cue count: \" + cuesInfo.length);\n        //printElementIds(cues);      \n        // If the new MetadataSize is not the same as the previous iteration, we need to run once more.\n        if (lastSizeDifference !== sizeDifference) {\n            lastSizeDifference = sizeDifference;\n            if (i === maxIterations - 1) {\n                throw new Error(\"Failed to converge to a stable metadata size\");\n            }\n        }\n        else {\n            return \"break\";\n        }\n    };\n    for (var i = 0; i < maxIterations; i++) {\n        var state_1 = _loop_1(i);\n        if (state_1 === \"break\")\n            break;\n    }\n    var finalMetadata = [].concat.apply([], [\n        header,\n        { name: \"Segment\", type: \"m\", isEnd: false, unknownSize: true },\n        seekHead,\n        info,\n        tracks,\n        cues\n    ]);\n    var result = new EBMLEncoder_1.default().encode(finalMetadata);\n    //printElementIds(finalMetadata);\n    //console.error(`Final metadata buffer size: ${result.byteLength}`);\n    //console.error(`Final metadata buffer size without header and segment: ${result.byteLength-segmentContentStartPos}`);\n    return result;\n}\nexports.makeMetadataSeekable = makeMetadataSeekable;\n/**\n * print all element id names in a list\n\n * @param metadata - array of EBML elements to print\n *\nexport function printElementIds(metadata: EBML.EBMLElementBuffer[]) {\n\n  let result: EBML.EBMLElementBuffer[] = [];\n  let start: number = -1;\n\n  for (let i = 0; i < metadata.length; i++) {\n    console.error(\"\\t id: \" + metadata[i].name);\n  }\n}\n*/\n/**\n * remove all occurances of an EBML element from an array of elements\n * If it's a MasterElement you will also remove the content. (everything between start and end)\n * @param idName - name of the EBML Element to remove.\n * @param metadata - array of EBML elements to search\n */\nfunction removeElement(idName, metadata) {\n    var result = [];\n    var start = -1;\n    for (var i = 0; i < metadata.length; i++) {\n        var element = metadata[i];\n        if (element.name === idName) {\n            // if it's a Master element, extract the start and end element, and everything in between\n            if (element.type === \"m\") {\n                if (!element.isEnd) {\n                    start = i;\n                }\n                else {\n                    // we've reached the end, extract the whole thing\n                    if (start == -1)\n                        throw new Error(\"Detected \" + idName + \" closing element before finding the start\");\n                    metadata.splice(start, i - start + 1);\n                    return;\n                }\n            }\n            else {\n                // not a Master element, so we've found what we're looking for.\n                metadata.splice(i, 1);\n                return;\n            }\n        }\n    }\n}\nexports.removeElement = removeElement;\n/**\n * extract the first occurance of an EBML tag from a flattened array of EBML data.\n * If it's a MasterElement you will also get the content. (everything between start and end)\n * @param idName - name of the EBML Element to extract.\n * @param metadata - array of EBML elements to search\n */\nfunction extractElement(idName, metadata) {\n    var result = [];\n    var start = -1;\n    for (var i = 0; i < metadata.length; i++) {\n        var element = metadata[i];\n        if (element.name === idName) {\n            // if it's a Master element, extract the start and end element, and everything in between\n            if (element.type === \"m\") {\n                if (!element.isEnd) {\n                    start = i;\n                }\n                else {\n                    // we've reached the end, extract the whole thing\n                    if (start == -1)\n                        throw new Error(\"Detected \" + idName + \" closing element before finding the start\");\n                    result = metadata.slice(start, i + 1);\n                    break;\n                }\n            }\n            else {\n                // not a Master element, so we've found what we're looking for.\n                result.push(metadata[i]);\n                break;\n            }\n        }\n    }\n    return result;\n}\nexports.extractElement = extractElement;\n/**\n * @deprecated\n * metadata に対して duration と seekhead を追加した metadata を返す\n * @param metadata - 変更前の webm における ファイル先頭から 最初の Cluster 要素までの 要素\n * @param duration - Duration (TimecodeScale)\n * @param cues - cue points for clusters\n * @deprecated @param clusterPtrs - 変更前の webm における SeekHead に追加する Cluster 要素 への start pointer\n * @deprecated @param cueInfos - please use cues.\n */\nfunction putRefinedMetaData(metadata, info) {\n    if (Array.isArray(info.cueInfos) && !Array.isArray(info.cues)) {\n        console.warn(\"putRefinedMetaData: info.cueInfos property is deprecated. please use info.cues\");\n        info.cues = info.cueInfos;\n    }\n    var ebml = [];\n    var payload = [];\n    for (var i_1 = 0; i_1 < metadata.length; i_1++) {\n        var elm = metadata[i_1];\n        if (elm.type === \"m\" && elm.name === \"Segment\") {\n            ebml = metadata.slice(0, i_1);\n            payload = metadata.slice(i_1);\n            if (elm.unknownSize) {\n                payload.shift(); // remove segment tag\n                break;\n            }\n            throw new Error(\"this metadata is not streaming webm file\");\n        }\n    }\n    // *0    *4    *5  *36      *40   *48=segmentOffset              *185=originalPayloadOffsetEnd\n    // |     |     |   |        |     |                              |\n    // [EBML][size]....[Segment][size][Info][size][Duration][size]...[Cluster]\n    // |               |        |^inf |                              |\n    // |               +segmentSiz(12)+                              |\n    // +-ebmlSize(36)--+        |     +-payloadSize(137)-------------+offsetEndDiff+\n    //                 |        |     +-newPayloadSize(??)-------------------------+\n    //                 |        |     |                                            |\n    //                 [Segment][size][Info][size][Duration][size]....[size][value][Cluster]\n    //                           ^                                                 |\n    //                           |                                                 *??=newPayloadOffsetEnd\n    //                           inf\n    if (!(payload[payload.length - 1].dataEnd > 0)) {\n        throw new Error(\"metadata dataEnd has wrong number\");\n    }\n    var originalPayloadOffsetEnd = payload[payload.length - 1].dataEnd; // = first cluster ptr\n    var ebmlSize = ebml[ebml.length - 1].dataEnd; // = first segment ptr\n    var refinedEBMLSize = new EBMLEncoder_1.default().encode(ebml).byteLength;\n    var offsetDiff = refinedEBMLSize - ebmlSize;\n    var payloadSize = originalPayloadOffsetEnd - payload[0].tagStart;\n    var segmentSize = payload[0].tagStart - ebmlSize;\n    var segmentOffset = payload[0].tagStart;\n    var segmentTagBuf = new exports.Buffer([0x18, 0x53, 0x80, 0x67]); // Segment\n    var segmentSizeBuf = new exports.Buffer('01ffffffffffffff', 'hex'); // Segmentの最後の位置は無数の Cluster 依存なので。 writeVint(newPayloadSize).byteLength ではなく、 infinity.\n    var _segmentSize = segmentTagBuf.byteLength + segmentSizeBuf.byteLength; // == segmentSize\n    var newPayloadSize = payloadSize;\n    // We need the size to be stable between two refinements in order for our offsets to be correct\n    // Bound the number of possible refinements so we can't go infinate if something goes wrong\n    var i;\n    for (i = 1; i < 20; i++) {\n        var newPayloadOffsetEnd = ebmlSize + _segmentSize + newPayloadSize;\n        var offsetEndDiff = newPayloadOffsetEnd - originalPayloadOffsetEnd;\n        var sizeDiff = offsetDiff + offsetEndDiff;\n        var refined = refineMetadata(payload, sizeDiff, info);\n        var newNewRefinedSize = new EBMLEncoder_1.default().encode(refined).byteLength; // 一旦 seekhead を作って自身のサイズを調べる\n        if (newNewRefinedSize === newPayloadSize) {\n            // Size is stable\n            return new EBMLEncoder_1.default().encode([].concat(ebml, [{ type: \"m\", name: \"Segment\", isEnd: false, unknownSize: true }], refined));\n        }\n        newPayloadSize = newNewRefinedSize;\n    }\n    throw new Error(\"unable to refine metadata, stable size could not be found in \" + i + \" iterations!\");\n}\nexports.putRefinedMetaData = putRefinedMetaData;\n// Given a list of EBMLElementBuffers, returns their encoded size in bytes\nfunction encodedSizeOfEbml(refinedMetaData) {\n    var encorder = new EBMLEncoder_1.default();\n    return refinedMetaData.reduce(function (lst, elm) { return lst.concat(encorder.encode([elm])); }, []).reduce(function (o, buf) { return o + buf.byteLength; }, 0);\n}\nfunction refineMetadata(mesetadata, sizeDiff, info) {\n    var duration = info.duration, clusterPtrs = info.clusterPtrs, cues = info.cues;\n    var _metadata = mesetadata.slice(0);\n    if (typeof duration === \"number\") {\n        // duration を追加する\n        var overwrited_1 = false;\n        _metadata.forEach(function (elm) {\n            if (elm.type === \"f\" && elm.name === \"Duration\") {\n                overwrited_1 = true;\n                elm.data = createFloatBuffer(duration, 8);\n            }\n        });\n        if (!overwrited_1) {\n            insertTag(_metadata, \"Info\", [{ name: \"Duration\", type: \"f\", data: createFloatBuffer(duration, 8) }]);\n        }\n    }\n    if (Array.isArray(cues)) {\n        insertTag(_metadata, \"Cues\", create_cue(cues, sizeDiff));\n    }\n    var seekhead_children = [];\n    if (Array.isArray(clusterPtrs)) {\n        console.warn(\"append cluster pointers to seekhead is deprecated. please use cues\");\n        seekhead_children = create_seek_from_clusters(clusterPtrs, sizeDiff);\n    }\n    // remove seek info\n    /*\n    _metadata = _metadata.filter((elm)=> !(\n      elm.name === \"Seek\" ||\n      elm.name === \"SeekID\" ||\n      elm.name === \"SeekPosition\") );\n    */\n    // working on progress\n    //seekhead_children = seekhead_children.concat(create_seekhead(_metadata));\n    insertTag(_metadata, \"SeekHead\", seekhead_children, true);\n    return _metadata;\n}\nfunction create_seekhead(metadata, sizeDiff) {\n    var seeks = [];\n    [\"Info\", \"Tracks\", \"Cues\"].forEach(function (tagName) {\n        var tagStarts = metadata.filter(function (elm) { return elm.type === \"m\" && elm.name === tagName && elm.isEnd === false; }).map(function (elm) { return elm[\"tagStart\"]; });\n        var tagStart = tagStarts[0];\n        if (typeof tagStart !== \"number\") {\n            return;\n        }\n        seeks.push({ name: \"Seek\", type: \"m\", isEnd: false });\n        switch (tagName) {\n            case \"Info\":\n                seeks.push({ name: \"SeekID\", type: \"b\", data: new exports.Buffer([0x15, 0x49, 0xA9, 0x66]) });\n                break;\n            case \"Tracks\":\n                seeks.push({ name: \"SeekID\", type: \"b\", data: new exports.Buffer([0x16, 0x54, 0xAE, 0x6B]) });\n                break;\n            case \"Cues\":\n                seeks.push({ name: \"SeekID\", type: \"b\", data: new exports.Buffer([0x1C, 0x53, 0xBB, 0x6B]) });\n                break;\n        }\n        seeks.push({ name: \"SeekPosition\", type: \"u\", data: createUIntBuffer(tagStart + sizeDiff) });\n        seeks.push({ name: \"Seek\", type: \"m\", isEnd: true });\n    });\n    return seeks;\n}\nfunction create_seek_from_clusters(clusterPtrs, sizeDiff) {\n    var seeks = [];\n    clusterPtrs.forEach(function (start) {\n        seeks.push({ name: \"Seek\", type: \"m\", isEnd: false });\n        // [0x1F, 0x43, 0xB6, 0x75] で Cluster 意\n        seeks.push({ name: \"SeekID\", type: \"b\", data: new exports.Buffer([0x1F, 0x43, 0xB6, 0x75]) });\n        seeks.push({ name: \"SeekPosition\", type: \"u\", data: createUIntBuffer(start + sizeDiff) });\n        seeks.push({ name: \"Seek\", type: \"m\", isEnd: true });\n    });\n    return seeks;\n}\nfunction create_cue(cueInfos, sizeDiff) {\n    var cues = [];\n    cueInfos.forEach(function (_a) {\n        var CueTrack = _a.CueTrack, CueClusterPosition = _a.CueClusterPosition, CueTime = _a.CueTime;\n        cues.push({ name: \"CuePoint\", type: \"m\", isEnd: false });\n        cues.push({ name: \"CueTime\", type: \"u\", data: createUIntBuffer(CueTime) });\n        cues.push({ name: \"CueTrackPositions\", type: \"m\", isEnd: false });\n        cues.push({ name: \"CueTrack\", type: \"u\", data: createUIntBuffer(CueTrack) }); // video track\n        cues.push({ name: \"CueClusterPosition\", type: \"u\", data: createUIntBuffer(CueClusterPosition + sizeDiff) });\n        cues.push({ name: \"CueTrackPositions\", type: \"m\", isEnd: true });\n        cues.push({ name: \"CuePoint\", type: \"m\", isEnd: true });\n    });\n    return cues;\n}\nfunction insertTag(_metadata, tagName, children, insertHead) {\n    if (insertHead === void 0) { insertHead = false; }\n    // find the tagname from _metadata\n    var idx = -1;\n    for (var i = 0; i < _metadata.length; i++) {\n        var elm = _metadata[i];\n        if (elm.type === \"m\" && elm.name === tagName && elm.isEnd === false) {\n            idx = i;\n            break;\n        }\n    }\n    if (idx >= 0) {\n        // insert [<CuePoint />] to <Cues />\n        Array.prototype.splice.apply(_metadata, [idx + 1, 0].concat(children));\n    }\n    else if (insertHead) {\n        [].concat([{ name: tagName, type: \"m\", isEnd: false }], children, [{ name: tagName, type: \"m\", isEnd: true }]).reverse().forEach(function (elm) { _metadata.unshift(elm); });\n    }\n    else {\n        // metadata 末尾に <Cues /> を追加\n        // insert <Cues />\n        _metadata.push({ name: tagName, type: \"m\", isEnd: false });\n        children.forEach(function (elm) { _metadata.push(elm); });\n        _metadata.push({ name: tagName, type: \"m\", isEnd: true });\n    }\n}\n// alter Buffer.concat - https://github.com/feross/buffer/issues/154\nfunction concat(list) {\n    //return Buffer.concat.apply(Buffer, list);\n    var i = 0;\n    var length = 0;\n    for (; i < list.length; ++i) {\n        length += list[i].length;\n    }\n    var buffer = exports.Buffer.allocUnsafe(length);\n    var pos = 0;\n    for (i = 0; i < list.length; ++i) {\n        var buf = list[i];\n        buf.copy(buffer, pos);\n        pos += buf.length;\n    }\n    return buffer;\n}\nexports.concat = concat;\nfunction encodeValueToBuffer(elm) {\n    var data = new exports.Buffer(0);\n    if (elm.type === \"m\") {\n        return elm;\n    }\n    switch (elm.type) {\n        case \"u\":\n            data = createUIntBuffer(elm.value);\n            break;\n        case \"i\":\n            data = createIntBuffer(elm.value);\n            break;\n        case \"f\":\n            data = createFloatBuffer(elm.value);\n            break;\n        case \"s\":\n            data = new exports.Buffer(elm.value, 'ascii');\n            break;\n        case \"8\":\n            data = new exports.Buffer(elm.value, 'utf8');\n            break;\n        case \"b\":\n            data = elm.value;\n            break;\n        case \"d\":\n            data = new int64_buffer_1.Int64BE(elm.value.getTime().toString()).toBuffer();\n            break;\n    }\n    return Object.assign({}, elm, { data: data });\n}\nexports.encodeValueToBuffer = encodeValueToBuffer;\nfunction createUIntBuffer(value) {\n    // Big-endian, any size from 1 to 8\n    // but js number is float64, so max 6 bit octets\n    var bytes = 1;\n    for (; value >= Math.pow(2, 8 * bytes); bytes++) { }\n    if (bytes >= 7) {\n        console.warn(\"7bit or more bigger uint not supported.\");\n        return new int64_buffer_1.Uint64BE(value).toBuffer();\n    }\n    var data = new exports.Buffer(bytes);\n    data.writeUIntBE(value, 0, bytes);\n    return data;\n}\nexports.createUIntBuffer = createUIntBuffer;\nfunction createIntBuffer(value) {\n    // Big-endian, any size from 1 to 8 octets\n    // but js number is float64, so max 6 bit\n    var bytes = 1;\n    for (; value >= Math.pow(2, 8 * bytes); bytes++) { }\n    if (bytes >= 7) {\n        console.warn(\"7bit or more bigger uint not supported.\");\n        return new int64_buffer_1.Int64BE(value).toBuffer();\n    }\n    var data = new exports.Buffer(bytes);\n    data.writeIntBE(value, 0, bytes);\n    return data;\n}\nexports.createIntBuffer = createIntBuffer;\nfunction createFloatBuffer(value, bytes) {\n    if (bytes === void 0) { bytes = 8; }\n    // Big-endian, defined for 4 and 8 octets (32, 64 bits)\n    // js number is float64 so 8 bytes.\n    if (bytes === 8) {\n        // 64bit\n        var data = new exports.Buffer(8);\n        data.writeDoubleBE(value, 0);\n        return data;\n    }\n    else if (bytes === 4) {\n        // 32bit\n        var data = new exports.Buffer(4);\n        data.writeFloatBE(value, 0);\n        return data;\n    }\n    else {\n        throw new Error(\"float type bits must 4bytes or 8bytes\");\n    }\n}\nexports.createFloatBuffer = createFloatBuffer;\nfunction convertEBMLDateToJSDate(int64str) {\n    if (int64str instanceof Date) {\n        return int64str;\n    }\n    return new Date(new Date(\"2001-01-01T00:00:00.000Z\").getTime() + (Number(int64str) / 1000 / 1000));\n}\nexports.convertEBMLDateToJSDate = convertEBMLDateToJSDate;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = React;","const __WEBPACK_NAMESPACE_OBJECT__ = ReactDOM;","const __WEBPACK_NAMESPACE_OBJECT__ = ReactIntl;","/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @fileoverview Firebase constants.  Some of these (@defines) can be overridden at compile-time.\r\n */\r\nconst CONSTANTS = {\r\n    /**\r\n     * @define {boolean} Whether this is the client Node.js SDK.\r\n     */\r\n    NODE_CLIENT: false,\r\n    /**\r\n     * @define {boolean} Whether this is the Admin Node.js SDK.\r\n     */\r\n    NODE_ADMIN: false,\r\n    /**\r\n     * Firebase SDK Version\r\n     */\r\n    SDK_VERSION: '${JSCORE_VERSION}'\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Throws an error if the provided assertion is falsy\r\n */\r\nconst assert = function (assertion, message) {\r\n    if (!assertion) {\r\n        throw assertionError(message);\r\n    }\r\n};\r\n/**\r\n * Returns an Error object suitable for throwing.\r\n */\r\nconst assertionError = function (message) {\r\n    return new Error('Firebase Database (' +\r\n        CONSTANTS.SDK_VERSION +\r\n        ') INTERNAL ASSERT FAILED: ' +\r\n        message);\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst stringToByteArray$1 = function (str) {\r\n    // TODO(user): Use native implementations if/when available\r\n    const out = [];\r\n    let p = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n        let c = str.charCodeAt(i);\r\n        if (c < 128) {\r\n            out[p++] = c;\r\n        }\r\n        else if (c < 2048) {\r\n            out[p++] = (c >> 6) | 192;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else if ((c & 0xfc00) === 0xd800 &&\r\n            i + 1 < str.length &&\r\n            (str.charCodeAt(i + 1) & 0xfc00) === 0xdc00) {\r\n            // Surrogate Pair\r\n            c = 0x10000 + ((c & 0x03ff) << 10) + (str.charCodeAt(++i) & 0x03ff);\r\n            out[p++] = (c >> 18) | 240;\r\n            out[p++] = ((c >> 12) & 63) | 128;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else {\r\n            out[p++] = (c >> 12) | 224;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n    }\r\n    return out;\r\n};\r\n/**\r\n * Turns an array of numbers into the string given by the concatenation of the\r\n * characters to which the numbers correspond.\r\n * @param bytes Array of numbers representing characters.\r\n * @return Stringification of the array.\r\n */\r\nconst byteArrayToString = function (bytes) {\r\n    // TODO(user): Use native implementations if/when available\r\n    const out = [];\r\n    let pos = 0, c = 0;\r\n    while (pos < bytes.length) {\r\n        const c1 = bytes[pos++];\r\n        if (c1 < 128) {\r\n            out[c++] = String.fromCharCode(c1);\r\n        }\r\n        else if (c1 > 191 && c1 < 224) {\r\n            const c2 = bytes[pos++];\r\n            out[c++] = String.fromCharCode(((c1 & 31) << 6) | (c2 & 63));\r\n        }\r\n        else if (c1 > 239 && c1 < 365) {\r\n            // Surrogate Pair\r\n            const c2 = bytes[pos++];\r\n            const c3 = bytes[pos++];\r\n            const c4 = bytes[pos++];\r\n            const u = (((c1 & 7) << 18) | ((c2 & 63) << 12) | ((c3 & 63) << 6) | (c4 & 63)) -\r\n                0x10000;\r\n            out[c++] = String.fromCharCode(0xd800 + (u >> 10));\r\n            out[c++] = String.fromCharCode(0xdc00 + (u & 1023));\r\n        }\r\n        else {\r\n            const c2 = bytes[pos++];\r\n            const c3 = bytes[pos++];\r\n            out[c++] = String.fromCharCode(((c1 & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\r\n        }\r\n    }\r\n    return out.join('');\r\n};\r\n// We define it as an object literal instead of a class because a class compiled down to es5 can't\r\n// be treeshaked. https://github.com/rollup/rollup/issues/1691\r\n// Static lookup maps, lazily populated by init_()\r\nconst base64 = {\r\n    /**\r\n     * Maps bytes to characters.\r\n     */\r\n    byteToCharMap_: null,\r\n    /**\r\n     * Maps characters to bytes.\r\n     */\r\n    charToByteMap_: null,\r\n    /**\r\n     * Maps bytes to websafe characters.\r\n     * @private\r\n     */\r\n    byteToCharMapWebSafe_: null,\r\n    /**\r\n     * Maps websafe characters to bytes.\r\n     * @private\r\n     */\r\n    charToByteMapWebSafe_: null,\r\n    /**\r\n     * Our default alphabet, shared between\r\n     * ENCODED_VALS and ENCODED_VALS_WEBSAFE\r\n     */\r\n    ENCODED_VALS_BASE: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '0123456789',\r\n    /**\r\n     * Our default alphabet. Value 64 (=) is special; it means \"nothing.\"\r\n     */\r\n    get ENCODED_VALS() {\r\n        return this.ENCODED_VALS_BASE + '+/=';\r\n    },\r\n    /**\r\n     * Our websafe alphabet.\r\n     */\r\n    get ENCODED_VALS_WEBSAFE() {\r\n        return this.ENCODED_VALS_BASE + '-_.';\r\n    },\r\n    /**\r\n     * Whether this browser supports the atob and btoa functions. This extension\r\n     * started at Mozilla but is now implemented by many browsers. We use the\r\n     * ASSUME_* variables to avoid pulling in the full useragent detection library\r\n     * but still allowing the standard per-browser compilations.\r\n     *\r\n     */\r\n    HAS_NATIVE_SUPPORT: typeof atob === 'function',\r\n    /**\r\n     * Base64-encode an array of bytes.\r\n     *\r\n     * @param input An array of bytes (numbers with\r\n     *     value in [0, 255]) to encode.\r\n     * @param webSafe Boolean indicating we should use the\r\n     *     alternative alphabet.\r\n     * @return The base64 encoded string.\r\n     */\r\n    encodeByteArray(input, webSafe) {\r\n        if (!Array.isArray(input)) {\r\n            throw Error('encodeByteArray takes an array as a parameter');\r\n        }\r\n        this.init_();\r\n        const byteToCharMap = webSafe\r\n            ? this.byteToCharMapWebSafe_\r\n            : this.byteToCharMap_;\r\n        const output = [];\r\n        for (let i = 0; i < input.length; i += 3) {\r\n            const byte1 = input[i];\r\n            const haveByte2 = i + 1 < input.length;\r\n            const byte2 = haveByte2 ? input[i + 1] : 0;\r\n            const haveByte3 = i + 2 < input.length;\r\n            const byte3 = haveByte3 ? input[i + 2] : 0;\r\n            const outByte1 = byte1 >> 2;\r\n            const outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4);\r\n            let outByte3 = ((byte2 & 0x0f) << 2) | (byte3 >> 6);\r\n            let outByte4 = byte3 & 0x3f;\r\n            if (!haveByte3) {\r\n                outByte4 = 64;\r\n                if (!haveByte2) {\r\n                    outByte3 = 64;\r\n                }\r\n            }\r\n            output.push(byteToCharMap[outByte1], byteToCharMap[outByte2], byteToCharMap[outByte3], byteToCharMap[outByte4]);\r\n        }\r\n        return output.join('');\r\n    },\r\n    /**\r\n     * Base64-encode a string.\r\n     *\r\n     * @param input A string to encode.\r\n     * @param webSafe If true, we should use the\r\n     *     alternative alphabet.\r\n     * @return The base64 encoded string.\r\n     */\r\n    encodeString(input, webSafe) {\r\n        // Shortcut for Mozilla browsers that implement\r\n        // a native base64 encoder in the form of \"btoa/atob\"\r\n        if (this.HAS_NATIVE_SUPPORT && !webSafe) {\r\n            return btoa(input);\r\n        }\r\n        return this.encodeByteArray(stringToByteArray$1(input), webSafe);\r\n    },\r\n    /**\r\n     * Base64-decode a string.\r\n     *\r\n     * @param input to decode.\r\n     * @param webSafe True if we should use the\r\n     *     alternative alphabet.\r\n     * @return string representing the decoded value.\r\n     */\r\n    decodeString(input, webSafe) {\r\n        // Shortcut for Mozilla browsers that implement\r\n        // a native base64 encoder in the form of \"btoa/atob\"\r\n        if (this.HAS_NATIVE_SUPPORT && !webSafe) {\r\n            return atob(input);\r\n        }\r\n        return byteArrayToString(this.decodeStringToByteArray(input, webSafe));\r\n    },\r\n    /**\r\n     * Base64-decode a string.\r\n     *\r\n     * In base-64 decoding, groups of four characters are converted into three\r\n     * bytes.  If the encoder did not apply padding, the input length may not\r\n     * be a multiple of 4.\r\n     *\r\n     * In this case, the last group will have fewer than 4 characters, and\r\n     * padding will be inferred.  If the group has one or two characters, it decodes\r\n     * to one byte.  If the group has three characters, it decodes to two bytes.\r\n     *\r\n     * @param input Input to decode.\r\n     * @param webSafe True if we should use the web-safe alphabet.\r\n     * @return bytes representing the decoded value.\r\n     */\r\n    decodeStringToByteArray(input, webSafe) {\r\n        this.init_();\r\n        const charToByteMap = webSafe\r\n            ? this.charToByteMapWebSafe_\r\n            : this.charToByteMap_;\r\n        const output = [];\r\n        for (let i = 0; i < input.length;) {\r\n            const byte1 = charToByteMap[input.charAt(i++)];\r\n            const haveByte2 = i < input.length;\r\n            const byte2 = haveByte2 ? charToByteMap[input.charAt(i)] : 0;\r\n            ++i;\r\n            const haveByte3 = i < input.length;\r\n            const byte3 = haveByte3 ? charToByteMap[input.charAt(i)] : 64;\r\n            ++i;\r\n            const haveByte4 = i < input.length;\r\n            const byte4 = haveByte4 ? charToByteMap[input.charAt(i)] : 64;\r\n            ++i;\r\n            if (byte1 == null || byte2 == null || byte3 == null || byte4 == null) {\r\n                throw Error();\r\n            }\r\n            const outByte1 = (byte1 << 2) | (byte2 >> 4);\r\n            output.push(outByte1);\r\n            if (byte3 !== 64) {\r\n                const outByte2 = ((byte2 << 4) & 0xf0) | (byte3 >> 2);\r\n                output.push(outByte2);\r\n                if (byte4 !== 64) {\r\n                    const outByte3 = ((byte3 << 6) & 0xc0) | byte4;\r\n                    output.push(outByte3);\r\n                }\r\n            }\r\n        }\r\n        return output;\r\n    },\r\n    /**\r\n     * Lazy static initialization function. Called before\r\n     * accessing any of the static map variables.\r\n     * @private\r\n     */\r\n    init_() {\r\n        if (!this.byteToCharMap_) {\r\n            this.byteToCharMap_ = {};\r\n            this.charToByteMap_ = {};\r\n            this.byteToCharMapWebSafe_ = {};\r\n            this.charToByteMapWebSafe_ = {};\r\n            // We want quick mappings back and forth, so we precompute two maps.\r\n            for (let i = 0; i < this.ENCODED_VALS.length; i++) {\r\n                this.byteToCharMap_[i] = this.ENCODED_VALS.charAt(i);\r\n                this.charToByteMap_[this.byteToCharMap_[i]] = i;\r\n                this.byteToCharMapWebSafe_[i] = this.ENCODED_VALS_WEBSAFE.charAt(i);\r\n                this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]] = i;\r\n                // Be forgiving when decoding and correctly decode both encodings.\r\n                if (i >= this.ENCODED_VALS_BASE.length) {\r\n                    this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)] = i;\r\n                    this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)] = i;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n/**\r\n * URL-safe base64 encoding\r\n */\r\nconst base64Encode = function (str) {\r\n    const utf8Bytes = stringToByteArray$1(str);\r\n    return base64.encodeByteArray(utf8Bytes, true);\r\n};\r\n/**\r\n * URL-safe base64 encoding (without \".\" padding in the end).\r\n * e.g. Used in JSON Web Token (JWT) parts.\r\n */\r\nconst base64urlEncodeWithoutPadding = function (str) {\r\n    // Use base64url encoding and remove padding in the end (dot characters).\r\n    return base64Encode(str).replace(/\\./g, '');\r\n};\r\n/**\r\n * URL-safe base64 decoding\r\n *\r\n * NOTE: DO NOT use the global atob() function - it does NOT support the\r\n * base64Url variant encoding.\r\n *\r\n * @param str To be decoded\r\n * @return Decoded result, if possible\r\n */\r\nconst base64Decode = function (str) {\r\n    try {\r\n        return base64.decodeString(str, true);\r\n    }\r\n    catch (e) {\r\n        console.error('base64Decode failed: ', e);\r\n    }\r\n    return null;\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Do a deep-copy of basic JavaScript Objects or Arrays.\r\n */\r\nfunction deepCopy(value) {\r\n    return deepExtend(undefined, value);\r\n}\r\n/**\r\n * Copy properties from source to target (recursively allows extension\r\n * of Objects and Arrays).  Scalar values in the target are over-written.\r\n * If target is undefined, an object of the appropriate type will be created\r\n * (and returned).\r\n *\r\n * We recursively copy all child properties of plain Objects in the source- so\r\n * that namespace- like dictionaries are merged.\r\n *\r\n * Note that the target can be a function, in which case the properties in\r\n * the source Object are copied onto it as static properties of the Function.\r\n *\r\n * Note: we don't merge __proto__ to prevent prototype pollution\r\n */\r\nfunction deepExtend(target, source) {\r\n    if (!(source instanceof Object)) {\r\n        return source;\r\n    }\r\n    switch (source.constructor) {\r\n        case Date:\r\n            // Treat Dates like scalars; if the target date object had any child\r\n            // properties - they will be lost!\r\n            const dateValue = source;\r\n            return new Date(dateValue.getTime());\r\n        case Object:\r\n            if (target === undefined) {\r\n                target = {};\r\n            }\r\n            break;\r\n        case Array:\r\n            // Always copy the array source and overwrite the target.\r\n            target = [];\r\n            break;\r\n        default:\r\n            // Not a plain Object - treat it as a scalar.\r\n            return source;\r\n    }\r\n    for (const prop in source) {\r\n        // use isValidKey to guard against prototype pollution. See https://snyk.io/vuln/SNYK-JS-LODASH-450202\r\n        if (!source.hasOwnProperty(prop) || !isValidKey(prop)) {\r\n            continue;\r\n        }\r\n        target[prop] = deepExtend(target[prop], source[prop]);\r\n    }\r\n    return target;\r\n}\r\nfunction isValidKey(key) {\r\n    return key !== '__proto__';\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns navigator.userAgent string or '' if it's not defined.\r\n * @return user agent string\r\n */\r\nfunction getUA() {\r\n    if (typeof navigator !== 'undefined' &&\r\n        typeof navigator['userAgent'] === 'string') {\r\n        return navigator['userAgent'];\r\n    }\r\n    else {\r\n        return '';\r\n    }\r\n}\r\n/**\r\n * Detect Cordova / PhoneGap / Ionic frameworks on a mobile device.\r\n *\r\n * Deliberately does not rely on checking `file://` URLs (as this fails PhoneGap\r\n * in the Ripple emulator) nor Cordova `onDeviceReady`, which would normally\r\n * wait for a callback.\r\n */\r\nfunction isMobileCordova() {\r\n    return (typeof window !== 'undefined' &&\r\n        // @ts-ignore Setting up an broadly applicable index signature for Window\r\n        // just to deal with this case would probably be a bad idea.\r\n        !!(window['cordova'] || window['phonegap'] || window['PhoneGap']) &&\r\n        /ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA()));\r\n}\r\n/**\r\n * Detect Node.js.\r\n *\r\n * @return true if Node.js environment is detected.\r\n */\r\n// Node detection logic from: https://github.com/iliakan/detect-node/\r\nfunction isNode() {\r\n    try {\r\n        return (Object.prototype.toString.call(global.process) === '[object process]');\r\n    }\r\n    catch (e) {\r\n        return false;\r\n    }\r\n}\r\n/**\r\n * Detect Browser Environment\r\n */\r\nfunction isBrowser() {\r\n    return typeof self === 'object' && self.self === self;\r\n}\r\nfunction isBrowserExtension() {\r\n    const runtime = typeof chrome === 'object'\r\n        ? chrome.runtime\r\n        : typeof browser === 'object'\r\n            ? browser.runtime\r\n            : undefined;\r\n    return typeof runtime === 'object' && runtime.id !== undefined;\r\n}\r\n/**\r\n * Detect React Native.\r\n *\r\n * @return true if ReactNative environment is detected.\r\n */\r\nfunction isReactNative() {\r\n    return (typeof navigator === 'object' && navigator['product'] === 'ReactNative');\r\n}\r\n/** Detects Electron apps. */\r\nfunction isElectron() {\r\n    return getUA().indexOf('Electron/') >= 0;\r\n}\r\n/** Detects Internet Explorer. */\r\nfunction isIE() {\r\n    const ua = getUA();\r\n    return ua.indexOf('MSIE ') >= 0 || ua.indexOf('Trident/') >= 0;\r\n}\r\n/** Detects Universal Windows Platform apps. */\r\nfunction isUWP() {\r\n    return getUA().indexOf('MSAppHost/') >= 0;\r\n}\r\n/**\r\n * Detect whether the current SDK build is the Node version.\r\n *\r\n * @return true if it's the Node SDK build.\r\n */\r\nfunction isNodeSdk() {\r\n    return CONSTANTS.NODE_CLIENT === true || CONSTANTS.NODE_ADMIN === true;\r\n}\r\n/** Returns true if we are running in Safari. */\r\nfunction isSafari() {\r\n    return (!isNode() &&\r\n        navigator.userAgent.includes('Safari') &&\r\n        !navigator.userAgent.includes('Chrome'));\r\n}\r\n/**\r\n * This method checks if indexedDB is supported by current browser/service worker context\r\n * @return true if indexedDB is supported by current browser/service worker context\r\n */\r\nfunction isIndexedDBAvailable() {\r\n    return typeof indexedDB === 'object';\r\n}\r\n/**\r\n * This method validates browser/sw context for indexedDB by opening a dummy indexedDB database and reject\r\n * if errors occur during the database open operation.\r\n *\r\n * @throws exception if current browser/sw context can't run idb.open (ex: Safari iframe, Firefox\r\n * private browsing)\r\n */\r\nfunction validateIndexedDBOpenable() {\r\n    return new Promise((resolve, reject) => {\r\n        try {\r\n            let preExist = true;\r\n            const DB_CHECK_NAME = 'validate-browser-context-for-indexeddb-analytics-module';\r\n            const request = self.indexedDB.open(DB_CHECK_NAME);\r\n            request.onsuccess = () => {\r\n                request.result.close();\r\n                // delete database only when it doesn't pre-exist\r\n                if (!preExist) {\r\n                    self.indexedDB.deleteDatabase(DB_CHECK_NAME);\r\n                }\r\n                resolve(true);\r\n            };\r\n            request.onupgradeneeded = () => {\r\n                preExist = false;\r\n            };\r\n            request.onerror = () => {\r\n                var _a;\r\n                reject(((_a = request.error) === null || _a === void 0 ? void 0 : _a.message) || '');\r\n            };\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    });\r\n}\r\n/**\r\n *\r\n * This method checks whether cookie is enabled within current browser\r\n * @return true if cookie is enabled within current browser\r\n */\r\nfunction areCookiesEnabled() {\r\n    if (typeof navigator === 'undefined' || !navigator.cookieEnabled) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * Polyfill for `globalThis` object.\r\n * @returns the `globalThis` object for the given environment.\r\n */\r\nfunction getGlobal() {\r\n    if (typeof self !== 'undefined') {\r\n        return self;\r\n    }\r\n    if (typeof window !== 'undefined') {\r\n        return window;\r\n    }\r\n    if (typeof global !== 'undefined') {\r\n        return global;\r\n    }\r\n    throw new Error('Unable to locate global object.');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2022 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst getDefaultsFromGlobal = () => getGlobal().__FIREBASE_DEFAULTS__;\r\n/**\r\n * Attempt to read defaults from a JSON string provided to\r\n * process.env.__FIREBASE_DEFAULTS__ or a JSON file whose path is in\r\n * process.env.__FIREBASE_DEFAULTS_PATH__\r\n */\r\nconst getDefaultsFromEnvVariable = () => {\r\n    if (typeof process === 'undefined' || typeof process.env === 'undefined') {\r\n        return;\r\n    }\r\n    const defaultsJsonString = process.env.__FIREBASE_DEFAULTS__;\r\n    if (defaultsJsonString) {\r\n        return JSON.parse(defaultsJsonString);\r\n    }\r\n};\r\nconst getDefaultsFromCookie = () => {\r\n    if (typeof document === 'undefined') {\r\n        return;\r\n    }\r\n    let match;\r\n    try {\r\n        match = document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/);\r\n    }\r\n    catch (e) {\r\n        // Some environments such as Angular Universal SSR have a\r\n        // `document` object but error on accessing `document.cookie`.\r\n        return;\r\n    }\r\n    const decoded = match && base64Decode(match[1]);\r\n    return decoded && JSON.parse(decoded);\r\n};\r\n/**\r\n * Get the __FIREBASE_DEFAULTS__ object. It checks in order:\r\n * (1) if such an object exists as a property of `globalThis`\r\n * (2) if such an object was provided on a shell environment variable\r\n * (3) if such an object exists in a cookie\r\n */\r\nconst getDefaults = () => {\r\n    try {\r\n        return (getDefaultsFromGlobal() ||\r\n            getDefaultsFromEnvVariable() ||\r\n            getDefaultsFromCookie());\r\n    }\r\n    catch (e) {\r\n        /**\r\n         * Catch-all for being unable to get __FIREBASE_DEFAULTS__ due\r\n         * to any environment case we have not accounted for. Log to\r\n         * info instead of swallowing so we can find these unknown cases\r\n         * and add paths for them if needed.\r\n         */\r\n        console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);\r\n        return;\r\n    }\r\n};\r\n/**\r\n * Returns emulator host stored in the __FIREBASE_DEFAULTS__ object\r\n * for the given product.\r\n * @returns a URL host formatted like `127.0.0.1:9999` or `[::1]:4000` if available\r\n * @public\r\n */\r\nconst getDefaultEmulatorHost = (productName) => { var _a, _b; return (_b = (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a.emulatorHosts) === null || _b === void 0 ? void 0 : _b[productName]; };\r\n/**\r\n * Returns emulator hostname and port stored in the __FIREBASE_DEFAULTS__ object\r\n * for the given product.\r\n * @returns a pair of hostname and port like `[\"::1\", 4000]` if available\r\n * @public\r\n */\r\nconst getDefaultEmulatorHostnameAndPort = (productName) => {\r\n    const host = getDefaultEmulatorHost(productName);\r\n    if (!host) {\r\n        return undefined;\r\n    }\r\n    const separatorIndex = host.lastIndexOf(':'); // Finding the last since IPv6 addr also has colons.\r\n    if (separatorIndex <= 0 || separatorIndex + 1 === host.length) {\r\n        throw new Error(`Invalid host ${host} with no separate hostname and port!`);\r\n    }\r\n    // eslint-disable-next-line no-restricted-globals\r\n    const port = parseInt(host.substring(separatorIndex + 1), 10);\r\n    if (host[0] === '[') {\r\n        // Bracket-quoted `[ipv6addr]:port` => return \"ipv6addr\" (without brackets).\r\n        return [host.substring(1, separatorIndex - 1), port];\r\n    }\r\n    else {\r\n        return [host.substring(0, separatorIndex), port];\r\n    }\r\n};\r\n/**\r\n * Returns Firebase app config stored in the __FIREBASE_DEFAULTS__ object.\r\n * @public\r\n */\r\nconst getDefaultAppConfig = () => { var _a; return (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a.config; };\r\n/**\r\n * Returns an experimental setting on the __FIREBASE_DEFAULTS__ object (properties\r\n * prefixed by \"_\")\r\n * @public\r\n */\r\nconst getExperimentalSetting = (name) => { var _a; return (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a[`_${name}`]; };\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nclass Deferred {\r\n    constructor() {\r\n        this.reject = () => { };\r\n        this.resolve = () => { };\r\n        this.promise = new Promise((resolve, reject) => {\r\n            this.resolve = resolve;\r\n            this.reject = reject;\r\n        });\r\n    }\r\n    /**\r\n     * Our API internals are not promiseified and cannot because our callback APIs have subtle expectations around\r\n     * invoking promises inline, which Promises are forbidden to do. This method accepts an optional node-style callback\r\n     * and returns a node-style callback which will resolve or reject the Deferred's promise.\r\n     */\r\n    wrapCallback(callback) {\r\n        return (error, value) => {\r\n            if (error) {\r\n                this.reject(error);\r\n            }\r\n            else {\r\n                this.resolve(value);\r\n            }\r\n            if (typeof callback === 'function') {\r\n                // Attaching noop handler just in case developer wasn't expecting\r\n                // promises\r\n                this.promise.catch(() => { });\r\n                // Some of our callbacks don't expect a value and our own tests\r\n                // assert that the parameter length is 1\r\n                if (callback.length === 1) {\r\n                    callback(error);\r\n                }\r\n                else {\r\n                    callback(error, value);\r\n                }\r\n            }\r\n        };\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction createMockUserToken(token, projectId) {\r\n    if (token.uid) {\r\n        throw new Error('The \"uid\" field is no longer supported by mockUserToken. Please use \"sub\" instead for Firebase Auth User ID.');\r\n    }\r\n    // Unsecured JWTs use \"none\" as the algorithm.\r\n    const header = {\r\n        alg: 'none',\r\n        type: 'JWT'\r\n    };\r\n    const project = projectId || 'demo-project';\r\n    const iat = token.iat || 0;\r\n    const sub = token.sub || token.user_id;\r\n    if (!sub) {\r\n        throw new Error(\"mockUserToken must contain 'sub' or 'user_id' field!\");\r\n    }\r\n    const payload = Object.assign({ \r\n        // Set all required fields to decent defaults\r\n        iss: `https://securetoken.google.com/${project}`, aud: project, iat, exp: iat + 3600, auth_time: iat, sub, user_id: sub, firebase: {\r\n            sign_in_provider: 'custom',\r\n            identities: {}\r\n        } }, token);\r\n    // Unsecured JWTs use the empty string as a signature.\r\n    const signature = '';\r\n    return [\r\n        base64urlEncodeWithoutPadding(JSON.stringify(header)),\r\n        base64urlEncodeWithoutPadding(JSON.stringify(payload)),\r\n        signature\r\n    ].join('.');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @fileoverview Standardized Firebase Error.\r\n *\r\n * Usage:\r\n *\r\n *   // Typescript string literals for type-safe codes\r\n *   type Err =\r\n *     'unknown' |\r\n *     'object-not-found'\r\n *     ;\r\n *\r\n *   // Closure enum for type-safe error codes\r\n *   // at-enum {string}\r\n *   var Err = {\r\n *     UNKNOWN: 'unknown',\r\n *     OBJECT_NOT_FOUND: 'object-not-found',\r\n *   }\r\n *\r\n *   let errors: Map<Err, string> = {\r\n *     'generic-error': \"Unknown error\",\r\n *     'file-not-found': \"Could not find file: {$file}\",\r\n *   };\r\n *\r\n *   // Type-safe function - must pass a valid error code as param.\r\n *   let error = new ErrorFactory<Err>('service', 'Service', errors);\r\n *\r\n *   ...\r\n *   throw error.create(Err.GENERIC);\r\n *   ...\r\n *   throw error.create(Err.FILE_NOT_FOUND, {'file': fileName});\r\n *   ...\r\n *   // Service: Could not file file: foo.txt (service/file-not-found).\r\n *\r\n *   catch (e) {\r\n *     assert(e.message === \"Could not find file: foo.txt.\");\r\n *     if ((e as FirebaseError)?.code === 'service/file-not-found') {\r\n *       console.log(\"Could not read file: \" + e['file']);\r\n *     }\r\n *   }\r\n */\r\nconst ERROR_NAME = 'FirebaseError';\r\n// Based on code from:\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types\r\nclass FirebaseError extends Error {\r\n    constructor(\r\n    /** The error code for this error. */\r\n    code, message, \r\n    /** Custom data for this error. */\r\n    customData) {\r\n        super(message);\r\n        this.code = code;\r\n        this.customData = customData;\r\n        /** The custom name for all FirebaseErrors. */\r\n        this.name = ERROR_NAME;\r\n        // Fix For ES5\r\n        // https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\r\n        Object.setPrototypeOf(this, FirebaseError.prototype);\r\n        // Maintains proper stack trace for where our error was thrown.\r\n        // Only available on V8.\r\n        if (Error.captureStackTrace) {\r\n            Error.captureStackTrace(this, ErrorFactory.prototype.create);\r\n        }\r\n    }\r\n}\r\nclass ErrorFactory {\r\n    constructor(service, serviceName, errors) {\r\n        this.service = service;\r\n        this.serviceName = serviceName;\r\n        this.errors = errors;\r\n    }\r\n    create(code, ...data) {\r\n        const customData = data[0] || {};\r\n        const fullCode = `${this.service}/${code}`;\r\n        const template = this.errors[code];\r\n        const message = template ? replaceTemplate(template, customData) : 'Error';\r\n        // Service Name: Error message (service/code).\r\n        const fullMessage = `${this.serviceName}: ${message} (${fullCode}).`;\r\n        const error = new FirebaseError(fullCode, fullMessage, customData);\r\n        return error;\r\n    }\r\n}\r\nfunction replaceTemplate(template, data) {\r\n    return template.replace(PATTERN, (_, key) => {\r\n        const value = data[key];\r\n        return value != null ? String(value) : `<${key}?>`;\r\n    });\r\n}\r\nconst PATTERN = /\\{\\$([^}]+)}/g;\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Evaluates a JSON string into a javascript object.\r\n *\r\n * @param {string} str A string containing JSON.\r\n * @return {*} The javascript object representing the specified JSON.\r\n */\r\nfunction jsonEval(str) {\r\n    return JSON.parse(str);\r\n}\r\n/**\r\n * Returns JSON representing a javascript object.\r\n * @param {*} data Javascript object to be stringified.\r\n * @return {string} The JSON contents of the object.\r\n */\r\nfunction stringify(data) {\r\n    return JSON.stringify(data);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Decodes a Firebase auth. token into constituent parts.\r\n *\r\n * Notes:\r\n * - May return with invalid / incomplete claims if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nconst decode = function (token) {\r\n    let header = {}, claims = {}, data = {}, signature = '';\r\n    try {\r\n        const parts = token.split('.');\r\n        header = jsonEval(base64Decode(parts[0]) || '');\r\n        claims = jsonEval(base64Decode(parts[1]) || '');\r\n        signature = parts[2];\r\n        data = claims['d'] || {};\r\n        delete claims['d'];\r\n    }\r\n    catch (e) { }\r\n    return {\r\n        header,\r\n        claims,\r\n        data,\r\n        signature\r\n    };\r\n};\r\n/**\r\n * Decodes a Firebase auth. token and checks the validity of its time-based claims. Will return true if the\r\n * token is within the time window authorized by the 'nbf' (not-before) and 'iat' (issued-at) claims.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nconst isValidTimestamp = function (token) {\r\n    const claims = decode(token).claims;\r\n    const now = Math.floor(new Date().getTime() / 1000);\r\n    let validSince = 0, validUntil = 0;\r\n    if (typeof claims === 'object') {\r\n        if (claims.hasOwnProperty('nbf')) {\r\n            validSince = claims['nbf'];\r\n        }\r\n        else if (claims.hasOwnProperty('iat')) {\r\n            validSince = claims['iat'];\r\n        }\r\n        if (claims.hasOwnProperty('exp')) {\r\n            validUntil = claims['exp'];\r\n        }\r\n        else {\r\n            // token will expire after 24h by default\r\n            validUntil = validSince + 86400;\r\n        }\r\n    }\r\n    return (!!now &&\r\n        !!validSince &&\r\n        !!validUntil &&\r\n        now >= validSince &&\r\n        now <= validUntil);\r\n};\r\n/**\r\n * Decodes a Firebase auth. token and returns its issued at time if valid, null otherwise.\r\n *\r\n * Notes:\r\n * - May return null if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nconst issuedAtTime = function (token) {\r\n    const claims = decode(token).claims;\r\n    if (typeof claims === 'object' && claims.hasOwnProperty('iat')) {\r\n        return claims['iat'];\r\n    }\r\n    return null;\r\n};\r\n/**\r\n * Decodes a Firebase auth. token and checks the validity of its format. Expects a valid issued-at time.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nconst isValidFormat = function (token) {\r\n    const decoded = decode(token), claims = decoded.claims;\r\n    return !!claims && typeof claims === 'object' && claims.hasOwnProperty('iat');\r\n};\r\n/**\r\n * Attempts to peer into an auth token and determine if it's an admin auth token by looking at the claims portion.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nconst isAdmin = function (token) {\r\n    const claims = decode(token).claims;\r\n    return typeof claims === 'object' && claims['admin'] === true;\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction contains(obj, key) {\r\n    return Object.prototype.hasOwnProperty.call(obj, key);\r\n}\r\nfunction safeGet(obj, key) {\r\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n        return obj[key];\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\nfunction isEmpty(obj) {\r\n    for (const key in obj) {\r\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction map(obj, fn, contextObj) {\r\n    const res = {};\r\n    for (const key in obj) {\r\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n            res[key] = fn.call(contextObj, obj[key], key, obj);\r\n        }\r\n    }\r\n    return res;\r\n}\r\n/**\r\n * Deep equal two objects. Support Arrays and Objects.\r\n */\r\nfunction deepEqual(a, b) {\r\n    if (a === b) {\r\n        return true;\r\n    }\r\n    const aKeys = Object.keys(a);\r\n    const bKeys = Object.keys(b);\r\n    for (const k of aKeys) {\r\n        if (!bKeys.includes(k)) {\r\n            return false;\r\n        }\r\n        const aProp = a[k];\r\n        const bProp = b[k];\r\n        if (isObject(aProp) && isObject(bProp)) {\r\n            if (!deepEqual(aProp, bProp)) {\r\n                return false;\r\n            }\r\n        }\r\n        else if (aProp !== bProp) {\r\n            return false;\r\n        }\r\n    }\r\n    for (const k of bKeys) {\r\n        if (!aKeys.includes(k)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction isObject(thing) {\r\n    return thing !== null && typeof thing === 'object';\r\n}\n\n/**\r\n * @license\r\n * Copyright 2022 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Rejects if the given promise doesn't resolve in timeInMS milliseconds.\r\n * @internal\r\n */\r\nfunction promiseWithTimeout(promise, timeInMS = 2000) {\r\n    const deferredPromise = new Deferred();\r\n    setTimeout(() => deferredPromise.reject('timeout!'), timeInMS);\r\n    promise.then(deferredPromise.resolve, deferredPromise.reject);\r\n    return deferredPromise.promise;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a querystring-formatted string (e.g. &arg=val&arg2=val2) from a\r\n * params object (e.g. {arg: 'val', arg2: 'val2'})\r\n * Note: You must prepend it with ? when adding it to a URL.\r\n */\r\nfunction querystring(querystringParams) {\r\n    const params = [];\r\n    for (const [key, value] of Object.entries(querystringParams)) {\r\n        if (Array.isArray(value)) {\r\n            value.forEach(arrayVal => {\r\n                params.push(encodeURIComponent(key) + '=' + encodeURIComponent(arrayVal));\r\n            });\r\n        }\r\n        else {\r\n            params.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\r\n        }\r\n    }\r\n    return params.length ? '&' + params.join('&') : '';\r\n}\r\n/**\r\n * Decodes a querystring (e.g. ?arg=val&arg2=val2) into a params object\r\n * (e.g. {arg: 'val', arg2: 'val2'})\r\n */\r\nfunction querystringDecode(querystring) {\r\n    const obj = {};\r\n    const tokens = querystring.replace(/^\\?/, '').split('&');\r\n    tokens.forEach(token => {\r\n        if (token) {\r\n            const [key, value] = token.split('=');\r\n            obj[decodeURIComponent(key)] = decodeURIComponent(value);\r\n        }\r\n    });\r\n    return obj;\r\n}\r\n/**\r\n * Extract the query string part of a URL, including the leading question mark (if present).\r\n */\r\nfunction extractQuerystring(url) {\r\n    const queryStart = url.indexOf('?');\r\n    if (!queryStart) {\r\n        return '';\r\n    }\r\n    const fragmentStart = url.indexOf('#', queryStart);\r\n    return url.substring(queryStart, fragmentStart > 0 ? fragmentStart : undefined);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @fileoverview SHA-1 cryptographic hash.\r\n * Variable names follow the notation in FIPS PUB 180-3:\r\n * http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf.\r\n *\r\n * Usage:\r\n *   var sha1 = new sha1();\r\n *   sha1.update(bytes);\r\n *   var hash = sha1.digest();\r\n *\r\n * Performance:\r\n *   Chrome 23:   ~400 Mbit/s\r\n *   Firefox 16:  ~250 Mbit/s\r\n *\r\n */\r\n/**\r\n * SHA-1 cryptographic hash constructor.\r\n *\r\n * The properties declared here are discussed in the above algorithm document.\r\n * @constructor\r\n * @final\r\n * @struct\r\n */\r\nclass Sha1 {\r\n    constructor() {\r\n        /**\r\n         * Holds the previous values of accumulated variables a-e in the compress_\r\n         * function.\r\n         * @private\r\n         */\r\n        this.chain_ = [];\r\n        /**\r\n         * A buffer holding the partially computed hash result.\r\n         * @private\r\n         */\r\n        this.buf_ = [];\r\n        /**\r\n         * An array of 80 bytes, each a part of the message to be hashed.  Referred to\r\n         * as the message schedule in the docs.\r\n         * @private\r\n         */\r\n        this.W_ = [];\r\n        /**\r\n         * Contains data needed to pad messages less than 64 bytes.\r\n         * @private\r\n         */\r\n        this.pad_ = [];\r\n        /**\r\n         * @private {number}\r\n         */\r\n        this.inbuf_ = 0;\r\n        /**\r\n         * @private {number}\r\n         */\r\n        this.total_ = 0;\r\n        this.blockSize = 512 / 8;\r\n        this.pad_[0] = 128;\r\n        for (let i = 1; i < this.blockSize; ++i) {\r\n            this.pad_[i] = 0;\r\n        }\r\n        this.reset();\r\n    }\r\n    reset() {\r\n        this.chain_[0] = 0x67452301;\r\n        this.chain_[1] = 0xefcdab89;\r\n        this.chain_[2] = 0x98badcfe;\r\n        this.chain_[3] = 0x10325476;\r\n        this.chain_[4] = 0xc3d2e1f0;\r\n        this.inbuf_ = 0;\r\n        this.total_ = 0;\r\n    }\r\n    /**\r\n     * Internal compress helper function.\r\n     * @param buf Block to compress.\r\n     * @param offset Offset of the block in the buffer.\r\n     * @private\r\n     */\r\n    compress_(buf, offset) {\r\n        if (!offset) {\r\n            offset = 0;\r\n        }\r\n        const W = this.W_;\r\n        // get 16 big endian words\r\n        if (typeof buf === 'string') {\r\n            for (let i = 0; i < 16; i++) {\r\n                // TODO(user): [bug 8140122] Recent versions of Safari for Mac OS and iOS\r\n                // have a bug that turns the post-increment ++ operator into pre-increment\r\n                // during JIT compilation.  We have code that depends heavily on SHA-1 for\r\n                // correctness and which is affected by this bug, so I've removed all uses\r\n                // of post-increment ++ in which the result value is used.  We can revert\r\n                // this change once the Safari bug\r\n                // (https://bugs.webkit.org/show_bug.cgi?id=109036) has been fixed and\r\n                // most clients have been updated.\r\n                W[i] =\r\n                    (buf.charCodeAt(offset) << 24) |\r\n                        (buf.charCodeAt(offset + 1) << 16) |\r\n                        (buf.charCodeAt(offset + 2) << 8) |\r\n                        buf.charCodeAt(offset + 3);\r\n                offset += 4;\r\n            }\r\n        }\r\n        else {\r\n            for (let i = 0; i < 16; i++) {\r\n                W[i] =\r\n                    (buf[offset] << 24) |\r\n                        (buf[offset + 1] << 16) |\r\n                        (buf[offset + 2] << 8) |\r\n                        buf[offset + 3];\r\n                offset += 4;\r\n            }\r\n        }\r\n        // expand to 80 words\r\n        for (let i = 16; i < 80; i++) {\r\n            const t = W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16];\r\n            W[i] = ((t << 1) | (t >>> 31)) & 0xffffffff;\r\n        }\r\n        let a = this.chain_[0];\r\n        let b = this.chain_[1];\r\n        let c = this.chain_[2];\r\n        let d = this.chain_[3];\r\n        let e = this.chain_[4];\r\n        let f, k;\r\n        // TODO(user): Try to unroll this loop to speed up the computation.\r\n        for (let i = 0; i < 80; i++) {\r\n            if (i < 40) {\r\n                if (i < 20) {\r\n                    f = d ^ (b & (c ^ d));\r\n                    k = 0x5a827999;\r\n                }\r\n                else {\r\n                    f = b ^ c ^ d;\r\n                    k = 0x6ed9eba1;\r\n                }\r\n            }\r\n            else {\r\n                if (i < 60) {\r\n                    f = (b & c) | (d & (b | c));\r\n                    k = 0x8f1bbcdc;\r\n                }\r\n                else {\r\n                    f = b ^ c ^ d;\r\n                    k = 0xca62c1d6;\r\n                }\r\n            }\r\n            const t = (((a << 5) | (a >>> 27)) + f + e + k + W[i]) & 0xffffffff;\r\n            e = d;\r\n            d = c;\r\n            c = ((b << 30) | (b >>> 2)) & 0xffffffff;\r\n            b = a;\r\n            a = t;\r\n        }\r\n        this.chain_[0] = (this.chain_[0] + a) & 0xffffffff;\r\n        this.chain_[1] = (this.chain_[1] + b) & 0xffffffff;\r\n        this.chain_[2] = (this.chain_[2] + c) & 0xffffffff;\r\n        this.chain_[3] = (this.chain_[3] + d) & 0xffffffff;\r\n        this.chain_[4] = (this.chain_[4] + e) & 0xffffffff;\r\n    }\r\n    update(bytes, length) {\r\n        // TODO(johnlenz): tighten the function signature and remove this check\r\n        if (bytes == null) {\r\n            return;\r\n        }\r\n        if (length === undefined) {\r\n            length = bytes.length;\r\n        }\r\n        const lengthMinusBlock = length - this.blockSize;\r\n        let n = 0;\r\n        // Using local instead of member variables gives ~5% speedup on Firefox 16.\r\n        const buf = this.buf_;\r\n        let inbuf = this.inbuf_;\r\n        // The outer while loop should execute at most twice.\r\n        while (n < length) {\r\n            // When we have no data in the block to top up, we can directly process the\r\n            // input buffer (assuming it contains sufficient data). This gives ~25%\r\n            // speedup on Chrome 23 and ~15% speedup on Firefox 16, but requires that\r\n            // the data is provided in large chunks (or in multiples of 64 bytes).\r\n            if (inbuf === 0) {\r\n                while (n <= lengthMinusBlock) {\r\n                    this.compress_(bytes, n);\r\n                    n += this.blockSize;\r\n                }\r\n            }\r\n            if (typeof bytes === 'string') {\r\n                while (n < length) {\r\n                    buf[inbuf] = bytes.charCodeAt(n);\r\n                    ++inbuf;\r\n                    ++n;\r\n                    if (inbuf === this.blockSize) {\r\n                        this.compress_(buf);\r\n                        inbuf = 0;\r\n                        // Jump to the outer loop so we use the full-block optimization.\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                while (n < length) {\r\n                    buf[inbuf] = bytes[n];\r\n                    ++inbuf;\r\n                    ++n;\r\n                    if (inbuf === this.blockSize) {\r\n                        this.compress_(buf);\r\n                        inbuf = 0;\r\n                        // Jump to the outer loop so we use the full-block optimization.\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.inbuf_ = inbuf;\r\n        this.total_ += length;\r\n    }\r\n    /** @override */\r\n    digest() {\r\n        const digest = [];\r\n        let totalBits = this.total_ * 8;\r\n        // Add pad 0x80 0x00*.\r\n        if (this.inbuf_ < 56) {\r\n            this.update(this.pad_, 56 - this.inbuf_);\r\n        }\r\n        else {\r\n            this.update(this.pad_, this.blockSize - (this.inbuf_ - 56));\r\n        }\r\n        // Add # bits.\r\n        for (let i = this.blockSize - 1; i >= 56; i--) {\r\n            this.buf_[i] = totalBits & 255;\r\n            totalBits /= 256; // Don't use bit-shifting here!\r\n        }\r\n        this.compress_(this.buf_);\r\n        let n = 0;\r\n        for (let i = 0; i < 5; i++) {\r\n            for (let j = 24; j >= 0; j -= 8) {\r\n                digest[n] = (this.chain_[i] >> j) & 255;\r\n                ++n;\r\n            }\r\n        }\r\n        return digest;\r\n    }\r\n}\n\n/**\r\n * Helper to make a Subscribe function (just like Promise helps make a\r\n * Thenable).\r\n *\r\n * @param executor Function which can make calls to a single Observer\r\n *     as a proxy.\r\n * @param onNoObservers Callback when count of Observers goes to zero.\r\n */\r\nfunction createSubscribe(executor, onNoObservers) {\r\n    const proxy = new ObserverProxy(executor, onNoObservers);\r\n    return proxy.subscribe.bind(proxy);\r\n}\r\n/**\r\n * Implement fan-out for any number of Observers attached via a subscribe\r\n * function.\r\n */\r\nclass ObserverProxy {\r\n    /**\r\n     * @param executor Function which can make calls to a single Observer\r\n     *     as a proxy.\r\n     * @param onNoObservers Callback when count of Observers goes to zero.\r\n     */\r\n    constructor(executor, onNoObservers) {\r\n        this.observers = [];\r\n        this.unsubscribes = [];\r\n        this.observerCount = 0;\r\n        // Micro-task scheduling by calling task.then().\r\n        this.task = Promise.resolve();\r\n        this.finalized = false;\r\n        this.onNoObservers = onNoObservers;\r\n        // Call the executor asynchronously so subscribers that are called\r\n        // synchronously after the creation of the subscribe function\r\n        // can still receive the very first value generated in the executor.\r\n        this.task\r\n            .then(() => {\r\n            executor(this);\r\n        })\r\n            .catch(e => {\r\n            this.error(e);\r\n        });\r\n    }\r\n    next(value) {\r\n        this.forEachObserver((observer) => {\r\n            observer.next(value);\r\n        });\r\n    }\r\n    error(error) {\r\n        this.forEachObserver((observer) => {\r\n            observer.error(error);\r\n        });\r\n        this.close(error);\r\n    }\r\n    complete() {\r\n        this.forEachObserver((observer) => {\r\n            observer.complete();\r\n        });\r\n        this.close();\r\n    }\r\n    /**\r\n     * Subscribe function that can be used to add an Observer to the fan-out list.\r\n     *\r\n     * - We require that no event is sent to a subscriber sychronously to their\r\n     *   call to subscribe().\r\n     */\r\n    subscribe(nextOrObserver, error, complete) {\r\n        let observer;\r\n        if (nextOrObserver === undefined &&\r\n            error === undefined &&\r\n            complete === undefined) {\r\n            throw new Error('Missing Observer.');\r\n        }\r\n        // Assemble an Observer object when passed as callback functions.\r\n        if (implementsAnyMethods(nextOrObserver, [\r\n            'next',\r\n            'error',\r\n            'complete'\r\n        ])) {\r\n            observer = nextOrObserver;\r\n        }\r\n        else {\r\n            observer = {\r\n                next: nextOrObserver,\r\n                error,\r\n                complete\r\n            };\r\n        }\r\n        if (observer.next === undefined) {\r\n            observer.next = noop;\r\n        }\r\n        if (observer.error === undefined) {\r\n            observer.error = noop;\r\n        }\r\n        if (observer.complete === undefined) {\r\n            observer.complete = noop;\r\n        }\r\n        const unsub = this.unsubscribeOne.bind(this, this.observers.length);\r\n        // Attempt to subscribe to a terminated Observable - we\r\n        // just respond to the Observer with the final error or complete\r\n        // event.\r\n        if (this.finalized) {\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n            this.task.then(() => {\r\n                try {\r\n                    if (this.finalError) {\r\n                        observer.error(this.finalError);\r\n                    }\r\n                    else {\r\n                        observer.complete();\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    // nothing\r\n                }\r\n                return;\r\n            });\r\n        }\r\n        this.observers.push(observer);\r\n        return unsub;\r\n    }\r\n    // Unsubscribe is synchronous - we guarantee that no events are sent to\r\n    // any unsubscribed Observer.\r\n    unsubscribeOne(i) {\r\n        if (this.observers === undefined || this.observers[i] === undefined) {\r\n            return;\r\n        }\r\n        delete this.observers[i];\r\n        this.observerCount -= 1;\r\n        if (this.observerCount === 0 && this.onNoObservers !== undefined) {\r\n            this.onNoObservers(this);\r\n        }\r\n    }\r\n    forEachObserver(fn) {\r\n        if (this.finalized) {\r\n            // Already closed by previous event....just eat the additional values.\r\n            return;\r\n        }\r\n        // Since sendOne calls asynchronously - there is no chance that\r\n        // this.observers will become undefined.\r\n        for (let i = 0; i < this.observers.length; i++) {\r\n            this.sendOne(i, fn);\r\n        }\r\n    }\r\n    // Call the Observer via one of it's callback function. We are careful to\r\n    // confirm that the observe has not been unsubscribed since this asynchronous\r\n    // function had been queued.\r\n    sendOne(i, fn) {\r\n        // Execute the callback asynchronously\r\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n        this.task.then(() => {\r\n            if (this.observers !== undefined && this.observers[i] !== undefined) {\r\n                try {\r\n                    fn(this.observers[i]);\r\n                }\r\n                catch (e) {\r\n                    // Ignore exceptions raised in Observers or missing methods of an\r\n                    // Observer.\r\n                    // Log error to console. b/31404806\r\n                    if (typeof console !== 'undefined' && console.error) {\r\n                        console.error(e);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n    close(err) {\r\n        if (this.finalized) {\r\n            return;\r\n        }\r\n        this.finalized = true;\r\n        if (err !== undefined) {\r\n            this.finalError = err;\r\n        }\r\n        // Proxy is no longer needed - garbage collect references\r\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n        this.task.then(() => {\r\n            this.observers = undefined;\r\n            this.onNoObservers = undefined;\r\n        });\r\n    }\r\n}\r\n/** Turn synchronous function into one called asynchronously. */\r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\nfunction async(fn, onError) {\r\n    return (...args) => {\r\n        Promise.resolve(true)\r\n            .then(() => {\r\n            fn(...args);\r\n        })\r\n            .catch((error) => {\r\n            if (onError) {\r\n                onError(error);\r\n            }\r\n        });\r\n    };\r\n}\r\n/**\r\n * Return true if the object passed in implements any of the named methods.\r\n */\r\nfunction implementsAnyMethods(obj, methods) {\r\n    if (typeof obj !== 'object' || obj === null) {\r\n        return false;\r\n    }\r\n    for (const method of methods) {\r\n        if (method in obj && typeof obj[method] === 'function') {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction noop() {\r\n    // do nothing\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Check to make sure the appropriate number of arguments are provided for a public function.\r\n * Throws an error if it fails.\r\n *\r\n * @param fnName The function name\r\n * @param minCount The minimum number of arguments to allow for the function call\r\n * @param maxCount The maximum number of argument to allow for the function call\r\n * @param argCount The actual number of arguments provided.\r\n */\r\nconst validateArgCount = function (fnName, minCount, maxCount, argCount) {\r\n    let argError;\r\n    if (argCount < minCount) {\r\n        argError = 'at least ' + minCount;\r\n    }\r\n    else if (argCount > maxCount) {\r\n        argError = maxCount === 0 ? 'none' : 'no more than ' + maxCount;\r\n    }\r\n    if (argError) {\r\n        const error = fnName +\r\n            ' failed: Was called with ' +\r\n            argCount +\r\n            (argCount === 1 ? ' argument.' : ' arguments.') +\r\n            ' Expects ' +\r\n            argError +\r\n            '.';\r\n        throw new Error(error);\r\n    }\r\n};\r\n/**\r\n * Generates a string to prefix an error message about failed argument validation\r\n *\r\n * @param fnName The function name\r\n * @param argName The name of the argument\r\n * @return The prefix to add to the error thrown for validation.\r\n */\r\nfunction errorPrefix(fnName, argName) {\r\n    return `${fnName} failed: ${argName} argument `;\r\n}\r\n/**\r\n * @param fnName\r\n * @param argumentNumber\r\n * @param namespace\r\n * @param optional\r\n */\r\nfunction validateNamespace(fnName, namespace, optional) {\r\n    if (optional && !namespace) {\r\n        return;\r\n    }\r\n    if (typeof namespace !== 'string') {\r\n        //TODO: I should do more validation here. We only allow certain chars in namespaces.\r\n        throw new Error(errorPrefix(fnName, 'namespace') + 'must be a valid firebase namespace.');\r\n    }\r\n}\r\nfunction validateCallback(fnName, argumentName, \r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\ncallback, optional) {\r\n    if (optional && !callback) {\r\n        return;\r\n    }\r\n    if (typeof callback !== 'function') {\r\n        throw new Error(errorPrefix(fnName, argumentName) + 'must be a valid function.');\r\n    }\r\n}\r\nfunction validateContextObject(fnName, argumentName, context, optional) {\r\n    if (optional && !context) {\r\n        return;\r\n    }\r\n    if (typeof context !== 'object' || context === null) {\r\n        throw new Error(errorPrefix(fnName, argumentName) + 'must be a valid context object.');\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n// Code originally came from goog.crypt.stringToUtf8ByteArray, but for some reason they\r\n// automatically replaced '\\r\\n' with '\\n', and they didn't handle surrogate pairs,\r\n// so it's been modified.\r\n// Note that not all Unicode characters appear as single characters in JavaScript strings.\r\n// fromCharCode returns the UTF-16 encoding of a character - so some Unicode characters\r\n// use 2 characters in Javascript.  All 4-byte UTF-8 characters begin with a first\r\n// character in the range 0xD800 - 0xDBFF (the first character of a so-called surrogate\r\n// pair).\r\n// See http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.3\r\n/**\r\n * @param {string} str\r\n * @return {Array}\r\n */\r\nconst stringToByteArray = function (str) {\r\n    const out = [];\r\n    let p = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n        let c = str.charCodeAt(i);\r\n        // Is this the lead surrogate in a surrogate pair?\r\n        if (c >= 0xd800 && c <= 0xdbff) {\r\n            const high = c - 0xd800; // the high 10 bits.\r\n            i++;\r\n            assert(i < str.length, 'Surrogate pair missing trail surrogate.');\r\n            const low = str.charCodeAt(i) - 0xdc00; // the low 10 bits.\r\n            c = 0x10000 + (high << 10) + low;\r\n        }\r\n        if (c < 128) {\r\n            out[p++] = c;\r\n        }\r\n        else if (c < 2048) {\r\n            out[p++] = (c >> 6) | 192;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else if (c < 65536) {\r\n            out[p++] = (c >> 12) | 224;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else {\r\n            out[p++] = (c >> 18) | 240;\r\n            out[p++] = ((c >> 12) & 63) | 128;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n    }\r\n    return out;\r\n};\r\n/**\r\n * Calculate length without actually converting; useful for doing cheaper validation.\r\n * @param {string} str\r\n * @return {number}\r\n */\r\nconst stringLength = function (str) {\r\n    let p = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n        const c = str.charCodeAt(i);\r\n        if (c < 128) {\r\n            p++;\r\n        }\r\n        else if (c < 2048) {\r\n            p += 2;\r\n        }\r\n        else if (c >= 0xd800 && c <= 0xdbff) {\r\n            // Lead surrogate of a surrogate pair.  The pair together will take 4 bytes to represent.\r\n            p += 4;\r\n            i++; // skip trail surrogate.\r\n        }\r\n        else {\r\n            p += 3;\r\n        }\r\n    }\r\n    return p;\r\n};\n\n/**\r\n * @license\r\n * Copyright 2022 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Copied from https://stackoverflow.com/a/2117523\r\n * Generates a new uuid.\r\n * @public\r\n */\r\nconst uuidv4 = function () {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\r\n        const r = (Math.random() * 16) | 0, v = c === 'x' ? r : (r & 0x3) | 0x8;\r\n        return v.toString(16);\r\n    });\r\n};\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * The amount of milliseconds to exponentially increase.\r\n */\r\nconst DEFAULT_INTERVAL_MILLIS = 1000;\r\n/**\r\n * The factor to backoff by.\r\n * Should be a number greater than 1.\r\n */\r\nconst DEFAULT_BACKOFF_FACTOR = 2;\r\n/**\r\n * The maximum milliseconds to increase to.\r\n *\r\n * <p>Visible for testing\r\n */\r\nconst MAX_VALUE_MILLIS = 4 * 60 * 60 * 1000; // Four hours, like iOS and Android.\r\n/**\r\n * The percentage of backoff time to randomize by.\r\n * See\r\n * http://go/safe-client-behavior#step-1-determine-the-appropriate-retry-interval-to-handle-spike-traffic\r\n * for context.\r\n *\r\n * <p>Visible for testing\r\n */\r\nconst RANDOM_FACTOR = 0.5;\r\n/**\r\n * Based on the backoff method from\r\n * https://github.com/google/closure-library/blob/master/closure/goog/math/exponentialbackoff.js.\r\n * Extracted here so we don't need to pass metadata and a stateful ExponentialBackoff object around.\r\n */\r\nfunction calculateBackoffMillis(backoffCount, intervalMillis = DEFAULT_INTERVAL_MILLIS, backoffFactor = DEFAULT_BACKOFF_FACTOR) {\r\n    // Calculates an exponentially increasing value.\r\n    // Deviation: calculates value from count and a constant interval, so we only need to save value\r\n    // and count to restore state.\r\n    const currBaseValue = intervalMillis * Math.pow(backoffFactor, backoffCount);\r\n    // A random \"fuzz\" to avoid waves of retries.\r\n    // Deviation: randomFactor is required.\r\n    const randomWait = Math.round(\r\n    // A fraction of the backoff value to add/subtract.\r\n    // Deviation: changes multiplication order to improve readability.\r\n    RANDOM_FACTOR *\r\n        currBaseValue *\r\n        // A random float (rounded to int by Math.round above) in the range [-1, 1]. Determines\r\n        // if we add or subtract.\r\n        (Math.random() - 0.5) *\r\n        2);\r\n    // Limits backoff to max to avoid effectively permanent backoff.\r\n    return Math.min(MAX_VALUE_MILLIS, currBaseValue + randomWait);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Provide English ordinal letters after a number\r\n */\r\nfunction ordinal(i) {\r\n    if (!Number.isFinite(i)) {\r\n        return `${i}`;\r\n    }\r\n    return i + indicator(i);\r\n}\r\nfunction indicator(i) {\r\n    i = Math.abs(i);\r\n    const cent = i % 100;\r\n    if (cent >= 10 && cent <= 20) {\r\n        return 'th';\r\n    }\r\n    const dec = i % 10;\r\n    if (dec === 1) {\r\n        return 'st';\r\n    }\r\n    if (dec === 2) {\r\n        return 'nd';\r\n    }\r\n    if (dec === 3) {\r\n        return 'rd';\r\n    }\r\n    return 'th';\r\n}\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction getModularInstance(service) {\r\n    if (service && service._delegate) {\r\n        return service._delegate;\r\n    }\r\n    else {\r\n        return service;\r\n    }\r\n}\n\nexport { CONSTANTS, Deferred, ErrorFactory, FirebaseError, MAX_VALUE_MILLIS, RANDOM_FACTOR, Sha1, areCookiesEnabled, assert, assertionError, async, base64, base64Decode, base64Encode, base64urlEncodeWithoutPadding, calculateBackoffMillis, contains, createMockUserToken, createSubscribe, decode, deepCopy, deepEqual, deepExtend, errorPrefix, extractQuerystring, getDefaultAppConfig, getDefaultEmulatorHost, getDefaultEmulatorHostnameAndPort, getExperimentalSetting, getGlobal, getModularInstance, getUA, isAdmin, isBrowser, isBrowserExtension, isElectron, isEmpty, isIE, isIndexedDBAvailable, isMobileCordova, isNode, isNodeSdk, isReactNative, isSafari, isUWP, isValidFormat, isValidTimestamp, issuedAtTime, jsonEval, map, ordinal, promiseWithTimeout, querystring, querystringDecode, safeGet, stringLength, stringToByteArray, stringify, uuidv4, validateArgCount, validateCallback, validateContextObject, validateIndexedDBOpenable, validateNamespace };\n//# sourceMappingURL=index.esm2017.js.map\n","import { Deferred } from '@firebase/util';\n\n/**\r\n * Component for service name T, e.g. `auth`, `auth-internal`\r\n */\r\nclass Component {\r\n    /**\r\n     *\r\n     * @param name The public service name, e.g. app, auth, firestore, database\r\n     * @param instanceFactory Service factory responsible for creating the public interface\r\n     * @param type whether the service provided by the component is public or private\r\n     */\r\n    constructor(name, instanceFactory, type) {\r\n        this.name = name;\r\n        this.instanceFactory = instanceFactory;\r\n        this.type = type;\r\n        this.multipleInstances = false;\r\n        /**\r\n         * Properties to be added to the service namespace\r\n         */\r\n        this.serviceProps = {};\r\n        this.instantiationMode = \"LAZY\" /* LAZY */;\r\n        this.onInstanceCreated = null;\r\n    }\r\n    setInstantiationMode(mode) {\r\n        this.instantiationMode = mode;\r\n        return this;\r\n    }\r\n    setMultipleInstances(multipleInstances) {\r\n        this.multipleInstances = multipleInstances;\r\n        return this;\r\n    }\r\n    setServiceProps(props) {\r\n        this.serviceProps = props;\r\n        return this;\r\n    }\r\n    setInstanceCreatedCallback(callback) {\r\n        this.onInstanceCreated = callback;\r\n        return this;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst DEFAULT_ENTRY_NAME = '[DEFAULT]';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Provider for instance for service name T, e.g. 'auth', 'auth-internal'\r\n * NameServiceMapping[T] is an alias for the type of the instance\r\n */\r\nclass Provider {\r\n    constructor(name, container) {\r\n        this.name = name;\r\n        this.container = container;\r\n        this.component = null;\r\n        this.instances = new Map();\r\n        this.instancesDeferred = new Map();\r\n        this.instancesOptions = new Map();\r\n        this.onInitCallbacks = new Map();\r\n    }\r\n    /**\r\n     * @param identifier A provider can provide mulitple instances of a service\r\n     * if this.component.multipleInstances is true.\r\n     */\r\n    get(identifier) {\r\n        // if multipleInstances is not supported, use the default name\r\n        const normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);\r\n        if (!this.instancesDeferred.has(normalizedIdentifier)) {\r\n            const deferred = new Deferred();\r\n            this.instancesDeferred.set(normalizedIdentifier, deferred);\r\n            if (this.isInitialized(normalizedIdentifier) ||\r\n                this.shouldAutoInitialize()) {\r\n                // initialize the service if it can be auto-initialized\r\n                try {\r\n                    const instance = this.getOrInitializeService({\r\n                        instanceIdentifier: normalizedIdentifier\r\n                    });\r\n                    if (instance) {\r\n                        deferred.resolve(instance);\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    // when the instance factory throws an exception during get(), it should not cause\r\n                    // a fatal error. We just return the unresolved promise in this case.\r\n                }\r\n            }\r\n        }\r\n        return this.instancesDeferred.get(normalizedIdentifier).promise;\r\n    }\r\n    getImmediate(options) {\r\n        var _a;\r\n        // if multipleInstances is not supported, use the default name\r\n        const normalizedIdentifier = this.normalizeInstanceIdentifier(options === null || options === void 0 ? void 0 : options.identifier);\r\n        const optional = (_a = options === null || options === void 0 ? void 0 : options.optional) !== null && _a !== void 0 ? _a : false;\r\n        if (this.isInitialized(normalizedIdentifier) ||\r\n            this.shouldAutoInitialize()) {\r\n            try {\r\n                return this.getOrInitializeService({\r\n                    instanceIdentifier: normalizedIdentifier\r\n                });\r\n            }\r\n            catch (e) {\r\n                if (optional) {\r\n                    return null;\r\n                }\r\n                else {\r\n                    throw e;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            // In case a component is not initialized and should/can not be auto-initialized at the moment, return null if the optional flag is set, or throw\r\n            if (optional) {\r\n                return null;\r\n            }\r\n            else {\r\n                throw Error(`Service ${this.name} is not available`);\r\n            }\r\n        }\r\n    }\r\n    getComponent() {\r\n        return this.component;\r\n    }\r\n    setComponent(component) {\r\n        if (component.name !== this.name) {\r\n            throw Error(`Mismatching Component ${component.name} for Provider ${this.name}.`);\r\n        }\r\n        if (this.component) {\r\n            throw Error(`Component for ${this.name} has already been provided`);\r\n        }\r\n        this.component = component;\r\n        // return early without attempting to initialize the component if the component requires explicit initialization (calling `Provider.initialize()`)\r\n        if (!this.shouldAutoInitialize()) {\r\n            return;\r\n        }\r\n        // if the service is eager, initialize the default instance\r\n        if (isComponentEager(component)) {\r\n            try {\r\n                this.getOrInitializeService({ instanceIdentifier: DEFAULT_ENTRY_NAME });\r\n            }\r\n            catch (e) {\r\n                // when the instance factory for an eager Component throws an exception during the eager\r\n                // initialization, it should not cause a fatal error.\r\n                // TODO: Investigate if we need to make it configurable, because some component may want to cause\r\n                // a fatal error in this case?\r\n            }\r\n        }\r\n        // Create service instances for the pending promises and resolve them\r\n        // NOTE: if this.multipleInstances is false, only the default instance will be created\r\n        // and all promises with resolve with it regardless of the identifier.\r\n        for (const [instanceIdentifier, instanceDeferred] of this.instancesDeferred.entries()) {\r\n            const normalizedIdentifier = this.normalizeInstanceIdentifier(instanceIdentifier);\r\n            try {\r\n                // `getOrInitializeService()` should always return a valid instance since a component is guaranteed. use ! to make typescript happy.\r\n                const instance = this.getOrInitializeService({\r\n                    instanceIdentifier: normalizedIdentifier\r\n                });\r\n                instanceDeferred.resolve(instance);\r\n            }\r\n            catch (e) {\r\n                // when the instance factory throws an exception, it should not cause\r\n                // a fatal error. We just leave the promise unresolved.\r\n            }\r\n        }\r\n    }\r\n    clearInstance(identifier = DEFAULT_ENTRY_NAME) {\r\n        this.instancesDeferred.delete(identifier);\r\n        this.instancesOptions.delete(identifier);\r\n        this.instances.delete(identifier);\r\n    }\r\n    // app.delete() will call this method on every provider to delete the services\r\n    // TODO: should we mark the provider as deleted?\r\n    async delete() {\r\n        const services = Array.from(this.instances.values());\r\n        await Promise.all([\r\n            ...services\r\n                .filter(service => 'INTERNAL' in service) // legacy services\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                .map(service => service.INTERNAL.delete()),\r\n            ...services\r\n                .filter(service => '_delete' in service) // modularized services\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                .map(service => service._delete())\r\n        ]);\r\n    }\r\n    isComponentSet() {\r\n        return this.component != null;\r\n    }\r\n    isInitialized(identifier = DEFAULT_ENTRY_NAME) {\r\n        return this.instances.has(identifier);\r\n    }\r\n    getOptions(identifier = DEFAULT_ENTRY_NAME) {\r\n        return this.instancesOptions.get(identifier) || {};\r\n    }\r\n    initialize(opts = {}) {\r\n        const { options = {} } = opts;\r\n        const normalizedIdentifier = this.normalizeInstanceIdentifier(opts.instanceIdentifier);\r\n        if (this.isInitialized(normalizedIdentifier)) {\r\n            throw Error(`${this.name}(${normalizedIdentifier}) has already been initialized`);\r\n        }\r\n        if (!this.isComponentSet()) {\r\n            throw Error(`Component ${this.name} has not been registered yet`);\r\n        }\r\n        const instance = this.getOrInitializeService({\r\n            instanceIdentifier: normalizedIdentifier,\r\n            options\r\n        });\r\n        // resolve any pending promise waiting for the service instance\r\n        for (const [instanceIdentifier, instanceDeferred] of this.instancesDeferred.entries()) {\r\n            const normalizedDeferredIdentifier = this.normalizeInstanceIdentifier(instanceIdentifier);\r\n            if (normalizedIdentifier === normalizedDeferredIdentifier) {\r\n                instanceDeferred.resolve(instance);\r\n            }\r\n        }\r\n        return instance;\r\n    }\r\n    /**\r\n     *\r\n     * @param callback - a function that will be invoked  after the provider has been initialized by calling provider.initialize().\r\n     * The function is invoked SYNCHRONOUSLY, so it should not execute any longrunning tasks in order to not block the program.\r\n     *\r\n     * @param identifier An optional instance identifier\r\n     * @returns a function to unregister the callback\r\n     */\r\n    onInit(callback, identifier) {\r\n        var _a;\r\n        const normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);\r\n        const existingCallbacks = (_a = this.onInitCallbacks.get(normalizedIdentifier)) !== null && _a !== void 0 ? _a : new Set();\r\n        existingCallbacks.add(callback);\r\n        this.onInitCallbacks.set(normalizedIdentifier, existingCallbacks);\r\n        const existingInstance = this.instances.get(normalizedIdentifier);\r\n        if (existingInstance) {\r\n            callback(existingInstance, normalizedIdentifier);\r\n        }\r\n        return () => {\r\n            existingCallbacks.delete(callback);\r\n        };\r\n    }\r\n    /**\r\n     * Invoke onInit callbacks synchronously\r\n     * @param instance the service instance`\r\n     */\r\n    invokeOnInitCallbacks(instance, identifier) {\r\n        const callbacks = this.onInitCallbacks.get(identifier);\r\n        if (!callbacks) {\r\n            return;\r\n        }\r\n        for (const callback of callbacks) {\r\n            try {\r\n                callback(instance, identifier);\r\n            }\r\n            catch (_a) {\r\n                // ignore errors in the onInit callback\r\n            }\r\n        }\r\n    }\r\n    getOrInitializeService({ instanceIdentifier, options = {} }) {\r\n        let instance = this.instances.get(instanceIdentifier);\r\n        if (!instance && this.component) {\r\n            instance = this.component.instanceFactory(this.container, {\r\n                instanceIdentifier: normalizeIdentifierForFactory(instanceIdentifier),\r\n                options\r\n            });\r\n            this.instances.set(instanceIdentifier, instance);\r\n            this.instancesOptions.set(instanceIdentifier, options);\r\n            /**\r\n             * Invoke onInit listeners.\r\n             * Note this.component.onInstanceCreated is different, which is used by the component creator,\r\n             * while onInit listeners are registered by consumers of the provider.\r\n             */\r\n            this.invokeOnInitCallbacks(instance, instanceIdentifier);\r\n            /**\r\n             * Order is important\r\n             * onInstanceCreated() should be called after this.instances.set(instanceIdentifier, instance); which\r\n             * makes `isInitialized()` return true.\r\n             */\r\n            if (this.component.onInstanceCreated) {\r\n                try {\r\n                    this.component.onInstanceCreated(this.container, instanceIdentifier, instance);\r\n                }\r\n                catch (_a) {\r\n                    // ignore errors in the onInstanceCreatedCallback\r\n                }\r\n            }\r\n        }\r\n        return instance || null;\r\n    }\r\n    normalizeInstanceIdentifier(identifier = DEFAULT_ENTRY_NAME) {\r\n        if (this.component) {\r\n            return this.component.multipleInstances ? identifier : DEFAULT_ENTRY_NAME;\r\n        }\r\n        else {\r\n            return identifier; // assume multiple instances are supported before the component is provided.\r\n        }\r\n    }\r\n    shouldAutoInitialize() {\r\n        return (!!this.component &&\r\n            this.component.instantiationMode !== \"EXPLICIT\" /* EXPLICIT */);\r\n    }\r\n}\r\n// undefined should be passed to the service factory for the default instance\r\nfunction normalizeIdentifierForFactory(identifier) {\r\n    return identifier === DEFAULT_ENTRY_NAME ? undefined : identifier;\r\n}\r\nfunction isComponentEager(component) {\r\n    return component.instantiationMode === \"EAGER\" /* EAGER */;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * ComponentContainer that provides Providers for service name T, e.g. `auth`, `auth-internal`\r\n */\r\nclass ComponentContainer {\r\n    constructor(name) {\r\n        this.name = name;\r\n        this.providers = new Map();\r\n    }\r\n    /**\r\n     *\r\n     * @param component Component being added\r\n     * @param overwrite When a component with the same name has already been registered,\r\n     * if overwrite is true: overwrite the existing component with the new component and create a new\r\n     * provider with the new component. It can be useful in tests where you want to use different mocks\r\n     * for different tests.\r\n     * if overwrite is false: throw an exception\r\n     */\r\n    addComponent(component) {\r\n        const provider = this.getProvider(component.name);\r\n        if (provider.isComponentSet()) {\r\n            throw new Error(`Component ${component.name} has already been registered with ${this.name}`);\r\n        }\r\n        provider.setComponent(component);\r\n    }\r\n    addOrOverwriteComponent(component) {\r\n        const provider = this.getProvider(component.name);\r\n        if (provider.isComponentSet()) {\r\n            // delete the existing provider from the container, so we can register the new component\r\n            this.providers.delete(component.name);\r\n        }\r\n        this.addComponent(component);\r\n    }\r\n    /**\r\n     * getProvider provides a type safe interface where it can only be called with a field name\r\n     * present in NameServiceMapping interface.\r\n     *\r\n     * Firebase SDKs providing services should extend NameServiceMapping interface to register\r\n     * themselves.\r\n     */\r\n    getProvider(name) {\r\n        if (this.providers.has(name)) {\r\n            return this.providers.get(name);\r\n        }\r\n        // create a Provider for a service that hasn't registered with Firebase\r\n        const provider = new Provider(name, this);\r\n        this.providers.set(name, provider);\r\n        return provider;\r\n    }\r\n    getProviders() {\r\n        return Array.from(this.providers.values());\r\n    }\r\n}\n\nexport { Component, ComponentContainer, Provider };\n//# sourceMappingURL=index.esm2017.js.map\n","/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * A container for all of the Logger instances\r\n */\r\nconst instances = [];\r\n/**\r\n * The JS SDK supports 5 log levels and also allows a user the ability to\r\n * silence the logs altogether.\r\n *\r\n * The order is a follows:\r\n * DEBUG < VERBOSE < INFO < WARN < ERROR\r\n *\r\n * All of the log types above the current log level will be captured (i.e. if\r\n * you set the log level to `INFO`, errors will still be logged, but `DEBUG` and\r\n * `VERBOSE` logs will not)\r\n */\r\nvar LogLevel;\r\n(function (LogLevel) {\r\n    LogLevel[LogLevel[\"DEBUG\"] = 0] = \"DEBUG\";\r\n    LogLevel[LogLevel[\"VERBOSE\"] = 1] = \"VERBOSE\";\r\n    LogLevel[LogLevel[\"INFO\"] = 2] = \"INFO\";\r\n    LogLevel[LogLevel[\"WARN\"] = 3] = \"WARN\";\r\n    LogLevel[LogLevel[\"ERROR\"] = 4] = \"ERROR\";\r\n    LogLevel[LogLevel[\"SILENT\"] = 5] = \"SILENT\";\r\n})(LogLevel || (LogLevel = {}));\r\nconst levelStringToEnum = {\r\n    'debug': LogLevel.DEBUG,\r\n    'verbose': LogLevel.VERBOSE,\r\n    'info': LogLevel.INFO,\r\n    'warn': LogLevel.WARN,\r\n    'error': LogLevel.ERROR,\r\n    'silent': LogLevel.SILENT\r\n};\r\n/**\r\n * The default log level\r\n */\r\nconst defaultLogLevel = LogLevel.INFO;\r\n/**\r\n * By default, `console.debug` is not displayed in the developer console (in\r\n * chrome). To avoid forcing users to have to opt-in to these logs twice\r\n * (i.e. once for firebase, and once in the console), we are sending `DEBUG`\r\n * logs to the `console.log` function.\r\n */\r\nconst ConsoleMethod = {\r\n    [LogLevel.DEBUG]: 'log',\r\n    [LogLevel.VERBOSE]: 'log',\r\n    [LogLevel.INFO]: 'info',\r\n    [LogLevel.WARN]: 'warn',\r\n    [LogLevel.ERROR]: 'error'\r\n};\r\n/**\r\n * The default log handler will forward DEBUG, VERBOSE, INFO, WARN, and ERROR\r\n * messages on to their corresponding console counterparts (if the log method\r\n * is supported by the current log level)\r\n */\r\nconst defaultLogHandler = (instance, logType, ...args) => {\r\n    if (logType < instance.logLevel) {\r\n        return;\r\n    }\r\n    const now = new Date().toISOString();\r\n    const method = ConsoleMethod[logType];\r\n    if (method) {\r\n        console[method](`[${now}]  ${instance.name}:`, ...args);\r\n    }\r\n    else {\r\n        throw new Error(`Attempted to log a message with an invalid logType (value: ${logType})`);\r\n    }\r\n};\r\nclass Logger {\r\n    /**\r\n     * Gives you an instance of a Logger to capture messages according to\r\n     * Firebase's logging scheme.\r\n     *\r\n     * @param name The name that the logs will be associated with\r\n     */\r\n    constructor(name) {\r\n        this.name = name;\r\n        /**\r\n         * The log level of the given Logger instance.\r\n         */\r\n        this._logLevel = defaultLogLevel;\r\n        /**\r\n         * The main (internal) log handler for the Logger instance.\r\n         * Can be set to a new function in internal package code but not by user.\r\n         */\r\n        this._logHandler = defaultLogHandler;\r\n        /**\r\n         * The optional, additional, user-defined log handler for the Logger instance.\r\n         */\r\n        this._userLogHandler = null;\r\n        /**\r\n         * Capture the current instance for later use\r\n         */\r\n        instances.push(this);\r\n    }\r\n    get logLevel() {\r\n        return this._logLevel;\r\n    }\r\n    set logLevel(val) {\r\n        if (!(val in LogLevel)) {\r\n            throw new TypeError(`Invalid value \"${val}\" assigned to \\`logLevel\\``);\r\n        }\r\n        this._logLevel = val;\r\n    }\r\n    // Workaround for setter/getter having to be the same type.\r\n    setLogLevel(val) {\r\n        this._logLevel = typeof val === 'string' ? levelStringToEnum[val] : val;\r\n    }\r\n    get logHandler() {\r\n        return this._logHandler;\r\n    }\r\n    set logHandler(val) {\r\n        if (typeof val !== 'function') {\r\n            throw new TypeError('Value assigned to `logHandler` must be a function');\r\n        }\r\n        this._logHandler = val;\r\n    }\r\n    get userLogHandler() {\r\n        return this._userLogHandler;\r\n    }\r\n    set userLogHandler(val) {\r\n        this._userLogHandler = val;\r\n    }\r\n    /**\r\n     * The functions below are all based on the `console` interface\r\n     */\r\n    debug(...args) {\r\n        this._userLogHandler && this._userLogHandler(this, LogLevel.DEBUG, ...args);\r\n        this._logHandler(this, LogLevel.DEBUG, ...args);\r\n    }\r\n    log(...args) {\r\n        this._userLogHandler &&\r\n            this._userLogHandler(this, LogLevel.VERBOSE, ...args);\r\n        this._logHandler(this, LogLevel.VERBOSE, ...args);\r\n    }\r\n    info(...args) {\r\n        this._userLogHandler && this._userLogHandler(this, LogLevel.INFO, ...args);\r\n        this._logHandler(this, LogLevel.INFO, ...args);\r\n    }\r\n    warn(...args) {\r\n        this._userLogHandler && this._userLogHandler(this, LogLevel.WARN, ...args);\r\n        this._logHandler(this, LogLevel.WARN, ...args);\r\n    }\r\n    error(...args) {\r\n        this._userLogHandler && this._userLogHandler(this, LogLevel.ERROR, ...args);\r\n        this._logHandler(this, LogLevel.ERROR, ...args);\r\n    }\r\n}\r\nfunction setLogLevel(level) {\r\n    instances.forEach(inst => {\r\n        inst.setLogLevel(level);\r\n    });\r\n}\r\nfunction setUserLogHandler(logCallback, options) {\r\n    for (const instance of instances) {\r\n        let customLogLevel = null;\r\n        if (options && options.level) {\r\n            customLogLevel = levelStringToEnum[options.level];\r\n        }\r\n        if (logCallback === null) {\r\n            instance.userLogHandler = null;\r\n        }\r\n        else {\r\n            instance.userLogHandler = (instance, level, ...args) => {\r\n                const message = args\r\n                    .map(arg => {\r\n                    if (arg == null) {\r\n                        return null;\r\n                    }\r\n                    else if (typeof arg === 'string') {\r\n                        return arg;\r\n                    }\r\n                    else if (typeof arg === 'number' || typeof arg === 'boolean') {\r\n                        return arg.toString();\r\n                    }\r\n                    else if (arg instanceof Error) {\r\n                        return arg.message;\r\n                    }\r\n                    else {\r\n                        try {\r\n                            return JSON.stringify(arg);\r\n                        }\r\n                        catch (ignored) {\r\n                            return null;\r\n                        }\r\n                    }\r\n                })\r\n                    .filter(arg => arg)\r\n                    .join(' ');\r\n                if (level >= (customLogLevel !== null && customLogLevel !== void 0 ? customLogLevel : instance.logLevel)) {\r\n                    logCallback({\r\n                        level: LogLevel[level].toLowerCase(),\r\n                        message,\r\n                        args,\r\n                        type: instance.name\r\n                    });\r\n                }\r\n            };\r\n        }\r\n    }\r\n}\n\nexport { LogLevel, Logger, setLogLevel, setUserLogHandler };\n//# sourceMappingURL=index.esm2017.js.map\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n","import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction));\n        });\n    }\n    if (blocked)\n        request.addEventListener('blocked', () => blocked());\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking)\n            db.addEventListener('versionchange', () => blocking());\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked)\n        request.addEventListener('blocked', () => blocked());\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n","import { Component, ComponentContainer } from '@firebase/component';\nimport { Logger, setUserLogHandler, setLogLevel as setLogLevel$1 } from '@firebase/logger';\nimport { ErrorFactory, getDefaultAppConfig, deepEqual, FirebaseError, base64urlEncodeWithoutPadding, isIndexedDBAvailable, validateIndexedDBOpenable } from '@firebase/util';\nexport { FirebaseError } from '@firebase/util';\nimport { openDB } from 'idb';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nclass PlatformLoggerServiceImpl {\r\n    constructor(container) {\r\n        this.container = container;\r\n    }\r\n    // In initial implementation, this will be called by installations on\r\n    // auth token refresh, and installations will send this string.\r\n    getPlatformInfoString() {\r\n        const providers = this.container.getProviders();\r\n        // Loop through providers and get library/version pairs from any that are\r\n        // version components.\r\n        return providers\r\n            .map(provider => {\r\n            if (isVersionServiceProvider(provider)) {\r\n                const service = provider.getImmediate();\r\n                return `${service.library}/${service.version}`;\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        })\r\n            .filter(logString => logString)\r\n            .join(' ');\r\n    }\r\n}\r\n/**\r\n *\r\n * @param provider check if this provider provides a VersionService\r\n *\r\n * NOTE: Using Provider<'app-version'> is a hack to indicate that the provider\r\n * provides VersionService. The provider is not necessarily a 'app-version'\r\n * provider.\r\n */\r\nfunction isVersionServiceProvider(provider) {\r\n    const component = provider.getComponent();\r\n    return (component === null || component === void 0 ? void 0 : component.type) === \"VERSION\" /* VERSION */;\r\n}\n\nconst name$o = \"@firebase/app\";\nconst version$1 = \"0.8.4\";\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst logger = new Logger('@firebase/app');\n\nconst name$n = \"@firebase/app-compat\";\n\nconst name$m = \"@firebase/analytics-compat\";\n\nconst name$l = \"@firebase/analytics\";\n\nconst name$k = \"@firebase/app-check-compat\";\n\nconst name$j = \"@firebase/app-check\";\n\nconst name$i = \"@firebase/auth\";\n\nconst name$h = \"@firebase/auth-compat\";\n\nconst name$g = \"@firebase/database\";\n\nconst name$f = \"@firebase/database-compat\";\n\nconst name$e = \"@firebase/functions\";\n\nconst name$d = \"@firebase/functions-compat\";\n\nconst name$c = \"@firebase/installations\";\n\nconst name$b = \"@firebase/installations-compat\";\n\nconst name$a = \"@firebase/messaging\";\n\nconst name$9 = \"@firebase/messaging-compat\";\n\nconst name$8 = \"@firebase/performance\";\n\nconst name$7 = \"@firebase/performance-compat\";\n\nconst name$6 = \"@firebase/remote-config\";\n\nconst name$5 = \"@firebase/remote-config-compat\";\n\nconst name$4 = \"@firebase/storage\";\n\nconst name$3 = \"@firebase/storage-compat\";\n\nconst name$2 = \"@firebase/firestore\";\n\nconst name$1 = \"@firebase/firestore-compat\";\n\nconst name = \"firebase\";\nconst version = \"9.14.0\";\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * The default app name\r\n *\r\n * @internal\r\n */\r\nconst DEFAULT_ENTRY_NAME = '[DEFAULT]';\r\nconst PLATFORM_LOG_STRING = {\r\n    [name$o]: 'fire-core',\r\n    [name$n]: 'fire-core-compat',\r\n    [name$l]: 'fire-analytics',\r\n    [name$m]: 'fire-analytics-compat',\r\n    [name$j]: 'fire-app-check',\r\n    [name$k]: 'fire-app-check-compat',\r\n    [name$i]: 'fire-auth',\r\n    [name$h]: 'fire-auth-compat',\r\n    [name$g]: 'fire-rtdb',\r\n    [name$f]: 'fire-rtdb-compat',\r\n    [name$e]: 'fire-fn',\r\n    [name$d]: 'fire-fn-compat',\r\n    [name$c]: 'fire-iid',\r\n    [name$b]: 'fire-iid-compat',\r\n    [name$a]: 'fire-fcm',\r\n    [name$9]: 'fire-fcm-compat',\r\n    [name$8]: 'fire-perf',\r\n    [name$7]: 'fire-perf-compat',\r\n    [name$6]: 'fire-rc',\r\n    [name$5]: 'fire-rc-compat',\r\n    [name$4]: 'fire-gcs',\r\n    [name$3]: 'fire-gcs-compat',\r\n    [name$2]: 'fire-fst',\r\n    [name$1]: 'fire-fst-compat',\r\n    'fire-js': 'fire-js',\r\n    [name]: 'fire-js-all'\r\n};\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @internal\r\n */\r\nconst _apps = new Map();\r\n/**\r\n * Registered components.\r\n *\r\n * @internal\r\n */\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nconst _components = new Map();\r\n/**\r\n * @param component - the component being added to this app's container\r\n *\r\n * @internal\r\n */\r\nfunction _addComponent(app, component) {\r\n    try {\r\n        app.container.addComponent(component);\r\n    }\r\n    catch (e) {\r\n        logger.debug(`Component ${component.name} failed to register with FirebaseApp ${app.name}`, e);\r\n    }\r\n}\r\n/**\r\n *\r\n * @internal\r\n */\r\nfunction _addOrOverwriteComponent(app, component) {\r\n    app.container.addOrOverwriteComponent(component);\r\n}\r\n/**\r\n *\r\n * @param component - the component to register\r\n * @returns whether or not the component is registered successfully\r\n *\r\n * @internal\r\n */\r\nfunction _registerComponent(component) {\r\n    const componentName = component.name;\r\n    if (_components.has(componentName)) {\r\n        logger.debug(`There were multiple attempts to register component ${componentName}.`);\r\n        return false;\r\n    }\r\n    _components.set(componentName, component);\r\n    // add the component to existing app instances\r\n    for (const app of _apps.values()) {\r\n        _addComponent(app, component);\r\n    }\r\n    return true;\r\n}\r\n/**\r\n *\r\n * @param app - FirebaseApp instance\r\n * @param name - service name\r\n *\r\n * @returns the provider for the service with the matching name\r\n *\r\n * @internal\r\n */\r\nfunction _getProvider(app, name) {\r\n    const heartbeatController = app.container\r\n        .getProvider('heartbeat')\r\n        .getImmediate({ optional: true });\r\n    if (heartbeatController) {\r\n        void heartbeatController.triggerHeartbeat();\r\n    }\r\n    return app.container.getProvider(name);\r\n}\r\n/**\r\n *\r\n * @param app - FirebaseApp instance\r\n * @param name - service name\r\n * @param instanceIdentifier - service instance identifier in case the service supports multiple instances\r\n *\r\n * @internal\r\n */\r\nfunction _removeServiceInstance(app, name, instanceIdentifier = DEFAULT_ENTRY_NAME) {\r\n    _getProvider(app, name).clearInstance(instanceIdentifier);\r\n}\r\n/**\r\n * Test only\r\n *\r\n * @internal\r\n */\r\nfunction _clearComponents() {\r\n    _components.clear();\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst ERRORS = {\r\n    [\"no-app\" /* NO_APP */]: \"No Firebase App '{$appName}' has been created - \" +\r\n        'call Firebase App.initializeApp()',\r\n    [\"bad-app-name\" /* BAD_APP_NAME */]: \"Illegal App name: '{$appName}\",\r\n    [\"duplicate-app\" /* DUPLICATE_APP */]: \"Firebase App named '{$appName}' already exists with different options or config\",\r\n    [\"app-deleted\" /* APP_DELETED */]: \"Firebase App named '{$appName}' already deleted\",\r\n    [\"no-options\" /* NO_OPTIONS */]: 'Need to provide options, when not being deployed to hosting via source.',\r\n    [\"invalid-app-argument\" /* INVALID_APP_ARGUMENT */]: 'firebase.{$appName}() takes either no argument or a ' +\r\n        'Firebase App instance.',\r\n    [\"invalid-log-argument\" /* INVALID_LOG_ARGUMENT */]: 'First argument to `onLog` must be null or a function.',\r\n    [\"idb-open\" /* IDB_OPEN */]: 'Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.',\r\n    [\"idb-get\" /* IDB_GET */]: 'Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.',\r\n    [\"idb-set\" /* IDB_WRITE */]: 'Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.',\r\n    [\"idb-delete\" /* IDB_DELETE */]: 'Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.'\r\n};\r\nconst ERROR_FACTORY = new ErrorFactory('app', 'Firebase', ERRORS);\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nclass FirebaseAppImpl {\r\n    constructor(options, config, container) {\r\n        this._isDeleted = false;\r\n        this._options = Object.assign({}, options);\r\n        this._config = Object.assign({}, config);\r\n        this._name = config.name;\r\n        this._automaticDataCollectionEnabled =\r\n            config.automaticDataCollectionEnabled;\r\n        this._container = container;\r\n        this.container.addComponent(new Component('app', () => this, \"PUBLIC\" /* PUBLIC */));\r\n    }\r\n    get automaticDataCollectionEnabled() {\r\n        this.checkDestroyed();\r\n        return this._automaticDataCollectionEnabled;\r\n    }\r\n    set automaticDataCollectionEnabled(val) {\r\n        this.checkDestroyed();\r\n        this._automaticDataCollectionEnabled = val;\r\n    }\r\n    get name() {\r\n        this.checkDestroyed();\r\n        return this._name;\r\n    }\r\n    get options() {\r\n        this.checkDestroyed();\r\n        return this._options;\r\n    }\r\n    get config() {\r\n        this.checkDestroyed();\r\n        return this._config;\r\n    }\r\n    get container() {\r\n        return this._container;\r\n    }\r\n    get isDeleted() {\r\n        return this._isDeleted;\r\n    }\r\n    set isDeleted(val) {\r\n        this._isDeleted = val;\r\n    }\r\n    /**\r\n     * This function will throw an Error if the App has already been deleted -\r\n     * use before performing API actions on the App.\r\n     */\r\n    checkDestroyed() {\r\n        if (this.isDeleted) {\r\n            throw ERROR_FACTORY.create(\"app-deleted\" /* APP_DELETED */, { appName: this._name });\r\n        }\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * The current SDK version.\r\n *\r\n * @public\r\n */\r\nconst SDK_VERSION = version;\r\nfunction initializeApp(_options, rawConfig = {}) {\r\n    let options = _options;\r\n    if (typeof rawConfig !== 'object') {\r\n        const name = rawConfig;\r\n        rawConfig = { name };\r\n    }\r\n    const config = Object.assign({ name: DEFAULT_ENTRY_NAME, automaticDataCollectionEnabled: false }, rawConfig);\r\n    const name = config.name;\r\n    if (typeof name !== 'string' || !name) {\r\n        throw ERROR_FACTORY.create(\"bad-app-name\" /* BAD_APP_NAME */, {\r\n            appName: String(name)\r\n        });\r\n    }\r\n    options || (options = getDefaultAppConfig());\r\n    if (!options) {\r\n        throw ERROR_FACTORY.create(\"no-options\" /* NO_OPTIONS */);\r\n    }\r\n    const existingApp = _apps.get(name);\r\n    if (existingApp) {\r\n        // return the existing app if options and config deep equal the ones in the existing app.\r\n        if (deepEqual(options, existingApp.options) &&\r\n            deepEqual(config, existingApp.config)) {\r\n            return existingApp;\r\n        }\r\n        else {\r\n            throw ERROR_FACTORY.create(\"duplicate-app\" /* DUPLICATE_APP */, { appName: name });\r\n        }\r\n    }\r\n    const container = new ComponentContainer(name);\r\n    for (const component of _components.values()) {\r\n        container.addComponent(component);\r\n    }\r\n    const newApp = new FirebaseAppImpl(options, config, container);\r\n    _apps.set(name, newApp);\r\n    return newApp;\r\n}\r\n/**\r\n * Retrieves a {@link @firebase/app#FirebaseApp} instance.\r\n *\r\n * When called with no arguments, the default app is returned. When an app name\r\n * is provided, the app corresponding to that name is returned.\r\n *\r\n * An exception is thrown if the app being retrieved has not yet been\r\n * initialized.\r\n *\r\n * @example\r\n * ```javascript\r\n * // Return the default app\r\n * const app = getApp();\r\n * ```\r\n *\r\n * @example\r\n * ```javascript\r\n * // Return a named app\r\n * const otherApp = getApp(\"otherApp\");\r\n * ```\r\n *\r\n * @param name - Optional name of the app to return. If no name is\r\n *   provided, the default is `\"[DEFAULT]\"`.\r\n *\r\n * @returns The app corresponding to the provided app name.\r\n *   If no app name is provided, the default app is returned.\r\n *\r\n * @public\r\n */\r\nfunction getApp(name = DEFAULT_ENTRY_NAME) {\r\n    const app = _apps.get(name);\r\n    if (!app && name === DEFAULT_ENTRY_NAME) {\r\n        return initializeApp();\r\n    }\r\n    if (!app) {\r\n        throw ERROR_FACTORY.create(\"no-app\" /* NO_APP */, { appName: name });\r\n    }\r\n    return app;\r\n}\r\n/**\r\n * A (read-only) array of all initialized apps.\r\n * @public\r\n */\r\nfunction getApps() {\r\n    return Array.from(_apps.values());\r\n}\r\n/**\r\n * Renders this app unusable and frees the resources of all associated\r\n * services.\r\n *\r\n * @example\r\n * ```javascript\r\n * deleteApp(app)\r\n *   .then(function() {\r\n *     console.log(\"App deleted successfully\");\r\n *   })\r\n *   .catch(function(error) {\r\n *     console.log(\"Error deleting app:\", error);\r\n *   });\r\n * ```\r\n *\r\n * @public\r\n */\r\nasync function deleteApp(app) {\r\n    const name = app.name;\r\n    if (_apps.has(name)) {\r\n        _apps.delete(name);\r\n        await Promise.all(app.container\r\n            .getProviders()\r\n            .map(provider => provider.delete()));\r\n        app.isDeleted = true;\r\n    }\r\n}\r\n/**\r\n * Registers a library's name and version for platform logging purposes.\r\n * @param library - Name of 1p or 3p library (e.g. firestore, angularfire)\r\n * @param version - Current version of that library.\r\n * @param variant - Bundle variant, e.g., node, rn, etc.\r\n *\r\n * @public\r\n */\r\nfunction registerVersion(libraryKeyOrName, version, variant) {\r\n    var _a;\r\n    // TODO: We can use this check to whitelist strings when/if we set up\r\n    // a good whitelist system.\r\n    let library = (_a = PLATFORM_LOG_STRING[libraryKeyOrName]) !== null && _a !== void 0 ? _a : libraryKeyOrName;\r\n    if (variant) {\r\n        library += `-${variant}`;\r\n    }\r\n    const libraryMismatch = library.match(/\\s|\\//);\r\n    const versionMismatch = version.match(/\\s|\\//);\r\n    if (libraryMismatch || versionMismatch) {\r\n        const warning = [\r\n            `Unable to register library \"${library}\" with version \"${version}\":`\r\n        ];\r\n        if (libraryMismatch) {\r\n            warning.push(`library name \"${library}\" contains illegal characters (whitespace or \"/\")`);\r\n        }\r\n        if (libraryMismatch && versionMismatch) {\r\n            warning.push('and');\r\n        }\r\n        if (versionMismatch) {\r\n            warning.push(`version name \"${version}\" contains illegal characters (whitespace or \"/\")`);\r\n        }\r\n        logger.warn(warning.join(' '));\r\n        return;\r\n    }\r\n    _registerComponent(new Component(`${library}-version`, () => ({ library, version }), \"VERSION\" /* VERSION */));\r\n}\r\n/**\r\n * Sets log handler for all Firebase SDKs.\r\n * @param logCallback - An optional custom log handler that executes user code whenever\r\n * the Firebase SDK makes a logging call.\r\n *\r\n * @public\r\n */\r\nfunction onLog(logCallback, options) {\r\n    if (logCallback !== null && typeof logCallback !== 'function') {\r\n        throw ERROR_FACTORY.create(\"invalid-log-argument\" /* INVALID_LOG_ARGUMENT */);\r\n    }\r\n    setUserLogHandler(logCallback, options);\r\n}\r\n/**\r\n * Sets log level for all Firebase SDKs.\r\n *\r\n * All of the log types above the current log level are captured (i.e. if\r\n * you set the log level to `info`, errors are logged, but `debug` and\r\n * `verbose` logs are not).\r\n *\r\n * @public\r\n */\r\nfunction setLogLevel(logLevel) {\r\n    setLogLevel$1(logLevel);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst DB_NAME = 'firebase-heartbeat-database';\r\nconst DB_VERSION = 1;\r\nconst STORE_NAME = 'firebase-heartbeat-store';\r\nlet dbPromise = null;\r\nfunction getDbPromise() {\r\n    if (!dbPromise) {\r\n        dbPromise = openDB(DB_NAME, DB_VERSION, {\r\n            upgrade: (db, oldVersion) => {\r\n                // We don't use 'break' in this switch statement, the fall-through\r\n                // behavior is what we want, because if there are multiple versions between\r\n                // the old version and the current version, we want ALL the migrations\r\n                // that correspond to those versions to run, not only the last one.\r\n                // eslint-disable-next-line default-case\r\n                switch (oldVersion) {\r\n                    case 0:\r\n                        db.createObjectStore(STORE_NAME);\r\n                }\r\n            }\r\n        }).catch(e => {\r\n            throw ERROR_FACTORY.create(\"idb-open\" /* IDB_OPEN */, {\r\n                originalErrorMessage: e.message\r\n            });\r\n        });\r\n    }\r\n    return dbPromise;\r\n}\r\nasync function readHeartbeatsFromIndexedDB(app) {\r\n    var _a;\r\n    try {\r\n        const db = await getDbPromise();\r\n        return db\r\n            .transaction(STORE_NAME)\r\n            .objectStore(STORE_NAME)\r\n            .get(computeKey(app));\r\n    }\r\n    catch (e) {\r\n        if (e instanceof FirebaseError) {\r\n            logger.warn(e.message);\r\n        }\r\n        else {\r\n            const idbGetError = ERROR_FACTORY.create(\"idb-get\" /* IDB_GET */, {\r\n                originalErrorMessage: (_a = e) === null || _a === void 0 ? void 0 : _a.message\r\n            });\r\n            logger.warn(idbGetError.message);\r\n        }\r\n    }\r\n}\r\nasync function writeHeartbeatsToIndexedDB(app, heartbeatObject) {\r\n    var _a;\r\n    try {\r\n        const db = await getDbPromise();\r\n        const tx = db.transaction(STORE_NAME, 'readwrite');\r\n        const objectStore = tx.objectStore(STORE_NAME);\r\n        await objectStore.put(heartbeatObject, computeKey(app));\r\n        return tx.done;\r\n    }\r\n    catch (e) {\r\n        if (e instanceof FirebaseError) {\r\n            logger.warn(e.message);\r\n        }\r\n        else {\r\n            const idbGetError = ERROR_FACTORY.create(\"idb-set\" /* IDB_WRITE */, {\r\n                originalErrorMessage: (_a = e) === null || _a === void 0 ? void 0 : _a.message\r\n            });\r\n            logger.warn(idbGetError.message);\r\n        }\r\n    }\r\n}\r\nfunction computeKey(app) {\r\n    return `${app.name}!${app.options.appId}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst MAX_HEADER_BYTES = 1024;\r\n// 30 days\r\nconst STORED_HEARTBEAT_RETENTION_MAX_MILLIS = 30 * 24 * 60 * 60 * 1000;\r\nclass HeartbeatServiceImpl {\r\n    constructor(container) {\r\n        this.container = container;\r\n        /**\r\n         * In-memory cache for heartbeats, used by getHeartbeatsHeader() to generate\r\n         * the header string.\r\n         * Stores one record per date. This will be consolidated into the standard\r\n         * format of one record per user agent string before being sent as a header.\r\n         * Populated from indexedDB when the controller is instantiated and should\r\n         * be kept in sync with indexedDB.\r\n         * Leave public for easier testing.\r\n         */\r\n        this._heartbeatsCache = null;\r\n        const app = this.container.getProvider('app').getImmediate();\r\n        this._storage = new HeartbeatStorageImpl(app);\r\n        this._heartbeatsCachePromise = this._storage.read().then(result => {\r\n            this._heartbeatsCache = result;\r\n            return result;\r\n        });\r\n    }\r\n    /**\r\n     * Called to report a heartbeat. The function will generate\r\n     * a HeartbeatsByUserAgent object, update heartbeatsCache, and persist it\r\n     * to IndexedDB.\r\n     * Note that we only store one heartbeat per day. So if a heartbeat for today is\r\n     * already logged, subsequent calls to this function in the same day will be ignored.\r\n     */\r\n    async triggerHeartbeat() {\r\n        const platformLogger = this.container\r\n            .getProvider('platform-logger')\r\n            .getImmediate();\r\n        // This is the \"Firebase user agent\" string from the platform logger\r\n        // service, not the browser user agent.\r\n        const agent = platformLogger.getPlatformInfoString();\r\n        const date = getUTCDateString();\r\n        if (this._heartbeatsCache === null) {\r\n            this._heartbeatsCache = await this._heartbeatsCachePromise;\r\n        }\r\n        // Do not store a heartbeat if one is already stored for this day\r\n        // or if a header has already been sent today.\r\n        if (this._heartbeatsCache.lastSentHeartbeatDate === date ||\r\n            this._heartbeatsCache.heartbeats.some(singleDateHeartbeat => singleDateHeartbeat.date === date)) {\r\n            return;\r\n        }\r\n        else {\r\n            // There is no entry for this date. Create one.\r\n            this._heartbeatsCache.heartbeats.push({ date, agent });\r\n        }\r\n        // Remove entries older than 30 days.\r\n        this._heartbeatsCache.heartbeats = this._heartbeatsCache.heartbeats.filter(singleDateHeartbeat => {\r\n            const hbTimestamp = new Date(singleDateHeartbeat.date).valueOf();\r\n            const now = Date.now();\r\n            return now - hbTimestamp <= STORED_HEARTBEAT_RETENTION_MAX_MILLIS;\r\n        });\r\n        return this._storage.overwrite(this._heartbeatsCache);\r\n    }\r\n    /**\r\n     * Returns a base64 encoded string which can be attached to the heartbeat-specific header directly.\r\n     * It also clears all heartbeats from memory as well as in IndexedDB.\r\n     *\r\n     * NOTE: Consuming product SDKs should not send the header if this method\r\n     * returns an empty string.\r\n     */\r\n    async getHeartbeatsHeader() {\r\n        if (this._heartbeatsCache === null) {\r\n            await this._heartbeatsCachePromise;\r\n        }\r\n        // If it's still null or the array is empty, there is no data to send.\r\n        if (this._heartbeatsCache === null ||\r\n            this._heartbeatsCache.heartbeats.length === 0) {\r\n            return '';\r\n        }\r\n        const date = getUTCDateString();\r\n        // Extract as many heartbeats from the cache as will fit under the size limit.\r\n        const { heartbeatsToSend, unsentEntries } = extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats);\r\n        const headerString = base64urlEncodeWithoutPadding(JSON.stringify({ version: 2, heartbeats: heartbeatsToSend }));\r\n        // Store last sent date to prevent another being logged/sent for the same day.\r\n        this._heartbeatsCache.lastSentHeartbeatDate = date;\r\n        if (unsentEntries.length > 0) {\r\n            // Store any unsent entries if they exist.\r\n            this._heartbeatsCache.heartbeats = unsentEntries;\r\n            // This seems more likely than emptying the array (below) to lead to some odd state\r\n            // since the cache isn't empty and this will be called again on the next request,\r\n            // and is probably safest if we await it.\r\n            await this._storage.overwrite(this._heartbeatsCache);\r\n        }\r\n        else {\r\n            this._heartbeatsCache.heartbeats = [];\r\n            // Do not wait for this, to reduce latency.\r\n            void this._storage.overwrite(this._heartbeatsCache);\r\n        }\r\n        return headerString;\r\n    }\r\n}\r\nfunction getUTCDateString() {\r\n    const today = new Date();\r\n    // Returns date format 'YYYY-MM-DD'\r\n    return today.toISOString().substring(0, 10);\r\n}\r\nfunction extractHeartbeatsForHeader(heartbeatsCache, maxSize = MAX_HEADER_BYTES) {\r\n    // Heartbeats grouped by user agent in the standard format to be sent in\r\n    // the header.\r\n    const heartbeatsToSend = [];\r\n    // Single date format heartbeats that are not sent.\r\n    let unsentEntries = heartbeatsCache.slice();\r\n    for (const singleDateHeartbeat of heartbeatsCache) {\r\n        // Look for an existing entry with the same user agent.\r\n        const heartbeatEntry = heartbeatsToSend.find(hb => hb.agent === singleDateHeartbeat.agent);\r\n        if (!heartbeatEntry) {\r\n            // If no entry for this user agent exists, create one.\r\n            heartbeatsToSend.push({\r\n                agent: singleDateHeartbeat.agent,\r\n                dates: [singleDateHeartbeat.date]\r\n            });\r\n            if (countBytes(heartbeatsToSend) > maxSize) {\r\n                // If the header would exceed max size, remove the added heartbeat\r\n                // entry and stop adding to the header.\r\n                heartbeatsToSend.pop();\r\n                break;\r\n            }\r\n        }\r\n        else {\r\n            heartbeatEntry.dates.push(singleDateHeartbeat.date);\r\n            // If the header would exceed max size, remove the added date\r\n            // and stop adding to the header.\r\n            if (countBytes(heartbeatsToSend) > maxSize) {\r\n                heartbeatEntry.dates.pop();\r\n                break;\r\n            }\r\n        }\r\n        // Pop unsent entry from queue. (Skipped if adding the entry exceeded\r\n        // quota and the loop breaks early.)\r\n        unsentEntries = unsentEntries.slice(1);\r\n    }\r\n    return {\r\n        heartbeatsToSend,\r\n        unsentEntries\r\n    };\r\n}\r\nclass HeartbeatStorageImpl {\r\n    constructor(app) {\r\n        this.app = app;\r\n        this._canUseIndexedDBPromise = this.runIndexedDBEnvironmentCheck();\r\n    }\r\n    async runIndexedDBEnvironmentCheck() {\r\n        if (!isIndexedDBAvailable()) {\r\n            return false;\r\n        }\r\n        else {\r\n            return validateIndexedDBOpenable()\r\n                .then(() => true)\r\n                .catch(() => false);\r\n        }\r\n    }\r\n    /**\r\n     * Read all heartbeats.\r\n     */\r\n    async read() {\r\n        const canUseIndexedDB = await this._canUseIndexedDBPromise;\r\n        if (!canUseIndexedDB) {\r\n            return { heartbeats: [] };\r\n        }\r\n        else {\r\n            const idbHeartbeatObject = await readHeartbeatsFromIndexedDB(this.app);\r\n            return idbHeartbeatObject || { heartbeats: [] };\r\n        }\r\n    }\r\n    // overwrite the storage with the provided heartbeats\r\n    async overwrite(heartbeatsObject) {\r\n        var _a;\r\n        const canUseIndexedDB = await this._canUseIndexedDBPromise;\r\n        if (!canUseIndexedDB) {\r\n            return;\r\n        }\r\n        else {\r\n            const existingHeartbeatsObject = await this.read();\r\n            return writeHeartbeatsToIndexedDB(this.app, {\r\n                lastSentHeartbeatDate: (_a = heartbeatsObject.lastSentHeartbeatDate) !== null && _a !== void 0 ? _a : existingHeartbeatsObject.lastSentHeartbeatDate,\r\n                heartbeats: heartbeatsObject.heartbeats\r\n            });\r\n        }\r\n    }\r\n    // add heartbeats\r\n    async add(heartbeatsObject) {\r\n        var _a;\r\n        const canUseIndexedDB = await this._canUseIndexedDBPromise;\r\n        if (!canUseIndexedDB) {\r\n            return;\r\n        }\r\n        else {\r\n            const existingHeartbeatsObject = await this.read();\r\n            return writeHeartbeatsToIndexedDB(this.app, {\r\n                lastSentHeartbeatDate: (_a = heartbeatsObject.lastSentHeartbeatDate) !== null && _a !== void 0 ? _a : existingHeartbeatsObject.lastSentHeartbeatDate,\r\n                heartbeats: [\r\n                    ...existingHeartbeatsObject.heartbeats,\r\n                    ...heartbeatsObject.heartbeats\r\n                ]\r\n            });\r\n        }\r\n    }\r\n}\r\n/**\r\n * Calculate bytes of a HeartbeatsByUserAgent array after being wrapped\r\n * in a platform logging header JSON object, stringified, and converted\r\n * to base 64.\r\n */\r\nfunction countBytes(heartbeatsCache) {\r\n    // base64 has a restricted set of characters, all of which should be 1 byte.\r\n    return base64urlEncodeWithoutPadding(\r\n    // heartbeatsCache wrapper properties\r\n    JSON.stringify({ version: 2, heartbeats: heartbeatsCache })).length;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction registerCoreComponents(variant) {\r\n    _registerComponent(new Component('platform-logger', container => new PlatformLoggerServiceImpl(container), \"PRIVATE\" /* PRIVATE */));\r\n    _registerComponent(new Component('heartbeat', container => new HeartbeatServiceImpl(container), \"PRIVATE\" /* PRIVATE */));\r\n    // Register `app` package.\r\n    registerVersion(name$o, version$1, variant);\r\n    // BUILD_TARGET will be replaced by values like esm5, esm2017, cjs5, etc during the compilation\r\n    registerVersion(name$o, version$1, 'esm2017');\r\n    // Register platform SDK identifier (no version).\r\n    registerVersion('fire-js', '');\r\n}\n\n/**\r\n * Firebase App\r\n *\r\n * @remarks This package coordinates the communication between the different Firebase components\r\n * @packageDocumentation\r\n */\r\nregisterCoreComponents('');\n\nexport { SDK_VERSION, DEFAULT_ENTRY_NAME as _DEFAULT_ENTRY_NAME, _addComponent, _addOrOverwriteComponent, _apps, _clearComponents, _components, _getProvider, _registerComponent, _removeServiceInstance, deleteApp, getApp, getApps, initializeApp, onLog, registerVersion, setLogLevel };\n//# sourceMappingURL=index.esm2017.js.map\n","import { registerVersion } from '@firebase/app';\nexport * from '@firebase/app';\n\nvar name = \"firebase\";\nvar version = \"9.14.0\";\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nregisterVersion(name, version, 'app');\n//# sourceMappingURL=index.esm.js.map\n","import { _getProvider, getApp, _registerComponent, registerVersion } from '@firebase/app';\nimport { Component } from '@firebase/component';\nimport { ErrorFactory, FirebaseError } from '@firebase/util';\nimport { openDB } from 'idb';\n\nconst name = \"@firebase/installations\";\nconst version = \"0.5.16\";\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst PENDING_TIMEOUT_MS = 10000;\r\nconst PACKAGE_VERSION = `w:${version}`;\r\nconst INTERNAL_AUTH_VERSION = 'FIS_v2';\r\nconst INSTALLATIONS_API_URL = 'https://firebaseinstallations.googleapis.com/v1';\r\nconst TOKEN_EXPIRATION_BUFFER = 60 * 60 * 1000; // One hour\r\nconst SERVICE = 'installations';\r\nconst SERVICE_NAME = 'Installations';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst ERROR_DESCRIPTION_MAP = {\r\n    [\"missing-app-config-values\" /* MISSING_APP_CONFIG_VALUES */]: 'Missing App configuration value: \"{$valueName}\"',\r\n    [\"not-registered\" /* NOT_REGISTERED */]: 'Firebase Installation is not registered.',\r\n    [\"installation-not-found\" /* INSTALLATION_NOT_FOUND */]: 'Firebase Installation not found.',\r\n    [\"request-failed\" /* REQUEST_FAILED */]: '{$requestName} request failed with error \"{$serverCode} {$serverStatus}: {$serverMessage}\"',\r\n    [\"app-offline\" /* APP_OFFLINE */]: 'Could not process request. Application offline.',\r\n    [\"delete-pending-registration\" /* DELETE_PENDING_REGISTRATION */]: \"Can't delete installation while there is a pending registration request.\"\r\n};\r\nconst ERROR_FACTORY = new ErrorFactory(SERVICE, SERVICE_NAME, ERROR_DESCRIPTION_MAP);\r\n/** Returns true if error is a FirebaseError that is based on an error from the server. */\r\nfunction isServerError(error) {\r\n    return (error instanceof FirebaseError &&\r\n        error.code.includes(\"request-failed\" /* REQUEST_FAILED */));\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction getInstallationsEndpoint({ projectId }) {\r\n    return `${INSTALLATIONS_API_URL}/projects/${projectId}/installations`;\r\n}\r\nfunction extractAuthTokenInfoFromResponse(response) {\r\n    return {\r\n        token: response.token,\r\n        requestStatus: 2 /* COMPLETED */,\r\n        expiresIn: getExpiresInFromResponseExpiresIn(response.expiresIn),\r\n        creationTime: Date.now()\r\n    };\r\n}\r\nasync function getErrorFromResponse(requestName, response) {\r\n    const responseJson = await response.json();\r\n    const errorData = responseJson.error;\r\n    return ERROR_FACTORY.create(\"request-failed\" /* REQUEST_FAILED */, {\r\n        requestName,\r\n        serverCode: errorData.code,\r\n        serverMessage: errorData.message,\r\n        serverStatus: errorData.status\r\n    });\r\n}\r\nfunction getHeaders({ apiKey }) {\r\n    return new Headers({\r\n        'Content-Type': 'application/json',\r\n        Accept: 'application/json',\r\n        'x-goog-api-key': apiKey\r\n    });\r\n}\r\nfunction getHeadersWithAuth(appConfig, { refreshToken }) {\r\n    const headers = getHeaders(appConfig);\r\n    headers.append('Authorization', getAuthorizationHeader(refreshToken));\r\n    return headers;\r\n}\r\n/**\r\n * Calls the passed in fetch wrapper and returns the response.\r\n * If the returned response has a status of 5xx, re-runs the function once and\r\n * returns the response.\r\n */\r\nasync function retryIfServerError(fn) {\r\n    const result = await fn();\r\n    if (result.status >= 500 && result.status < 600) {\r\n        // Internal Server Error. Retry request.\r\n        return fn();\r\n    }\r\n    return result;\r\n}\r\nfunction getExpiresInFromResponseExpiresIn(responseExpiresIn) {\r\n    // This works because the server will never respond with fractions of a second.\r\n    return Number(responseExpiresIn.replace('s', '000'));\r\n}\r\nfunction getAuthorizationHeader(refreshToken) {\r\n    return `${INTERNAL_AUTH_VERSION} ${refreshToken}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function createInstallationRequest({ appConfig, heartbeatServiceProvider }, { fid }) {\r\n    const endpoint = getInstallationsEndpoint(appConfig);\r\n    const headers = getHeaders(appConfig);\r\n    // If heartbeat service exists, add the heartbeat string to the header.\r\n    const heartbeatService = heartbeatServiceProvider.getImmediate({\r\n        optional: true\r\n    });\r\n    if (heartbeatService) {\r\n        const heartbeatsHeader = await heartbeatService.getHeartbeatsHeader();\r\n        if (heartbeatsHeader) {\r\n            headers.append('x-firebase-client', heartbeatsHeader);\r\n        }\r\n    }\r\n    const body = {\r\n        fid,\r\n        authVersion: INTERNAL_AUTH_VERSION,\r\n        appId: appConfig.appId,\r\n        sdkVersion: PACKAGE_VERSION\r\n    };\r\n    const request = {\r\n        method: 'POST',\r\n        headers,\r\n        body: JSON.stringify(body)\r\n    };\r\n    const response = await retryIfServerError(() => fetch(endpoint, request));\r\n    if (response.ok) {\r\n        const responseValue = await response.json();\r\n        const registeredInstallationEntry = {\r\n            fid: responseValue.fid || fid,\r\n            registrationStatus: 2 /* COMPLETED */,\r\n            refreshToken: responseValue.refreshToken,\r\n            authToken: extractAuthTokenInfoFromResponse(responseValue.authToken)\r\n        };\r\n        return registeredInstallationEntry;\r\n    }\r\n    else {\r\n        throw await getErrorFromResponse('Create Installation', response);\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/** Returns a promise that resolves after given time passes. */\r\nfunction sleep(ms) {\r\n    return new Promise(resolve => {\r\n        setTimeout(resolve, ms);\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction bufferToBase64UrlSafe(array) {\r\n    const b64 = btoa(String.fromCharCode(...array));\r\n    return b64.replace(/\\+/g, '-').replace(/\\//g, '_');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst VALID_FID_PATTERN = /^[cdef][\\w-]{21}$/;\r\nconst INVALID_FID = '';\r\n/**\r\n * Generates a new FID using random values from Web Crypto API.\r\n * Returns an empty string if FID generation fails for any reason.\r\n */\r\nfunction generateFid() {\r\n    try {\r\n        // A valid FID has exactly 22 base64 characters, which is 132 bits, or 16.5\r\n        // bytes. our implementation generates a 17 byte array instead.\r\n        const fidByteArray = new Uint8Array(17);\r\n        const crypto = self.crypto || self.msCrypto;\r\n        crypto.getRandomValues(fidByteArray);\r\n        // Replace the first 4 random bits with the constant FID header of 0b0111.\r\n        fidByteArray[0] = 0b01110000 + (fidByteArray[0] % 0b00010000);\r\n        const fid = encode(fidByteArray);\r\n        return VALID_FID_PATTERN.test(fid) ? fid : INVALID_FID;\r\n    }\r\n    catch (_a) {\r\n        // FID generation errored\r\n        return INVALID_FID;\r\n    }\r\n}\r\n/** Converts a FID Uint8Array to a base64 string representation. */\r\nfunction encode(fidByteArray) {\r\n    const b64String = bufferToBase64UrlSafe(fidByteArray);\r\n    // Remove the 23rd character that was added because of the extra 4 bits at the\r\n    // end of our 17 byte array, and the '=' padding.\r\n    return b64String.substr(0, 22);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/** Returns a string key that can be used to identify the app. */\r\nfunction getKey(appConfig) {\r\n    return `${appConfig.appName}!${appConfig.appId}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst fidChangeCallbacks = new Map();\r\n/**\r\n * Calls the onIdChange callbacks with the new FID value, and broadcasts the\r\n * change to other tabs.\r\n */\r\nfunction fidChanged(appConfig, fid) {\r\n    const key = getKey(appConfig);\r\n    callFidChangeCallbacks(key, fid);\r\n    broadcastFidChange(key, fid);\r\n}\r\nfunction addCallback(appConfig, callback) {\r\n    // Open the broadcast channel if it's not already open,\r\n    // to be able to listen to change events from other tabs.\r\n    getBroadcastChannel();\r\n    const key = getKey(appConfig);\r\n    let callbackSet = fidChangeCallbacks.get(key);\r\n    if (!callbackSet) {\r\n        callbackSet = new Set();\r\n        fidChangeCallbacks.set(key, callbackSet);\r\n    }\r\n    callbackSet.add(callback);\r\n}\r\nfunction removeCallback(appConfig, callback) {\r\n    const key = getKey(appConfig);\r\n    const callbackSet = fidChangeCallbacks.get(key);\r\n    if (!callbackSet) {\r\n        return;\r\n    }\r\n    callbackSet.delete(callback);\r\n    if (callbackSet.size === 0) {\r\n        fidChangeCallbacks.delete(key);\r\n    }\r\n    // Close broadcast channel if there are no more callbacks.\r\n    closeBroadcastChannel();\r\n}\r\nfunction callFidChangeCallbacks(key, fid) {\r\n    const callbacks = fidChangeCallbacks.get(key);\r\n    if (!callbacks) {\r\n        return;\r\n    }\r\n    for (const callback of callbacks) {\r\n        callback(fid);\r\n    }\r\n}\r\nfunction broadcastFidChange(key, fid) {\r\n    const channel = getBroadcastChannel();\r\n    if (channel) {\r\n        channel.postMessage({ key, fid });\r\n    }\r\n    closeBroadcastChannel();\r\n}\r\nlet broadcastChannel = null;\r\n/** Opens and returns a BroadcastChannel if it is supported by the browser. */\r\nfunction getBroadcastChannel() {\r\n    if (!broadcastChannel && 'BroadcastChannel' in self) {\r\n        broadcastChannel = new BroadcastChannel('[Firebase] FID Change');\r\n        broadcastChannel.onmessage = e => {\r\n            callFidChangeCallbacks(e.data.key, e.data.fid);\r\n        };\r\n    }\r\n    return broadcastChannel;\r\n}\r\nfunction closeBroadcastChannel() {\r\n    if (fidChangeCallbacks.size === 0 && broadcastChannel) {\r\n        broadcastChannel.close();\r\n        broadcastChannel = null;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst DATABASE_NAME = 'firebase-installations-database';\r\nconst DATABASE_VERSION = 1;\r\nconst OBJECT_STORE_NAME = 'firebase-installations-store';\r\nlet dbPromise = null;\r\nfunction getDbPromise() {\r\n    if (!dbPromise) {\r\n        dbPromise = openDB(DATABASE_NAME, DATABASE_VERSION, {\r\n            upgrade: (db, oldVersion) => {\r\n                // We don't use 'break' in this switch statement, the fall-through\r\n                // behavior is what we want, because if there are multiple versions between\r\n                // the old version and the current version, we want ALL the migrations\r\n                // that correspond to those versions to run, not only the last one.\r\n                // eslint-disable-next-line default-case\r\n                switch (oldVersion) {\r\n                    case 0:\r\n                        db.createObjectStore(OBJECT_STORE_NAME);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return dbPromise;\r\n}\r\n/** Assigns or overwrites the record for the given key with the given value. */\r\nasync function set(appConfig, value) {\r\n    const key = getKey(appConfig);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    const objectStore = tx.objectStore(OBJECT_STORE_NAME);\r\n    const oldValue = (await objectStore.get(key));\r\n    await objectStore.put(value, key);\r\n    await tx.done;\r\n    if (!oldValue || oldValue.fid !== value.fid) {\r\n        fidChanged(appConfig, value.fid);\r\n    }\r\n    return value;\r\n}\r\n/** Removes record(s) from the objectStore that match the given key. */\r\nasync function remove(appConfig) {\r\n    const key = getKey(appConfig);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    await tx.objectStore(OBJECT_STORE_NAME).delete(key);\r\n    await tx.done;\r\n}\r\n/**\r\n * Atomically updates a record with the result of updateFn, which gets\r\n * called with the current value. If newValue is undefined, the record is\r\n * deleted instead.\r\n * @return Updated value\r\n */\r\nasync function update(appConfig, updateFn) {\r\n    const key = getKey(appConfig);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    const store = tx.objectStore(OBJECT_STORE_NAME);\r\n    const oldValue = (await store.get(key));\r\n    const newValue = updateFn(oldValue);\r\n    if (newValue === undefined) {\r\n        await store.delete(key);\r\n    }\r\n    else {\r\n        await store.put(newValue, key);\r\n    }\r\n    await tx.done;\r\n    if (newValue && (!oldValue || oldValue.fid !== newValue.fid)) {\r\n        fidChanged(appConfig, newValue.fid);\r\n    }\r\n    return newValue;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Updates and returns the InstallationEntry from the database.\r\n * Also triggers a registration request if it is necessary and possible.\r\n */\r\nasync function getInstallationEntry(installations) {\r\n    let registrationPromise;\r\n    const installationEntry = await update(installations.appConfig, oldEntry => {\r\n        const installationEntry = updateOrCreateInstallationEntry(oldEntry);\r\n        const entryWithPromise = triggerRegistrationIfNecessary(installations, installationEntry);\r\n        registrationPromise = entryWithPromise.registrationPromise;\r\n        return entryWithPromise.installationEntry;\r\n    });\r\n    if (installationEntry.fid === INVALID_FID) {\r\n        // FID generation failed. Waiting for the FID from the server.\r\n        return { installationEntry: await registrationPromise };\r\n    }\r\n    return {\r\n        installationEntry,\r\n        registrationPromise\r\n    };\r\n}\r\n/**\r\n * Creates a new Installation Entry if one does not exist.\r\n * Also clears timed out pending requests.\r\n */\r\nfunction updateOrCreateInstallationEntry(oldEntry) {\r\n    const entry = oldEntry || {\r\n        fid: generateFid(),\r\n        registrationStatus: 0 /* NOT_STARTED */\r\n    };\r\n    return clearTimedOutRequest(entry);\r\n}\r\n/**\r\n * If the Firebase Installation is not registered yet, this will trigger the\r\n * registration and return an InProgressInstallationEntry.\r\n *\r\n * If registrationPromise does not exist, the installationEntry is guaranteed\r\n * to be registered.\r\n */\r\nfunction triggerRegistrationIfNecessary(installations, installationEntry) {\r\n    if (installationEntry.registrationStatus === 0 /* NOT_STARTED */) {\r\n        if (!navigator.onLine) {\r\n            // Registration required but app is offline.\r\n            const registrationPromiseWithError = Promise.reject(ERROR_FACTORY.create(\"app-offline\" /* APP_OFFLINE */));\r\n            return {\r\n                installationEntry,\r\n                registrationPromise: registrationPromiseWithError\r\n            };\r\n        }\r\n        // Try registering. Change status to IN_PROGRESS.\r\n        const inProgressEntry = {\r\n            fid: installationEntry.fid,\r\n            registrationStatus: 1 /* IN_PROGRESS */,\r\n            registrationTime: Date.now()\r\n        };\r\n        const registrationPromise = registerInstallation(installations, inProgressEntry);\r\n        return { installationEntry: inProgressEntry, registrationPromise };\r\n    }\r\n    else if (installationEntry.registrationStatus === 1 /* IN_PROGRESS */) {\r\n        return {\r\n            installationEntry,\r\n            registrationPromise: waitUntilFidRegistration(installations)\r\n        };\r\n    }\r\n    else {\r\n        return { installationEntry };\r\n    }\r\n}\r\n/** This will be executed only once for each new Firebase Installation. */\r\nasync function registerInstallation(installations, installationEntry) {\r\n    try {\r\n        const registeredInstallationEntry = await createInstallationRequest(installations, installationEntry);\r\n        return set(installations.appConfig, registeredInstallationEntry);\r\n    }\r\n    catch (e) {\r\n        if (isServerError(e) && e.customData.serverCode === 409) {\r\n            // Server returned a \"FID can not be used\" error.\r\n            // Generate a new ID next time.\r\n            await remove(installations.appConfig);\r\n        }\r\n        else {\r\n            // Registration failed. Set FID as not registered.\r\n            await set(installations.appConfig, {\r\n                fid: installationEntry.fid,\r\n                registrationStatus: 0 /* NOT_STARTED */\r\n            });\r\n        }\r\n        throw e;\r\n    }\r\n}\r\n/** Call if FID registration is pending in another request. */\r\nasync function waitUntilFidRegistration(installations) {\r\n    // Unfortunately, there is no way of reliably observing when a value in\r\n    // IndexedDB changes (yet, see https://github.com/WICG/indexed-db-observers),\r\n    // so we need to poll.\r\n    let entry = await updateInstallationRequest(installations.appConfig);\r\n    while (entry.registrationStatus === 1 /* IN_PROGRESS */) {\r\n        // createInstallation request still in progress.\r\n        await sleep(100);\r\n        entry = await updateInstallationRequest(installations.appConfig);\r\n    }\r\n    if (entry.registrationStatus === 0 /* NOT_STARTED */) {\r\n        // The request timed out or failed in a different call. Try again.\r\n        const { installationEntry, registrationPromise } = await getInstallationEntry(installations);\r\n        if (registrationPromise) {\r\n            return registrationPromise;\r\n        }\r\n        else {\r\n            // if there is no registrationPromise, entry is registered.\r\n            return installationEntry;\r\n        }\r\n    }\r\n    return entry;\r\n}\r\n/**\r\n * Called only if there is a CreateInstallation request in progress.\r\n *\r\n * Updates the InstallationEntry in the DB based on the status of the\r\n * CreateInstallation request.\r\n *\r\n * Returns the updated InstallationEntry.\r\n */\r\nfunction updateInstallationRequest(appConfig) {\r\n    return update(appConfig, oldEntry => {\r\n        if (!oldEntry) {\r\n            throw ERROR_FACTORY.create(\"installation-not-found\" /* INSTALLATION_NOT_FOUND */);\r\n        }\r\n        return clearTimedOutRequest(oldEntry);\r\n    });\r\n}\r\nfunction clearTimedOutRequest(entry) {\r\n    if (hasInstallationRequestTimedOut(entry)) {\r\n        return {\r\n            fid: entry.fid,\r\n            registrationStatus: 0 /* NOT_STARTED */\r\n        };\r\n    }\r\n    return entry;\r\n}\r\nfunction hasInstallationRequestTimedOut(installationEntry) {\r\n    return (installationEntry.registrationStatus === 1 /* IN_PROGRESS */ &&\r\n        installationEntry.registrationTime + PENDING_TIMEOUT_MS < Date.now());\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function generateAuthTokenRequest({ appConfig, heartbeatServiceProvider }, installationEntry) {\r\n    const endpoint = getGenerateAuthTokenEndpoint(appConfig, installationEntry);\r\n    const headers = getHeadersWithAuth(appConfig, installationEntry);\r\n    // If heartbeat service exists, add the heartbeat string to the header.\r\n    const heartbeatService = heartbeatServiceProvider.getImmediate({\r\n        optional: true\r\n    });\r\n    if (heartbeatService) {\r\n        const heartbeatsHeader = await heartbeatService.getHeartbeatsHeader();\r\n        if (heartbeatsHeader) {\r\n            headers.append('x-firebase-client', heartbeatsHeader);\r\n        }\r\n    }\r\n    const body = {\r\n        installation: {\r\n            sdkVersion: PACKAGE_VERSION,\r\n            appId: appConfig.appId\r\n        }\r\n    };\r\n    const request = {\r\n        method: 'POST',\r\n        headers,\r\n        body: JSON.stringify(body)\r\n    };\r\n    const response = await retryIfServerError(() => fetch(endpoint, request));\r\n    if (response.ok) {\r\n        const responseValue = await response.json();\r\n        const completedAuthToken = extractAuthTokenInfoFromResponse(responseValue);\r\n        return completedAuthToken;\r\n    }\r\n    else {\r\n        throw await getErrorFromResponse('Generate Auth Token', response);\r\n    }\r\n}\r\nfunction getGenerateAuthTokenEndpoint(appConfig, { fid }) {\r\n    return `${getInstallationsEndpoint(appConfig)}/${fid}/authTokens:generate`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a valid authentication token for the installation. Generates a new\r\n * token if one doesn't exist, is expired or about to expire.\r\n *\r\n * Should only be called if the Firebase Installation is registered.\r\n */\r\nasync function refreshAuthToken(installations, forceRefresh = false) {\r\n    let tokenPromise;\r\n    const entry = await update(installations.appConfig, oldEntry => {\r\n        if (!isEntryRegistered(oldEntry)) {\r\n            throw ERROR_FACTORY.create(\"not-registered\" /* NOT_REGISTERED */);\r\n        }\r\n        const oldAuthToken = oldEntry.authToken;\r\n        if (!forceRefresh && isAuthTokenValid(oldAuthToken)) {\r\n            // There is a valid token in the DB.\r\n            return oldEntry;\r\n        }\r\n        else if (oldAuthToken.requestStatus === 1 /* IN_PROGRESS */) {\r\n            // There already is a token request in progress.\r\n            tokenPromise = waitUntilAuthTokenRequest(installations, forceRefresh);\r\n            return oldEntry;\r\n        }\r\n        else {\r\n            // No token or token expired.\r\n            if (!navigator.onLine) {\r\n                throw ERROR_FACTORY.create(\"app-offline\" /* APP_OFFLINE */);\r\n            }\r\n            const inProgressEntry = makeAuthTokenRequestInProgressEntry(oldEntry);\r\n            tokenPromise = fetchAuthTokenFromServer(installations, inProgressEntry);\r\n            return inProgressEntry;\r\n        }\r\n    });\r\n    const authToken = tokenPromise\r\n        ? await tokenPromise\r\n        : entry.authToken;\r\n    return authToken;\r\n}\r\n/**\r\n * Call only if FID is registered and Auth Token request is in progress.\r\n *\r\n * Waits until the current pending request finishes. If the request times out,\r\n * tries once in this thread as well.\r\n */\r\nasync function waitUntilAuthTokenRequest(installations, forceRefresh) {\r\n    // Unfortunately, there is no way of reliably observing when a value in\r\n    // IndexedDB changes (yet, see https://github.com/WICG/indexed-db-observers),\r\n    // so we need to poll.\r\n    let entry = await updateAuthTokenRequest(installations.appConfig);\r\n    while (entry.authToken.requestStatus === 1 /* IN_PROGRESS */) {\r\n        // generateAuthToken still in progress.\r\n        await sleep(100);\r\n        entry = await updateAuthTokenRequest(installations.appConfig);\r\n    }\r\n    const authToken = entry.authToken;\r\n    if (authToken.requestStatus === 0 /* NOT_STARTED */) {\r\n        // The request timed out or failed in a different call. Try again.\r\n        return refreshAuthToken(installations, forceRefresh);\r\n    }\r\n    else {\r\n        return authToken;\r\n    }\r\n}\r\n/**\r\n * Called only if there is a GenerateAuthToken request in progress.\r\n *\r\n * Updates the InstallationEntry in the DB based on the status of the\r\n * GenerateAuthToken request.\r\n *\r\n * Returns the updated InstallationEntry.\r\n */\r\nfunction updateAuthTokenRequest(appConfig) {\r\n    return update(appConfig, oldEntry => {\r\n        if (!isEntryRegistered(oldEntry)) {\r\n            throw ERROR_FACTORY.create(\"not-registered\" /* NOT_REGISTERED */);\r\n        }\r\n        const oldAuthToken = oldEntry.authToken;\r\n        if (hasAuthTokenRequestTimedOut(oldAuthToken)) {\r\n            return Object.assign(Object.assign({}, oldEntry), { authToken: { requestStatus: 0 /* NOT_STARTED */ } });\r\n        }\r\n        return oldEntry;\r\n    });\r\n}\r\nasync function fetchAuthTokenFromServer(installations, installationEntry) {\r\n    try {\r\n        const authToken = await generateAuthTokenRequest(installations, installationEntry);\r\n        const updatedInstallationEntry = Object.assign(Object.assign({}, installationEntry), { authToken });\r\n        await set(installations.appConfig, updatedInstallationEntry);\r\n        return authToken;\r\n    }\r\n    catch (e) {\r\n        if (isServerError(e) &&\r\n            (e.customData.serverCode === 401 || e.customData.serverCode === 404)) {\r\n            // Server returned a \"FID not found\" or a \"Invalid authentication\" error.\r\n            // Generate a new ID next time.\r\n            await remove(installations.appConfig);\r\n        }\r\n        else {\r\n            const updatedInstallationEntry = Object.assign(Object.assign({}, installationEntry), { authToken: { requestStatus: 0 /* NOT_STARTED */ } });\r\n            await set(installations.appConfig, updatedInstallationEntry);\r\n        }\r\n        throw e;\r\n    }\r\n}\r\nfunction isEntryRegistered(installationEntry) {\r\n    return (installationEntry !== undefined &&\r\n        installationEntry.registrationStatus === 2 /* COMPLETED */);\r\n}\r\nfunction isAuthTokenValid(authToken) {\r\n    return (authToken.requestStatus === 2 /* COMPLETED */ &&\r\n        !isAuthTokenExpired(authToken));\r\n}\r\nfunction isAuthTokenExpired(authToken) {\r\n    const now = Date.now();\r\n    return (now < authToken.creationTime ||\r\n        authToken.creationTime + authToken.expiresIn < now + TOKEN_EXPIRATION_BUFFER);\r\n}\r\n/** Returns an updated InstallationEntry with an InProgressAuthToken. */\r\nfunction makeAuthTokenRequestInProgressEntry(oldEntry) {\r\n    const inProgressAuthToken = {\r\n        requestStatus: 1 /* IN_PROGRESS */,\r\n        requestTime: Date.now()\r\n    };\r\n    return Object.assign(Object.assign({}, oldEntry), { authToken: inProgressAuthToken });\r\n}\r\nfunction hasAuthTokenRequestTimedOut(authToken) {\r\n    return (authToken.requestStatus === 1 /* IN_PROGRESS */ &&\r\n        authToken.requestTime + PENDING_TIMEOUT_MS < Date.now());\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Creates a Firebase Installation if there isn't one for the app and\r\n * returns the Installation ID.\r\n * @param installations - The `Installations` instance.\r\n *\r\n * @public\r\n */\r\nasync function getId(installations) {\r\n    const installationsImpl = installations;\r\n    const { installationEntry, registrationPromise } = await getInstallationEntry(installationsImpl);\r\n    if (registrationPromise) {\r\n        registrationPromise.catch(console.error);\r\n    }\r\n    else {\r\n        // If the installation is already registered, update the authentication\r\n        // token if needed.\r\n        refreshAuthToken(installationsImpl).catch(console.error);\r\n    }\r\n    return installationEntry.fid;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a Firebase Installations auth token, identifying the current\r\n * Firebase Installation.\r\n * @param installations - The `Installations` instance.\r\n * @param forceRefresh - Force refresh regardless of token expiration.\r\n *\r\n * @public\r\n */\r\nasync function getToken(installations, forceRefresh = false) {\r\n    const installationsImpl = installations;\r\n    await completeInstallationRegistration(installationsImpl);\r\n    // At this point we either have a Registered Installation in the DB, or we've\r\n    // already thrown an error.\r\n    const authToken = await refreshAuthToken(installationsImpl, forceRefresh);\r\n    return authToken.token;\r\n}\r\nasync function completeInstallationRegistration(installations) {\r\n    const { registrationPromise } = await getInstallationEntry(installations);\r\n    if (registrationPromise) {\r\n        // A createInstallation request is in progress. Wait until it finishes.\r\n        await registrationPromise;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function deleteInstallationRequest(appConfig, installationEntry) {\r\n    const endpoint = getDeleteEndpoint(appConfig, installationEntry);\r\n    const headers = getHeadersWithAuth(appConfig, installationEntry);\r\n    const request = {\r\n        method: 'DELETE',\r\n        headers\r\n    };\r\n    const response = await retryIfServerError(() => fetch(endpoint, request));\r\n    if (!response.ok) {\r\n        throw await getErrorFromResponse('Delete Installation', response);\r\n    }\r\n}\r\nfunction getDeleteEndpoint(appConfig, { fid }) {\r\n    return `${getInstallationsEndpoint(appConfig)}/${fid}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Deletes the Firebase Installation and all associated data.\r\n * @param installations - The `Installations` instance.\r\n *\r\n * @public\r\n */\r\nasync function deleteInstallations(installations) {\r\n    const { appConfig } = installations;\r\n    const entry = await update(appConfig, oldEntry => {\r\n        if (oldEntry && oldEntry.registrationStatus === 0 /* NOT_STARTED */) {\r\n            // Delete the unregistered entry without sending a deleteInstallation request.\r\n            return undefined;\r\n        }\r\n        return oldEntry;\r\n    });\r\n    if (entry) {\r\n        if (entry.registrationStatus === 1 /* IN_PROGRESS */) {\r\n            // Can't delete while trying to register.\r\n            throw ERROR_FACTORY.create(\"delete-pending-registration\" /* DELETE_PENDING_REGISTRATION */);\r\n        }\r\n        else if (entry.registrationStatus === 2 /* COMPLETED */) {\r\n            if (!navigator.onLine) {\r\n                throw ERROR_FACTORY.create(\"app-offline\" /* APP_OFFLINE */);\r\n            }\r\n            else {\r\n                await deleteInstallationRequest(appConfig, entry);\r\n                await remove(appConfig);\r\n            }\r\n        }\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Sets a new callback that will get called when Installation ID changes.\r\n * Returns an unsubscribe function that will remove the callback when called.\r\n * @param installations - The `Installations` instance.\r\n * @param callback - The callback function that is invoked when FID changes.\r\n * @returns A function that can be called to unsubscribe.\r\n *\r\n * @public\r\n */\r\nfunction onIdChange(installations, callback) {\r\n    const { appConfig } = installations;\r\n    addCallback(appConfig, callback);\r\n    return () => {\r\n        removeCallback(appConfig, callback);\r\n    };\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns an instance of {@link Installations} associated with the given\r\n * {@link @firebase/app#FirebaseApp} instance.\r\n * @param app - The {@link @firebase/app#FirebaseApp} instance.\r\n *\r\n * @public\r\n */\r\nfunction getInstallations(app = getApp()) {\r\n    const installationsImpl = _getProvider(app, 'installations').getImmediate();\r\n    return installationsImpl;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction extractAppConfig(app) {\r\n    if (!app || !app.options) {\r\n        throw getMissingValueError('App Configuration');\r\n    }\r\n    if (!app.name) {\r\n        throw getMissingValueError('App Name');\r\n    }\r\n    // Required app config keys\r\n    const configKeys = [\r\n        'projectId',\r\n        'apiKey',\r\n        'appId'\r\n    ];\r\n    for (const keyName of configKeys) {\r\n        if (!app.options[keyName]) {\r\n            throw getMissingValueError(keyName);\r\n        }\r\n    }\r\n    return {\r\n        appName: app.name,\r\n        projectId: app.options.projectId,\r\n        apiKey: app.options.apiKey,\r\n        appId: app.options.appId\r\n    };\r\n}\r\nfunction getMissingValueError(valueName) {\r\n    return ERROR_FACTORY.create(\"missing-app-config-values\" /* MISSING_APP_CONFIG_VALUES */, {\r\n        valueName\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst INSTALLATIONS_NAME = 'installations';\r\nconst INSTALLATIONS_NAME_INTERNAL = 'installations-internal';\r\nconst publicFactory = (container) => {\r\n    const app = container.getProvider('app').getImmediate();\r\n    // Throws if app isn't configured properly.\r\n    const appConfig = extractAppConfig(app);\r\n    const heartbeatServiceProvider = _getProvider(app, 'heartbeat');\r\n    const installationsImpl = {\r\n        app,\r\n        appConfig,\r\n        heartbeatServiceProvider,\r\n        _delete: () => Promise.resolve()\r\n    };\r\n    return installationsImpl;\r\n};\r\nconst internalFactory = (container) => {\r\n    const app = container.getProvider('app').getImmediate();\r\n    // Internal FIS instance relies on public FIS instance.\r\n    const installations = _getProvider(app, INSTALLATIONS_NAME).getImmediate();\r\n    const installationsInternal = {\r\n        getId: () => getId(installations),\r\n        getToken: (forceRefresh) => getToken(installations, forceRefresh)\r\n    };\r\n    return installationsInternal;\r\n};\r\nfunction registerInstallations() {\r\n    _registerComponent(new Component(INSTALLATIONS_NAME, publicFactory, \"PUBLIC\" /* PUBLIC */));\r\n    _registerComponent(new Component(INSTALLATIONS_NAME_INTERNAL, internalFactory, \"PRIVATE\" /* PRIVATE */));\r\n}\n\n/**\r\n * Firebase Installations\r\n *\r\n * @packageDocumentation\r\n */\r\nregisterInstallations();\r\nregisterVersion(name, version);\r\n// BUILD_TARGET will be replaced by values like esm5, esm2017, cjs5, etc during the compilation\r\nregisterVersion(name, version, 'esm2017');\n\nexport { deleteInstallations, getId, getInstallations, getToken, onIdChange };\n//# sourceMappingURL=index.esm2017.js.map\n","import '@firebase/installations';\nimport { Component } from '@firebase/component';\nimport { openDB, deleteDB } from 'idb';\nimport { ErrorFactory, validateIndexedDBOpenable, isIndexedDBAvailable, areCookiesEnabled, getModularInstance } from '@firebase/util';\nimport { _registerComponent, registerVersion, _getProvider, getApp } from '@firebase/app';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst DEFAULT_SW_PATH = '/firebase-messaging-sw.js';\r\nconst DEFAULT_SW_SCOPE = '/firebase-cloud-messaging-push-scope';\r\nconst DEFAULT_VAPID_KEY = 'BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4';\r\nconst ENDPOINT = 'https://fcmregistrations.googleapis.com/v1';\r\nconst CONSOLE_CAMPAIGN_ID = 'google.c.a.c_id';\r\nconst CONSOLE_CAMPAIGN_NAME = 'google.c.a.c_l';\r\nconst CONSOLE_CAMPAIGN_TIME = 'google.c.a.ts';\r\n/** Set to '1' if Analytics is enabled for the campaign */\r\nconst CONSOLE_CAMPAIGN_ANALYTICS_ENABLED = 'google.c.a.e';\r\nvar MessageType$1;\r\n(function (MessageType) {\r\n    MessageType[MessageType[\"DATA_MESSAGE\"] = 1] = \"DATA_MESSAGE\";\r\n    MessageType[MessageType[\"DISPLAY_NOTIFICATION\"] = 3] = \"DISPLAY_NOTIFICATION\";\r\n})(MessageType$1 || (MessageType$1 = {}));\n\n/**\r\n * @license\r\n * Copyright 2018 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\r\n * in compliance with the License. You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software distributed under the License\r\n * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\r\n * or implied. See the License for the specific language governing permissions and limitations under\r\n * the License.\r\n */\r\nvar MessageType;\r\n(function (MessageType) {\r\n    MessageType[\"PUSH_RECEIVED\"] = \"push-received\";\r\n    MessageType[\"NOTIFICATION_CLICKED\"] = \"notification-clicked\";\r\n})(MessageType || (MessageType = {}));\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction arrayToBase64(array) {\r\n    const uint8Array = new Uint8Array(array);\r\n    const base64String = btoa(String.fromCharCode(...uint8Array));\r\n    return base64String.replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_');\r\n}\r\nfunction base64ToArray(base64String) {\r\n    const padding = '='.repeat((4 - (base64String.length % 4)) % 4);\r\n    const base64 = (base64String + padding)\r\n        .replace(/\\-/g, '+')\r\n        .replace(/_/g, '/');\r\n    const rawData = atob(base64);\r\n    const outputArray = new Uint8Array(rawData.length);\r\n    for (let i = 0; i < rawData.length; ++i) {\r\n        outputArray[i] = rawData.charCodeAt(i);\r\n    }\r\n    return outputArray;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst OLD_DB_NAME = 'fcm_token_details_db';\r\n/**\r\n * The last DB version of 'fcm_token_details_db' was 4. This is one higher, so that the upgrade\r\n * callback is called for all versions of the old DB.\r\n */\r\nconst OLD_DB_VERSION = 5;\r\nconst OLD_OBJECT_STORE_NAME = 'fcm_token_object_Store';\r\nasync function migrateOldDatabase(senderId) {\r\n    if ('databases' in indexedDB) {\r\n        // indexedDb.databases() is an IndexedDB v3 API and does not exist in all browsers. TODO: Remove\r\n        // typecast when it lands in TS types.\r\n        const databases = await indexedDB.databases();\r\n        const dbNames = databases.map(db => db.name);\r\n        if (!dbNames.includes(OLD_DB_NAME)) {\r\n            // old DB didn't exist, no need to open.\r\n            return null;\r\n        }\r\n    }\r\n    let tokenDetails = null;\r\n    const db = await openDB(OLD_DB_NAME, OLD_DB_VERSION, {\r\n        upgrade: async (db, oldVersion, newVersion, upgradeTransaction) => {\r\n            var _a;\r\n            if (oldVersion < 2) {\r\n                // Database too old, skip migration.\r\n                return;\r\n            }\r\n            if (!db.objectStoreNames.contains(OLD_OBJECT_STORE_NAME)) {\r\n                // Database did not exist. Nothing to do.\r\n                return;\r\n            }\r\n            const objectStore = upgradeTransaction.objectStore(OLD_OBJECT_STORE_NAME);\r\n            const value = await objectStore.index('fcmSenderId').get(senderId);\r\n            await objectStore.clear();\r\n            if (!value) {\r\n                // No entry in the database, nothing to migrate.\r\n                return;\r\n            }\r\n            if (oldVersion === 2) {\r\n                const oldDetails = value;\r\n                if (!oldDetails.auth || !oldDetails.p256dh || !oldDetails.endpoint) {\r\n                    return;\r\n                }\r\n                tokenDetails = {\r\n                    token: oldDetails.fcmToken,\r\n                    createTime: (_a = oldDetails.createTime) !== null && _a !== void 0 ? _a : Date.now(),\r\n                    subscriptionOptions: {\r\n                        auth: oldDetails.auth,\r\n                        p256dh: oldDetails.p256dh,\r\n                        endpoint: oldDetails.endpoint,\r\n                        swScope: oldDetails.swScope,\r\n                        vapidKey: typeof oldDetails.vapidKey === 'string'\r\n                            ? oldDetails.vapidKey\r\n                            : arrayToBase64(oldDetails.vapidKey)\r\n                    }\r\n                };\r\n            }\r\n            else if (oldVersion === 3) {\r\n                const oldDetails = value;\r\n                tokenDetails = {\r\n                    token: oldDetails.fcmToken,\r\n                    createTime: oldDetails.createTime,\r\n                    subscriptionOptions: {\r\n                        auth: arrayToBase64(oldDetails.auth),\r\n                        p256dh: arrayToBase64(oldDetails.p256dh),\r\n                        endpoint: oldDetails.endpoint,\r\n                        swScope: oldDetails.swScope,\r\n                        vapidKey: arrayToBase64(oldDetails.vapidKey)\r\n                    }\r\n                };\r\n            }\r\n            else if (oldVersion === 4) {\r\n                const oldDetails = value;\r\n                tokenDetails = {\r\n                    token: oldDetails.fcmToken,\r\n                    createTime: oldDetails.createTime,\r\n                    subscriptionOptions: {\r\n                        auth: arrayToBase64(oldDetails.auth),\r\n                        p256dh: arrayToBase64(oldDetails.p256dh),\r\n                        endpoint: oldDetails.endpoint,\r\n                        swScope: oldDetails.swScope,\r\n                        vapidKey: arrayToBase64(oldDetails.vapidKey)\r\n                    }\r\n                };\r\n            }\r\n        }\r\n    });\r\n    db.close();\r\n    // Delete all old databases.\r\n    await deleteDB(OLD_DB_NAME);\r\n    await deleteDB('fcm_vapid_details_db');\r\n    await deleteDB('undefined');\r\n    return checkTokenDetails(tokenDetails) ? tokenDetails : null;\r\n}\r\nfunction checkTokenDetails(tokenDetails) {\r\n    if (!tokenDetails || !tokenDetails.subscriptionOptions) {\r\n        return false;\r\n    }\r\n    const { subscriptionOptions } = tokenDetails;\r\n    return (typeof tokenDetails.createTime === 'number' &&\r\n        tokenDetails.createTime > 0 &&\r\n        typeof tokenDetails.token === 'string' &&\r\n        tokenDetails.token.length > 0 &&\r\n        typeof subscriptionOptions.auth === 'string' &&\r\n        subscriptionOptions.auth.length > 0 &&\r\n        typeof subscriptionOptions.p256dh === 'string' &&\r\n        subscriptionOptions.p256dh.length > 0 &&\r\n        typeof subscriptionOptions.endpoint === 'string' &&\r\n        subscriptionOptions.endpoint.length > 0 &&\r\n        typeof subscriptionOptions.swScope === 'string' &&\r\n        subscriptionOptions.swScope.length > 0 &&\r\n        typeof subscriptionOptions.vapidKey === 'string' &&\r\n        subscriptionOptions.vapidKey.length > 0);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n// Exported for tests.\r\nconst DATABASE_NAME = 'firebase-messaging-database';\r\nconst DATABASE_VERSION = 1;\r\nconst OBJECT_STORE_NAME = 'firebase-messaging-store';\r\nlet dbPromise = null;\r\nfunction getDbPromise() {\r\n    if (!dbPromise) {\r\n        dbPromise = openDB(DATABASE_NAME, DATABASE_VERSION, {\r\n            upgrade: (upgradeDb, oldVersion) => {\r\n                // We don't use 'break' in this switch statement, the fall-through behavior is what we want,\r\n                // because if there are multiple versions between the old version and the current version, we\r\n                // want ALL the migrations that correspond to those versions to run, not only the last one.\r\n                // eslint-disable-next-line default-case\r\n                switch (oldVersion) {\r\n                    case 0:\r\n                        upgradeDb.createObjectStore(OBJECT_STORE_NAME);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return dbPromise;\r\n}\r\n/** Gets record(s) from the objectStore that match the given key. */\r\nasync function dbGet(firebaseDependencies) {\r\n    const key = getKey(firebaseDependencies);\r\n    const db = await getDbPromise();\r\n    const tokenDetails = (await db\r\n        .transaction(OBJECT_STORE_NAME)\r\n        .objectStore(OBJECT_STORE_NAME)\r\n        .get(key));\r\n    if (tokenDetails) {\r\n        return tokenDetails;\r\n    }\r\n    else {\r\n        // Check if there is a tokenDetails object in the old DB.\r\n        const oldTokenDetails = await migrateOldDatabase(firebaseDependencies.appConfig.senderId);\r\n        if (oldTokenDetails) {\r\n            await dbSet(firebaseDependencies, oldTokenDetails);\r\n            return oldTokenDetails;\r\n        }\r\n    }\r\n}\r\n/** Assigns or overwrites the record for the given key with the given value. */\r\nasync function dbSet(firebaseDependencies, tokenDetails) {\r\n    const key = getKey(firebaseDependencies);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    await tx.objectStore(OBJECT_STORE_NAME).put(tokenDetails, key);\r\n    await tx.done;\r\n    return tokenDetails;\r\n}\r\n/** Removes record(s) from the objectStore that match the given key. */\r\nasync function dbRemove(firebaseDependencies) {\r\n    const key = getKey(firebaseDependencies);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    await tx.objectStore(OBJECT_STORE_NAME).delete(key);\r\n    await tx.done;\r\n}\r\nfunction getKey({ appConfig }) {\r\n    return appConfig.appId;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst ERROR_MAP = {\r\n    [\"missing-app-config-values\" /* MISSING_APP_CONFIG_VALUES */]: 'Missing App configuration value: \"{$valueName}\"',\r\n    [\"only-available-in-window\" /* AVAILABLE_IN_WINDOW */]: 'This method is available in a Window context.',\r\n    [\"only-available-in-sw\" /* AVAILABLE_IN_SW */]: 'This method is available in a service worker context.',\r\n    [\"permission-default\" /* PERMISSION_DEFAULT */]: 'The notification permission was not granted and dismissed instead.',\r\n    [\"permission-blocked\" /* PERMISSION_BLOCKED */]: 'The notification permission was not granted and blocked instead.',\r\n    [\"unsupported-browser\" /* UNSUPPORTED_BROWSER */]: \"This browser doesn't support the API's required to use the Firebase SDK.\",\r\n    [\"indexed-db-unsupported\" /* INDEXED_DB_UNSUPPORTED */]: \"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)\",\r\n    [\"failed-service-worker-registration\" /* FAILED_DEFAULT_REGISTRATION */]: 'We are unable to register the default service worker. {$browserErrorMessage}',\r\n    [\"token-subscribe-failed\" /* TOKEN_SUBSCRIBE_FAILED */]: 'A problem occurred while subscribing the user to FCM: {$errorInfo}',\r\n    [\"token-subscribe-no-token\" /* TOKEN_SUBSCRIBE_NO_TOKEN */]: 'FCM returned no token when subscribing the user to push.',\r\n    [\"token-unsubscribe-failed\" /* TOKEN_UNSUBSCRIBE_FAILED */]: 'A problem occurred while unsubscribing the ' +\r\n        'user from FCM: {$errorInfo}',\r\n    [\"token-update-failed\" /* TOKEN_UPDATE_FAILED */]: 'A problem occurred while updating the user from FCM: {$errorInfo}',\r\n    [\"token-update-no-token\" /* TOKEN_UPDATE_NO_TOKEN */]: 'FCM returned no token when updating the user to push.',\r\n    [\"use-sw-after-get-token\" /* USE_SW_AFTER_GET_TOKEN */]: 'The useServiceWorker() method may only be called once and must be ' +\r\n        'called before calling getToken() to ensure your service worker is used.',\r\n    [\"invalid-sw-registration\" /* INVALID_SW_REGISTRATION */]: 'The input to useServiceWorker() must be a ServiceWorkerRegistration.',\r\n    [\"invalid-bg-handler\" /* INVALID_BG_HANDLER */]: 'The input to setBackgroundMessageHandler() must be a function.',\r\n    [\"invalid-vapid-key\" /* INVALID_VAPID_KEY */]: 'The public VAPID key must be a string.',\r\n    [\"use-vapid-key-after-get-token\" /* USE_VAPID_KEY_AFTER_GET_TOKEN */]: 'The usePublicVapidKey() method may only be called once and must be ' +\r\n        'called before calling getToken() to ensure your VAPID key is used.'\r\n};\r\nconst ERROR_FACTORY = new ErrorFactory('messaging', 'Messaging', ERROR_MAP);\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function requestGetToken(firebaseDependencies, subscriptionOptions) {\r\n    var _a;\r\n    const headers = await getHeaders(firebaseDependencies);\r\n    const body = getBody(subscriptionOptions);\r\n    const subscribeOptions = {\r\n        method: 'POST',\r\n        headers,\r\n        body: JSON.stringify(body)\r\n    };\r\n    let responseData;\r\n    try {\r\n        const response = await fetch(getEndpoint(firebaseDependencies.appConfig), subscribeOptions);\r\n        responseData = await response.json();\r\n    }\r\n    catch (err) {\r\n        throw ERROR_FACTORY.create(\"token-subscribe-failed\" /* TOKEN_SUBSCRIBE_FAILED */, {\r\n            errorInfo: (_a = err) === null || _a === void 0 ? void 0 : _a.toString()\r\n        });\r\n    }\r\n    if (responseData.error) {\r\n        const message = responseData.error.message;\r\n        throw ERROR_FACTORY.create(\"token-subscribe-failed\" /* TOKEN_SUBSCRIBE_FAILED */, {\r\n            errorInfo: message\r\n        });\r\n    }\r\n    if (!responseData.token) {\r\n        throw ERROR_FACTORY.create(\"token-subscribe-no-token\" /* TOKEN_SUBSCRIBE_NO_TOKEN */);\r\n    }\r\n    return responseData.token;\r\n}\r\nasync function requestUpdateToken(firebaseDependencies, tokenDetails) {\r\n    var _a;\r\n    const headers = await getHeaders(firebaseDependencies);\r\n    const body = getBody(tokenDetails.subscriptionOptions);\r\n    const updateOptions = {\r\n        method: 'PATCH',\r\n        headers,\r\n        body: JSON.stringify(body)\r\n    };\r\n    let responseData;\r\n    try {\r\n        const response = await fetch(`${getEndpoint(firebaseDependencies.appConfig)}/${tokenDetails.token}`, updateOptions);\r\n        responseData = await response.json();\r\n    }\r\n    catch (err) {\r\n        throw ERROR_FACTORY.create(\"token-update-failed\" /* TOKEN_UPDATE_FAILED */, {\r\n            errorInfo: (_a = err) === null || _a === void 0 ? void 0 : _a.toString()\r\n        });\r\n    }\r\n    if (responseData.error) {\r\n        const message = responseData.error.message;\r\n        throw ERROR_FACTORY.create(\"token-update-failed\" /* TOKEN_UPDATE_FAILED */, {\r\n            errorInfo: message\r\n        });\r\n    }\r\n    if (!responseData.token) {\r\n        throw ERROR_FACTORY.create(\"token-update-no-token\" /* TOKEN_UPDATE_NO_TOKEN */);\r\n    }\r\n    return responseData.token;\r\n}\r\nasync function requestDeleteToken(firebaseDependencies, token) {\r\n    var _a;\r\n    const headers = await getHeaders(firebaseDependencies);\r\n    const unsubscribeOptions = {\r\n        method: 'DELETE',\r\n        headers\r\n    };\r\n    try {\r\n        const response = await fetch(`${getEndpoint(firebaseDependencies.appConfig)}/${token}`, unsubscribeOptions);\r\n        const responseData = await response.json();\r\n        if (responseData.error) {\r\n            const message = responseData.error.message;\r\n            throw ERROR_FACTORY.create(\"token-unsubscribe-failed\" /* TOKEN_UNSUBSCRIBE_FAILED */, {\r\n                errorInfo: message\r\n            });\r\n        }\r\n    }\r\n    catch (err) {\r\n        throw ERROR_FACTORY.create(\"token-unsubscribe-failed\" /* TOKEN_UNSUBSCRIBE_FAILED */, {\r\n            errorInfo: (_a = err) === null || _a === void 0 ? void 0 : _a.toString()\r\n        });\r\n    }\r\n}\r\nfunction getEndpoint({ projectId }) {\r\n    return `${ENDPOINT}/projects/${projectId}/registrations`;\r\n}\r\nasync function getHeaders({ appConfig, installations }) {\r\n    const authToken = await installations.getToken();\r\n    return new Headers({\r\n        'Content-Type': 'application/json',\r\n        Accept: 'application/json',\r\n        'x-goog-api-key': appConfig.apiKey,\r\n        'x-goog-firebase-installations-auth': `FIS ${authToken}`\r\n    });\r\n}\r\nfunction getBody({ p256dh, auth, endpoint, vapidKey }) {\r\n    const body = {\r\n        web: {\r\n            endpoint,\r\n            auth,\r\n            p256dh\r\n        }\r\n    };\r\n    if (vapidKey !== DEFAULT_VAPID_KEY) {\r\n        body.web.applicationPubKey = vapidKey;\r\n    }\r\n    return body;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n// UpdateRegistration will be called once every week.\r\nconst TOKEN_EXPIRATION_MS = 7 * 24 * 60 * 60 * 1000; // 7 days\r\nasync function getTokenInternal(messaging) {\r\n    const pushSubscription = await getPushSubscription(messaging.swRegistration, messaging.vapidKey);\r\n    const subscriptionOptions = {\r\n        vapidKey: messaging.vapidKey,\r\n        swScope: messaging.swRegistration.scope,\r\n        endpoint: pushSubscription.endpoint,\r\n        auth: arrayToBase64(pushSubscription.getKey('auth')),\r\n        p256dh: arrayToBase64(pushSubscription.getKey('p256dh'))\r\n    };\r\n    const tokenDetails = await dbGet(messaging.firebaseDependencies);\r\n    if (!tokenDetails) {\r\n        // No token, get a new one.\r\n        return getNewToken(messaging.firebaseDependencies, subscriptionOptions);\r\n    }\r\n    else if (!isTokenValid(tokenDetails.subscriptionOptions, subscriptionOptions)) {\r\n        // Invalid token, get a new one.\r\n        try {\r\n            await requestDeleteToken(messaging.firebaseDependencies, tokenDetails.token);\r\n        }\r\n        catch (e) {\r\n            // Suppress errors because of #2364\r\n            console.warn(e);\r\n        }\r\n        return getNewToken(messaging.firebaseDependencies, subscriptionOptions);\r\n    }\r\n    else if (Date.now() >= tokenDetails.createTime + TOKEN_EXPIRATION_MS) {\r\n        // Weekly token refresh\r\n        return updateToken(messaging, {\r\n            token: tokenDetails.token,\r\n            createTime: Date.now(),\r\n            subscriptionOptions\r\n        });\r\n    }\r\n    else {\r\n        // Valid token, nothing to do.\r\n        return tokenDetails.token;\r\n    }\r\n}\r\n/**\r\n * This method deletes the token from the database, unsubscribes the token from FCM, and unregisters\r\n * the push subscription if it exists.\r\n */\r\nasync function deleteTokenInternal(messaging) {\r\n    const tokenDetails = await dbGet(messaging.firebaseDependencies);\r\n    if (tokenDetails) {\r\n        await requestDeleteToken(messaging.firebaseDependencies, tokenDetails.token);\r\n        await dbRemove(messaging.firebaseDependencies);\r\n    }\r\n    // Unsubscribe from the push subscription.\r\n    const pushSubscription = await messaging.swRegistration.pushManager.getSubscription();\r\n    if (pushSubscription) {\r\n        return pushSubscription.unsubscribe();\r\n    }\r\n    // If there's no SW, consider it a success.\r\n    return true;\r\n}\r\nasync function updateToken(messaging, tokenDetails) {\r\n    try {\r\n        const updatedToken = await requestUpdateToken(messaging.firebaseDependencies, tokenDetails);\r\n        const updatedTokenDetails = Object.assign(Object.assign({}, tokenDetails), { token: updatedToken, createTime: Date.now() });\r\n        await dbSet(messaging.firebaseDependencies, updatedTokenDetails);\r\n        return updatedToken;\r\n    }\r\n    catch (e) {\r\n        await deleteTokenInternal(messaging);\r\n        throw e;\r\n    }\r\n}\r\nasync function getNewToken(firebaseDependencies, subscriptionOptions) {\r\n    const token = await requestGetToken(firebaseDependencies, subscriptionOptions);\r\n    const tokenDetails = {\r\n        token,\r\n        createTime: Date.now(),\r\n        subscriptionOptions\r\n    };\r\n    await dbSet(firebaseDependencies, tokenDetails);\r\n    return tokenDetails.token;\r\n}\r\n/**\r\n * Gets a PushSubscription for the current user.\r\n */\r\nasync function getPushSubscription(swRegistration, vapidKey) {\r\n    const subscription = await swRegistration.pushManager.getSubscription();\r\n    if (subscription) {\r\n        return subscription;\r\n    }\r\n    return swRegistration.pushManager.subscribe({\r\n        userVisibleOnly: true,\r\n        // Chrome <= 75 doesn't support base64-encoded VAPID key. For backward compatibility, VAPID key\r\n        // submitted to pushManager#subscribe must be of type Uint8Array.\r\n        applicationServerKey: base64ToArray(vapidKey)\r\n    });\r\n}\r\n/**\r\n * Checks if the saved tokenDetails object matches the configuration provided.\r\n */\r\nfunction isTokenValid(dbOptions, currentOptions) {\r\n    const isVapidKeyEqual = currentOptions.vapidKey === dbOptions.vapidKey;\r\n    const isEndpointEqual = currentOptions.endpoint === dbOptions.endpoint;\r\n    const isAuthEqual = currentOptions.auth === dbOptions.auth;\r\n    const isP256dhEqual = currentOptions.p256dh === dbOptions.p256dh;\r\n    return isVapidKeyEqual && isEndpointEqual && isAuthEqual && isP256dhEqual;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction externalizePayload(internalPayload) {\r\n    const payload = {\r\n        from: internalPayload.from,\r\n        // eslint-disable-next-line camelcase\r\n        collapseKey: internalPayload.collapse_key,\r\n        // eslint-disable-next-line camelcase\r\n        messageId: internalPayload.fcmMessageId\r\n    };\r\n    propagateNotificationPayload(payload, internalPayload);\r\n    propagateDataPayload(payload, internalPayload);\r\n    propagateFcmOptions(payload, internalPayload);\r\n    return payload;\r\n}\r\nfunction propagateNotificationPayload(payload, messagePayloadInternal) {\r\n    if (!messagePayloadInternal.notification) {\r\n        return;\r\n    }\r\n    payload.notification = {};\r\n    const title = messagePayloadInternal.notification.title;\r\n    if (!!title) {\r\n        payload.notification.title = title;\r\n    }\r\n    const body = messagePayloadInternal.notification.body;\r\n    if (!!body) {\r\n        payload.notification.body = body;\r\n    }\r\n    const image = messagePayloadInternal.notification.image;\r\n    if (!!image) {\r\n        payload.notification.image = image;\r\n    }\r\n    const icon = messagePayloadInternal.notification.icon;\r\n    if (!!icon) {\r\n        payload.notification.icon = icon;\r\n    }\r\n}\r\nfunction propagateDataPayload(payload, messagePayloadInternal) {\r\n    if (!messagePayloadInternal.data) {\r\n        return;\r\n    }\r\n    payload.data = messagePayloadInternal.data;\r\n}\r\nfunction propagateFcmOptions(payload, messagePayloadInternal) {\r\n    var _a, _b, _c, _d, _e;\r\n    // fcmOptions.link value is written into notification.click_action. see more in b/232072111\r\n    if (!messagePayloadInternal.fcmOptions &&\r\n        !((_a = messagePayloadInternal.notification) === null || _a === void 0 ? void 0 : _a.click_action)) {\r\n        return;\r\n    }\r\n    payload.fcmOptions = {};\r\n    const link = (_c = (_b = messagePayloadInternal.fcmOptions) === null || _b === void 0 ? void 0 : _b.link) !== null && _c !== void 0 ? _c : (_d = messagePayloadInternal.notification) === null || _d === void 0 ? void 0 : _d.click_action;\r\n    if (!!link) {\r\n        payload.fcmOptions.link = link;\r\n    }\r\n    // eslint-disable-next-line camelcase\r\n    const analyticsLabel = (_e = messagePayloadInternal.fcmOptions) === null || _e === void 0 ? void 0 : _e.analytics_label;\r\n    if (!!analyticsLabel) {\r\n        payload.fcmOptions.analyticsLabel = analyticsLabel;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction isConsoleMessage(data) {\r\n    // This message has a campaign ID, meaning it was sent using the Firebase Console.\r\n    return typeof data === 'object' && !!data && CONSOLE_CAMPAIGN_ID in data;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n_mergeStrings('hts/frbslgigp.ogepscmv/ieo/eaylg', 'tp:/ieaeogn-agolai.o/1frlglgc/o');\r\n_mergeStrings('AzSCbw63g1R0nCw85jG8', 'Iaya3yLKwmgvh7cF0q4');\r\nfunction _mergeStrings(s1, s2) {\r\n    const resultArray = [];\r\n    for (let i = 0; i < s1.length; i++) {\r\n        resultArray.push(s1.charAt(i));\r\n        if (i < s2.length) {\r\n            resultArray.push(s2.charAt(i));\r\n        }\r\n    }\r\n    return resultArray.join('');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction extractAppConfig(app) {\r\n    if (!app || !app.options) {\r\n        throw getMissingValueError('App Configuration Object');\r\n    }\r\n    if (!app.name) {\r\n        throw getMissingValueError('App Name');\r\n    }\r\n    // Required app config keys\r\n    const configKeys = [\r\n        'projectId',\r\n        'apiKey',\r\n        'appId',\r\n        'messagingSenderId'\r\n    ];\r\n    const { options } = app;\r\n    for (const keyName of configKeys) {\r\n        if (!options[keyName]) {\r\n            throw getMissingValueError(keyName);\r\n        }\r\n    }\r\n    return {\r\n        appName: app.name,\r\n        projectId: options.projectId,\r\n        apiKey: options.apiKey,\r\n        appId: options.appId,\r\n        senderId: options.messagingSenderId\r\n    };\r\n}\r\nfunction getMissingValueError(valueName) {\r\n    return ERROR_FACTORY.create(\"missing-app-config-values\" /* MISSING_APP_CONFIG_VALUES */, {\r\n        valueName\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nclass MessagingService {\r\n    constructor(app, installations, analyticsProvider) {\r\n        // logging is only done with end user consent. Default to false.\r\n        this.deliveryMetricsExportedToBigQueryEnabled = false;\r\n        this.onBackgroundMessageHandler = null;\r\n        this.onMessageHandler = null;\r\n        this.logEvents = [];\r\n        this.isLogServiceStarted = false;\r\n        const appConfig = extractAppConfig(app);\r\n        this.firebaseDependencies = {\r\n            app,\r\n            appConfig,\r\n            installations,\r\n            analyticsProvider\r\n        };\r\n    }\r\n    _delete() {\r\n        return Promise.resolve();\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function registerDefaultSw(messaging) {\r\n    var _a;\r\n    try {\r\n        messaging.swRegistration = await navigator.serviceWorker.register(DEFAULT_SW_PATH, {\r\n            scope: DEFAULT_SW_SCOPE\r\n        });\r\n        // The timing when browser updates sw when sw has an update is unreliable from experiment. It\r\n        // leads to version conflict when the SDK upgrades to a newer version in the main page, but sw\r\n        // is stuck with the old version. For example,\r\n        // https://github.com/firebase/firebase-js-sdk/issues/2590 The following line reliably updates\r\n        // sw if there was an update.\r\n        messaging.swRegistration.update().catch(() => {\r\n            /* it is non blocking and we don't care if it failed */\r\n        });\r\n    }\r\n    catch (e) {\r\n        throw ERROR_FACTORY.create(\"failed-service-worker-registration\" /* FAILED_DEFAULT_REGISTRATION */, {\r\n            browserErrorMessage: (_a = e) === null || _a === void 0 ? void 0 : _a.message\r\n        });\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function updateSwReg(messaging, swRegistration) {\r\n    if (!swRegistration && !messaging.swRegistration) {\r\n        await registerDefaultSw(messaging);\r\n    }\r\n    if (!swRegistration && !!messaging.swRegistration) {\r\n        return;\r\n    }\r\n    if (!(swRegistration instanceof ServiceWorkerRegistration)) {\r\n        throw ERROR_FACTORY.create(\"invalid-sw-registration\" /* INVALID_SW_REGISTRATION */);\r\n    }\r\n    messaging.swRegistration = swRegistration;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function updateVapidKey(messaging, vapidKey) {\r\n    if (!!vapidKey) {\r\n        messaging.vapidKey = vapidKey;\r\n    }\r\n    else if (!messaging.vapidKey) {\r\n        messaging.vapidKey = DEFAULT_VAPID_KEY;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function getToken$1(messaging, options) {\r\n    if (!navigator) {\r\n        throw ERROR_FACTORY.create(\"only-available-in-window\" /* AVAILABLE_IN_WINDOW */);\r\n    }\r\n    if (Notification.permission === 'default') {\r\n        await Notification.requestPermission();\r\n    }\r\n    if (Notification.permission !== 'granted') {\r\n        throw ERROR_FACTORY.create(\"permission-blocked\" /* PERMISSION_BLOCKED */);\r\n    }\r\n    await updateVapidKey(messaging, options === null || options === void 0 ? void 0 : options.vapidKey);\r\n    await updateSwReg(messaging, options === null || options === void 0 ? void 0 : options.serviceWorkerRegistration);\r\n    return getTokenInternal(messaging);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function logToScion(messaging, messageType, data) {\r\n    const eventType = getEventType(messageType);\r\n    const analytics = await messaging.firebaseDependencies.analyticsProvider.get();\r\n    analytics.logEvent(eventType, {\r\n        /* eslint-disable camelcase */\r\n        message_id: data[CONSOLE_CAMPAIGN_ID],\r\n        message_name: data[CONSOLE_CAMPAIGN_NAME],\r\n        message_time: data[CONSOLE_CAMPAIGN_TIME],\r\n        message_device_time: Math.floor(Date.now() / 1000)\r\n        /* eslint-enable camelcase */\r\n    });\r\n}\r\nfunction getEventType(messageType) {\r\n    switch (messageType) {\r\n        case MessageType.NOTIFICATION_CLICKED:\r\n            return 'notification_open';\r\n        case MessageType.PUSH_RECEIVED:\r\n            return 'notification_foreground';\r\n        default:\r\n            throw new Error();\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function messageEventListener(messaging, event) {\r\n    const internalPayload = event.data;\r\n    if (!internalPayload.isFirebaseMessaging) {\r\n        return;\r\n    }\r\n    if (messaging.onMessageHandler &&\r\n        internalPayload.messageType === MessageType.PUSH_RECEIVED) {\r\n        if (typeof messaging.onMessageHandler === 'function') {\r\n            messaging.onMessageHandler(externalizePayload(internalPayload));\r\n        }\r\n        else {\r\n            messaging.onMessageHandler.next(externalizePayload(internalPayload));\r\n        }\r\n    }\r\n    // Log to Scion if applicable\r\n    const dataPayload = internalPayload.data;\r\n    if (isConsoleMessage(dataPayload) &&\r\n        dataPayload[CONSOLE_CAMPAIGN_ANALYTICS_ENABLED] === '1') {\r\n        await logToScion(messaging, internalPayload.messageType, dataPayload);\r\n    }\r\n}\n\nconst name = \"@firebase/messaging\";\nconst version = \"0.11.0\";\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst WindowMessagingFactory = (container) => {\r\n    const messaging = new MessagingService(container.getProvider('app').getImmediate(), container.getProvider('installations-internal').getImmediate(), container.getProvider('analytics-internal'));\r\n    navigator.serviceWorker.addEventListener('message', e => messageEventListener(messaging, e));\r\n    return messaging;\r\n};\r\nconst WindowMessagingInternalFactory = (container) => {\r\n    const messaging = container\r\n        .getProvider('messaging')\r\n        .getImmediate();\r\n    const messagingInternal = {\r\n        getToken: (options) => getToken$1(messaging, options)\r\n    };\r\n    return messagingInternal;\r\n};\r\nfunction registerMessagingInWindow() {\r\n    _registerComponent(new Component('messaging', WindowMessagingFactory, \"PUBLIC\" /* PUBLIC */));\r\n    _registerComponent(new Component('messaging-internal', WindowMessagingInternalFactory, \"PRIVATE\" /* PRIVATE */));\r\n    registerVersion(name, version);\r\n    // BUILD_TARGET will be replaced by values like esm5, esm2017, cjs5, etc during the compilation\r\n    registerVersion(name, version, 'esm2017');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Checks if all required APIs exist in the browser.\r\n * @returns a Promise that resolves to a boolean.\r\n *\r\n * @public\r\n */\r\nasync function isWindowSupported() {\r\n    try {\r\n        // This throws if open() is unsupported, so adding it to the conditional\r\n        // statement below can cause an uncaught error.\r\n        await validateIndexedDBOpenable();\r\n    }\r\n    catch (e) {\r\n        return false;\r\n    }\r\n    // firebase-js-sdk/issues/2393 reveals that idb#open in Safari iframe and Firefox private browsing\r\n    // might be prohibited to run. In these contexts, an error would be thrown during the messaging\r\n    // instantiating phase, informing the developers to import/call isSupported for special handling.\r\n    return (typeof window !== 'undefined' &&\r\n        isIndexedDBAvailable() &&\r\n        areCookiesEnabled() &&\r\n        'serviceWorker' in navigator &&\r\n        'PushManager' in window &&\r\n        'Notification' in window &&\r\n        'fetch' in window &&\r\n        ServiceWorkerRegistration.prototype.hasOwnProperty('showNotification') &&\r\n        PushSubscription.prototype.hasOwnProperty('getKey'));\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function deleteToken$1(messaging) {\r\n    if (!navigator) {\r\n        throw ERROR_FACTORY.create(\"only-available-in-window\" /* AVAILABLE_IN_WINDOW */);\r\n    }\r\n    if (!messaging.swRegistration) {\r\n        await registerDefaultSw(messaging);\r\n    }\r\n    return deleteTokenInternal(messaging);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction onMessage$1(messaging, nextOrObserver) {\r\n    if (!navigator) {\r\n        throw ERROR_FACTORY.create(\"only-available-in-window\" /* AVAILABLE_IN_WINDOW */);\r\n    }\r\n    messaging.onMessageHandler = nextOrObserver;\r\n    return () => {\r\n        messaging.onMessageHandler = null;\r\n    };\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Retrieves a Firebase Cloud Messaging instance.\r\n *\r\n * @returns The Firebase Cloud Messaging instance associated with the provided firebase app.\r\n *\r\n * @public\r\n */\r\nfunction getMessagingInWindow(app = getApp()) {\r\n    // Conscious decision to make this async check non-blocking during the messaging instance\r\n    // initialization phase for performance consideration. An error would be thrown latter for\r\n    // developer's information. Developers can then choose to import and call `isSupported` for\r\n    // special handling.\r\n    isWindowSupported().then(isSupported => {\r\n        // If `isWindowSupported()` resolved, but returned false.\r\n        if (!isSupported) {\r\n            throw ERROR_FACTORY.create(\"unsupported-browser\" /* UNSUPPORTED_BROWSER */);\r\n        }\r\n    }, _ => {\r\n        // If `isWindowSupported()` rejected.\r\n        throw ERROR_FACTORY.create(\"indexed-db-unsupported\" /* INDEXED_DB_UNSUPPORTED */);\r\n    });\r\n    return _getProvider(getModularInstance(app), 'messaging').getImmediate();\r\n}\r\n/**\r\n * Subscribes the {@link Messaging} instance to push notifications. Returns an Firebase Cloud\r\n * Messaging registration token that can be used to send push messages to that {@link Messaging}\r\n * instance.\r\n *\r\n * If a notification permission isn't already granted, this method asks the user for permission. The\r\n * returned promise rejects if the user does not allow the app to show notifications.\r\n *\r\n * @param messaging - The {@link Messaging} instance.\r\n * @param options - Provides an optional vapid key and an optinoal service worker registration\r\n *\r\n * @returns The promise resolves with an FCM registration token.\r\n *\r\n * @public\r\n */\r\nasync function getToken(messaging, options) {\r\n    messaging = getModularInstance(messaging);\r\n    return getToken$1(messaging, options);\r\n}\r\n/**\r\n * Deletes the registration token associated with this {@link Messaging} instance and unsubscribes\r\n * the {@link Messaging} instance from the push subscription.\r\n *\r\n * @param messaging - The {@link Messaging} instance.\r\n *\r\n * @returns The promise resolves when the token has been successfully deleted.\r\n *\r\n * @public\r\n */\r\nfunction deleteToken(messaging) {\r\n    messaging = getModularInstance(messaging);\r\n    return deleteToken$1(messaging);\r\n}\r\n/**\r\n * When a push message is received and the user is currently on a page for your origin, the\r\n * message is passed to the page and an `onMessage()` event is dispatched with the payload of\r\n * the push message.\r\n *\r\n *\r\n * @param messaging - The {@link Messaging} instance.\r\n * @param nextOrObserver - This function, or observer object with `next` defined,\r\n *     is called when a message is received and the user is currently viewing your page.\r\n * @returns To stop listening for messages execute this returned function.\r\n *\r\n * @public\r\n */\r\nfunction onMessage(messaging, nextOrObserver) {\r\n    messaging = getModularInstance(messaging);\r\n    return onMessage$1(messaging, nextOrObserver);\r\n}\n\n/**\r\n * Firebase Cloud Messaging\r\n *\r\n * @packageDocumentation\r\n */\r\nregisterMessagingInWindow();\n\nexport { deleteToken, getMessagingInWindow as getMessaging, getToken, isWindowSupported as isSupported, onMessage };\n//# sourceMappingURL=index.esm2017.js.map\n","const __WEBPACK_NAMESPACE_OBJECT__ = Tinode;","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport default class Alert extends React.PureComponent {\n  render() {\n    return this.props.visible ?\n      <div className=\"alert-container\">\n        <div className=\"alert\">\n          <div className=\"title\">{this.props.title}</div>\n          <div className=\"content\">{this.props.content}</div>\n          <div className=\"dialog-buttons\">\n            {this.props.onReject ?\n              <button className=\"outline\" onClick={this.props.onReject}>\n                {this.props.reject || <FormattedMessage id=\"button_cancel\" defaultMessage=\"Cancel\" description=\"Button [Cancel]\" />}\n              </button>\n              :\n              null\n            }\n            <button className=\"primary\" onClick={this.props.onConfirm}>\n              {this.props.confirm || <FormattedMessage id=\"button_ok\" defaultMessage=\"OK\" description=\"Button [OK]\"  />}\n            </button>\n          </div>\n        </div>\n      </div>\n    :\n    null;\n  }\n};\n","// This is a generated file. Don't edit.\n\nexport const PACKAGE_VERSION = \"0.20.2\";\n","import { PACKAGE_VERSION } from './version.js';\n\n// Name of this application, used in the User-Agent.\nexport const APP_NAME = 'TinodeWeb/' + (PACKAGE_VERSION || '0.17');\n\n// API key. Use https://github.com/tinode/chat/tree/master/keygen to generate your own\nexport const API_KEY = 'AQEAAAABAAD_rAp4DJh05a1HAwFT3A6K';\n\n// The array of possible hosts to connect to.\nexport const KNOWN_HOSTS = {hosted: 'web.tinode.co', local: 'localhost:6060'};\n\n// Default host name and port to connect to.\nexport const DEFAULT_HOST = KNOWN_HOSTS.hosted;\n\n// Enable console logging.\nexport const LOGGING_ENABLED = true;\n\n// Minimum time between two keypress notifications, milliseconds.\nexport const KEYPRESS_DELAY = 3_000;\n// Delay before sending a read notification, milliseconds.\nexport const READ_DELAY = 1_500;\n\n// The default shortest allowed tag length. Matches the value on the server.\nexport const MIN_TAG_LENGTH = 2;\n// The default greatest allowed tag length. Matches the value on the server.\nexport const MAX_TAG_LENGTH = 96;\n// The default maximum number of tags allowed. Matches the value on the server.\nexport const MAX_TAG_COUNT = 16;\n\n// Access mode for P2P subscriptions initiated by the current user.\nexport const DEFAULT_P2P_ACCESS_MODE = 'JRWPS';\n// Access mode for new group topics created by the current user.\nexport const NEW_GRP_ACCESS_MODE = 'JRWPSAO';\n// Access mode for a channel.\nexport const CHANNEL_ACCESS_MODE = 'JR';\n\n// Access mode for no access.\nexport const NO_ACCESS_MODE = 'N';\n\n// Mediaquery breakpoint between desktop and mobile, in px. Should match the value\n// in @media (max-size: 640px) in base.css\nexport const MEDIA_BREAKPOINT = 640;\n// Size of css 'rem' unit in pixels. Default 1rem = 10pt = 13px.\nexport const REM_SIZE = 13;\n\n// Size of the avatar image: when image dimensions are greater or the image is not square, it's resized to\n// a square of this size or less.\nexport const AVATAR_SIZE = 384;\n\n// Maximum size of an avatar in bytes for sending in-band. Bigger avatars will be sent out of band (as uploads).\nexport const MAX_AVATAR_BYTES = 4096;\n\n// Size of the broken_image shown in MessagesView\nexport const BROKEN_IMAGE_SIZE = 32;\n\n// Number of chat messages to fetch in one call.\nexport const MESSAGES_PAGE = 24;\n\n// Default maximum in-band (included directly into the message) attachment size which fits into\n// a message of 256K in size. Used when the server-provided value is unavailable. The actual\n// binary size of the attachment should be smaller due to base64 encoding expansion and some overhead,\n// for instance 1024 bytes.\n// Increase this limit to a greater value in production, if desired. Also increase\n// max_message_size in the server config.\nexport const MAX_INBAND_ATTACHMENT_SIZE = 262_144;\n\n// Default absolute maximum attachment size to be used with the server = 8MB.\n// Used when the server-provided value is unavailable. Increase to something like 100MB in production.\nexport const MAX_EXTERN_ATTACHMENT_SIZE = 1 << 23;\n\n// Maximum allowed linear dimension (pixels) of an image sent inline. Larger images will be shrunk\n// to make the larger dimension fit under this size. You may want to adjust it to 1600 or\n// 2400 for production.\nexport const MAX_IMAGE_DIM = 1024;\n\n// Linear dimensions of image preview: shrink image under this size for previews.\nexport const IMAGE_PREVIEW_DIM = 64;\n\n// Linear dimensions of image thumbnail: shrink image under this size for thumbnails in reply quote previews.\nexport const IMAGE_THUMBNAIL_DIM = 36;\n\n// Maximum number of online users to be shown in a topic title bar. Others will be\n// hidden under \"+X more\"\nexport const MAX_ONLINE_IN_TOPIC = 4;\n\n// Maximum length of user name, topic title, and private comment.\nexport const MAX_TITLE_LENGTH = 60;\n// Maximum length of topic description.\nexport const MAX_TOPIC_DESCRIPTION_LENGTH = 360;\n// Maximum length of user name when displaying a video call.\nexport const MAX_PEER_TITLE_LENGTH = 20;\n\n// Length of message previews in chat list, in characters.\nexport const MESSAGE_PREVIEW_LENGTH = 80;\n\n// Length of a quote in quoted reply (for outgoing messages).\nexport const QUOTED_REPLY_LENGTH = 30;\n// Length of a preview of a forwarded message.\nexport const FORWARDED_PREVIEW_LENGTH = 84;\n\n// Minimum duration of an audio recording in milliseconds (2 sec).\nexport const MIN_DURATION = 2_000;\n// Maximum duration of an audio recording in milliseconds (10 min).\nexport const MAX_DURATION = 600_000;\n\n// Link for \"Contact Us\".\nexport const LINK_CONTACT_US = 'mailto:support@tinode.co';\n\n// Link to Privacy Policy.\nexport const LINK_PRIVACY_POLICY = 'https://tinode.co/privacy.html';\n\n// Link to Terms of Service.\nexport const LINK_TERMS_OF_SERVICE = 'https://tinode.co/terms.html';\n\n","// Context Menu: popup/dropdown menu.\nimport React from 'react';\nimport { injectIntl, defineMessages } from 'react-intl';\n\nimport { REM_SIZE } from '../config.js';\n\nconst messages = defineMessages({\n  info: {\n    id: 'menu_item_info',\n    defaultMessage: 'Info',\n    description: 'Show extended topic information'\n  },\n  clear_messages: {\n    id: 'menu_item_clear_messages',\n    defaultMessage: 'Clear messages',\n    description: 'Delete all messages'\n  },\n  clear_for_all: {\n    id: 'menu_item_clear_messages_for_all',\n    defaultMessage: 'Clear for All',\n    description: 'Delete all message(s) for all members'\n  },\n  delete: {\n    id: 'menu_item_delete',\n    defaultMessage: 'Delete',\n    description: 'Delete selected messages'\n  },\n  delete_for_all: {\n    id: 'menu_item_delete_for_all',\n    defaultMessage: 'Delete for All',\n    description: 'Delete selected message(s) for all members'\n  },\n  send_retry: {\n    id: 'menu_item_send_retry',\n    defaultMessage: 'Retry',\n    description: 'Retry sending message'\n  },\n  mute: {\n    id: 'menu_item_mute',\n    defaultMessage: 'Mute',\n    description: 'Turn off notifications'\n  },\n  unmute: {\n    id: 'menu_item_unmute',\n    defaultMessage: 'Unmute',\n    description: 'Turn notifications on'\n  },\n  reply: {\n    id: 'menu_item_reply',\n    defaultMessage: 'Reply',\n    description: 'Reply to message'\n  },\n  forward: {\n    id: 'menu_item_forward',\n    defaultMessage: 'Forward',\n    description: 'Forward message'\n  },\n  topic_delete: {\n    id: 'menu_item_delete_topic',\n    defaultMessage: 'Delete',\n    description: 'Delete entire topic'\n  },\n  topic_delete_warning: {\n    id: 'topic_delete_warning',\n    defaultMessage: 'Are you sure you want to delete this conversation? It cannot be undone.',\n    description: 'Alert warning when deleting entire topic'\n  },\n  delete_messages_warning: {\n    id: 'delete_messages_warning',\n    defaultMessage: 'Are you sure you want to delete all messages for everyone? It cannot be undone.',\n    description: 'Alert dialog warning when hard-deleting all messages.'\n  },\n  unblock: {\n    id: 'menu_item_unblock',\n    defaultMessage: 'Unblock',\n    description: 'Unblock topic or user'\n  },\n  // Generic string suitable for either topic or user.\n  block: {\n    id: 'menu_item_block',\n    defaultMessage: 'Block',\n    description: 'Block topic or user'\n  },\n  topic_block_warning: {\n    id: 'topic_block_warning',\n    defaultMessage: 'Are you sure you want to block this conversation?',\n    description: 'Alert warning when blocking a topic.'\n  },\n  member_delete: {\n    id: 'menu_item_member_delete',\n    defaultMessage: 'Remove',\n    description: 'Remove user from topic'\n  },\n  archive: {\n    id: 'menu_item_archive_topic',\n    defaultMessage: 'Archive',\n    description: 'Move topic from the list of active chats to archive'\n  },\n  unarchive: {\n    id: 'menu_item_restore_topic',\n    defaultMessage: 'Restore',\n    description: 'Restore topic from archive'\n  },\n  edit_permissions: {\n    id: 'menu_item_edit_permissions',\n    defaultMessage: 'Edit permissions',\n    description: 'Menu item [Edit permissions]'\n  },\n  clear_messages_warning: {\n    id: 'clear_messages_warning',\n    defaultMessage: 'Are you sure you want to clear all messages? It cannot be undone.',\n    description: 'Alert dialog warning when deleting all messages.'\n  },\n});\n\nclass ContextMenu extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.selfRef = React.createRef();\n\n    const {formatMessage} = props.intl;\n\n    this.handlePageClick = this.handlePageClick.bind(this);\n    this.handleEscapeKey = this.handleEscapeKey.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n\n    // Preconfigured menu items.\n    this.MenuItems = {\n      'topic_info': {\n        id: 'topic_info',\n        title: formatMessage(messages.info),\n        handler: null\n      },\n      'messages_clear': {\n        id: 'messages_clear',\n        title: formatMessage(messages.clear_messages),\n        handler: (params, errorHandler) => {\n          return props.onShowAlert(\n            formatMessage(messages.clear_messages), // title\n            formatMessage(messages.clear_messages_warning), // content\n            (_ => { this.deleteMessages(true, false, params, errorHandler); }), // onConfirm\n            null, // \"OK\"\n            true, // Show Reject button\n            null  // \"Cancel\"\n          );\n        }\n      },\n      'messages_clear_hard': {\n        id: 'messages_clear_hard',\n        title: formatMessage(messages.clear_for_all),\n        handler: (params, errorHandler) => {\n          return props.onShowAlert(\n            formatMessage(messages.clear_for_all), // title\n            formatMessage(messages.delete_messages_warning), // content\n            (_ => { return this.deleteMessages(true, true, params, errorHandler); }),\n            null, // \"OK\"\n            true, // Show Reject button\n            null  // \"Cancel\"\n          );\n        }\n      },\n      'message_delete': {\n        id: 'message_delete',\n        title: formatMessage(messages.delete),\n        handler: (params, errorHandler) => {\n          return this.deleteMessages(false, false, params, errorHandler);\n        }\n      },\n      'message_delete_hard': {\n        id: 'message_delete_hard',\n        title: formatMessage(messages.delete_for_all),\n        handler: (params, errorHandler) => {\n          return this.deleteMessages(false, true, params, errorHandler);\n        }\n      },\n      'menu_item_send_retry': {\n        id: 'menu_item_send_retry',\n        title: formatMessage(messages.send_retry),\n        handler: (params, errorHandler) => {\n          return this.retryMessage(params, errorHandler);\n        }\n      },\n      'menu_item_reply': {\n        id: 'menu_item_reply',\n        title: formatMessage(messages.reply),\n        handler: (params, errorHandler) => {\n          return this.replyToMessage(params, errorHandler);\n        }\n      },\n      'menu_item_forward': {\n        id: 'menu_item_forward',\n        title: formatMessage(messages.forward),\n        handler: () => {} /* the action is taken directly in tinode-web */\n      },\n      'topic_unmute': {\n        id: 'topic_unmute',\n        title: formatMessage(messages.unmute),\n        handler: this.topicPermissionSetter.bind(this, '+P')\n      },\n      'topic_mute': {\n        id: 'topic_mute',\n        title: formatMessage(messages.mute),\n        handler: this.topicPermissionSetter.bind(this, '-P')\n      },\n      'topic_unblock': {\n        id: 'topic_unblock',\n        title: formatMessage(messages.unblock),\n        handler: this.topicPermissionSetter.bind(this, '+JP')\n      },\n      'topic_block': {\n        id: 'topic_block',\n        title: formatMessage(messages.block),\n        handler: (params, errorHandler) => {\n          return props.onShowAlert(\n            formatMessage(messages.block), // title\n            formatMessage(messages.topic_block_warning), // content\n            (() => {\n              return this.topicPermissionSetter('-JP', params, errorHandler).then((ctrl) => {\n                this.props.onTopicRemoved(params.topicName);\n                return ctrl;\n              });\n            }),\n            null, // \"OK\"\n            true, // Show Reject button\n            null  // \"Cancel\"\n          );\n        }\n      },\n      'topic_delete': {\n        id: 'topic_delete',\n        title: formatMessage(messages.topic_delete),\n        handler: (params, errorHandler) => {\n          return props.onShowAlert(\n            formatMessage(messages.topic_delete), // title\n            formatMessage(messages.topic_delete_warning), // content\n            (() => {\n              const topic = this.props.tinode.getTopic(params.topicName);\n              if (!topic) {\n                console.warn(\"Topic not found: \", params.topicName);\n                return;\n              }\n              return topic.delTopic(true).catch((err) => {\n                if (errorHandler) {\n                  errorHandler(err.message, 'err');\n                }\n              });\n            }),\n            null, // \"OK\"\n            true, // Show Reject button\n            null  // \"Cancel\"\n          );\n        }\n      },\n      'topic_archive': {\n        id: 'topic_archive',\n        title: formatMessage(messages.archive),\n        handler: (params, errorHandler) => {\n          const topic = this.props.tinode.getTopic(params.topicName);\n          if (!topic) {\n            console.warn(\"Topic not found: \", params.topicName);\n            return;\n          }\n          return topic.archive(true).catch((err) => {\n            if (errorHandler) {\n              errorHandler(err.message, 'err');\n            }\n          });\n        }\n      },\n      'topic_restore': {\n        id: 'topic_restore',\n        title: formatMessage(messages.unarchive),\n        handler: (params, errorHandler) => {\n          const topic = this.props.tinode.getTopic(params.topicName);\n          if (!topic) {\n            console.warn(\"Topic not found: \", params.topicName);\n            return;\n          }\n          return topic.archive(false).catch((err) => {\n            if (errorHandler) {\n              errorHandler(err.message, 'err');\n            }\n          });\n        }\n      },\n      // menu_item_edit_permissions is defined elsewhere.\n      'permissions': {\n        id: 'permissions',\n        title: formatMessage(messages.edit_permissions),\n        handler: null\n      },\n      'member_delete': {\n        id: 'member_delete',\n        title: formatMessage(messages.member_delete),\n        handler: (params, errorHandler) => {\n          const topic = this.props.tinode.getTopic(params.topicName);\n          if (!topic || !params.user) {\n            console.warn(\"Topic or user not found: '\" + params.topicName + \"', '\" + params.user + \"'\");\n            return;\n          }\n          return topic.delSubscription(params.user).catch((err) => {\n            if (errorHandler) {\n              errorHandler(err.message, 'err');\n            }\n          });\n        }\n      },\n      'member_mute': {\n        id: 'member_mute',\n        title: formatMessage(messages.mute),\n        handler: this.topicPermissionSetter.bind(this, '-P')\n      },\n      'member_unmute': {\n        id: 'member_unmute',\n        title: formatMessage(messages.unmute),\n        handler: this.topicPermissionSetter.bind(this, '+P')\n      },\n      'member_block': {\n        id: 'member_block',\n        title: formatMessage(messages.block),\n        handler: this.topicPermissionSetter.bind(this, '-JP')\n      },\n      'member_unblock': {\n        id: 'member_unblock',\n        title: formatMessage(messages.unblock),\n        handler: this.topicPermissionSetter.bind(this, '+JP')\n      },\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.handlePageClick, false);\n    document.addEventListener('keyup', this.handleEscapeKey, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.handlePageClick, false);\n    document.removeEventListener('keyup', this.handleEscapeKey, false);\n  }\n\n  handlePageClick(e) {\n    if (this.selfRef.current.contains(e.target)) {\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.hide();\n  }\n\n  handleEscapeKey(e) {\n    if (e.keyCode === 27) {\n      this.props.hide();\n    }\n  }\n\n  handleClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.hide();\n    let item = this.props.items[e.currentTarget.dataset.id];\n    if (typeof item == 'string') {\n      item = this.MenuItems[item];\n    }\n\n    if (!item) {\n      console.error(\"Invalid menu item ID\", e.currentTarget.dataset.id);\n    } else {\n      this.props.onAction(\n        item.id,\n        item.handler(this.props.params, this.props.onError),\n        this.props.params);\n    }\n  }\n\n  // Menu Actions\n\n  deleteMessages(all, hard, params, errorHandler) {\n    const topic = this.props.tinode.getTopic(params.topicName);\n    if (!topic) {\n      console.warn(\"Topic not found: \", params.topicName);\n      return;\n    }\n\n    // We don't know if the message is still pending (e.g. attachment is being uploaded),\n    // so try cancelling first. No harm if we can't cancel.\n    // The message can be cancelled if transmission to the server has not\n    // started yet or if the message send has failed.\n    if (!all && topic.cancelSend(params.seq)) {\n      return;\n    }\n    // Can't cancel. Delete instead.\n    const promise = all ?\n      topic.delMessagesAll(hard) :\n      topic.delMessagesList([params.seq], hard);\n\n    return promise.catch((err) => {\n      if (errorHandler) {\n        errorHandler(err.message, 'err');\n      }\n    });\n  }\n\n  // Retries sending failed message.\n  retryMessage(params, errorHandler) {\n    const topic = this.props.tinode.getTopic(params.topicName);\n    // Remove the existing message entry.\n    if (!topic || !topic.flushMessage(params.seq)) {\n      return;\n    }\n    const msg = topic.createMessage(params.content, false);\n    return topic.publishDraft(msg).catch((err) => {\n      if (errorHandler) {\n        errorHandler(err.message, 'err');\n      }\n    });\n  }\n\n  // Function is used by context menu to set permissions.\n  topicPermissionSetter(mode, params, errorHandler) {\n    const topic = this.props.tinode.getTopic(params.topicName);\n    if (!topic) {\n      console.warn(\"Topic not found\", params.topicName);\n      return;\n    }\n\n    let result = topic.updateMode(params.user, mode);\n    if (errorHandler) {\n      result = result.catch((err) => {\n        errorHandler(err.message, 'err');\n      });\n    }\n    return result;\n  }\n\n  replyToMessage(params, errorHandler) {\n    params.pickReply(params.seq, params.content, params.userFrom, params.userName, errorHandler);\n  }\n\n  render() {\n    const menu = [];\n    let count = 0;\n    this.props.items.map((item) => {\n      if (typeof item == 'string') {\n        item = this.MenuItems[item];\n      }\n      if (item && item.title) {\n        menu.push(\n          item.title == '-' ?\n            <li className=\"separator\" key={count} />\n            :\n            <li onClick={this.handleClick} data-id={count} key={count}>{item.title}</li>\n        );\n      }\n      count++;\n    });\n\n    // Ensure that menu is inside the app-container.\n    const hSize = 12 * REM_SIZE;\n    const vSize = REM_SIZE * (0.7 + menu.length * 2.5);\n    const left = (this.props.bounds.right - this.props.clickAt.x < hSize) ?\n        (this.props.clickAt.x - this.props.bounds.left - hSize) :\n        (this.props.clickAt.x - this.props.bounds.left);\n    const top = (this.props.bounds.bottom - this.props.clickAt.y < vSize) ?\n        (this.props.clickAt.y - this.props.bounds.top - vSize) :\n        (this.props.clickAt.y - this.props.bounds.top);\n\n    const position = {\n      left: left + 'px',\n      top: top + 'px'\n    };\n\n    return (\n      <ul className=\"menu\" style={position} ref={this.selfRef}>\n        {menu}\n      </ul>\n    );\n  }\n}\n\nexport default injectIntl(ContextMenu);\n","import React from 'react';\n\nconst icon_mapping = {'muted': 'notifications_off', 'banned': 'block', 'staff': 'verified_user'};\n\n/* Contact's labels: [you], or icons [muted], [blocked] */\nexport default class ContactBadges extends React.PureComponent {\n  render() {\n    let badges = null;\n    if (this.props.badges && this.props.badges.length > 0) {\n      badges = [];\n      this.props.badges.map((b) => {\n        const color = (b.color ? ' ' + b.color : '');\n        if (b.icon) {\n          badges.push(<i className={'material-icons as-badge' + color} key={b.key || b.icon}>{icon_mapping[b.icon] || b.icon}</i>);\n        } else {\n          badges.push(<span className={'badge' + color} key={b.key || b.name}>{b.name}</span>);\n        }\n      });\n      return <>{badges}</>;\n    }\n    return null;\n  }\n};\n","// Short representation of time in the past.\nexport function shortDateFormat(then, locale) {\n  locale = locale || window.navigator.userLanguage || window.navigator.language;\n  const now = new Date();\n  if (then.getFullYear() == now.getFullYear()) {\n    // Same year.\n    if (then.getMonth() == now.getMonth() && then.getDate() == now.getDate()) {\n      // Same month and day, show time only.\n      return then.toLocaleTimeString(locale, {hour12: false, hour: '2-digit', minute: '2-digit'});\n    }\n    // Different month and/or day, show month day, time.\n    return then.toLocaleDateString(locale,\n      {hour12: false, month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit'});\n  }\n  // Different year: just show the date.\n  return then.toLocaleDateString(locale, {year: 'numeric', month: 'short', day: 'numeric'});\n}\n\n// Convert seconds to [hours:]minutes:seconds, i.e. 156 sec -> 2:36, 3756 sec -> 1:02:36.\n// If <code>fixedMins</code> is true, then minutes are represented by at least two digits.\nexport function secondsToTime(seconds, fixedMin) {\n  let min = Math.floor(seconds / 60) | 0;\n  let hours = Math.floor(min / 60) | 0;\n\n  if (fixedMin || hours > 0) {\n    min = min < 10 ? `0${min}` : min;\n  }\n  let sec = (seconds % 60) | 0;\n  sec = sec < 10 ? `0${sec}` : sec;\n  if (hours == 0) {\n    return `${min}:${sec}`;\n  }\n  return `${hours}:${min}:${sec}`;\n}\n\n// Convert a number of bytes to human-readable format.\nexport function bytesToHumanSize(bytes) {\n  if (!bytes || bytes == 0) {\n    return '0 Bytes';\n  }\n\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];\n  const bucket = Math.min(Math.floor(Math.log2(bytes) / 10) | 0, sizes.length-1);\n  const count = bytes / Math.pow(1024, bucket);\n  const round = bucket > 0 ? (count < 3 ? 2 : (count < 30 ? 1 : 0)) : 0;\n  return count.toFixed(round) + ' ' + sizes[bucket];\n}\n\n// Shorten a file name to be under maxLength by clipping out the middle.\nexport function shortenFileName(filename, maxLength) {\n  if (typeof filename != 'string') {\n    return filename;\n  }\n  return filename.length > maxLength ?\n    filename.slice(0, maxLength/2 - 1) + '…' + filename.slice(1 - maxLength/2) : filename;\n}\n\n// Get 32 bit integer hash value for a string. Ideally it should produce the same value\n// as Java's String#hash().\nfunction stringToColorHash(value) {\n  let hash = 0;\n  value = '' + value;\n  for (let i = 0; i < value.length; i++) {\n    hash = ((hash << 5) - hash) + value.charCodeAt(i);\n    hash = hash & hash; // Convert to 32bit integer\n  }\n  return hash;\n}\n\n// User avatar letter color id.\nexport function letterTileColorId(userId) {\n  return Math.abs(stringToColorHash(userId)) % 16;\n}\n\n// Converts user or topic ID to a CSS color class. Ideally it should produce the same color value as Java version.\n// params:\n// - {string} id: user or topic ID\n// - {boolean} light: light or dark version of the color.\n// - {boolean} fg: foreground (text) or background color.\nexport function idToColorClass(id, light, fg) {\n  return (light ? 'lt-' : 'dk-') + (fg ? 'fg-' : 'bg-') + letterTileColorId(id);\n}\n","// Odds and ends\n\nimport { Tinode } from 'tinode-sdk';\n\n// Make shortcut icon appear with a green dot + show unread count in title.\nexport function updateFavicon(count) {\n  const oldIcon = document.getElementById('shortcut-icon');\n  const head = document.head || document.getElementsByTagName('head')[0];\n  const newIcon = document.createElement('link');\n  newIcon.type = 'image/png';\n  newIcon.id = 'shortcut-icon';\n  newIcon.rel = 'shortcut icon';\n  newIcon.href = 'img/logo32x32' + (count > 0 ? 'a' : '') + '.png';\n  if (oldIcon) {\n    head.removeChild(oldIcon);\n  }\n  head.appendChild(newIcon);\n\n  document.title = (count > 0 ? '('+count+') ' : '') + 'Tinode';\n}\n\n// Create theCard which represents user's or topic's \"public\" info.\nexport function theCard(fn, imageUrl, imageMimeType, note) {\n  let card = null;\n  fn = fn && fn.trim();\n  note = note && note.trim();\n\n  if (fn) {\n    card = {\n      fn: fn\n    };\n  }\n\n  if (typeof note == 'string') {\n    card = card || {};\n    card.note = note ? note : Tinode.DEL_CHAR;\n  }\n\n  if (imageUrl) {\n    card = card || {};\n    let mimeType = imageMimeType;\n    // Is this a data URL \"data:[<mediatype>][;base64],<data>\"?\n    const matches = /^data:(image\\/[-a-z0-9+.]+)?(;base64)?,/i.exec(imageUrl);\n    if (matches) {\n      mimeType = matches[1];\n      card.photo = {\n        data: imageUrl.substring(imageUrl.indexOf(',') + 1),\n        ref: Tinode.DEL_CHAR\n      };\n    } else {\n      card.photo = {\n        data: Tinode.DEL_CHAR,\n        ref: imageUrl\n      };\n    }\n    card.photo.type = (mimeType || 'image/jpeg').substring('image/'.length);\n  }\n\n  return card;\n}\n\n// Deep-shallow compare two arrays: shallow compare each element.\nexport function arrayEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (!Array.isArray(a) || !Array.isArray(b)) {\n    return false;\n  }\n\n  // Compare lengths first.\n  if (a.length != b.length) {\n    return false;\n  }\n  // Order of elements is ignored.\n  a.sort();\n  b.sort();\n  for (let i = 0, l = a.length; i < l; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n// Checks (loosely) if the given string is a phone. If so, returns the phone number in a format\n// as close to E.164 as possible.\nexport function asPhone(val) {\n  val = val.trim();\n  if (/^(?:\\+?(\\d{1,3}))?[- (.]*(\\d{3})[- ).]*(\\d{3})[- .]*(\\d{2})[- .]*(\\d{2})?$/.test(val)) {\n    return val.replace(/[- ().]*/, '');\n  }\n  return null;\n}\n\n// Checks (loosely) if the given string is an email. If so returns the email.\nexport function asEmail(val) {\n  val = val.trim();\n  if (/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$/.test(val)) {\n    return val;\n  }\n  return null;\n}\n\n// Checks if URL is a relative url, i.e. has no 'scheme://', including the case of missing scheme '//'.\n// The scheme is expected to be RFC-compliant, e.g. [a-z][a-z0-9+.-]*\n// example.html - ok\n// https:example.com - not ok.\n// http:/example.com - not ok.\n// ' ↲ https://example.com' - not ok. (↲ means carriage return)\nexport function isUrlRelative(url) {\n  return url && !/^\\s*([a-z][a-z0-9+.-]*:|\\/\\/)/im.test(url);\n}\n\n// Ensure URL does not present an XSS risk. Optional allowedSchemes may contain an array of\n// strings with permitted URL schemes, such as ['ftp', 'ftps']; otherwise accept http and https only.\nexport function sanitizeUrl(url, allowedSchemes) {\n  if (typeof url != 'string') {\n    return url;\n  }\n\n  // Strip control characters and whitespace. They are not valid URL characters anyway.\n  url = url.replace(/[^\\x20-\\x7E]/gmi, '').trim();\n\n  // Relative URLs are safe.\n  // Relative URL does not start with ':', abcd123: or '//'.\n  if (!/^([a-z][a-z0-9+.-]*:|\\/\\/)/i.test(url)) {\n    return url;\n  }\n\n  // Blob URLs are safe.\n  if (/^blob:http/.test(url)) {\n    return url;\n  }\n\n  // Absolute URL. Accept only safe schemes, or no scheme.\n  const schemes = Array.isArray(allowedSchemes) ? allowedSchemes.join('|') : 'http|https';\n  const re = new RegExp('^((' + schemes + '):|//)', 'i');\n  if (!re.test(url)) {\n    return null;\n  }\n\n  return url;\n}\n\n// Ensure URL is suitable as a source like <img src=\"url\"> field: the URL must be a relative URL or\n// have http:, https:, blob: or data: scheme.\n// In case of data: scheme, the URL must must be of the right MIME type such as 'data:{mimeMajor}/XXXX;base64,'.\nexport function sanitizeUrlForMime(url, mimeMajor) {\n  if (!url) {\n    return null;\n  }\n\n  const sanitizedUrl = sanitizeUrl(url);\n  if (sanitizedUrl) {\n    return sanitizedUrl;\n  }\n\n  // Is this a data: URL of the appropriate mime type?\n  const re = new RegExp(`data:${mimeMajor}\\/[a-z0-9.-]+;base64,`, 'i');\n  if (re.test(url.trim())) {\n    return url;\n  }\n\n  return null;\n}\n\n// Given message's received status, return name and color of a delivery indicator icon.\nexport function deliveryMarker(received) {\n  switch (received) {\n    case Tinode.MESSAGE_STATUS_SENDING:\n      return { name: 'access_time' }; // watch face\n    case Tinode.MESSAGE_STATUS_FAILED:\n      return { name: 'warning', color: 'danger-color' }; // yellow icon /!\\\n    case Tinode.MESSAGE_STATUS_SENT:\n      return { name: 'done' }; // checkmark\n    case Tinode.MESSAGE_STATUS_RECEIVED:\n      return { name: 'done_all' }; // double checkmark\n    case Tinode.MESSAGE_STATUS_READ:\n      return { name: 'done_all', color: 'blue' }; // blue double checkmark\n  }\n  return null;\n}\n\n// Wraps a promise to make it cancelable.\n// The parameter can be either a promise or an error. If it's an error, the wrapped promise is\n// created in a rejected state.\nexport function cancelablePromise(promise) {\n  let hasCanceled = false;\n\n  const wrappedPromise = promise instanceof Error ?\n    Promise.reject(promise) :\n    new Promise((resolve, reject) => {\n      promise.then(\n        result => hasCanceled ? reject({isCanceled: true}) : resolve(result),\n        error => hasCanceled ? reject({isCanceled: true}) : reject(error)\n      );\n    });\n\n  return {\n    promise: wrappedPromise,\n    cancel() {\n      hasCanceled = true;\n    },\n  };\n};\n\n// Clips string to the specified length.\nexport function clipStr(str, length) {\n  return str && str.substring(0, length);\n}\n","import React from 'react';\n\nimport { Tinode } from 'tinode-sdk';\n\nimport { idToColorClass } from '../lib/strformat.js';\nimport { sanitizeUrlForMime } from '../lib/utils.js';\n\nexport default class LetterTile extends React.PureComponent {\n  render() {\n    let avatar;\n    if (this.props.avatar === true) {\n      const isGroup = Tinode.isGroupTopicName(this.props.topic);\n      const iconColor = idToColorClass(this.props.topic, isGroup);\n      if (this.props.topic && this.props.title && this.props.title.trim()) {\n        const letter = this.props.title.trim().charAt(0);\n        const className = 'lettertile ' + iconColor + (this.props.deleted ? ' disabled' : '');\n        avatar = (<div className={className}><div>{letter}</div></div>)\n      } else {\n        const className = 'material-icons ' + iconColor + (this.props.deleted ? ' disabled' : '');\n        avatar = isGroup ? <i className={className}>group</i> : <i className={className}>person</i>;\n      }\n    } else if (this.props.avatar) {\n      const url = this.props.tinode.authorizeURL(sanitizeUrlForMime(this.props.avatar, 'image'));\n      // If avatar image is invalid, show a placeholder.\n      const className = 'avatar' + (this.props.deleted ? ' deleted' : '');\n      avatar = <img className={className} alt=\"avatar\" src={url}\n        onError={(e)=>{e.target.onerror = null; e.target.src=\"../img/broken_image.png\"}} />;\n    } else {\n      avatar = null;\n    }\n    return avatar;\n  }\n}\n","// The counter of unread messages in the topic.\nimport React from 'react';\n\nexport default class UnreadBadge extends React.PureComponent {\n  render() {\n    return (this.props.count > 0 ?\n      <span className=\"unread\">{this.props.count > 9 ? \"9+\" : this.props.count}</span>\n      : null);\n  }\n};\n","// File and image helper functions.\n\n// Supported image MIME types and corresponding file extensions.\nexport const SUPPORTED_IMAGE_FORMATS = ['image/jpeg', 'image/gif', 'image/png', 'image/svg', 'image/svg+xml'];\nexport const MIME_EXTENSIONS         = ['jpg',        'gif',       'png',       'svg',       'svg'];\n\n// Get an URL from a theCard photo: either create a data: URL or return reference URL.\nexport function makeImageUrl(photo) {\n  if (photo && typeof photo == 'object') {\n    if (photo.ref) {\n      return photo.ref\n    }\n    if (photo.data && photo.type) {\n      const mime = photo.type.startsWith('image/') ? photo.type : ('image/' + photo.type);\n      return 'data:' + mime + ';base64,' + photo.data;\n    }\n  }\n  return null;\n}\n\n// Calculate linear dimensions for scaling image down to fit under a certain size.\n// Returns an object which contains destination sizes, source sizes, and offsets\n// into source (when making square images).\nexport function fitImageSize(width, height, maxWidth, maxHeight, forceSquare) {\n  // Sanitize input\n  width = width | 0;\n  height = height | 0;\n  maxWidth = maxWidth | 0;\n  maxHeight = maxHeight | 0;\n\n  if (width <= 0 || height <= 0 || maxWidth <= 0 || maxHeight <= 0) {\n    return null;\n  }\n\n  if (forceSquare) {\n    maxWidth = maxHeight = Math.min(maxWidth, maxHeight);\n  }\n\n  const scale = Math.min(\n    Math.min(width, maxWidth) / width,\n    Math.min(height, maxHeight) / height\n  );\n\n  const size = {\n    dstWidth: (width * scale) | 0,\n    dstHeight: (height * scale) | 0,\n  };\n\n  if (forceSquare) {\n    // Also calculate parameters for making the image square.\n    size.dstWidth = size.dstHeight = Math.min(size.dstWidth, size.dstHeight);\n    size.srcWidth = size.srcHeight = Math.min(width, height);\n    size.xoffset = ((width - size.srcWidth) / 2) | 0;\n    size.yoffset = ((height - size.srcWidth) / 2) | 0;\n  } else {\n    size.xoffset = size.yoffset = 0;\n    size.srcWidth = width;\n    size.srcHeight = height;\n  }\n  return size;\n}\n\n// Ensure file's extension matches mime content type\nexport function fileNameForMime(fname, mime) {\n  const idx = SUPPORTED_IMAGE_FORMATS.indexOf(mime);\n  if (idx < 0 || !fname) {\n    // Unknown mime or empty name.\n    return fname;\n  }\n  const ext = MIME_EXTENSIONS[idx];\n\n  const at = fname.lastIndexOf('.');\n  if (at >= 0) {\n    fname = fname.substring(0, at);\n  }\n  return fname + '.' + ext;\n}\n\n// Scale uploaded image to fit under certain dimensions and byte size, optionally constraining to a square.\n// Returns a promise which is resolven on success or rejected on failure.\nexport function imageScaled(fileOrBlob, maxWidth, maxHeight, maxSize, forceSquare) {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.crossOrigin = 'Anonymous';\n    img.onerror = function(err) {\n      reject(new Error(\"Image format unrecognized\"));\n    }\n    img.onload = async function() {\n      // Once the image is loaded, the URL is no longer needed.\n      URL.revokeObjectURL(img.src);\n\n      // Calculate the desired image dimensions.\n      const dim = fitImageSize(img.width, img.height, maxWidth, maxHeight, forceSquare);\n      if (!dim) {\n        reject(new Error(\"Invalid image\"));\n        return;\n      }\n      let canvas = document.createElement('canvas');\n      canvas.width = dim.dstWidth;\n      canvas.height = dim.dstHeight;\n      let ctx = canvas.getContext('2d');\n      ctx.imageSmoothingEnabled = true;\n      ctx.drawImage(img, dim.xoffset, dim.yoffset, dim.srcWidth, dim.srcHeight,\n        0, 0, dim.dstWidth, dim.dstHeight);\n\n      const mime = SUPPORTED_IMAGE_FORMATS.includes(fileOrBlob.type) ? fileOrBlob.type : 'image/jpeg';\n      // Generate blob to check size of the image.\n      let blob = await new Promise(resolve => canvas.toBlob(resolve, mime));\n      if (!blob) {\n        reject(new Error(\"Unsupported image format\"));\n        return;\n      }\n      // Ensure the image is not too large. Shrink the image keeping the aspect ratio.\n      // Do nothing if maxsize is <= 0.\n      while (maxSize > 0 && blob.length > maxSize) {\n        dim.dstWidth = (dim.dstWidth * 0.70710678118) | 0;\n        dim.dstHeight = (dim.dstHeight * 0.70710678118) | 0;\n        canvas.width = dim.dstWidth;\n        canvas.height = dim.dstHeight;\n        ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.drawImage(img, dim.xoffset, dim.yoffset, dim.srcWidth, dim.srcHeight,\n          0, 0, dim.dstWidth, dim.dstHeight);\n        blob = await new Promise(resolve => canvas.toBlob(resolve, mime));\n      }\n\n      canvas = null;\n      resolve({mime: mime, blob: blob, width: dim.dstWidth, height: dim.dstHeight, name: fileNameForMime(fileOrBlob.name, mime)});\n    };\n    img.src = URL.createObjectURL(fileOrBlob);\n  });\n}\n\n// Scale and crop image according to specified dimensions.\n// The coordinates are in unscaled image pixels, i.e. cut the rectangle first then scale it.\n// returns a promise.\nexport function imageCrop(mime, objURL, left, top, width, height, scale) {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.crossOrigin = 'Anonymous';\n    img.onerror = (err) => {\n      reject(new Error(\"Image format unrecognized\"));\n    };\n    img.onload = () => {\n      // Once the image is loaded, the URL is no longer needed.\n      URL.revokeObjectURL(img.src);\n\n      let canvas = document.createElement('canvas');\n      canvas.width = width * scale;\n      canvas.height = height * scale;\n      let ctx = canvas.getContext('2d');\n      ctx.imageSmoothingEnabled = true;\n      ctx.drawImage(img, left, top, width, height, 0, 0, canvas.width, canvas.height);\n\n      mime = SUPPORTED_IMAGE_FORMATS.includes(mime) ? mime : 'image/jpeg';\n      // Generate blob to check size of the image.\n      canvas.toBlob((blob) => {\n        // Allow GC.\n        canvas = null;\n        if (blob) {\n          resolve({mime: mime, blob: blob, width: width, height: height});\n        } else {\n          reject(new Error(\"Unsupported image format\"));\n        }\n      }, mime);\n    };\n    img.src = objURL;\n  });\n}\n\n// Convert file to base64 string.\nexport function fileToBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onerror = (evt) => {\n      reject(reader.error);\n    };\n    reader.onload = () => {\n      resolve({mime: file.type, bits: reader.result.split(',')[1], name: file.name});\n    };\n    reader.readAsDataURL(file);\n  });\n}\n\n// Convert Blob to base64 string. Returns a promise resolved with the base64 string and mime.\nexport function blobToBase64(blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onerror = _ => {\n      reject(reader.error);\n    };\n    reader.onload = () => {\n      resolve({mime: blob.type, bits: reader.result.split(',')[1]});\n    };\n    reader.readAsDataURL(blob);\n  });\n}\n\n// File pasted from the clipboard. It's either an inline image or a file attachment.\nexport function filePasted(event, onImageSuccess, onAttachmentSuccess, onError) {\n  const items = (event.clipboardData || event.originalEvent.clipboardData || {}).items;\n  if (!items || !items.length) {\n    return false;\n  }\n\n  for (let i in items) {\n    const item = items[i];\n    if (item.kind === 'file') {\n      const file = item.getAsFile();\n      if (!file) {\n        console.error(\"Failed to get file object from pasted file item\", item.kind, item.type);\n        onError(\"Failed to get file object from pasted file item\");\n        continue;\n      }\n      if (file.type && file.type.split('/')[0] == 'image') {\n        onImageSuccess(file);\n      } else {\n        onAttachmentSuccess(file);\n      }\n      // Indicate that the pasted data contains a file.\n      return true;\n    }\n  }\n  // No file found.\n  return false;\n}\n\n// Get mime type from data URL header.\nexport function getMimeType(header) {\n  var mime = /^data:(image\\/[-+a-z0-9.]+);base64/.exec(header);\n  return (mime && mime.length > 1) ? mime[1] : null;\n}\n\n// Given length of a binary object in bytes, calculate the length after\n// base64 encoding.\nexport function base64EncodedLen(n) {\n  return Math.floor((n + 2) / 3) * 4;\n}\n\n// Given length of a base64-encoded object, calculate decoded size of the\n// pbject in bytes.\nexport function base64DecodedLen(n) {\n  return Math.floor(n / 4) * 3;\n}\n\n// Re-encode string to standard base64 encoding with padding.\n// The string may be base64-URL encoded without the padding.\nexport function base64ReEncode(str) {\n  if (str) {\n    str = str.replace(/-/g, '+').replace(/_/g, '/');\n    try {\n      str = btoa(atob(str));\n    } catch(err) {\n      console.error(\"Failed to base64 re-encode string.\", err);\n      str = null;\n    }\n  }\n  return str;\n}\n\n// Convert a base64 encoded string with the provided mime type into a Blob.\nexport function base64ToBlob(str, mime) {\n  if (!str) {\n    return null;\n  }\n\n  try {\n    // Make blob.\n    const bin = atob(str);\n    const length = bin.length;\n    const buf = new ArrayBuffer(length);\n    const arr = new Uint8Array(buf);\n    for (let i = 0; i < length; i++) {\n      arr[i] = bin.charCodeAt(i);\n    }\n\n    return new Blob([buf], { type: mime });\n  } catch(err) {\n    console.error(\"Failed to convert base64 to blob: \", err);\n  }\n\n  return null;\n}\n\nexport function intArrayToBase64(arr) {\n  if (!Array.isArray(arr)) {\n    return null;\n  }\n  try {\n    let bin = '';\n    new Uint8Array(arr).forEach(b => bin += String.fromCharCode(b));\n    return window.btoa(bin);\n  } catch (err) {}\n  return null;\n}\n\nexport function base64ToIntArray(b64) {\n  const arr = [];\n  try {\n    const bin =  window.atob(b64);\n    [...bin].forEach(c => {\n      arr.push(c.charCodeAt(0));\n    });\n    return arr;\n  } catch (err) {}\n  return null;\n}\n","// Audio recorder widget.\n\nimport React from 'react';\n\nimport { secondsToTime } from '../lib/strformat';\nimport { base64ToIntArray } from '../lib/blob-helpers';\n\n// Make canvas bigger than the element size to reduce blurring.\nconst CANVAS_UPSCALING = 2.0;\n// Thickness of a visualization bar.\nconst LINE_WIDTH = 3 * CANVAS_UPSCALING;\n// Spacing between two visualization bars.\nconst SPACING = 2 * CANVAS_UPSCALING;\n// Color of histogram bars.\nconst BAR_COLOR = '#888A';\nconst BAR_COLOR_DARK = '#666C';\nconst THUMB_COLOR = '#444E';\n// Minimum number of amplitude bars to draw.\nconst MIN_PREVIEW_LENGTH = 16;\n\nexport default class AudioPlayer extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    let preview = base64ToIntArray(this.props.preview);\n    if (!Array.isArray(preview) || preview.length < MIN_PREVIEW_LENGTH) {\n      preview = null;\n    }\n\n    this.state = {\n      canPlay: false,\n      playing: false,\n      currentTime: '0:00',\n      duration: this.props.duration > 0 ? secondsToTime(this.props.duration / 1000) : '-:--',\n      longMin: this.props.duration >= 600000,\n      preview: preview\n    };\n\n    this.initAudio = this.initAudio.bind(this);\n    this.initCanvas = this.initCanvas.bind(this);\n    this.resampleBars = this.resampleBars.bind(this);\n    this.visualize = this.visualize.bind(this);\n\n    this.handlePlay = this.handlePlay.bind(this);\n    this.handleSeek = this.handleSeek.bind(this);\n    this.handleError = this.handleError.bind(this);\n\n    this.audioPlayer = null;\n\n    this.viewBuffer = [];\n    this.canvasRef = React.createRef();\n  }\n\n  componentDidMount() {\n    if (this.props.src) {\n      this.initAudio();\n    }\n\n    this.initCanvas();\n  }\n\n  componentWillUnmount() {\n    if (this.audioPlayer) {\n      this.audioPlayer.oncanplay = null;\n      this.audioPlayer.ontimeupdate = null;\n      this.audioPlayer.onended = null;\n      this.audioPlayer.pause();\n      this.audioPlayer = null;\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.src != prevProps.src) {\n      this.initAudio();\n    }\n\n    if (this.props.preview != prevProps.preview) {\n      let preview = base64ToIntArray(this.props.preview);\n      if (!Array.isArray(preview) || preview.length < MIN_PREVIEW_LENGTH) {\n        preview = null;\n      }\n      this.setState({preview: preview}, this.initCanvas);\n    }\n  }\n\n  initAudio() {\n    this.audioPlayer = new Audio(this.props.src);\n    this.audioPlayer.oncanplay = _ => this.setState({canPlay: true});\n    this.audioPlayer.ontimeupdate = _ => this.setState({\n      currentTime: secondsToTime(this.audioPlayer.currentTime, this.state.longMin)\n    });\n    this.audioPlayer.onended = _ => {\n      this.audioPlayer.currentTime = 0;\n      this.setState({playing: false, currentTime: secondsToTime(0, this.state.longMin)})\n    }\n  }\n\n  initCanvas() {\n    // Force canvas aspect ratio to match one of the element + upscale canvas to reduce blurring.\n    this.canvasRef.current.width = this.canvasRef.current.offsetWidth * CANVAS_UPSCALING;\n    this.canvasRef.current.height = this.canvasRef.current.offsetHeight * CANVAS_UPSCALING;\n\n    this.canvasContext = this.canvasRef.current.getContext('2d');\n    this.canvasContext.lineCap = 'round';\n\n    this.viewBuffer = this.resampleBars(this.state.preview);\n    this.visualize();\n  }\n\n  // Draw amplitude of sound.\n  visualize() {\n    if (!this.canvasRef.current) {\n      return;\n    }\n\n    const width = this.effectiveWidth;\n    const height = this.canvasRef.current.height;\n\n    this.canvasContext.lineWidth = LINE_WIDTH;\n\n    const drawFrame = () => {\n      if (!this.canvasRef.current || !this.audioPlayer) {\n        // The component is unmounted.\n        return;\n      }\n\n      this.canvasContext.clearRect(0, 0, this.canvasRef.current.width, height);\n\n      if (this.viewBuffer) {\n        if (this.state.playing) {\n          window.requestAnimationFrame(drawFrame);\n        }\n\n        // Current playback position.\n        const thumbAt = this.props.duration ?\n          Math.max(0, Math.min(this.audioPlayer.currentTime * 1000 / this.props.duration, 1)) * (width - LINE_WIDTH * 2) : -1;\n\n        // Draw amplitude bars.\n        this.canvasContext.beginPath();\n        this.canvasContext.strokeStyle = BAR_COLOR_DARK;\n        for (let i = 0; i < this.viewBuffer.length; i++) {\n          let x = 1 + i * (LINE_WIDTH + SPACING) + LINE_WIDTH * 0.5;\n          let y = this.viewBuffer[i] * height * 0.9;\n\n          const color = x < thumbAt ? BAR_COLOR_DARK : BAR_COLOR;\n          if (this.canvasContext.strokeStyle != color) {\n            this.canvasContext.stroke();\n            this.canvasContext.beginPath();\n            this.canvasContext.strokeStyle = color;\n          }\n\n          this.canvasContext.moveTo(x, (height - y) * 0.5);\n          this.canvasContext.lineTo(x, height * 0.5 + y * 0.5);\n        }\n        // Actually draw the bars on canvas.\n        this.canvasContext.stroke();\n\n        // Draw thumb.\n        if (this.props.duration) {\n          this.canvasContext.beginPath();\n          this.canvasContext.arc(thumbAt + LINE_WIDTH * 2, height * 0.5, LINE_WIDTH * 2, 0, 2 * Math.PI);\n          this.canvasContext.fillStyle = THUMB_COLOR;\n          this.canvasContext.fill();\n        }\n      }\n    }\n\n    drawFrame();\n  }\n\n  // Quick and dirty downsampling of the original preview bars into a smaller (or equal) number of bars we can display here.\n  resampleBars(original) {\n    const dstCount = ((this.canvasRef.current.width - SPACING) / (LINE_WIDTH + SPACING)) | 0;\n    // Remove extra padding on the right due to fractional bar which is not drawn.\n    this.effectiveWidth = dstCount * (LINE_WIDTH + SPACING) + SPACING;\n\n    if (!Array.isArray(original) || original.length == 0) {\n      return Array.apply(null, Array(dstCount)).map(_ => 0.01);\n    }\n\n    const factor = original.length / dstCount;\n    let amps = [];\n    let maxAmp = -1;\n    for (let i=0; i<dstCount; i++) {\n      let lo = (i * factor) | 0; // low bound;\n      let hi = ((i + 1) * factor) | 0; // high bound;\n      if (hi == lo) {\n        amps[i] = original[lo];\n      } else {\n        let amp = 0.0;\n        for (let j=lo; j<hi; j++) {\n          amp += original[j]\n        }\n        amps[i] = Math.max(0, amp / (hi - lo));\n      }\n      maxAmp = Math.max(amps[i], maxAmp);\n    }\n\n    if (maxAmp > 0) {\n      return amps.map(a => a / maxAmp);\n    }\n    return Array.apply(null, Array(dstCount)).map(_ => 0.01);\n  }\n\n  handlePlay(e) {\n    e.preventDefault();\n    if (!this.state.canPlay) {\n      return;\n    }\n    if (this.state.playing) {\n      this.audioPlayer.pause();\n      this.setState({playing: false});\n    } else {\n      this.audioPlayer.play();\n      this.setState({playing: true}, this.visualize);\n    }\n  }\n\n  handleError(err) {\n    console.error(err);\n  }\n\n  handleSeek(e) {\n    e.preventDefault();\n    if (e.target && this.props.duration) {\n      const rect = e.target.getBoundingClientRect();\n      const offset = (e.clientX - rect.left) / this.effectiveWidth * CANVAS_UPSCALING;\n      this.audioPlayer.currentTime = this.props.duration * offset / 1000;\n      this.setState({currentTime: secondsToTime(this.audioPlayer.currentTime, this.state.longMin)});\n      if (!this.state.playing) {\n        this.visualize();\n      }\n    }\n  }\n\n  render() {\n    const playClass = 'material-icons' +\n      (this.props.short ? '' : ' large') +\n      (this.state.canPlay ? '' : ' disabled');\n    const play = (<a href=\"#\" onClick={this.handlePlay} title=\"Play\">\n        <i className={playClass}>{this.state.playing ? 'pause_circle' :\n          (this.state.canPlay ? 'play_circle' : 'not_interested')}</i>\n      </a>);\n    return (<div className=\"audio-player\">{this.props.short ?\n      <>\n        <canvas className=\"playback\" ref={this.canvasRef} onClick={this.handleSeek} />\n        {play}\n      </>\n    :\n      <>\n        {play}\n        <div>\n          <canvas className=\"playback\" ref={this.canvasRef} onClick={this.handleSeek} />\n          <div className=\"timer\">{this.state.currentTime}/{this.state.duration}</div>\n        </div>\n      </>\n    }\n    </div>);\n  }\n}\n","// Chat message describing a video or voice call.\n\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport { secondsToTime } from '../lib/strformat.js';\n\nexport default class CallMessage extends React.PureComponent {\n  render() {\n    const isCallDropped = ['declined', 'disconnected', 'missed'].includes(this.props.callState);\n    const successClass = 'material-icons medium ' + (isCallDropped ? 'red' : 'green');\n    const callIcon = this.props.incoming ?\n      (isCallDropped ? 'call_missed' : 'call_received') :\n      (isCallDropped ? 'call_missed_outgoing' : 'call_made');\n    let duration;\n    if (isCallDropped) {\n      switch (this.props.callState) {\n        case 'declined':\n          duration = <FormattedMessage id=\"call_declined\" defaultMessage=\"declined\" description=\"Label for declined call\" />;\n          break;\n        case 'missed':\n          duration = this.props.incoming ?\n            <FormattedMessage id=\"call_missed\" defaultMessage=\"missed\" description=\"Label for missed incoming call\" /> :\n            <FormattedMessage id=\"call_cancelled\" defaultMessage=\"cancelled\" description=\"Label for cancelled outgoing call\" />;\n          break;\n        default:\n          duration = <FormattedMessage id=\"call_disconnected\" defaultMessage=\"disconnected\" description=\"Label for disconnected call\" />;\n          break;\n      }\n    } else {\n      duration = <span>{secondsToTime(this.props.duration / 1000)}</span>;\n    }\n    return <div className=\"call-message\">\n      <div><i className=\"material-icons big gray\">call</i></div>\n      <div className=\"flex-column narrow\">\n        <div>{this.props.incoming ?\n          <FormattedMessage id=\"calls_incoming\" defaultMessage=\"Incoming call\" description=\"Incoming call label\" /> :\n          <FormattedMessage id=\"calls_outgoing\" defaultMessage=\"Outgoing call\" description=\"Outgoing call label\" />\n        }</div>\n        <div className=\"duration\"><i className={successClass}>{callIcon}</i> {duration}</div>\n      </div>\n    </div>;\n  }\n}\n","// The counter of unread messages in the topic.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport { secondsToTime } from '../lib/strformat.js';\n\n// Props:\n//  incoming: true | false.\n//  success: true | false.\nexport default class CallStatus extends React.PureComponent {\n  render() {\n    const isCallDropped = ['declined', 'disconnected', 'missed'].includes(this.props.callState);\n    const icon2 = this.props.incoming ?\n      (isCallDropped ? 'call_missed' : 'call_received') :\n      (isCallDropped ? 'call_missed_outgoing' : 'call_made');\n    let duration;\n    if (isCallDropped) {\n      switch (this.props.callState) {\n        case 'declined':\n          duration = <FormattedMessage id=\"call_declined\" defaultMessage=\"declined\" description=\"Label for declined call\" />;\n          break;\n        case 'missed':\n          duration = this.props.incoming ?\n            <FormattedMessage id=\"call_missed\" defaultMessage=\"missed\" description=\"Label for missed incoming call\" /> :\n            <FormattedMessage id=\"call_cancelled\" defaultMessage=\"cancelled\" description=\"Label for cancelled outgoing call\" />;\n          break;\n        default:\n          duration = <FormattedMessage id=\"call_disconnected\" defaultMessage=\"disconnected\" description=\"Label for disconnected call\" />;\n          break;\n      }\n    } else {\n      duration = <span>{secondsToTime(this.props.duration / 1000)}</span>;\n    }\n    return (\n      <>\n        <div className=\"composed-material\">\n          <i className=\"material-icons\">call</i><i className=\"material-icons second\">{icon2}</i>\n        </div> {duration}\n      </>\n    );\n  }\n};\n","// Image with a placeholder which is replaced when the promise is resolved.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport default class LazyImage extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      src: 'img/placeholder.png',\n      style: Object.assign({padding: '4px'}, this.props.style),\n      className: this.props.className,\n      alt: this.props.alt,\n      onClick: this.props.onClick,\n    };\n  }\n\n  componentDidMount() {\n    // whenDone is a wrapper around an actual promise to be able to cancel it.\n    this.props.whenDone\n      .promise\n      .then(data => this.setState({src: data.src, style: {...this.state.style, padding: 0}}))\n      .catch(() => this.setState({src: 'img/broken_image.png'}));\n  }\n\n  componentWillUnmount() {\n    this.props.whenDone.cancel();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.whenDone != this.props.whenDone) {\n      this.setState({src: 'img/placeholder.png', style: {...this.state.style, padding: '4px'}});\n      this.props.whenDone\n        .promise\n        .then(data => this.setState({src: data.src, style: {...this.state.style, padding: 0}}))\n        .catch(() => this.setState({src: 'img/broken_image.png'}));\n    }\n  }\n\n  render() {\n    return React.createElement('img', this.state);\n  }\n};\n","// File uload/download progress indicator with a cancel inside.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport default class FileProgress extends React.PureComponent {\n  render() {\n    return (\n      <div className=\"uploader\">\n        <div><span style={{width: (this.props.progress * 100) + \"%\"}}></span></div>\n        {this.props.progress < 0.999 ?\n          <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onCancel();}}>\n            <i className=\"material-icons\">close</i> <FormattedMessage id=\"action_cancel\"\n              defaultMessage=\"cancel\" description=\"Call to action [cancel]\" />\n          </a>\n          :\n          <FormattedMessage id=\"upload_finishing\" defaultMessage=\"finishing...\"\n            description=\"Notification that upload is finishing\" />\n        }\n      </div>\n    );\n  }\n}\n","// Image view with progress bar and a cancel button.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport FileProgress from './file-progress.jsx';\n\nexport default class UploadingImage extends React.PureComponent {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <div className=\"inline-image\">\n        {React.createElement('img', this.props)}\n        <div className=\"rounded-container\">\n          <FileProgress progress={this.props.progress} onCancel={this.props.onCancelUpload} />\n        </div>\n      </div>\n    );\n  }\n};\n","import React from 'react';\nimport { defineMessages } from 'react-intl';\n\nimport { Drafty } from 'tinode-sdk';\n\nimport AudioPlayer from '../widgets/audio-player.jsx'\nimport CallMessage from '../widgets/call-message.jsx'\nimport CallStatus from '../widgets/call-status.jsx';\nimport LazyImage from '../widgets/lazy-image.jsx'\nimport UploadingImage from '../widgets/uploading-image.jsx'\n\nimport { IMAGE_THUMBNAIL_DIM, BROKEN_IMAGE_SIZE, REM_SIZE } from '../config.js';\nimport { base64ToBlob, blobToBase64, fitImageSize, imageScaled } from './blob-helpers.js';\nimport { idToColorClass, secondsToTime, shortenFileName } from './strformat.js';\nimport { cancelablePromise, sanitizeUrlForMime } from './utils.js';\n\nconst messages = defineMessages({\n  drafty_form: {\n    id: 'drafty_form',\n    defaultMessage: 'Form: ',\n    description: 'Comment for form in drafty'\n  },\n  drafty_attachment: {\n    id: 'drafty_attachment',\n    defaultMessage: 'Attachment',\n    description: 'Comment for attachment in drafty'\n  },\n  drafty_image: {\n    id: 'drafty_image',\n    defaultMessage: 'Picture',\n    description: 'Comment for embedded images in drafty'\n  },\n  drafty_unknown: {\n    id: 'drafty_unknown',\n    defaultMessage: 'Unsupported',\n    description: 'Unsupported entity in drafty'\n  }\n});\n\n// Additional processing of image data.\nfunction handleImageData(el, data, attr) {\n  if (!data) {\n    attr.src = 'img/broken_image.png';\n    attr.style = {\n      width: IMAGE_THUMBNAIL_DIM + 'px',\n      height: IMAGE_THUMBNAIL_DIM + 'px',\n    };\n    return el;\n  }\n\n  attr.className = 'inline-image';\n  const dim = fitImageSize(data.width, data.height,\n    this.viewportWidth > 0 ? Math.min(this.viewportWidth - REM_SIZE * 6.5, REM_SIZE * 34.5) :\n      REM_SIZE * 34.5, REM_SIZE * 24, false) ||\n      {dstWidth: BROKEN_IMAGE_SIZE, dstHeight: BROKEN_IMAGE_SIZE};\n  attr.style = {\n    width: dim.dstWidth + 'px',\n    height: dim.dstHeight + 'px',\n    // Looks like a Chrome bug: broken image does not respect 'width' and 'height'.\n    minWidth: dim.dstWidth + 'px',\n    minHeight: dim.dstHeight + 'px'\n  };\n  if (!Drafty.isProcessing(data)) {\n    attr.src = this.authorizeURL(sanitizeUrlForMime(attr.src, 'image'));\n    attr.alt = data.name;\n    if (attr.src) {\n      if (Math.max(data.width || 0, data.height || 0) > IMAGE_THUMBNAIL_DIM) {\n        // Allow previews for large enough images.\n        attr.onClick = this.onImagePreview;\n        attr.className += ' image-clickable';\n      }\n      attr.loading = 'lazy';\n    } else {\n      attr.src = 'img/broken_image.png';\n    }\n  } else {\n    // Use custom element instead of <img>.\n    el = UploadingImage;\n  }\n\n  return el;\n}\n\n// The main Drafty formatter: converts Drafty elements into React classes. 'this' is set by the caller.\n// 'this' must contain:\n//    viewportWidth: this.props.viewportWidth;\n//    authorizeURL: this.props.tinode.authorizeURL\n//    onImagePreview: this.handleImagePreview\n//    onFormButtonClick: this.handleFormButtonClick\n//    onQuoteClick: this.handleQuoteClick (optional)\nexport function fullFormatter(style, data, values, key, stack) {\n  if (stack.includes('QQ')) {\n    return quoteFormatter.call(this, style, data, values, key);\n  }\n\n  if (!style) {\n    // Unformatted.\n    return values;\n  }\n\n  let el = Drafty.tagName(style);\n  let attr = Drafty.attrValue(style, data) || {};\n  attr.key = key;\n  switch (style) {\n    case 'AU':\n      // Show audio player.\n      if (attr.src) {\n        attr.src = this.authorizeURL(sanitizeUrlForMime(attr.src, 'audio'));\n        attr.duration = data.duration > 0 ? (data.duration | 0) : undefined;\n        attr.preview = data.preview;\n        attr.loading = 'lazy';\n      }\n      el = AudioPlayer;\n      // Audio element cannot have content.\n      values = null;\n      break;\n    case 'BR':\n      values = null;\n      break;\n    case 'EX':\n      // Ignore.\n      break;\n    case 'HL':\n      // Highlighted text. Assign class name.\n      attr.className = 'highlight';\n      break;\n    case 'HD':\n      el = null;\n      values = null;\n      break;\n    case 'IM':\n      // Additional processing for images\n      el = handleImageData.call(this, el, data, attr);\n      // Image element cannot have content.\n      values = null;\n      break;\n    case 'BN':\n      // Button\n      attr.onClick = this.onFormButtonClick;\n      let inner = React.Children.map(values, (child) => {\n        return typeof child == 'string' ? child : undefined;\n      });\n      if (!inner || inner.length == 0) {\n        inner = [attr.name]\n      }\n      // Get text which will be sent back when the button is clicked.\n      attr['data-title'] = inner.join('');\n      break;\n    case 'MN':\n      // Mention\n      attr.className = 'mention'\n      if (data) {\n        attr.className += ' ' + idToColorClass(data.val, false, true);\n      }\n      break;\n    case 'FM':\n      // Form\n      attr.className = 'bot-form';\n      break;\n    case 'RW':\n      // Form element formatting is dependent on element content.\n      break;\n    case 'QQ':\n      // Quote/citation.\n      attr.className = 'reply-quote'\n      attr.onClick = this.onQuoteClick;\n      break;\n    case 'VC':\n      el = CallMessage;\n      // Video call messages do not have content.\n      values = null;\n      if (data) {\n        attr.callState = data.state;\n        attr.incoming = data.incoming;\n        attr.duration = data.duration;\n      }\n      break;\n    default:\n      if (!el) {\n        // Unknown element.\n        el = React.Fragment;\n        attr = {key: key};\n        // Generate comment for unknown element.\n        let body = values;\n        if (!Array.isArray(values) || !values.join('').trim()) {\n          body = [<span key=\"x1\" className=\"gray\">{this.formatMessage(messages.drafty_unknown)}</span>];\n        }\n        values = [<i key=\"x0\" className=\"material-icons gray\">extension</i>, ' '].concat(body);\n      }\n      break;\n  }\n  if (!el) {\n    return values;\n  }\n  return React.createElement(el, attr, values);\n}\n\n// Converts Drafty object into a one-line preview. 'this' is set by the caller.\n// 'this' must contain:\n//    formatMessage: this.props.intl.formatMessage\n//    messages: formatjs messages defined with defineMessages.\nexport function previewFormatter(style, data, values, key) {\n  if (!style) {\n    // Unformatted.\n    return values;\n  }\n\n  let el = Drafty.tagName(style);\n  const attr = { key: key };\n  switch (style) {\n    case 'AU':\n      // Voicemail as '[mic] 0:00'.\n      el = React.Fragment;\n      values = [<i key=\"au\" className=\"material-icons\">mic</i>, ' ', secondsToTime(data.duration/1000)];\n      break;\n    case 'BR':\n      // Replace new line with a space.\n      el = React.Fragment;\n      values = [' '];\n      break;\n    case 'HL':\n      // Make highlight less prominent in preview.\n      attr.className = 'highlight preview';\n      break;\n    case 'LN':\n    case 'MN':\n      // Disable links in previews.\n      el = 'span';\n      break;\n    case 'IM':\n      // Replace image with '[icon] Image'.\n      el = React.Fragment;\n      values = [<i key=\"im\" className=\"material-icons\">photo</i>, ' ', this.formatMessage(messages.drafty_image)];\n      break;\n    case 'BN':\n      el = 'span';\n      attr.className = 'flat-button faux';\n      break;\n    case 'FM':\n      el = React.Fragment;\n      values = [<i key=\"fm\" className=\"material-icons\">dashboard</i>,\n        this.formatMessage(messages.drafty_form)].concat(' ', values || []);\n      break;\n    case 'RW':\n      el = React.Fragment;\n      break;\n    case 'EX':\n      if (data) {\n        if (data.mime == 'application/json') {\n          // Ignore JSON attachments: they are form response payloads.\n          return null;\n        }\n        // Clear payload.\n        delete data.val;\n        delete data.ref;\n      }\n      el = React.Fragment;\n      values = [<i key=\"ex\" className=\"material-icons\">attachment</i>, ' ', this.formatMessage(messages.drafty_attachment)];\n      break;\n    case 'VC':\n      el = CallStatus;\n      if (data) {\n        attr.callState = data.state;\n        attr.incoming = data.incoming;\n        attr.duration = data.duration;\n      }\n      values = null;\n      break;\n    case 'QQ':\n    case 'HD':\n      el = null;\n      values = null;\n      break;\n    default:\n      if (!el) {\n        // Unknown element.\n        el = React.Fragment;\n        values = [<i key=\"x0\" className=\"material-icons gray\">extension</i>, ' ', this.formatMessage(messages.drafty_unknown)];\n      }\n      break;\n  }\n  if (!el) {\n    return values;\n  }\n  return React.createElement(el, attr, values);\n};\n\n// Converts Drafty object into a quoted reply. 'this' is set by the caller.\nfunction inlineImageAttr(attr, data) {\n  attr.style = {\n    width: IMAGE_THUMBNAIL_DIM + 'px',\n    height: IMAGE_THUMBNAIL_DIM + 'px',\n    maxWidth: IMAGE_THUMBNAIL_DIM + 'px',\n    maxHeight: IMAGE_THUMBNAIL_DIM + 'px',\n  }\n  attr.className = 'inline-image';\n  attr.alt = this.formatMessage(messages.drafty_image);\n  if (!data) {\n    attr.src = 'img/broken_image.png';\n  }\n  attr.title = attr.alt;\n  return attr;\n}\n\n// Displays a portion of Drafty within 'QQ' quotes. 'this' is set by the caller.\n// 'this' must contain:\n//    formatMessage: this.props.intl.formatMessage\n//    messages: formatjs messages defined with defineMessages.\n//    authorizeURL: this.props.tinode.authorizeURL\n//    onQuoteClick: this.handleQuoteClick (optional)\nfunction quoteFormatter(style, data, values, key) {\n  if (['BR', 'EX', 'IM', 'MN'].includes(style)) {\n    let el = Drafty.tagName(style);\n    let attr = Drafty.attrValue(style, data) || {};\n    attr.key = key;\n    switch(style) {\n      case 'BR':\n        values = null;\n        break;\n      case 'IM':\n        attr = inlineImageAttr.call(this, attr, data);\n        values = [React.createElement('img', attr, null), ' ', attr.alt];\n        el = React.Fragment;\n        // Fragment attributes.\n        attr = {key: key};\n        break;\n      case 'MN':\n        el = 'span';\n        attr.className = 'mention'\n        if (data) {\n          attr.className += ' ' + idToColorClass(data.val, false, true);\n        }\n        break;\n      case 'EX':\n        let fname;\n        if (data) {\n          if (data.mime == 'application/json') {\n            // Ignore JSON attachments: they are form response payloads.\n            return null;\n          }\n          fname = data.name;\n          // Clear payload.\n          delete data.val;\n          delete data.ref;\n        }\n        el = React.Fragment;\n        values = [<i key=\"ex\" className=\"material-icons\">attachment</i>,\n          shortenFileName(fname, 16) || this.formatMessage(messages.drafty_attachment)];\n        break;\n    }\n    return React.createElement(el, attr, values);\n  }\n  return previewFormatter.call(this, style, data, values, key);\n}\n\n// Create image thumbnail suitable for inclusion in a quote.\nfunction quoteImage(data) {\n  let promise;\n  // Get the blob from the image data.\n  if (data.val) {\n    const blob = base64ToBlob(data.val, data.mime);\n    if (!blob) {\n      throw new Error(\"Invalid image\");\n    }\n    promise = Promise.resolve(blob);\n  } else if (data.ref) {\n    promise = fetch(this.authorizeURL(sanitizeUrlForMime(data.ref, 'image')))\n      .then(evt => {\n        if (evt.ok) {\n          return evt.blob();\n        } else {\n          throw new Error(`Image fetch unsuccessful: ${evt.status} ${evt.statusText}`);\n        }\n      });\n  } else {\n    throw new Error(\"Missing image data\");\n  }\n\n  // Scale the blob.\n  return promise\n    .then(blob => {\n      // Cut the square from the center of the image and shrink it.\n      return imageScaled(blob, IMAGE_THUMBNAIL_DIM, IMAGE_THUMBNAIL_DIM, -1, true)\n    }).then(scaled => {\n      data.mime = scaled.mime;\n      data.size = scaled.blob.size;\n      data.width = scaled.width;\n      data.height = scaled.height;\n      delete data.ref;\n      // Keeping the original file name, if provided: ex.data.name;\n\n      data.src = URL.createObjectURL(scaled.blob);\n      return blobToBase64(scaled.blob);\n    }).then(b64 => {\n      data.val = b64.bits;\n      return data;\n    }).catch(err => {\n      delete data.val;\n      delete data.src;\n      data.width = IMAGE_THUMBNAIL_DIM;\n      data.height = IMAGE_THUMBNAIL_DIM;\n      // Rethrow.\n      throw err;\n    });\n}\n\n// Create a preview of a reply.\nexport function replyFormatter(style, data, values, key, stack) {\n  if (style == 'IM') {\n    const attr = inlineImageAttr.call(this, {key: key}, data);\n    let loadedPromise;\n    try {\n      loadedPromise = cancelablePromise(quoteImage.call(this, data));\n    } catch (error) {\n      loadedPromise = cancelablePromise(error);\n    }\n    attr.whenDone = loadedPromise;\n    values = [React.createElement(LazyImage, attr, null), ' ', attr.alt];\n    return React.createElement(React.Fragment, {key: key}, values);\n  } else if (style == 'QQ') {\n    if (stack.includes('QQ')) {\n      // Quote inside quote when forwarding a message.\n      return React.createElement('span', {key: key},\n        [<i key=\"qq\" className=\"material-icons\">format_quote</i>, ' ']);\n    }\n\n    const attr = Drafty.attrValue('QQ', data) || {};\n    attr.key = key;\n    attr.className = 'reply-quote'\n    return React.createElement(Drafty.tagName('QQ'), attr, values);\n  }\n  return quoteFormatter.call(this, style, data, values, key);\n}\n","// A single topic or user.\nimport React from 'react';\nimport { FormattedMessage, injectIntl } from 'react-intl';\n\nimport ContactBadges from './contact-badges.jsx';\nimport LetterTile from './letter-tile.jsx';\nimport UnreadBadge from './unread-badge.jsx';\n\nimport { Drafty } from 'tinode-sdk';\n\nimport { previewFormatter } from '../lib/formatters.js';\nimport { deliveryMarker } from '../lib/utils.js';\n\nclass Contact extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleClick = this.handleClick.bind(this);\n    this.handleContextClick = this.handleContextClick.bind(this);\n  }\n\n  handleClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (this.props.onSelected) {\n      // Index this.props.index is used by GroupManager.\n      this.props.onSelected(this.props.item, this.props.index);\n    }\n  }\n\n  handleContextClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.showContextMenu({ topicName: this.props.item, y: e.pageY, x: e.pageX });\n  }\n\n  render() {\n    let title = this.props.title;\n    if (!title) {\n      title = <i><FormattedMessage id=\"unnamed_topic\" defaultMessage=\"Unnamed\"\n        description=\"Title shown when the topic has no name\" /></i>;\n    } else if (title.length > 30) {\n      // FIXME: this is probably wrong for RTL languages.\n      title = title.substring(0, 28) + '…';\n    }\n    const online = this.props.now ? 'online' : 'offline';\n    const avatar = this.props.avatar ? this.props.avatar : true;\n    const badges = this.props.badges ? this.props.badges.slice() : [];\n    const icon_badges = [];\n    if (this.props.isVerified) {\n      icon_badges.push({icon: 'verified', color: 'verified-color'});\n    }\n    if (this.props.isStaff) {\n      icon_badges.push({icon: 'staff', color: 'staff-color'});\n    }\n    if (this.props.isDangerous) {\n      icon_badges.push({icon: 'dangerous', color: 'danger-color'});\n    }\n    if (this.props.acs) {\n      if (this.props.showMode) {\n        badges.push({name: this.props.acs.getMode(), key: 'mode'});\n      }\n      if (this.props.acs.isMuted()) {\n        icon_badges.push({icon: 'muted'});\n      }\n      if (!this.props.acs.isJoiner()) {\n        icon_badges.push({icon: 'banned'});\n      }\n    }\n\n    // The this.props.preview contains alreay shortened Drafty or string.\n    let preview;\n    if (typeof this.props.preview == 'string') {\n      preview = this.props.preview;\n    } else if (Drafty.isValid(this.props.preview)) {\n      preview = React.createElement(React.Fragment, null, Drafty.format(this.props.preview, previewFormatter,\n        {formatMessage: this.props.intl.formatMessage, previewIsResponse: this.props.previewIsResponse}));\n    } else if (this.props.preview) {\n      preview =\n        <><i className=\"material-icons gray\">warning_amber</i> <i className=\"gray\">\n          <FormattedMessage id=\"invalid_content\"\n            defaultMessage=\"invalid content\" description=\"Shown when the message is unreadable\" /></i>\n        </>;\n    }\n\n    const icon = deliveryMarker(this.props.received);\n    const marker = icon ? <i className={'material-icons small space-right' +\n      (icon.color ? ' ' + icon.color : '')}>{icon.name}</i> : null;\n    const titleClass = 'contact-title' + (this.props.deleted ? ' deleted' : '');\n\n    return (\n      <li className={!this.props.showCheckmark && this.props.selected ? 'selected' : null} onClick={this.handleClick}>\n        <div className=\"avatar-box\">\n          <LetterTile\n            tinode={this.props.tinode}\n            avatar={avatar}\n            title={this.props.title}\n            topic={this.props.item}\n            deleted={this.props.deleted} />\n          {this.props.deleted ? <i className=\"deleted material-icons\">cancel</i> :\n            this.props.showOnline ? <span className={online} /> :\n            (this.props.showCheckmark && this.props.selected) ?\n            <i className=\"checkmark material-icons\">check_circle</i>\n            : null}\n        </div>\n        <div className=\"text-box\">\n          <div><span className={titleClass}>{title}</span>\n            {this.props.isChannel ? <img src=\"/img/channel.png\" className=\"channel\" alt=\"channel\" /> : null}\n            <ContactBadges badges={icon_badges} />\n            {!this.props.deleted ? <UnreadBadge count={this.props.unread} /> : null}\n          </div>\n          {this.props.showMode ?\n            <span><ContactBadges badges={badges} /></span> :\n            this.props.small ? null : <div className=\"contact-comment\">{marker}<span>{preview || this.props.comment || '\\u00A0'}</span></div>}\n        </div>\n        {this.props.showContextMenu ?\n          <span className=\"menuTrigger\">\n            <a href=\"#\" onClick={this.handleContextClick}>\n              <i className=\"material-icons\">expand_more</i>\n            </a>\n          </span> : null}\n      </li>\n    );\n  }\n};\n\nexport default injectIntl(Contact);\n","// A panel included into a list of contacts with an action text.\nimport React from 'react';\nimport { injectIntl } from 'react-intl';\n\nclass ContactAction extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  handleClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.onAction(this.props.action);\n  }\n\n  render() {\n    const {formatMessage} = this.props.intl;\n    return (\n      <li onClick={this.handleClick} className=\"action\">\n        <div className=\"action-text\">{formatMessage(this.props.title, this.props.values)}</div>\n      </li>\n    );\n  }\n};\n\nexport default injectIntl(ContactAction);\n","// ContactList: component for showing a list of contacts,\n// such as a list of group members in a group chat.\nimport React from 'react';\nimport { defineMessages, injectIntl } from 'react-intl';\n\nimport { Drafty, Tinode } from 'tinode-sdk';\n\nimport Contact from './contact.jsx';\nimport ContactAction from './contact-action.jsx';\n\nimport { makeImageUrl } from '../lib/blob-helpers.js';\n\nimport { MESSAGE_PREVIEW_LENGTH } from '../config.js';\n\nconst messages = defineMessages({\n  badge_you: {\n    id: 'badge_you',\n    defaultMessage: 'you',\n    description: 'Badge for indicating the current user'\n  },\n  badge_owner: {\n    id: 'badge_owner',\n    defaultMessage: 'owner',\n    description: 'Badge for indicating the owner'\n  }\n});\n\nclass ContactList extends React.Component {\n  render() {\n    const { formatMessage } = this.props.intl;\n    const showCheckmark = Array.isArray(this.props.topicSelected);\n    const contactNodes = [];\n    let contactsCount = 0;\n    if (this.props.contacts && this.props.contacts.length > 0) {\n      this.props.contacts.map((c) => {\n        if (c.action) {\n          // Action item\n          contactNodes.push(\n            <ContactAction\n              title={c.title} action={c.action} values={c.values}\n              key={c.action}\n              onAction={this.props.onAction}\n              />);\n        } else {\n          // Normal contact\n          const key = this.props.showMode ? c.user : (c.topic || c.user);\n          // If filter function is provided, filter out the items\n          // which don't satisfy the condition.\n          if (this.props.filterFunc && this.props.filter) {\n            const filterOn = [key];\n            if (c.private && c.private.comment) {\n              filterOn.push(('' + c.private.comment).toLowerCase());\n            }\n            if (c.public && c.public.fn) {\n              filterOn.push(('' + c.public.fn).toLowerCase());\n            }\n            if (!this.props.filterFunc(this.props.filter, filterOn)) {\n              return;\n            }\n          }\n\n          const isChannel = Tinode.isChannelTopicName(key);\n          const selected = showCheckmark ?\n            (this.props.topicSelected.indexOf(key) > -1) :\n            (this.props.topicSelected === key);\n          const badges = [];\n          if (this.props.showMode) {\n            if (key == this.props.myUserId) {\n              badges.push({name: formatMessage(messages.badge_you), color: 'green'});\n            }\n            if (c.acs && c.acs.isOwner()) {\n              badges.push({name: formatMessage(messages.badge_owner), color: 'blue'});\n            }\n          }\n\n          const comment = Array.isArray(c.private) ?\n            c.private.join(',') : (c.private ? c.private.comment : null);\n          let preview;\n          let forwarded;\n          let previewIsResponse;\n          let deliveryStatus;\n          if (!this.props.showMode && c.latestMessage) {\n            const msg = c.latestMessage(true);\n            if (msg) {\n              forwarded = msg.head ? msg.head.forwarded : null;\n              deliveryStatus = msg._status || c.msgStatus(msg, true);\n              previewIsResponse = msg.from != this.props.myUserId;\n              if (msg.content) {\n                preview = typeof msg.content == 'string' ?\n                  msg.content.substr(0, MESSAGE_PREVIEW_LENGTH) :\n                  Drafty.preview(msg.content, MESSAGE_PREVIEW_LENGTH);\n              }\n            }\n          }\n\n          contactNodes.push(\n            <Contact\n              tinode={this.props.tinode}\n              title={c.public ? c.public.fn : null}\n              avatar={makeImageUrl(c.public ? c.public.photo : null)}\n              comment={comment}\n              preview={preview}\n              previewIsResponse={previewIsResponse}\n              forwarded={forwarded}\n              received={deliveryStatus}\n              unread={this.props.showUnread ? c.unread : 0}\n              now={c.online && this.props.connected}\n              acs={c.acs}\n              showMode={this.props.showMode}\n              badges={badges}\n              showCheckmark={showCheckmark}\n              selected={selected}\n              showOnline={this.props.showOnline && !isChannel}\n              isChannel={isChannel}\n              showContextMenu={this.props.showContextMenu}\n              isVerified={c.trusted && c.trusted.verified}\n              isStaff={c.trusted && c.trusted.staff}\n              isDangerous={c.trusted && c.trusted.danger}\n              deleted={c._deleted}\n              onSelected={this.props.onTopicSelected}\n              item={key}\n              index={contactNodes.length}\n              key={key} />\n          );\n          contactsCount ++;\n        }\n      }, this);\n    }\n\n    return (\n      <div className={this.props.noScroll ? null : \"scrollable-panel\"}>\n        {contactsCount == 0 ?\n          <div className=\"center-medium-text\"\n            dangerouslySetInnerHTML={{__html: this.props.emptyListMessage}} />\n          :\n          null\n        }\n        {contactNodes.length > 0 ?\n          <ul className=\"contact-box\">\n            {contactNodes}\n          </ul>\n          :\n          null\n        }\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(ContactList);\n","import React from 'react';\n\nimport { Tinode } from 'tinode-sdk';\n\nexport default class SearchContacts extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      edited: false,\n      search: ''\n    };\n\n    this.handleSearchChange = this.handleSearchChange.bind(this);\n    this.handleSearch = this.handleSearch.bind(this);\n    this.handleClear = this.handleClear.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n  }\n\n  componentWillUnmount() {\n    if (this.state.edited) {\n      this.setState({search: '', edited: false});\n      this.props.onSearchContacts(Tinode.DEL_CHAR);\n    }\n  }\n\n  handleSearchChange(e) {\n    this.setState({search: e.target.value});\n  }\n\n  handleSearch(e) {\n    e.preventDefault();\n    var query = this.state.search.trim();\n    this.setState({edited: (query.length > 0)});\n    this.props.onSearchContacts(query.length > 0 ? query : Tinode.DEL_CHAR);\n  }\n\n  handleClear(e) {\n    e.preventDefault();\n    if (this.state.edited) {\n      this.props.onSearchContacts(Tinode.DEL_CHAR);\n    }\n    this.setState({search: '', edited: false});\n  }\n\n  handleKeyDown(e) {\n    if (e.key === 'Enter') {\n      this.handleSearch(e);\n    } else if (e.key === 'Escape') {\n      this.handleClear();\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"panel-form\">\n        <div className=\"panel-form-row\">\n          <i className=\"material-icons search\">search</i>\n          <input className=\"search\" type=\"text\"\n              placeholder={this.props.placeholder}\n              value={this.state.search} onChange={this.handleSearchChange}\n              onKeyDown={this.handleKeyDown} required autoFocus />\n          {this.state.search ?\n            <a href=\"#\" onClick={this.handleClear}><i className=\"material-icons\">highlight_off</i></a>\n            :\n            <span><i className=\"material-icons\">&nbsp;</i></span>}\n        </div>\n      </div>\n    );\n  }\n};\n","// Forward Menu: message forwarding popup/dropdown menu.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport { Tinode } from 'tinode-sdk';\n\nimport ContactList from './contact-list.jsx';\nimport SearchContacts from './search-contacts.jsx';\n\nexport default class ForwardDialog extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      query: null\n    };\n\n    this.handleEscapeKey = this.handleEscapeKey.bind(this);\n    this.handleClose = this.handleClose.bind(this);\n\n    this.handleSearchContacts = this.handleSearchContacts.bind(this);\n    this.handleContactSelected = this.handleContactSelected.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.onInitFind();\n  }\n\n  handleEscapeKey(e) {\n    if (e.keyCode === 27) {\n      // Not forwarding the message.\n      this.props.hide(false);\n    }\n  }\n\n  handleClose(e) {\n    e.preventDefault();\n    this.props.hide(false);\n  }\n\n  handleSearchContacts(query) {\n    this.setState({ query: Tinode.isNullValue(query) ? null : query });\n    this.props.onSearchContacts(query);\n  }\n\n  handleContactSelected(uid) {\n    this.props.onTopicSelected(uid);\n    this.props.hide(true);\n  }\n\n  render() {\n    let contacts = this.state.query != null ? this.props.searchResults : this.props.contacts;\n    // Filter out contacts without a 'W' or 'J' permissions as well as the current topic.\n    contacts = contacts.filter((c) => {\n      return (c.name != this.props.topicSelected) && c.acs.isJoiner() && c.acs.isWriter();\n    });\n\n    return (\n      <div className=\"alert-container\">\n        <div className=\"forward-dialog\">\n          <div className=\"title with-control\">\n            <div><FormattedMessage id=\"forward_to\" defaultMessage=\"Forward to\"\n              desription=\"Title of the contact selector dialog when forwarding a message\" /></div>\n            <div><a href=\"#\" onClick={this.handleClose}><i className=\"material-icons\">close</i></a></div>\n          </div>\n          <FormattedMessage id=\"forward_to_search_placeholder\" defaultMessage=\"Search contacts\"\n            description=\"Contact search prompt when forwarding a message.\">{\n            (search_placeholder) => <SearchContacts\n              placeholder={search_placeholder}\n              onSearchContacts={this.handleSearchContacts} />\n          }</FormattedMessage>\n          <FormattedMessage id=\"search_no_results\" defaultMessage=\"Search returned no results\"\n              description=\"Text shown in contacts view when query returned no results.\">{\n            (not_found_placeholder) => <ContactList\n              tinode={this.props.tinode}\n              contacts={contacts}\n              myUserId={this.props.myUserId}\n              emptyListMessage={not_found_placeholder}\n              showOnline={false}\n              showUnread={false}\n              showContextMenu={false}\n              onTopicSelected={this.handleContactSelected} />\n          }</FormattedMessage>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { defineMessages, injectIntl } from 'react-intl';\n\nconst icon_mapping = {'staff': 'verified_user'};\n\nconst messages = defineMessages({\n  badge_verified: {\n    id: 'badge_verified',\n    defaultMessage: 'Verified/official',\n    description: 'Explanation of a verified account or topic badge'\n  },\n  badge_staff: {\n    id: 'badge_staff',\n    defaultMessage: 'Staff-managed',\n    description: 'Explanation of a staff-managed account or topic badge'\n  },\n  badge_danger: {\n    id: 'badge_danger',\n    defaultMessage: 'Untrustworthy',\n    description: 'Suspicious or untrustworthy account or topic badge'\n  },\n});\n\n\n/* Trusted badges with labels: verified, staff, danger */\nclass BadgeList extends React.PureComponent {\n  render() {\n    const {formatMessage} = this.props.intl;\n    let badges = null;\n    if (this.props.trustedBadges && this.props.trustedBadges.length > 0) {\n      badges = [];\n      this.props.trustedBadges.map((b) => {\n        const comment = this.props.short ? null : formatMessage(messages['badge_' + b]);\n        const style = 'material-icons ' + b + '-color';\n        badges.push(<div className=\"trusted-badge\" key={b}><i className={style}>{icon_mapping[b] || b}</i> {comment}</div>);\n      });\n      return <>{badges}</>;\n    }\n    return null;\n  }\n};\n\nexport default injectIntl(BadgeList);\n","// Video call states.\nexport const CALL_STATE_NONE = 0;\nexport const CALL_STATE_OUTGOING_INITATED = 1;\nexport const CALL_STATE_INCOMING_RECEIVED = 2;\nexport const CALL_STATE_IN_PROGRESS = 3;\n\n// Video call drafty headers representing call state.\nexport const CALL_HEAD_STARTED = 'started';\n","// IncomingCall: displays Accept & Reject buttons for incoming calls.\nimport React from 'react';\n\nimport BadgeList from './badge-list.jsx';\nimport LetterTile from './letter-tile.jsx';\n\nimport { MAX_TITLE_LENGTH, MAX_PEER_TITLE_LENGTH } from '../config.js';\nimport { CALL_STATE_INCOMING_RECEIVED } from '../constants.js';\n\nimport { makeImageUrl } from '../lib/blob-helpers.js';\nimport { clipStr } from '../lib/utils.js'\n\nconst RING_SOUND = new Audio('audio/call-in.m4a');\n\nexport default class CallIncoming extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      topic: null,\n      fullName: undefined,\n      avatar: null,\n      trustedBadges: [],\n      previousMetaDesc: undefined,\n    };\n\n    this.resetDesc = this.resetDesc.bind(this);\n    this.onMetaDesc = this.onMetaDesc.bind(this);\n    this.handleRejectCall = this.handleRejectCall.bind(this);\n    this.handleAcceptCall = this.handleAcceptCall.bind(this);\n    this.ringTimer = null;\n  }\n\n  componentDidMount() {\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    if (!topic) {\n      return;\n    }\n\n    this.resetDesc(topic, this.props);\n    if (this.props.callState == CALL_STATE_INCOMING_RECEIVED) {\n      // play() throws if the user did not click the app first: https://goo.gl/xX8pDD.\n      RING_SOUND.play().catch(_ => {});\n      this.ringTimer = setInterval(_ => {RING_SOUND.play().catch(_ => {})}, 2000);\n      this.props.onRinging(this.props.topic, this.props.seq);\n    }\n  }\n\n  // No need to separately handle component mount.\n  componentDidUpdate(props) {\n    const topic = this.props.tinode.getTopic(props.topic);\n    if (!topic) {\n      return;\n    }\n\n    if (this.onMetaDesc != topic.onMetaDesc) {\n      this.previousMetaDesc = topic.onMetaDesc;\n      topic.onMetaDesc = this.onMetaDesc;\n    }\n\n    if (this.state.topic != props.topic) {\n      this.setState({topic: props.topic});\n      this.resetDesc(topic, props);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.ringTimer != null) {\n      clearInterval(this.ringTimer);\n      RING_SOUND.pause();\n    }\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    if (!topic) {\n      return;\n    }\n    this.setState({topic: null});\n    topic.onMetaDesc = this.previousMetaDesc;\n  }\n\n  resetDesc(topic, props) {\n    const defacs = topic.getDefaultAccess() || {};\n    const acs = topic.getAccessMode();\n    const badges = [];\n    if (topic.trusted) {\n      for (const [key, val] of Object.entries(topic.trusted)) {\n        if (val) {\n          badges.push(key);\n        }\n      }\n    }\n\n    this.setState({\n      fullName: clipStr(topic.public ? topic.public.fn : undefined, MAX_TITLE_LENGTH),\n      avatar: makeImageUrl(topic.public ? topic.public.photo : null),\n      trustedBadges: badges,\n    });\n  }\n\n  onMetaDesc(desc) {\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    if (!topic) {\n      return;\n    }\n    this.resetDesc(topic, this.props);\n\n    if (this.previousMetaDesc && this.previousMetaDesc != this.onMetaDesc) {\n      this.previousMetaDesc(desc);\n    }\n  }\n\n  handleAcceptCall() {\n    this.props.onAcceptCall(this.props.topic);\n  }\n\n  handleRejectCall() {\n    this.props.onReject(this.props.topic, this.props.seq);\n    this.props.onClose();\n  }\n\n  render() {\n    return (\n      <div className=\"alert-container\">\n        <div className=\"incoming-call\">\n          <div className=\"caller-card incoming pulse\">\n            <div className=\"avatar-box\">\n              <LetterTile\n                tinode={this.props.tinode}\n                avatar={this.state.avatar || true}\n                topic={this.props.topic}\n                title={this.state.fullName} />\n            </div>\n            <div className=\"caller-name\">{clipStr(this.state.fullName, MAX_PEER_TITLE_LENGTH)}\n              <BadgeList short={true} trustedBadges={this.state.trustedBadges} /></div>\n          </div>\n          <div className=\"controls\">\n            {this.props.callState == CALL_STATE_INCOMING_RECEIVED ?\n              <>\n                <button className=\"danger\" onClick={this.handleRejectCall}>\n                  <i className=\"material-icons\">call_end</i>\n                </button>\n                <button className=\"positive\" onClick={this.handleAcceptCall}>\n                  <i className=\"material-icons\">call</i>\n                </button>\n              </>\n              :\n              null\n            }\n          </div>\n        </div>\n      </div>\n    );\n  }\n};\n","import React from 'react';\n\nexport default class LoadSpinner extends React.PureComponent {\n  render() {\n    const className = 'load-spinner-box' + (this.props.large ? ' large' : '')\n      + (this.props.clear ? ' clear' : '') + (this.props.centered ? ' centered' : '');\n    return (this.props.show ?\n      <div className={className}><div className=\"loader-spinner\"></div></div> : null);\n  }\n}\n","import React from 'react';\n\nimport LetterTile from './letter-tile.jsx';\nimport LoadSpinner from './load-spinner.jsx';\n\nimport { sanitizeUrlForMime } from '../lib/utils.js';\n\nimport { AVATAR_SIZE } from '../config.js';\n\nexport default class AvatarUpload extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      source: props.avatar\n    };\n\n    this.handleFileReceived = this.handleFileReceived.bind(this);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.avatar != prevProps.avatar) {\n      this.setState({source: this.props.avatar});\n    }\n  }\n\n  handleFileReceived(e) {\n    const image = e.target.files[0];\n    this.props.onImageUpdated(image.type, URL.createObjectURL(image), image.name);\n    // Clear the value so the same file can be uploaded again.\n    e.target.value = '';\n  }\n\n  render() {\n    // Randomize id value in case more than one AvatarUpload is shown\n    // at the same time.\n    const randId = 'file-input-avatar-' + ('' + Math.random()).substring(0, 4);\n    const className = 'avatar-upload' + (this.props.readOnly ? ' read-only' : '');\n    return (\n      <div className={className}>\n        {this.props.readOnly || !this.state.source ?\n          null :\n          <a href=\"#\" className=\"clear-avatar\" onClick={(e) => {e.preventDefault(); this.props.onImageUpdated();}}>\n            <i className=\"material-icons\">clear</i>\n          </a>}\n        {this.state.source ?\n          <img src={this.props.tinode.authorizeURL(sanitizeUrlForMime(this.state.source, 'image'))} className=\"preview\" /> :\n          this.props.readOnly && this.props.uid ?\n            <div className=\"avatar-box\">\n              <LetterTile\n                tinode={this.props.tinode}\n                avatar={true}\n                topic={this.props.uid}\n                title={this.props.title} />\n            </div>\n            :\n            <div className=\"blank\">{AVATAR_SIZE}&times;{AVATAR_SIZE}</div>}\n        {this.props.readOnly ? null :\n          <input type=\"file\" id={randId} className=\"inputfile hidden\"\n            accept=\"image/*\" onChange={this.handleFileReceived} />}\n        {this.props.readOnly ? null :\n        <label htmlFor={randId} className=\"round\">\n          <i className=\"material-icons\">file_upload</i>\n        </label>}\n        <LoadSpinner show={this.props.uploading} large={true} clear={true} centered={true} />\n      </div>\n    );\n  }\n};\n","import React from 'react';\n\n/* CheckBox: styled three-state checkbox, either clickable or static */\nexport default class CheckBox extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  handleChange() {\n    this.props.onChange(this.props.name, !this.props.checked);\n  }\n\n  render() {\n    let classList = ['material-icons'];\n    let iconName;\n    if (Array.isArray(this.props.className)) {\n      classList.push(...this.props.className);\n    } else if (this.props.className) {\n      classList.push(this.props.className);\n    }\n    if (this.props.onChange) {\n      if (this.props.checked) {\n        classList.push('blue', 'clickable');\n        iconName = 'check_box';\n      } else if (this.props.checked === false) {\n        classList.push('blue', 'clickable');\n        iconName = 'check_box_outline_blank';\n      } else {\n        classList.push('lt-blue');\n        iconName = 'indeterminate_check_box';\n      }\n    } else {\n        if (this.props.checked) {\n          iconName = 'check_box';\n        } else {\n          iconName = 'check_box_outline_blank';\n        }\n    }\n    let attrs = {\n      className: classList.join(' '),\n      id: this.props.id,\n    };\n    if (this.props.onChange) {\n      attrs.onClick = this.handleChange;\n    }\n    return React.createElement('i', attrs, iconName);\n  }\n}\n","// The X menu to be displayed in title bars.\nimport React from 'react';\n\nexport default class MenuCancel extends React.PureComponent {\n  render() {\n    return (\n      <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onCancel();}}>\n        <i className=\"material-icons\">close</i>\n      </a>\n    );\n  }\n}\n","import React from 'react';\n\nimport MenuCancel from './menu-cancel.jsx';\n\nexport default class ErrorPanel extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      show: false,\n    };\n\n    this.hide = this.hide.bind(this);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.level !== this.props.level) {\n      this.setState({\n        show: !(!this.props.level)\n      });\n    }\n  }\n\n  hide() {\n    this.setState({show: false});\n    if (this.props.onClearError) {\n      this.props.onClearError();\n    }\n  }\n\n  render() {\n    const icons = {err: 'error', warn: 'warning', info: 'info'}\n    const level = icons[this.props.level] || '';\n    const className = 'info-box ' + level;\n    return (\n      <div className={className}>\n        <div className=\"icon\"><i className=\"material-icons\">{level}</i></div>\n        <span>\n          {this.props.text}\n          {this.props.action ?\n            <>\n              &#32;<a href=\"#\"\n                style={{ whiteSpace: 'nowrap' }}\n                onClick={(e) => {e.preventDefault(); this.props.action();}}>\n                {this.props.actionText}\n              </a>\n            </>\n          : null}\n        </span>\n        <div className=\"cancel\"><MenuCancel onCancel={this.hide} /></div>\n      </div>\n    );\n  }\n};\n","import React from 'react';\n\nimport LetterTile from './letter-tile.jsx';\n\nexport default class Chip extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.handleCancel = this.handleCancel.bind(this);\n  }\n\n  handleCancel(e) {\n    e.preventDefault();\n    this.props.onCancel(this.props.topic, this.props.index);\n  }\n\n  render() {\n    const title = this.props.title || this.props.topic;\n    const className = this.props.invalid ? 'chip invalid' : 'chip';\n    return (\n      <div className={className}>\n        {this.props.noAvatar ?\n          <span className=\"spacer\" /> :\n          <div className=\"avatar-box\">\n            <LetterTile\n              tinode={this.props.tinode}\n              avatar={this.props.avatar || true}\n              topic={this.props.topic}\n              title={this.props.title} />\n          </div>\n        }\n        <span>{title}</span>\n        {this.props.onCancel && !this.props.required ?\n          <a href=\"#\" onClick={this.handleCancel} >&times;</a>\n          : <span className=\"spacer\" />}\n      </div>\n    );\n  }\n};\n","import React from 'react';\n\nimport Chip from './chip.jsx';\n\nimport { makeImageUrl } from '../lib/blob-helpers.js';\n\n/* BEGIN ChipInput: group membership widget */\nexport default class ChipInput extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = ChipInput.deriveStateFromProps(props);\n    this.state.input = '';\n    this.state.focused = false;\n\n    this.handleTextInput = this.handleTextInput.bind(this);\n    this.removeChipAt = this.removeChipAt.bind(this);\n    this.handleChipCancel = this.handleChipCancel.bind(this);\n    this.handleFocusGained = this.handleFocusGained.bind(this);\n    this.handleFocusLost = this.handleFocusLost.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n  }\n\n  static deriveStateFromProps(props) {\n    return {\n      placeholder: props.chips ? '' : props.prompt,\n      sortedChips: ChipInput.sortChips(props.chips, props.staticMembers),\n      chipIndex: ChipInput.indexChips(props.chips)\n    };\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.chips != this.props.chips ||\n      prevProps.staticMembers != this.props.staticMembers ||\n      prevProps.prompt != this.props.prompt) {\n      this.setState(ChipInput.deriveStateFromProps(this.props));\n    }\n    if (!prevState || this.props.chips.length > prevState.sortedChips.length) {\n      this.setState({input: ''});\n    }\n  }\n\n  // Map chip index to user name\n  static indexChips(chips) {\n    const index = {};\n    let count = 0;\n    chips.map((item) => {\n      index[item.user] = count;\n      count ++;\n    });\n    return index;\n  }\n\n  // Have non-removable chips appear before all other chips.\n  static sortChips(chips, keep) {\n    const required = [];\n    const normal = [];\n    chips.map((item) => {\n      if (keep && keep.includes(item.user)) {\n        required.push(item);\n      } else {\n        normal.push(item);\n      }\n    });\n    return required.concat(normal);\n  }\n\n  handleTextInput(e) {\n    this.setState({input: e.target.value});\n    if (this.props.filterFunc) {\n      this.props.filterFunc(e.target.value);\n    }\n  }\n\n  removeChipAt(idx) {\n    const removed = this.state.sortedChips[idx];\n    this.props.onChipRemoved(removed.user, this.state.chipIndex[removed.user]);\n  }\n\n  handleChipCancel(item, idx) {\n    this.removeChipAt(idx);\n  }\n\n  handleFocusGained() {\n    this.setState({focused: true});\n  }\n\n  handleFocusLost() {\n    this.setState({focused: false});\n    if (this.props.onFocusLost) {\n      this.props.onFocusLost(this.state.input);\n    }\n  }\n\n  handleKeyDown(e) {\n    if (e.key === 'Backspace') {\n      if (this.state.input.length == 0 && this.state.sortedChips.length > 0) {\n        const at = this.state.sortedChips.length - 1;\n        if (this.state.sortedChips[at].user !== this.props.staticMembers) {\n          this.removeChipAt(at);\n        }\n      }\n    } else if (e.key === 'Enter') {\n      if (this.props.onEnter) {\n        this.props.onEnter(this.state.input);\n      }\n    } else if (e.key === 'Escape') {\n      if (this.props.onCancel) {\n        this.props.onCancel();\n      }\n    }\n  }\n\n  render() {\n    const chips = [];\n    let count = 0;\n    const staticMembers = this.props.staticMembers || [];\n    this.state.sortedChips.map((item) => {\n      chips.push(\n        <Chip\n          tinode={this.props.tinode}\n          onCancel={this.handleChipCancel}\n          avatar={makeImageUrl(item.public ? item.public.photo : null)}\n          title={item.public ? item.public.fn : undefined}\n          noAvatar={this.props.avatarDisabled}\n          topic={item.user}\n          required={staticMembers.includes(item.user)}\n          invalid={item.invalid}\n          index={count}\n          key={item.user} />\n      );\n      count++;\n    });\n    const className = \"chip-input\" + (this.state.focused ? ' focused' : '');\n    const autoFocus = !(this.props.tabIndex > 0);\n    return (\n      <div className={className}>\n        {chips}\n        <input type=\"text\"\n          placeholder={this.state.placeholder}\n          onChange={this.handleTextInput}\n          onFocus={this.handleFocusGained}\n          onBlur={this.handleFocusLost}\n          onKeyDown={this.handleKeyDown}\n          value={this.state.input}\n          tabIndex={this.props.tabIndex}\n          autoFocus={autoFocus} />\n      </div>\n    );\n  }\n};\n","// GroupMembers: control for managing a list of group members.\nimport React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nimport ChipInput from './chip-input.jsx';\nimport ContactList from './contact-list.jsx';\n\nconst messages = defineMessages({\n  no_contacts: {\n    id: 'no_contacts',\n    defaultMessage: 'You have no contacts :-(',\n    description: 'Shown in ContactsView when the user has no contacts'\n  },\n  contacts_not_found_short: {\n    id: 'contacts_not_found_short',\n    defaultMessage: \"No contacts match ''{query}''\",\n    description: 'Shown in ContactsView when search returned no results'\n  }\n});\n\nclass GroupManager extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      // Array of topic members\n      members: props.members,\n      index: GroupManager.indexMembers(props.members),\n      staticMembers: GroupManager.staticMembers(props.members, props.keepInitialMembers, props.requiredMember),\n      contactFilter: '',\n      noContactsMessage: props.intl.formatMessage(messages.no_contacts),\n      selectedContacts: GroupManager.selectedContacts(props.members)\n    };\n\n    this.handleContactSelected = this.handleContactSelected.bind(this);\n    this.handleMemberRemoved = this.handleMemberRemoved.bind(this);\n    this.handleContactFilter = this.handleContactFilter.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n  }\n\n  static indexMembers(members) {\n    let index = {};\n    members.map((m) => {\n      index[m.user] = {delta: 0, present: true}; // Delta: 0 unchanged, +1 added, -1 removed\n    });\n    return index;\n  }\n\n  static staticMembers(members, keepInitial, requiredMember) {\n    let stat = [];\n    members.map((m) => {\n      if (keepInitial || m.user == requiredMember) {\n        stat.push(m.user);\n      }\n    });\n    return stat;\n  }\n\n  static selectedContacts(members) {\n    let sel = [];\n    members.map((m) => {\n      sel.push(m.user);\n    });\n    return sel;\n  }\n\n  handleContactSelected(userId, index) {\n    let status = this.state.index[userId];\n    if (status) {\n      if (status.present) {\n        // Prevent duplicate members\n        return;\n      }\n      status.delta += 1;\n      status.present = true;\n    } else {\n      status = {delta: 1, present: true};\n    }\n\n    let m = this.state.members.slice();\n    m.push(this.props.contacts[index]);\n\n    const sel = GroupManager.selectedContacts(m);\n\n    const i = this.state.index;\n    i[userId] = status;\n\n    this.setState({members: m, index: i, selectedContacts: sel});\n  }\n\n  handleMemberRemoved(userId, index) {\n    const status = this.state.index[userId];\n    if (!status || !status.present) {\n      return;\n    }\n    status.present = false;\n    status.delta -= 1;\n\n    let m = this.state.members.slice();\n    m.splice(index, 1);\n\n    const sel = GroupManager.selectedContacts(m);\n\n    const i = this.state.index;\n    i[userId] = status;\n\n    this.setState({members: m, index: i, selectedContacts: sel});\n  }\n\n  handleContactFilter(val) {\n    const {formatMessage} = this.props.intl;\n    const msg = !val ?\n      formatMessage(messages.no_contacts) :\n      formatMessage(messages.contacts_not_found_short, {query: val});\n\n    this.setState({contactFilter: val, noContactsMessage: msg});\n  }\n\n  static doContactFiltering(filter, values) {\n    if (filter) {\n      for (let i=0; i<values.length; i++) {\n        if (values[i].indexOf(filter) >= 0) {\n          return true;\n        }\n      }\n      return false;\n    }\n    return true;\n  }\n\n  handleSubmit() {\n    var instance = this;\n    var members = [];\n    var added = [];\n    var removed = [];\n\n    var keys = Object.keys(this.state.index);\n    keys.map(function(k) {\n      if (instance.state.index[k].present) {\n        members.push(k);\n      }\n\n      if (instance.state.index[k].delta > 0) {\n        added.push(k);\n      } else if (instance.state.index[k].delta < 0) {\n        removed.push(k);\n      }\n    });\n    this.props.onSubmit(members, added, removed);\n  }\n\n  handleCancel() {\n    this.props.onCancel();\n  }\n\n  render() {\n    const {formatMessage} = this.props.intl;\n    return (\n      <div id=\"group-manager\">\n        <div className=\"panel-form-row\">\n          <label className=\"small\">\n            <FormattedMessage id=\"title_group_members\" defaultMessage=\"Group Members\" description=\"Section title\" />\n          </label>\n        </div>\n        <div className=\"panel-form-row\">\n          <ChipInput\n            tinode={this.props.tinode}\n            chips={this.state.members}\n            staticMembers={this.state.staticMembers}\n            prompt=\"add members\"\n            filterFunc={this.handleContactFilter}\n            onChipRemoved={this.handleMemberRemoved} />\n        </div>\n        <div className=\"panel-form-row\">\n          <label className=\"small\">\n            <FormattedMessage id=\"title_all_contacts\" defaultMessage=\"All Contacts\"\n              description=\"Section title [All Contacts]\" />\n          </label>\n        </div>\n        <ContactList\n          tinode={this.props.tinode}\n          contacts={this.props.contacts}\n          myUserId={this.props.myUserId}\n          topicSelected={this.state.selectedContacts}\n          filter={this.state.contactFilter}\n          filterFunc={GroupManager.doContactFiltering}\n          emptyListMessage={this.state.noContactsMessage}\n          showOnline={false}\n          showUnread={false}\n          onTopicSelected={this.handleContactSelected} />\n        <div id=\"group-manager-buttons\" className=\"panel-form-row\">\n          <button className=\"secondary\" onClick={this.handleCancel}>\n            <FormattedMessage id=\"button_cancel\" defaultMessage=\"Cancel\" description=\"Button [Cancel]\" />\n          </button>\n          <button className=\"primary\" onClick={this.handleSubmit}>\n            <FormattedMessage id=\"button_ok\" defaultMessage=\"OK\" description=\"Button [OK]\" />\n          </button>\n        </div>\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(GroupManager);\n","// PermissionsEditor: Component for editing permissions\n// <PermissionsEditor mode=\"JWROD\" skip=\"O\" onChange={this.handleCheckboxTest} />\nimport React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nimport CheckBox from './checkbox.jsx';\nimport Contact from './contact.jsx';\n\nimport { makeImageUrl } from '../lib/blob-helpers.js';\n\n// Translatable permission names.\nconst messages = defineMessages({\n  joiner: {\n    id: 'permission_join',\n    defaultMessage: \"Join ({val})\",\n    description: 'Name of J permission'\n  },\n  reader: {\n    id: 'permission_read',\n    defaultMessage: \"Read ({val})\",\n    description: 'Name of R permission'\n  },\n  writer: {\n    id: 'permission_write',\n    defaultMessage: \"Write ({val})\",\n    description: 'Name of W permission'\n  },\n  preser: {\n    id: 'permission_pres',\n    defaultMessage: \"Get notified ({val})\",\n    description: 'Name of P permission'\n  },\n  approver: {\n    id: 'permission_admin',\n    defaultMessage: \"Approve ({val})\",\n    description: 'Name of A permission'\n  },\n  sharer: {\n    id: 'permission_share',\n    defaultMessage: \"Share ({val})\",\n    description: 'Name of S permission'\n  },\n  deleter: {\n    id: 'permission_delete',\n    defaultMessage: \"Delete ({val})\",\n    description: 'Name of D permission'\n  },\n  owner: {\n    id: 'permission_owner',\n    defaultMessage: \"Owner ({val})\",\n    description: 'Name of O permission'\n  }\n});\n\nclass PermissionsEditor extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      mode: (props.mode || '').replace('N', '')\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n  }\n\n  handleChange(val) {\n    let mode = this.state.mode;\n    const idx = mode.indexOf(val);\n    if (idx == -1) {\n      mode += val;\n    } else {\n      mode = mode.replace(val, '');\n    }\n    this.setState({mode: mode});\n  }\n\n  handleSubmit() {\n    // Normalize string, otherwise cannot check if mode has changed.\n    const mode = (this.state.mode || 'N').split('').sort().join('');\n    const before = (this.props.mode || 'N').split('').sort().join('')\n    if (mode !== before) {\n      this.props.onSubmit(mode);\n    } else {\n      this.props.onCancel();\n    }\n  }\n\n  handleCancel() {\n    this.props.onCancel();\n  }\n\n  render() {\n    const {formatMessage} = this.props.intl;\n    const all = 'JRWPASDO';\n    const names = {\n      'J': formatMessage(messages.joiner, {val: 'J'}),\n      'R': formatMessage(messages.reader, {val: 'R'}),\n      'W': formatMessage(messages.writer, {val: 'W'}),\n      'P': formatMessage(messages.preser, {val: 'P'}),\n      'A': formatMessage(messages.approver, {val: 'A'}),\n      'S': formatMessage(messages.sharer, {val: 'S'}),\n      'D': formatMessage(messages.deleter, {val: 'D'}),\n      'O': formatMessage(messages.owner, {val: 'O'})\n    };\n\n    let skip = this.props.skip || '';\n    let mode = this.state.mode;\n    let compare = (this.props.compare || '').replace('N', '');\n    let items = [];\n    for (let i=0; i<all.length; i++) {\n      let c = all.charAt(i);\n      if (skip.indexOf(c) >= 0 && mode.indexOf(c) < 0) {\n        // Permission is marked as inactive: hide unchecked permissions, disable checked permissions\n        continue;\n      }\n      items.push(\n        <tr key={c}>\n          <td>{names[c]}</td>\n          <td className=\"checkbox\">{skip.indexOf(c) < 0 ?\n            <CheckBox name={c} checked={(mode.indexOf(c) >= 0)} onChange={this.handleChange}/>\n            :\n            <CheckBox name={c} checked={(mode.indexOf(c) >= 0)} />\n          }</td>{this.props.compare ? <td className=\"checkbox\">\n            <CheckBox name={c} checked={(compare.indexOf(c) >= 0)}/>\n          </td> : null}\n        </tr>\n      );\n    }\n\n    return (\n      <div className=\"panel-form-column\">\n        {this.props.userTitle ?\n          <ul className=\"contact-box small\"><Contact\n            tinode={this.props.tinode}\n            item={this.props.item}\n            title={this.props.userTitle}\n            small={true}\n            avatar={makeImageUrl(this.props.userAvatar ? this.props.userAvatar : null)} /></ul> : null}\n        <label className=\"small\"><FormattedMessage id=\"title_permissions\"\n          defaultMessage=\"Permissions\" description=\"Section title\"/></label>\n        <table className=\"permission-editor\">\n        {this.props.compare ?\n          <thead><tr>\n            <th></th><th>{this.props.modeTitle}</th>\n            <th>{this.props.compareTitle}</th>\n          </tr></thead> :\n          null}\n        <tbody>\n          {items}\n        </tbody></table>\n        <br />\n        <div className=\"dialog-buttons\">\n          <button className=\"outline\" onClick={this.handleCancel}>\n            <FormattedMessage id=\"button_cancel\" defaultMessage=\"Cancel\" description=\"Button [Cancel]\" />\n          </button>\n          <button className=\"primary\" onClick={this.handleSubmit}>\n            <FormattedMessage id=\"button_ok\" defaultMessage=\"OK\" description=\"Button [OK]\" />\n          </button>\n        </div>\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(PermissionsEditor);\n","// Image zoom and crop widget.\n\nimport React from 'react';\n\nconst DEFAULT_MAX_ZOOM = 2.5;\n\nexport default class Cropper extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      // Coordinates of the top left corner of the image in container coordinates.\n      panX: 0,\n      panY: 0,\n      // Origin of the zoom in image coordinates.\n      originX: 0,\n      originY: 0,\n      // Zoom scale.\n      zoom: 1,\n      // Zoom min and max.\n      minZoom: 0,\n      maxZoom: DEFAULT_MAX_ZOOM,\n    };\n\n    // References to DOM elements for hooking up events and getting screen dimensions.\n    // The transparent element which captures mouse moves (moves with the image).\n    this.overlay = React.createRef();\n    // The image cutout window or view port (static).\n    this.cutout = React.createRef();\n    // Scaled and translated image preview.\n    this.preview = React.createRef();\n    // The main container (static).\n    this.boundingBox = React.createRef();\n\n    // The original image width and height before any scaling.\n    this.imageWidth = 0;\n    this.imageHeight = 0;\n\n    // Mouse position when dragging.\n    this.mouseX = 0\n    this.mouseY = 0;\n    // Length of the previous mouse move when dragging.\n    this.prevDistance = 0;\n\n    // Bounding rectangles of static elements.\n    this.cutoutRect = {};\n    this.bBoxRect = {};\n    // Center of the bounding box.\n    this.originX = 0;\n    this.originY = 0;\n\n    this.initScaling = this.initScaling.bind(this);\n    this.onZoom = this.onZoom.bind(this);\n    this.handleZoom = this.handleZoom.bind(this);\n    this.mouseDown = this.mouseDown.bind(this);\n    this.mouseUp = this.mouseUp.bind(this);\n    this.mouseMove = this.mouseMove.bind(this);\n    this.mouseTouch = this.mouseTouch.bind(this);\n    this.positionAll = this.positionAll.bind(this);\n    this.translate = this.translate.bind(this);\n  }\n\n  componentDidMount() {\n    this.overlay.current.addEventListener('mousedown', this.mouseDown, { passive: true });\n    this.overlay.current.addEventListener('touchstart', this.mouseDown, { passive: true });\n\n    // The rectangle position is in viewport coordinates.\n    this.bBoxRect = this.boundingBox.current.getBoundingClientRect();\n    // Center of the bounding box in container coordinates.\n    this.originX = this.bBoxRect.width / 2;\n    this.originY = this.bBoxRect.height / 2;\n\n    // The rectangle position is in viewport coordinates.\n    this.cutoutRect = this.cutout.current.getBoundingClientRect();\n  }\n\n  componentWillUnmount() {\n    this.overlay.current.removeEventListener('mousedown', this.mouseDown);\n    this.overlay.current.removeEventListener('touchstart', this.mouseDown);\n  }\n\n  // Position all elements.\n  positionAll(panX, panY, zoom) {\n    // Zoom origin in image preview coordinates.\n    this.setState({\n      panX: panX,\n      panY: panY,\n      zoom: zoom,\n      originX: this.originX - panX,\n      originY: this.originY - panY,\n    });\n\n    // Pass cut out coordinates to caller.\n    const left = (this.originX - panX) * zoom - this.originX;\n    const top = (this.originY - panY) * zoom - this.originY;\n    this.props.onChange(\n      (left + this.cutoutRect.left - this.bBoxRect.left) / zoom,\n      (top + this.cutoutRect.top - this.bBoxRect.top) / zoom,\n      this.cutoutRect.width / zoom,\n      this.cutoutRect.height / zoom,\n      zoom);\n  }\n\n  // Check if new location is within the limits.\n  static checkBound(currPan, img, cutout, delta) {\n    let nextDiff = Math.min(0, cutout[0] - img[0] - delta, img[1] - cutout[1] + delta);\n    if (nextDiff == 0) {\n      // Cutout is completely within the image.\n      currPan += delta;\n    } else if (Math.min(0, cutout[0] - img[0], img[1] - cutout[1]) < nextDiff) {\n      // Cutout is outside of the range but closer to the bound.\n      currPan += delta;\n    }\n    return currPan;\n  }\n\n  initScaling() {\n    // Initialize components.\n    const imgRect = this.preview.current.getBoundingClientRect();\n\n    this.imageWidth = imgRect.width;\n    this.imageHeight = imgRect.height;\n\n    // Set zoom slider's min and max values. Make sure the scaled image cannot be smaller than the cutout.\n    const minZoom = Math.max(this.cutoutRect.width / imgRect.width, this.cutoutRect.height / imgRect.height);\n    this.setState({\n      minZoom: minZoom,\n      maxZoom: Math.max(DEFAULT_MAX_ZOOM, minZoom + 1)\n    });\n\n    // Initial zoom level fills the bounding box at the smallest image dimension and overflows the largest, i.e. \"fill\" not \"fit\".\n    const zoom = Math.max(this.bBoxRect.width / imgRect.width, this.bBoxRect.height / imgRect.height);\n    // Converting from viewport coordinates to container, then panning.\n    const panX = this.cutoutRect.left - this.bBoxRect.left -\n      (imgRect.width - this.cutoutRect.width) / 2;\n    const panY = this.cutoutRect.top - this.bBoxRect.top -\n      (imgRect.height - this.cutoutRect.height) / 2;\n\n    this.positionAll(panX, panY, zoom);\n  }\n\n  onZoom(e) {\n    this.handleZoom(e.target.value);\n  }\n\n  handleZoom(zoom) {\n    let panX = this.state.panX;\n    let panY = this.state.panY;\n\n    // Ensure that the image at the new zoom is not outside of the cutout boundaries.\n    // Calculate image coordinates at the new zoom.\n    const imgLeft = this.originX - (this.originX - panX) * zoom;\n    const imgRight = imgLeft + this.imageWidth * zoom;\n    // Cutout in the same coordinates as the image.\n    const coLeft = this.cutoutRect.left - this.bBoxRect.left;\n    const coRight = coLeft + this.cutoutRect.width;\n    if (coLeft < imgLeft) {\n      panX -= imgLeft - coLeft;\n    } else if (coRight > imgRight) {\n      panX += coRight - imgRight;\n    }\n    const imgTop = this.originY - (this.originY - panY) * zoom;\n    const imgBottom = imgTop + this.imageHeight * zoom;\n    const coTop = this.cutoutRect.top - this.bBoxRect.top;\n    const coBottom = coTop + this.cutoutRect.height;\n    if (coTop < imgTop) {\n      panY -= imgTop - coTop;\n    } else if (coBottom > imgBottom) {\n      panY += coBottom - imgBottom;\n    }\n\n    this.positionAll(panX, panY, zoom);\n  }\n\n  mouseDown(e) {\n    if (e.touches) {\n      this.mouseX = e.touches[0].pageX;\n      this.mouseY = e.touches[0].pageY;\n    } else {\n      this.mouseX = e.pageX;\n      this.mouseY = e.pageY;\n    }\n\n    window.addEventListener('mousemove', this.mouseMove, { passive: false });\n    window.addEventListener('touchmove', this.mouseTouch, { passive: false });\n    window.addEventListener('mouseup', this.mouseUp, { passive: true });\n    window.addEventListener('touchend', this.mouseUp, { passive: true });\n    // Disable text selection in the entire document.\n    document.body.style['userSelect'] = 'none';\n  }\n\n  // Perform image panning.\n  translate(pageX, pageY) {\n    const dX = pageX - this.mouseX;\n    const dY = pageY - this.mouseY;\n\n    this.mouseX = pageX;\n    this.mouseY = pageY;\n\n    // Make sure the image is within the cutout window.\n    const imgRect = this.preview.current.getBoundingClientRect();\n\n    // Check if the new position is within the boundaries, and if not if it's closer to them.\n    let panX = Cropper.checkBound(this.state.panX, [imgRect.left, imgRect.right],\n      [this.cutoutRect.left, this.cutoutRect.right], dX);\n    let panY = Cropper.checkBound(this.state.panY, [imgRect.top, imgRect.bottom],\n      [this.cutoutRect.top, this.cutoutRect.bottom], dY);\n\n    this.positionAll(panX, panY, this.state.zoom);\n  }\n\n  // Image panning.\n  mouseMove(e) {\n    e.preventDefault();\n    this.translate(e.pageX, e.pageY);\n  }\n\n  mouseTouch(e) {\n    e.preventDefault();\n\n    if (e.touches.length == 1) {\n      this.translate(e.touches[0].pageX, e.touches[0].pageY);\n      return;\n    }\n\n    // Image zooming by pinching.\n    const [touch0, touch1] = e.touches;\n    const distance = Math.sqrt((touch0.pageX - touch1.pageX) * (touch0.pageX - touch1.pageX) +\n      (touch0.pageY - touch1.pageY) * (touch0.pageY - touch1.pageY));\n\n    if (!this.prevDistance) {\n        this.prevDistance = distance / this.state.zoom;\n    }\n\n    let scale = (distance / this.prevDistance);\n    this.handleZoom(Math.max(this.minZoom, Math.min(this.maxZoom, scale)));\n  }\n\n  mouseUp(e) {\n    window.removeEventListener('mousemove', this.mouseMove);\n    window.removeEventListener('touchmove', this.mouseTouch);\n    window.removeEventListener('mouseup', this.mouseUp);\n    window.removeEventListener('touchend', this.mouseUp);\n    // Re-enable text selection.\n    document.body.style['userSelect'] = '';\n\n    this.positionAll(this.state.panX, this.state.panY, this.state.zoom);\n  }\n\n  render() {\n    // transform3d: position and scale.\n    const t3d = `translate3d(${this.state.panX}px, ${this.state.panY}px, 0) scale(${this.state.zoom})`;\n    // transformOrigin: zoom origin.\n    const orig = `${this.state.originX}px ${this.state.originY}px`;\n\n    // Overlay position and size are exactly equal to the position and size of the transformed image\n    // except it uses different coordinates.\n    const overlay = {\n      top: `${this.originY - this.state.originY * this.state.zoom}px`,\n      left: `${this.originX - this.state.originX * this.state.zoom}px`,\n      width: `${this.imageWidth * this.state.zoom}px`,\n      height: `${this.imageHeight * this.state.zoom}px`\n    };\n    return (\n      <div className=\"cropper\">\n        <div className=\"bounding-box\" ref={this.boundingBox}>\n          <img src={this.props.source} className=\"preview\" alt=\"\"\n            style={{transform: t3d, transformOrigin: orig}} ref={this.preview} onLoad={this.initScaling} />\n          <div className=\"cutout circle\" ref={this.cutout} />\n          <div className=\"overlay\" style={overlay} ref={this.overlay} />\n        </div>\n        <div className=\"zoom-wrapper\">\n          <input type=\"range\" className=\"zoomer\"\n            step=\"0.001\" min={this.state.minZoom} max={this.state.maxZoom} value={this.state.zoom} onChange={this.onZoom} />\n        </div>\n      </div>\n    );\n  }\n}\n","// Edit account parameters.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport Cropper from './cropper.jsx';\nimport { imageCrop } from '../lib/blob-helpers.js';\n\nexport default class AvatarCrop extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      top: 0,\n      left: 0,\n      width: 0,\n      height: 0,\n      scale: 1\n    };\n\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  // Cut out in image coordinates and desired scale factor.\n  handleChange(left, top, width, height, scale) {\n    this.setState({\n      left: left,\n      top: top,\n      width: width,\n      height: height,\n      scale: scale\n    });\n  }\n\n  handleSubmit() {\n    imageCrop(this.props.mime, this.props.avatar,\n      this.state.left, this.state.top, this.state.width, this.state.height,\n      this.state.scale)\n      .then(img => {\n        this.props.onSubmit(img.mime, img.blob, img.width, img.height);\n      })\n      .catch(err => {\n        this.props.onError(err);\n      });\n  }\n\n  render() {\n    return (\n      <div className=\"panel-form\">\n        <div className=\"panel-form-row\">\n          <Cropper\n            source={this.props.avatar}\n            onChange={this.handleChange} />\n        </div>\n        <div className=\"dialog-buttons\">\n          {this.props.onCancel ?\n            <button className=\"secondary\" onClick={this.props.onCancel}>\n              <FormattedMessage id=\"button_cancel\" defaultMessage=\"Cancel\" description=\"Button [Cancel]\" />\n            </button>\n            : null}\n          <button className=\"primary\" onClick={this.handleSubmit}>\n            <FormattedMessage id=\"button_ok\" defaultMessage=\"OK\" description=\"Button [OK]\" />\n          </button>\n        </div>\n      </div>\n    );\n  }\n};\n","// Password with a visiblity toggle.\nimport React from 'react';\n\nexport default class VisiblePassword extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.inputRef = React.createRef();\n\n    this.state = {\n      value: this.props.value,\n      visible: false\n    };\n\n    this.handleVisibility = this.handleVisibility.bind(this);\n    this.handeTextChange = this.handeTextChange.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleEditingFinished = this.handleEditingFinished.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.props.autoFocus) {\n      this.inputRef.current.focus();\n    }\n  }\n\n  handeTextChange(e) {\n    this.setState({value: e.target.value});\n    if (this.props.onChange) {\n      this.props.onChange(e);\n    }\n  }\n\n  handleVisibility(e) {\n    e.preventDefault();\n    this.setState({visible: !this.state.visible});\n  }\n\n  handleKeyDown(e) {\n    if (e.keyCode == 27) {\n      // Escape pressed\n      this.setState({value: this.props.value, visible: false});\n      if (this.props.onFinished) {\n        this.props.onFinished();\n      }\n    } else if (e.keyCode == 13) {\n      // Enter pressed\n      this.handleEditingFinished();\n    }\n  }\n\n  handleEditingFinished(e) {\n    if (e) {\n      let currentTarget = e.currentTarget;\n      setTimeout(() => {\n        if (!currentTarget.contains(document.activeElement)) {\n          if (this.props.onFinished) {\n            this.props.onFinished(this.state.value);\n          }\n        }\n      }, 0);\n    } else if (this.props.onFinished) {\n      this.props.onFinished(this.state.value.trim());\n    }\n  }\n\n  render() {\n    return (\n      <div tabIndex=\"-1\" className=\"group-focus\" onBlur={this.handleEditingFinished}>\n        <input className=\"with-visibility\"\n          type={this.state.visible ? \"text\" : \"password\"}\n          value={this.state.value}\n          placeholder={this.props.placeholder}\n          required={this.props.required ? 'required' : ''}\n          autoFocus={this.props.autoFocus ? 'autoFocus' : ''}\n          autoComplete={this.props.autoComplete}\n          onChange={this.handeTextChange}\n          onKeyDown={this.handleKeyDown}\n          ref={this.inputRef} />\n        <span onClick={this.handleVisibility}>\n          <i className=\"material-icons clickable light-gray\">\n            {this.state.visible ? 'visibility' : 'visibility_off'}\n          </i>\n        </span>\n      </div>\n    );\n  }\n}\n","// In-place text editor. Shows text with an icon which toggles it into an input field.\nimport React from 'react';\n\nimport VisiblePassword from './visible-password.jsx';\n\nexport default class InPlaceEdit extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.selfRef = React.createRef();\n\n    this.state = {\n      active: props.active,\n      initialValue: props.value || '',\n      value: props.value || ''\n    };\n\n    this.handeTextChange = this.handeTextChange.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleStartEditing = this.handleStartEditing.bind(this);\n    this.handleEditingFinished = this.handleEditingFinished.bind(this);\n    this.handlePasswordFinished = this.handlePasswordFinished.bind(this);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    // If text has changed while in read mode, update text and discard changes.\n    // Ignore update if in edit mode.\n    const newValue = this.props.value || '';\n    if (prevState.initialValue != newValue && !prevState.active) {\n      this.setState({\n        initialValue: newValue,\n        value: newValue\n      });\n    }\n  }\n\n  handeTextChange(e) {\n    this.setState({value: e.target.value || ''});\n  }\n\n  handleKeyDown(e) {\n    if (e.keyCode === 27) {\n      // Escape pressed\n      this.setState({value: this.props.value, active: false});\n    } else if (e.keyCode === 13) {\n      // Enter pressed\n      this.handleEditingFinished(e);\n    }\n  }\n\n   handleStartEditing() {\n    if (!this.props.readOnly) {\n      this.setState({active: true}, () => {\n        if (this.selfRef.current) {\n          this.selfRef.current.focus();\n        }\n      });\n    }\n  }\n\n  handleEditingFinished(event) {\n    const value = this.state.value.trim();\n    if (this.props.required && (!event.target.checkValidity() || !value)) {\n      // Empty input\n      this.setState({value: this.props.value, active: false});\n      return;\n    }\n    this.setState({active: false});\n    if ((value || this.props.value) && (value !== this.props.value)) {\n      this.props.onFinished(value);\n    }\n  }\n\n  handlePasswordFinished(value) {\n    this.setState({active: false});\n    if (value && (value !== this.props.value)) {\n      this.props.onFinished(value);\n    }\n  }\n\n  render() {\n    if (!this.state.active) {\n      let spanText = this.props.type == 'password' ? '••••••••' : this.state.value;\n      let spanClass = 'in-place-edit' + (this.props.readOnly ? ' disabled' : '');\n      if (!spanText) {\n        spanText = this.props.placeholder;\n        spanClass += ' placeholder';\n      }\n      if (!this.props.multiline || this.props.multiline == 1) {\n        spanClass += ' short';\n      }\n\n      return (<span className={spanClass} onClick={this.handleStartEditing}>\n        <span>{spanText}</span>\n      </span>);\n    }\n\n    let element;\n    const attr = {};\n    if (this.props.type == 'password') {\n      element = VisiblePassword;\n      attr.onFinished = this.handlePasswordFinished;\n    } else {\n      if (this.props.multiline > 1) {\n        element = 'textarea';\n        attr.rows = this.props.multiline;\n        attr.className = 'inplace-edit';\n      } else {\n        element = 'input';\n        attr.type = this.props.type || 'text';\n      }\n      attr.value = this.state.value;\n      attr.ref = this.selfRef;\n      attr.onChange = this.handeTextChange;\n      attr.onKeyDown = this.handleKeyDown;\n      attr.onBlur = this.handleEditingFinished;\n    }\n    attr.placeholder = this.props.placeholder;\n    attr.required = this.props.required ? 'required' : '';\n    attr.autoComplete = this.props.autoComplete;\n    attr.autoFocus = true;\n\n    return React.createElement(element, attr, null);\n  }\n};\n","// TagManager: edit topic or user tags.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport ChipInput from './chip-input.jsx';\n\nimport { MAX_TAG_COUNT, MAX_TAG_LENGTH, MIN_TAG_LENGTH } from '../config.js';\nimport { arrayEqual } from '../lib/utils.js';\n\nexport default class TagManager extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      tags: this.props.tags || [],\n      tagInput: '',\n      activated: this.props.activated\n    };\n\n    this.handleTagInput = this.handleTagInput.bind(this);\n    this.handleAddTag = this.handleAddTag.bind(this);\n    this.handleRemoveTag = this.handleRemoveTag.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    const tags = nextProps.tags || [];\n    if (!arrayEqual(tags, prevState.tags) && !prevState.activated) {\n      return {tags: tags};\n    }\n    return null;\n  }\n\n  handleTagInput(text) {\n    this.setState({tagInput: text});\n    if (text.length > 0) {\n      const last = text[text.length-1];\n      if (text[0] == '\"') {\n        // This is a quoted string.\n        if (text.length > 1 && last == '\"') {\n          this.handleAddTag(text.substring(1, text.length-1));\n        }\n      } else if (last == ',' || last == ' ' || last == ';' || last == '\"') {\n        // User entered ',', ' ' or ';'\n        this.handleAddTag(text.substring(0, text.length-1).trim());\n      }\n    }\n  }\n\n  handleAddTag(tag) {\n    const maxTagCount = this.props.tinode.getServerParam('maxTagCount', MAX_TAG_COUNT);\n\n    if (tag.length > 0 && this.state.tags.length < maxTagCount) {\n      const tags = this.state.tags.slice(0);\n      tags.push(tag);\n\n      this.setState({tags: tags, tagInput: ''});\n      if (this.props.onTagsChanged) {\n        this.props.onTagsChanged(tags);\n      }\n      return tags;\n    }\n    return this.state.tags;\n  }\n\n  handleRemoveTag(tag, index) {\n    const tags = this.state.tags.slice(0);\n    tags.splice(index, 1);\n    this.setState({tags: tags});\n    if (this.props.onTagsChanged) {\n      this.props.onTagsChanged(tags);\n    }\n  }\n\n  handleSubmit() {\n    // Add unprocessed input to tags, submit the list.\n    this.props.onSubmit(this.handleAddTag(this.state.tagInput.trim()));\n    this.setState({activated: false, tags: this.props.tags || []});\n  }\n\n  handleCancel() {\n    this.setState({activated: false, tagInput: '', tags: this.props.tags || []});\n    if (this.props.onCancel) {\n      this.props.onCancel();\n    }\n  }\n\n  render() {\n    const minTagLength = this.props.tinode.getServerParam('minTagLength', MIN_TAG_LENGTH);\n    const maxTagLength = this.props.tinode.getServerParam('maxTagLength', MAX_TAG_LENGTH);\n\n    let tags = [];\n    if (this.state.activated) {\n      this.state.tags.map((tag) => {\n        tags.push({user: tag, invalid: (tag.length < minTagLength || tag.length > maxTagLength)});\n      });\n    } else {\n      this.state.tags.map((tag) => {\n        tags.push(<span className=\"badge\" key={tags.length}>{tag}</span>);\n      });\n      if (tags.length == 0) {\n        tags = (\n          <i>\n            <FormattedMessage id=\"tags_not_found\" defaultMessage=\"No tags defined. Add some.\" description=\"\" />\n          </i>\n        );\n      }\n    }\n    return (\n      <div className=\"panel-form-column\">\n        <div className=\"panel-form-row\">\n          <label className=\"small\">{this.props.title}</label>\n        </div>\n        {this.state.activated ?\n        <div>\n          <FormattedMessage id=\"tags_editor_no_tags\" defaultMessage=\"Add some tags\"\n            description=\"Tag editor prompt when no tags are found.\">{\n            (add_tags_prompt) => <ChipInput\n              tinode={this.props.tinode}\n              chips={tags}\n              avatarDisabled={true}\n              prompt={add_tags_prompt}\n              tabIndex={this.props.tabIndex}\n              onEnter={this.handleAddTag}\n              onFocusLost={this.handleAddTag}\n              onCancel={this.handleCancel}\n              onChipRemoved={this.handleRemoveTag}\n              filterFunc={this.handleTagInput} />\n          }</FormattedMessage>\n          {this.props.onSubmit || this.props.onCancel ?\n            <div id=\"tag-manager-buttons\" className=\"dialog-buttons panel-form-row\">\n              <button className=\"outline\" onClick={this.handleCancel}>\n                <FormattedMessage id=\"button_cancel\" defaultMessage=\"Cancel\" description=\"Button [Cancel]\" />\n              </button>\n              <button className=\"primary\" onClick={this.handleSubmit}>\n                <FormattedMessage id=\"button_ok\" defaultMessage=\"OK\" description=\"Button [OK]\" />\n              </button>\n            </div>\n          : null}\n        </div>\n        :\n        <div className=\"quoted\">\n          <a href=\"#\" className=\"flat-button\" onClick={(e) => {e.preventDefault(); this.setState({activated: true});}}>\n            <i className=\"material-icons\">edit</i> &nbsp;<FormattedMessage id=\"title_manage_tags\" defaultMessage=\"Manage\"\n              description=\"Section title for the list of tags\" />\n          </a>\n          <>{tags}</>\n        </div>\n      }\n      </div>\n    );\n  }\n};\n","// Widget for editing topic description.\n\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport { Tinode } from 'tinode-sdk';\n\nimport AvatarCrop from './avatar-crop.jsx';\nimport AvatarUpload from './avatar-upload.jsx';\nimport InPlaceEdit from './in-place-edit.jsx';\nimport TagManager from './tag-manager.jsx';\n\nimport { AVATAR_SIZE, MAX_AVATAR_BYTES, MAX_EXTERN_ATTACHMENT_SIZE, MAX_TITLE_LENGTH,\n  MAX_TOPIC_DESCRIPTION_LENGTH } from '../config.js';\nimport { imageScaled, blobToBase64, makeImageUrl } from '../lib/blob-helpers.js';\nimport { arrayEqual, theCard } from '../lib/utils.js';\n\nexport default class TopicDescEdit extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    const acs = topic.getAccessMode();\n    this.state = {\n      isMe: Tinode.isMeTopicName(this.props.topic),\n      owner: acs && acs.isOwner(),\n      fullName: topic.public ? topic.public.fn : undefined,\n      private: topic.private ? topic.private.comment : null,\n      description: topic.public ? topic.public.note : undefined,\n      avatar: makeImageUrl(topic.public ? topic.public.photo : null),\n      tags: topic.tags() || [],\n      newAvatar: null,\n      newAvatarMime: null\n    };\n\n    this.previousOnTags = null;\n\n    this.tnNewTags = this.tnNewTags.bind(this);\n    this.handleFullNameUpdate = this.handleFullNameUpdate.bind(this);\n    this.handleImageUpdated = this.handleImageUpdated.bind(this);\n    this.handleAvatarCropped = this.handleAvatarCropped.bind(this);\n    this.handleAvatarCropCancel = this.handleAvatarCropCancel.bind(this);\n    this.uploadAvatar = this.uploadAvatar.bind(this);\n    this.handlePrivateUpdate = this.handlePrivateUpdate.bind(this);\n    this.handleDescriptionUpdate = this.handleDescriptionUpdate.bind(this);\n    this.handleTagsUpdated = this.handleTagsUpdated.bind(this);\n  }\n\n  componentDidMount() {\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    this.previousOnTags = topic.onTagsUpdated;\n    topic.onTagsUpdated = this.tnNewTags;\n  }\n\n  componentWillUnmount() {\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    topic.onTagsUpdated = this.previousOnTags;\n  }\n\n  tnNewTags(tags) {\n    this.setState({tags: tags});\n  }\n\n  handleFullNameUpdate(fn) {\n    fn = fn.trim().substring(0, MAX_TITLE_LENGTH);\n    if (fn && this.state.fullName !== fn) {\n      this.setState({fullName: fn});\n      this.props.onUpdateTopicDesc(this.props.topic, theCard(fn, null));\n    }\n  }\n\n  handlePrivateUpdate(comment) {\n    comment = comment.trim().substring(0, MAX_TITLE_LENGTH);\n    if (this.state.private !== comment) {\n      this.setState({private: comment});\n      this.props.onUpdateTopicDesc(this.props.topic, null, comment || Tinode.DEL_CHAR);\n    }\n  }\n\n  handleDescriptionUpdate(desc) {\n    desc = desc.trim().substring(0, MAX_TOPIC_DESCRIPTION_LENGTH);\n    if (desc) {\n      this.setState({description: desc});\n      this.props.onUpdateTopicDesc(this.props.topic, theCard(null, null, null, desc));\n    }\n  }\n\n  // AvatarUpload widget has changed the avatar: received a new file or deleted the avatar.\n  handleImageUpdated(mime, img) {\n    // This will show the AvatarCropView is img is not null.\n    this.setState({newAvatar: img, newAvatarMime: mime});\n    if (!img) {\n      // Deleting the avatar.\n      this.setState({avatar: null});\n      this.props.onUpdateTopicDesc(this.props.topic, theCard(null, Tinode.DEL_CHAR));\n    }\n  }\n\n  // AvatarCropView calls this method when the user has cropped the image.\n  handleAvatarCropped(mime, blob, width, height) {\n    const url = blob ? URL.createObjectURL(blob) : null;\n    this.setState({avatar: url, newAvatar: null, newAvatarMime: null});\n    if (blob) {\n      this.uploadAvatar(mime, blob, width, height);\n    }\n  }\n\n  // Utility method for converting cropped avatar blob to bytes for sending inband or\n  // for uploading it to the server out of band.\n  uploadAvatar(mime, blob, width, height) {\n    const readyToUpload = image => {\n      let {mime, blob} = image;\n      if (blob.size > MAX_AVATAR_BYTES) {\n        // Too large to send inband - uploading out of band and sending as a link.\n        const uploader = this.props.tinode.getLargeFileHelper();\n        uploader.upload(blob)\n          .then(url => this.props.onUpdateTopicDesc(this.props.topic, theCard(null, url)))\n          .catch(err => this.props.onError(err.message, 'err'));\n      } else {\n        // Convert blob to base64-encoded bits.\n        blobToBase64(blob)\n          .then(b64 => {\n            const du = makeImageUrl({data: b64.bits, type: mime});\n            this.setState({source: du});\n            this.props.onUpdateTopicDesc(this.props.topic, theCard(null, du));\n          });\n      }\n    };\n\n    if (width > AVATAR_SIZE || height > AVATAR_SIZE || width != height) {\n      // Avatar is not square or too large even after cropping. Shrink it and make square.\n      imageScaled(blob, AVATAR_SIZE, AVATAR_SIZE, MAX_EXTERN_ATTACHMENT_SIZE, true)\n        .then(scaled => readyToUpload(scaled))\n        .catch(err => this.props.onError(err.message, 'err'));\n    } else {\n      readyToUpload({mime: mime, blob: blob, width: width, height: height});\n    }\n  }\n\n  handleAvatarCropCancel() {\n    this.setState({newAvatar: null, newAvatarMime: null});\n  }\n\n  handleTagsUpdated(tags) {\n    // Check if tags have actually changed.\n    if (arrayEqual(this.state.tags.slice(0), tags.slice(0))) {\n      return;\n    }\n    this.props.onUpdateTags(tags);\n  }\n\n  render() {\n    if (this.state.newAvatar) {\n      return (\n        <AvatarCrop\n          avatar={this.state.newAvatar}\n          mime={this.state.newAvatarMime}\n          onSubmit={this.handleAvatarCropped}\n          onCancel={this.handleAvatarCropCancel}\n          onError={this.props.onError} />\n      );\n    }\n\n    const editable = this.state.isMe || this.state.owner;\n\n    return (\n      <>\n      <div className=\"panel-form-column\">\n        <center>\n          <AvatarUpload\n            tinode={this.props.tinode}\n            avatar={this.state.avatar}\n            readOnly={!editable}\n            uid={this.props.topic}\n            title={this.state.fullName}\n            onImageUpdated={this.handleImageUpdated}\n            onError={this.props.onError} />\n        </center>\n        {this.state.isMe ?\n          <div className=\"group\">\n            <label className=\"small\">\n              <FormattedMessage id=\"label_your_name\" defaultMessage=\"Your name\"\n              description=\"Label for full name editing\" />\n            </label>\n            <div>\n              <FormattedMessage id=\"full_name_prompt\" defaultMessage=\"Full name, e.g. John Doe\"\n                description=\"Input placeholder for person's full name\">{\n                (full_name_placeholder) => <InPlaceEdit\n                  placeholder={full_name_placeholder}\n                  value={this.state.fullName}\n                  required={true}\n                  onFinished={this.handleFullNameUpdate} />\n              }</FormattedMessage>\n            </div>\n          </div>\n        :\n          <>\n            <div className=\"group\">\n              <div><label className=\"small\">\n                <FormattedMessage id=\"label_topic_name\" defaultMessage=\"Name\"\n                  description=\"Label for editing topic name\" />\n              </label></div>\n              <div>\n                <FormattedMessage id=\"topic_name_editing_placeholder\" defaultMessage=\"Freeform name of the group\"\n                  description=\"Prompt for entering topic name\">{\n                  (group_name_placeholder) => <InPlaceEdit\n                    placeholder={group_name_placeholder}\n                    readOnly={!editable}\n                    value={this.state.fullName}\n                    required={true}\n                    onFinished={this.handleFullNameUpdate} />\n                }</FormattedMessage>\n              </div>\n            </div>\n            <div className=\"group\">\n              <div>\n                <label className=\"small\">\n                  <FormattedMessage id=\"label_private\" defaultMessage=\"Private comment\"\n                    description=\"Label for editing 'private'\" />\n                </label>\n              </div>\n              <div>\n                <FormattedMessage id=\"private_editing_placeholder\" defaultMessage=\"Visible to you only\"\n                  description=\"Placeholder for editing 'private'\">{\n                  (private_placeholder) => <InPlaceEdit\n                    placeholder={private_placeholder}\n                    value={this.state.private}\n                    onFinished={this.handlePrivateUpdate} />\n                }</FormattedMessage>\n              </div>\n            </div>\n          </>\n        }\n        {editable || this.state.description ?\n          <div className=\"group\">\n            <div><label className=\"small\">\n              <FormattedMessage id=\"label_description\" defaultMessage=\"Description\"\n                description=\"Label for editing topic description\" />\n            </label></div>\n            <div>\n              <FormattedMessage id=\"description_editing_placeholder\"\n                defaultMessage=\"Description (optional)\"\n                description=\"Placeholder for editing topic description\">{\n                (private_placeholder) => <InPlaceEdit\n                  placeholder={private_placeholder}\n                  readOnly={!editable}\n                  value={this.state.description}\n                  multiline={2}\n                  onFinished={this.handleDescriptionUpdate} />\n              }</FormattedMessage>\n            </div>\n          </div>\n          : null\n        }\n      </div>\n      {editable ?\n        <>\n          <div className=\"hr\" />\n          <FormattedMessage id=\"title_tag_manager\" defaultMessage=\"Tags (search & discovery)\"\n            description=\"Section title for TagManager\">{\n              (title_tag_manager) => <TagManager\n                tinode={this.props.tinode}\n                title={title_tag_manager}\n                activated={false}\n                tags={this.state.tags}\n                onSubmit={this.handleTagsUpdated} />\n          }</FormattedMessage>\n        </>\n        : null\n      }\n      </>\n    );\n  }\n};\n","// View for editing topic (including 'me' topic) parameters.\n\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport TopicDescEdit from '../widgets/topic-desc-edit.jsx';\n\nimport { arrayEqual, asEmail, asPhone } from '../lib/utils.js';\n\nexport default class TopicCommon extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    const acs = topic.getAccessMode();\n    this.state = {\n      isMe: this.props.topic == 'me',\n      owner: acs && acs.isOwner(),\n      credentials: (topic.getCredentials ? topic.getCredentials() : null) || [],\n      addCredActive: false,\n      addCredInvalid: false,\n      newCred: '',\n      tags: []\n    };\n\n    this.previousTagsUpdated = undefined;\n\n    this.onTagsUpdated = this.onTagsUpdated.bind(this);\n    this.handleTagsUpdated = this.handleTagsUpdated.bind(this);\n    this.tnCredsUpdated = this.tnCredsUpdated.bind(this);\n    this.handleCredChange = this.handleCredChange.bind(this);\n    this.handleCredKeyDown = this.handleCredKeyDown.bind(this);\n    this.handleCredEntered = this.handleCredEntered.bind(this);\n  }\n\n  // No need to separately handle component mount.\n  componentDidUpdate(props) {\n    const topic = this.props.tinode.getTopic(props.topic);\n    if (!topic) {\n      return;\n    }\n\n    topic.onCredsUpdated = this.tnCredsUpdated;\n\n    if (topic.onTagsUpdated != this.onTagsUpdated) {\n      if (topic.getType() == 'grp') {\n        this.previousTagsUpdated = topic.onTagsUpdated;\n        topic.onTagsUpdated = this.onTagsUpdated;\n      } else {\n        this.previousTagsUpdated = undefined;\n      }\n    }\n\n    if (this.state.topic != props.topic) {\n      this.setState({topic: props.topic});\n    }\n  }\n\n  componentWillUnmount() {\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    topic.onCredsUpdated = undefined;\n    topic.onTagsUpdated = this.previousTagsUpdated;\n  }\n\n  tnCredsUpdated(creds) {\n    this.setState({credentials: creds || []});\n  }\n\n  handleCredChange(e) {\n    this.setState({newCred: e.target.value, addCredInvalid: false});\n  }\n\n  handleCredKeyDown(e) {\n    if (e.keyCode === 27) {\n      // Escape pressed\n      this.setState({newCred: '', addCredActive: false});\n    } else if (e.keyCode === 13) {\n      // Enter pressed\n      this.handleCredEntered(e);\n    }\n  }\n\n  handleCredEntered(e) {\n    const value = this.state.newCred.trim();\n    if (!value) {\n      this.setState({addCredActive: false, addCredInvalid: false});\n      return;\n    }\n\n    let val = asPhone(value);\n    let method;\n    if (val) {\n      method = 'tel';\n    } else {\n      val = asEmail(value);\n      if (val) {\n        method = 'email';\n      }\n    }\n    if (method) {\n      this.props.onCredAdd(method, val);\n      this.setState({addCredActive: false, newCred: ''});\n    } else {\n      this.setState({addCredInvalid: true});\n    }\n  }\n\n  // Server informs that the tags have been updated.\n  onTagsUpdated(tags) {\n    this.setState({tags: tags});\n\n    if (this.previousTagsUpdated && this.previousTagsUpdated != this.onTagsUpdated) {\n      this.previousTagsUpdated(tags);\n    }\n  }\n\n  // Request server to change tags.\n  handleTagsUpdated(tags) {\n    if (!arrayEqual(this.state.tags.slice(0), tags.slice(0))) {\n      this.props.onTopicTagsUpdateRequest(this.props.topic, tags);\n    }\n  }\n\n  render() {\n    const credentials = [];\n    if (this.state.isMe) {\n      this.state.credentials.map((cred) => {\n        credentials.push(\n          <div key={cred.meth + \":\" + cred.val + \":\" + cred.done}>{cred.meth}: <tt>{cred.val}</tt>\n            <span> {!cred.done ?\n              <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onCredConfirm(cred.meth, cred.val);}}>\n                <FormattedMessage id=\"validate_credential_action\" defaultMessage=\"confirm\"\n                  description=\"Validate credentail call to action\" />\n              </a>\n            : null} <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onCredDelete(cred.meth, cred.val);}}><i\n              className=\"material-icons gray\">delete_outline</i></a></span>\n          </div>\n        );\n      });\n    }\n\n    return (\n      <div className=\"scrollable-panel\">\n        <TopicDescEdit\n          tinode={this.props.tinode}\n          topic={this.props.topic}\n          onUpdateTopicDesc={this.props.onUpdateTopicDesc}\n          onUpdateTags={this.handleTagsUpdated}\n          onError={this.props.onError} />\n        {this.state.isMe ?\n          <>\n            <div className=\"hr\" />\n            <div className=\"panel-form-column\">\n              <label className=\"small\">\n                <FormattedMessage id=\"label_user_contacts\" defaultMessage=\"Contacts:\"\n                description=\"Label for user contacts\" />\n              </label>\n              <div className=\"quoted\">\n                {credentials}\n                {this.state.addCredActive ?\n                  <FormattedMessage id=\"phone_or_email_prompt\" defaultMessage=\"Phone number or email\"\n                    description=\"Placeholer for phone or email\">{(phone_or_email_prompt) =>\n                    <input type=\"text\" value={this.state.value}\n                      className={this.state.addCredInvalid ? 'invalid' : null}\n                      placeholder={phone_or_email_prompt} required=\"required\" autoFocus\n                      onChange={this.handleCredChange} onKeyDown={this.handleCredKeyDown} onBlur={this.handleCredEntered} />\n                  }</FormattedMessage>\n                  : null}\n                <div>\n                  <a href=\"#\" onClick={(e) => {e.preventDefault(); this.setState({addCredActive: true});}}>\n                    <i className=\"material-icons\">add</i>\n                    <FormattedMessage id=\"button_add_another\" defaultMessage=\"Add another\" description=\"Call to action [+ add another]\" />\n                  </a></div>\n              </div>\n            </div>\n          </>\n        : null\n      }\n      </div>\n    );\n  }\n};\n","// Edit account parameters.\nimport React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nimport InPlaceEdit from './in-place-edit.jsx';\n\nimport { NO_ACCESS_MODE } from '../config.js';\n\nconst messages = defineMessages({\n  clear_messages: {\n    id: 'action_clear_messages',\n    defaultMessage: 'Clear Messages',\n    description: 'Flat button [Clear Messages] (soft-delete messages)'\n  },\n  clear_messages_warning: {\n    id: 'clear_messages_warning',\n    defaultMessage: 'Are you sure you want to clear all messages? It cannot be undone.',\n    description: 'Alert dialog warning when deleting all messages.'\n  },\n  delete_messages: {\n    id: 'action_delete_messages',\n    defaultMessage: 'Clear Messages for All',\n    description: 'Flat button [Clear for All] (hard-delete all messages)'\n  },\n  delete_messages_warning: {\n    id: 'delete_messages_warning',\n    defaultMessage: 'Are you sure you want to delete all messages for everyone? It cannot be undone.',\n    description: 'Alert dialog warning when hard-deleting all messages.'\n  },\n  topic_delete: {\n    id: 'topic_delete',\n    defaultMessage: 'Delete Conversation',\n    description: 'Alert title when deleting the topic.'\n  },\n  topic_delete_warning: {\n    id: 'topic_delete_warning',\n    defaultMessage: 'Are you sure you want to delete this conversation? It cannot be undone.',\n    description: 'Alert warning when deleting entire topic'\n  },\n  leave_chat: {\n    id: 'action_leave_chat',\n    defaultMessage: 'Leave Conversation',\n    description: 'Flat button [Leave Conversation]'\n  },\n  leave_chat_warning: {\n    id: 'leave_chat_warning',\n    defaultMessage: 'Are you sure you want to leave this conversation?',\n    description: 'Alert dialog warning when unsubscribing from a chat.'\n  },\n  block_contact: {\n    id: 'action_block_contact',\n    defaultMessage: \"Block Contact\",\n    description: \"Flat button [Block Contact]\"\n  },\n  block_contact_warning: {\n    id: 'block_contact_warning',\n    defaultMessage: 'Are you sure you want to block this contact?',\n    description: 'Alert dialog warning when blocking a contact.'\n  },\n  report_chat: {\n    id: 'action_report_chat',\n    defaultMessage: 'Report Conversation',\n    description: 'Flat button [Report Group]'\n  },\n  report_chat_warning: {\n    id: 'report_chat_warning',\n    defaultMessage: 'Are you sure you want to block and report this conversation?',\n    description: 'Alert dialog warning when reporting a conversation for abuse'\n  },\n  other_user: {\n    id: 'label_other_user',\n    defaultMessage: 'Other',\n    description: 'Label for the other user when the user is unnamed'\n  },\n});\n\nclass TopicSecurity extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.handleDeleteTopic = this.handleDeleteTopic.bind(this);\n    this.handleDeleteMessages = this.handleDeleteMessages.bind(this);\n    this.handleLeave = this.handleLeave.bind(this);\n    this.handleBlock = this.handleBlock.bind(this);\n    this.handleReport = this.handleReport.bind(this);\n  }\n\n  handleDeleteTopic(e) {\n    e.preventDefault();\n    const {formatMessage} = this.props.intl;\n    this.props.onShowAlert(\n      formatMessage(messages.topic_delete), // title\n      formatMessage(messages.topic_delete_warning), // content\n      (() => { this.props.onDeleteTopic(this.props.topic); }), // onConfirm\n      null, // \"OK\"\n      true, // Show Reject button\n      null  // \"Cancel\"\n    );\n  }\n\n  handleDeleteMessages(e) {\n    e.preventDefault();\n    const {formatMessage} = this.props.intl;\n    this.props.onShowAlert(\n      formatMessage(this.props.deleter ? messages.delete_messages : messages.clear_messages), // title\n      formatMessage(this.props.deleter ? messages.delete_messages_warning : messages.clear_messages_warning), // content\n      (() => { this.props.onDeleteMessages(this.props.topic); }), // onConfirm\n      null, // \"OK\"\n      true, // Show Reject button\n      null  // \"Cancel\"\n    );\n  }\n\n  handleLeave(e) {\n    e.preventDefault();\n    const {formatMessage} = this.props.intl;\n    this.props.onShowAlert(\n      formatMessage(messages.leave_chat), // title\n      formatMessage(messages.leave_chat_warning), // content\n      (() => { this.props.onLeaveTopic(this.props.topic); }), // onConfirm\n      null, // \"OK\"\n      true, // Show Reject button\n      null  // \"Cancel\"\n    );\n  }\n\n  handleBlock(e) {\n    e.preventDefault();\n    const {formatMessage} = this.props.intl;\n    this.props.onShowAlert(\n      formatMessage(messages.block_contact), // title\n      formatMessage(messages.block_contact_warning), // content\n      (() => { this.props.onBlockTopic(this.props.topic); }), // onConfirm\n      null, // \"OK\"\n      true, // Show Reject button\n      null  // \"Cancel\"\n    );\n  }\n\n  handleReport(e) {\n    e.preventDefault();\n    const {formatMessage} = this.props.intl;\n    this.props.onShowAlert(\n      formatMessage(messages.report_chat), // title\n      formatMessage(messages.report_chat_warning), // content\n      (_ => { this.props.onReportTopic(this.props.topic); }), // onConfirm\n      null, // \"OK\"\n      true, // Show Reject button\n      null  // \"Cancel\"\n    );\n  }\n\n  render() {\n    const {formatMessage} = this.props.intl;\n    return (\n      <div className=\"scrollable-panel\">\n        <div className=\"panel-form-column\">\n          {!this.props.channel ?\n            <a href=\"#\" className=\"flat-button\" onClick={this.handleDeleteMessages}>\n              <i className=\"material-icons\">delete_outline</i> &nbsp;{\n                formatMessage(this.props.deleter ? messages.delete_messages : messages.clear_messages)\n              }\n            </a>\n            :\n            null\n          }\n          {this.props.owner ?\n            <a href=\"#\" className=\"danger flat-button\" onClick={this.handleDeleteTopic}>\n              <i className=\"material-icons\">delete</i> &nbsp;{formatMessage(messages.topic_delete)}\n            </a>\n            :\n            <a href=\"#\" className=\"danger flat-button\" onClick={this.handleLeave}>\n              <i className=\"material-icons\">exit_to_app</i> &nbsp;{formatMessage(messages.leave_chat)}\n            </a>\n          }\n          {!this.props.groupTopic ?\n            <a href=\"#\" className=\"danger flat-button\" onClick={this.handleBlock}>\n              <i className=\"material-icons\">block</i> &nbsp;{formatMessage(messages.block_contact)}\n            </a>\n            :\n            null\n          }\n          {!this.props.owner ?\n            <a href=\"#\" className=\"danger flat-button\" onClick={this.handleReport}>\n              <i className=\"material-icons\">report</i> &nbsp;{formatMessage(messages.report_chat)}\n            </a>\n            :\n            null\n          }\n        </div>\n        <div className=\"hr\" />\n        <div className=\"panel-form-column\">\n          {this.props.groupTopic ?\n            <>\n              <div className=\"group\">\n                <label>\n                  <FormattedMessage id=\"label_your_permissions\" defaultMessage=\"Your permissions:\"\n                    description=\"Label for current user permissions\" />\n                </label> <tt className=\"clickable\"\n                  onClick={(e) => {e.preventDefault(); this.props.onLaunchPermissionsEditor('want')}}>\n                  {this.props.access}\n                </tt>\n              </div>\n              {!this.props.channel ?\n                <div className=\"group\">\n                  <div>\n                    <label className=\"small\">\n                      <FormattedMessage id=\"label_default_access_mode\" defaultMessage=\"Default access mode:\"\n                      description=\"Label for default access mode\" />\n                    </label>\n                  </div>\n                  <div className=\"quoted\">\n                    <div>Auth: <tt className={this.props.owner ? 'clickable' : null}\n                      onClick={(e) => {\n                        e.preventDefault();\n                        if (this.props.owner) {\n                          this.props.onLaunchPermissionsEditor('auth');\n                        }\n                      }}>{this.props.auth}</tt>\n                    </div>\n                    <div>Anon: <tt className={this.props.owner ? 'clickable' : null}\n                      onClick={(e) => {\n                        e.preventDefault();\n                        if (this.props.owner) {\n                          this.props.onLaunchPermissionsEditor('anon');\n                        }\n                      }}>{this.props.anon}</tt>\n                    </div>\n                  </div>\n                </div>\n              :\n                null\n              }\n            </>\n            :\n            <div className=\"group\">\n              <div>\n                <label className=\"small\">\n                  <FormattedMessage id=\"label_permissions\" defaultMessage=\"Permissions:\"\n                    description=\"Section title\" />\n                </label>\n              </div>\n              <div className=\"quoted\">\n                <div>\n                  <FormattedMessage id=\"label_you\" defaultMessage=\"You:\"\n                    description=\"Label for the current user\" /> <tt className=\"clickable\"\n                    onClick={(e) => {e.preventDefault(); this.props.onLaunchPermissionsEditor('want')}}>\n                    {this.props.access}\n                  </tt>\n                </div>\n                <div>{this.props.fullName ? this.props.fullName : formatMessage(messages.other_user)}:\n                  &nbsp;<tt className=\"clickable\"\n                    onClick={(e) => {e.preventDefault(); this.props.onLaunchPermissionsEditor('given')}}>\n                    {this.props.modeGiven2}\n                  </tt>\n                </div>\n              </div>\n            </div>\n          }\n        </div>\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(TopicSecurity);\n","// InfoView: panel with topic/user info.\nimport React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nimport { AccessMode, Tinode } from 'tinode-sdk';\n\nimport AvatarUpload from '../widgets/avatar-upload.jsx';\nimport BadgeList from '../widgets/badge-list.jsx';\nimport CheckBox from '../widgets/checkbox.jsx';\nimport ContactList from '../widgets/contact-list.jsx';\nimport ErrorPanel from '../widgets/error-panel.jsx';\nimport GroupManager from '../widgets/group-manager.jsx';\nimport MenuCancel from '../widgets/menu-cancel.jsx';\nimport PermissionsEditor from '../widgets/permissions-editor.jsx';\nimport TopicCommon from '../widgets/topic-common.jsx';\nimport TopicSecurity from '../widgets/topic-security.jsx';\n\nimport { MAX_TITLE_LENGTH, MAX_TOPIC_DESCRIPTION_LENGTH, NO_ACCESS_MODE } from '../config.js';\n\nimport { makeImageUrl } from '../lib/blob-helpers.js';\nimport { theCard, clipStr } from '../lib/utils.js';\n\nconst messages = defineMessages({\n  info: {\n    id: 'panel_title_info',\n    description: 'Title for InfoView',\n    defaultMessage: 'Info'\n  },\n  general: {\n    id: 'panel_title_general',\n    description: 'Title for TopicCommon.',\n    defaultMessage: 'General'\n  },\n  security: {\n    id: 'panel_title_security',\n    description: 'Title for TopicSecirity and AccSecurity.',\n    defaultMessage: 'Security'\n  },\n  members: {\n    id: 'panel_title_members',\n    description: 'Title for managing group members view.',\n    defaultMessage: 'Members'\n  },\n  crop: {\n    id: 'panel_title_crop',\n    description: 'Title for AvatarCropView.',\n    defaultMessage: 'Drag to Adjust'\n  },\n  perm_want: {\n    id: 'requested_permissions',\n    defaultMessage: 'Requested',\n    description: 'Title for permissions'\n  },\n  perm_given: {\n    id: 'granted_permissions',\n    defaultMessage: 'Granted',\n    description: 'Title for permissions'\n  },\n  perm_auth: {\n    id: 'permissions_authenticated',\n    defaultMessage: 'Authenticated',\n    description: 'Title for editing default authenticated permissions'\n  },\n  perm_anon: {\n    id: 'permissions_anonymous',\n    defaultMessage: 'Anonymous',\n    description: 'Title for editing default anonymous permissions'\n  },\n  perm_user: {\n    id: 'permissions_user',\n    defaultMessage: 'User\\'s Permissions',\n    description: 'Title for editing user\\'s permissions'\n  },\n  edit_permissions: {\n    id: 'menu_item_edit_permissions',\n    defaultMessage: 'Edit permissions',\n    description: 'Menu item [Edit permissions]'\n  },\n});\n\nclass InfoView extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      topic: null,\n      owner: false,\n      admin: false,\n      sharer: false,\n      deleter: false,\n      muted: false,\n      address: null,\n      groupTopic: undefined,\n      channel: undefined,\n      fullName: undefined,\n      description: undefined,\n      avatar: null,\n      private: null,\n      selectedContact: null,\n      access: null,\n      modeGiven: null,\n      modeWant: null,\n      modeGiven2: null, // P2P topic, the other user mode given\n      modeWant2: null,  // P2P topic, the other user mode want\n      auth: null,\n      anon: null,\n      contactList: [],\n      trustedBadges: [],\n      previousMetaDesc: undefined,\n      previousSubsUpdated: undefined,\n    };\n\n    this.resetSubs = this.resetSubs.bind(this);\n    this.resetDesc = this.resetDesc.bind(this);\n    this.resetTags = this.resetTags.bind(this);\n    this.onMetaDesc = this.onMetaDesc.bind(this);\n    this.onSubsUpdated = this.onSubsUpdated.bind(this);\n    this.handleImageChanged = this.handleImageChanged.bind(this);\n    this.handleMuted = this.handleMuted.bind(this);\n    this.handleUnarchive = this.handleUnarchive.bind(this);\n    this.handlePermissionsChanged = this.handlePermissionsChanged.bind(this);\n    this.handleLaunchPermissionsEditor = this.handleLaunchPermissionsEditor.bind(this);\n    this.handleShowAddMembers = this.handleShowAddMembers.bind(this);\n    this.handleMemberUpdateRequest = this.handleMemberUpdateRequest.bind(this);\n    this.handleMemberSelected = this.handleMemberSelected.bind(this);\n    this.handleContextMenu = this.handleContextMenu.bind(this);\n    this.handleBackNavigate = this.handleBackNavigate.bind(this);\n  }\n\n  // No need to separately handle component mount.\n  componentDidUpdate(props) {\n    const topic = this.props.tinode.getTopic(props.topic);\n    if (!topic) {\n      return;\n    }\n\n    if (this.onMetaDesc != topic.onMetaDesc) {\n      this.previousMetaDesc = topic.onMetaDesc;\n      topic.onMetaDesc = this.onMetaDesc;\n\n      this.previousSubsUpdated = topic.onSubsUpdated;\n      topic.onSubsUpdated = this.onSubsUpdated;\n    }\n\n    if (this.state.topic != props.topic) {\n      this.setState({topic: props.topic});\n      this.resetDesc(topic, props);\n      this.resetSubs(topic, props);\n      this.resetTags(topic);\n    }\n  }\n\n  componentWillUnmount() {\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    if (!topic) {\n      return;\n    }\n    this.setState({topic: null});\n    topic.onMetaDesc = this.previousMetaDesc;\n    topic.onSubsUpdated = this.previousSubsUpdated;\n  }\n\n  resetSubs(topic, props) {\n    const newState = {contactList: []};\n    if (topic.getType() == 'p2p') {\n      // Fetch the other party in the p2p conversation.\n      // Topic may not be ready yet, so check if user is found.\n      const user2 = topic.subscriber(props.topic);\n      if (user2) {\n        newState.modeGiven2 = user2.acs.getGiven();\n        newState.modeWant2 = user2.acs.getWant();\n      } else {\n        newState.modeGiven2 = NO_ACCESS_MODE;\n        newState.modeWant2 = NO_ACCESS_MODE;\n      }\n    } else {\n      topic.subscribers((sub) => {\n        newState.contactList.push(sub);\n      }, this);\n    }\n\n    this.setState(newState);\n  }\n\n  resetDesc(topic, props) {\n    const defacs = topic.getDefaultAccess() || {};\n    const acs = topic.getAccessMode();\n\n    const badges = [];\n    if (topic.trusted) {\n      for (const [key, val] of Object.entries(topic.trusted)) {\n        if (val) {\n          badges.push(key);\n        }\n      }\n    }\n\n    this.setState({\n      owner: acs && acs.isOwner(),\n      admin: acs && acs.isAdmin(),\n      sharer: acs && acs.isSharer(),\n      deleter: acs && acs.isDeleter(),\n      muted: acs && acs.isMuted(),\n\n      fullName: clipStr(topic.public && topic.public.fn, MAX_TITLE_LENGTH),\n      description: clipStr(topic.public && topic.public.note, MAX_TOPIC_DESCRIPTION_LENGTH),\n      avatar: makeImageUrl(topic.public ? topic.public.photo : null),\n      trustedBadges: badges,\n      private: clipStr(topic.private && topic.private.comment, MAX_TITLE_LENGTH),\n      archived: topic.isArchived(),\n      address: topic.name,\n      groupTopic: topic.isGroupType(),\n      channel: topic.isChannelType() || topic.chan,\n      access: acs ? acs.getMode() : undefined,\n      modeGiven: acs ? acs.getGiven() : undefined,\n      modeWant: acs ? acs.getWant() : undefined,\n      auth: defacs.auth,\n      anon: defacs.anon\n    });\n  }\n\n  resetTags(topic) {\n    if (topic.getType() != 'grp') {\n      return;\n    }\n\n    const acs = topic.getAccessMode();\n    if (acs && acs.isOwner()) {\n      // Requesting tags: owner is editing the topic.\n      topic.getMeta(topic.startMetaQuery().withTags().build());\n    }\n  }\n\n  onMetaDesc(desc) {\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    if (!topic) {\n      return;\n    }\n    this.resetDesc(topic, this.props);\n\n    if (this.previousMetaDesc && this.previousMetaDesc != this.onMetaDesc) {\n      this.previousMetaDesc(desc);\n    }\n  }\n\n  onSubsUpdated(subs) {\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    if (!topic) {\n      return;\n    }\n    this.resetSubs(topic, this.props);\n\n    if (this.previousSubsUpdated && this.previousSubsUpdated != this.onSubsUpdated) {\n      this.previousSubsUpdated(subs);\n    }\n  }\n\n  handleImageChanged(mime, img) {\n    this.setState({avatar: img});\n    this.props.onTopicDescUpdate(this.props.topic, theCard(null, img || Tinode.DEL_CHAR), null);\n  }\n\n  handleMuted(ignored, checked) {\n    this.setState({muted: checked});\n    this.props.onChangePermissions(this.props.topic, checked ? '-P' : '+P');\n  }\n\n  handleUnarchive(ignored, ignored2) {\n    this.props.onTopicUnArchive(this.props.topic);\n  }\n\n  handlePermissionsChanged(which, perm) {\n    switch (which) {\n      case 'auth':\n        this.props.onTopicDescUpdateRequest(this.props.topic, null, null, {auth: perm});\n        break;\n      case 'anon':\n        this.props.onTopicDescUpdateRequest(this.props.topic, null, null, {anon: perm});\n        break;\n      case 'mode':\n      case 'want':\n        this.props.onChangePermissions(this.props.topic, perm);\n        break;\n      case 'given':\n        this.props.onChangePermissions(this.props.topic, perm, this.props.topic);\n        break;\n      case 'user':\n        this.props.onChangePermissions(this.props.topic, perm, this.state.userPermissionsEdited);\n        break;\n    }\n\n    this.handleBackNavigate();\n  }\n\n  handleLaunchPermissionsEditor(which, uid) {\n    const {formatMessage} = this.props.intl;\n    let toEdit, toCompare, toSkip, titleEdit, titleCompare, userTitle, userAvatar;\n    switch (which) {\n      case 'mode':\n        toEdit = this.state.access;\n        break;\n      case 'want':\n        toEdit = this.state.modeWant;\n        toCompare = this.state.modeGiven;\n        if (this.state.owner) {\n          // Don't allow owner to unset 'O' permission. All other permissions are OK.\n          toSkip = 'O';\n        } else {\n          // Allow accepting any of 'ASDO' permissions but don't allow asking for them.\n          toSkip = AccessMode.encode(AccessMode.diff('ASDO', this.state.modeGiven));\n          if (this.state.channel) {\n            // Channels are read-only.\n            toSkip += 'W';\n          }\n        }\n        titleEdit = formatMessage(messages.perm_want);\n        titleCompare = formatMessage(messages.perm_given);\n        break;\n      case 'given':\n        toEdit = this.state.modeGiven2;\n        toCompare = this.state.modeWant2;\n        toSkip = this.state.groupTopic ? (this.state.owner ? '' : 'O') : 'ASDO';\n        titleEdit = formatMessage(messages.perm_given);\n        titleCompare = formatMessage(messages.perm_want);\n        break;\n      case 'auth':\n        toEdit = this.state.auth;\n        toSkip = 'O';\n        break;\n      case 'anon':\n        toEdit = this.state.anon;\n        toSkip = 'O';\n        break;\n      case 'user': {\n        const topic = this.props.tinode.getTopic(this.props.topic);\n        if (!topic) {\n          return;\n        }\n        const user = topic.subscriber(uid);\n        if (!user || !user.acs) {\n          return;\n        }\n        toEdit = user.acs.getGiven();\n        toCompare = user.acs.getWant();\n        toSkip = this.state.owner ? '' : 'O';\n        titleEdit = formatMessage(messages.perm_given);\n        titleCompare = formatMessage(messages.perm_want);\n        if (user.public) {\n          userTitle = user.public.fn;\n          userAvatar = user.public.photo;\n        }\n        break;\n      }\n      default:\n        console.error(\"Unknown permission editing mode '\" + which + \"'\");\n        return;\n    }\n    this.setState({\n      userPermissionsEdited: uid,\n      userPermissionsTitle: userTitle,\n      userPermissionsAvatar: userAvatar,\n      editedPermissions: toEdit,\n      immutablePermissions: toCompare,\n      editedPermissionsTitle: titleEdit,\n      immutablePermissionsTitle: titleCompare,\n      editedPermissionsSkipped: toSkip,\n    });\n    this.props.onNavigate(`perm/${which}`);\n  }\n\n  handleShowAddMembers(e) {\n    e.preventDefault();\n    this.props.onInitFind();\n    this.props.onNavigate('members');\n  }\n\n  handleMemberUpdateRequest(members, added, removed) {\n    this.props.onMemberUpdateRequest(this.props.topic, added, removed);\n    this.props.onNavigate('info');\n  }\n\n  handleMemberSelected(uid) {\n    this.setState({selectedContact: uid});\n  }\n\n  handleBackNavigate() {\n    const args = (this.props.panel || 'info').split('/');\n    if (args[0] == 'info') {\n      this.props.onNavigate(null);\n    } else if (args[0] == 'perm') {\n      if (args[1] == 'user') {\n        this.props.onNavigate('info');\n      } else {\n        this.props.onNavigate('security');\n      }\n    } else {\n      this.props.onNavigate('info');\n    }\n  }\n\n  handleContextMenu(params) {\n    const {formatMessage} = this.props.intl;\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    if (!topic) {\n      return;\n    }\n    const user = topic.subscriber(params.topicName);\n    if (!user || !user.acs) {\n      return;\n    }\n\n    const isMe = this.props.tinode.isMe(params.topicName);\n    const menuItems = [\n      {title: formatMessage(messages.edit_permissions), handler: () => {\n        this.handleLaunchPermissionsEditor(isMe ? 'want' : 'user', params.topicName);\n      }}\n    ];\n    if (!isMe) {\n      menuItems.push('member_delete');\n    }\n    menuItems.push(user.acs.isMuted() ? 'member_unmute' : 'member_mute');\n    if (!isMe) {\n      menuItems.push(user.acs.isJoiner() ? 'member_block' : 'member_unblock');\n    }\n    this.props.showContextMenu({\n      topicName: this.props.topic,\n      x: params.x,\n      y: params.y,\n      user: params.topicName}, menuItems);\n  }\n\n  render() {\n    const args = (this.props.panel || 'info').split('/');\n    const view = args[0];\n    args.shift();\n\n    const {formatMessage} = this.props.intl;\n    const panelTitle = formatMessage((view == 'perm' ? messages['perm_' + args[0]] : messages[view])\n      || messages['info']);\n\n    return (\n      <div id=\"info-view\">\n        <div className=\"caption-panel\" id=\"info-caption-panel\">\n          <div className=\"panel-title\" id=\"info-title\">{panelTitle}</div>\n          <div>\n            <MenuCancel onCancel={this.handleBackNavigate} />\n          </div>\n        </div>\n        {this.props.displayMobile ?\n          <ErrorPanel\n            level={this.props.errorLevel}\n            text={this.props.errorText}\n            onClearError={this.props.onError} /> : null}\n        {view == 'members' ?\n          <GroupManager\n            tinode={this.props.tinode}\n            members={this.state.contactList}\n            requiredMember={this.props.myUserId}\n            keepInitialMembers={!this.state.admin && !this.state.owner}\n            myUserId={this.props.myUserId}\n            contacts={this.props.searchableContacts}\n            onCancel={this.handleBackNavigate}\n            onSubmit={this.handleMemberUpdateRequest} />\n          :\n        view == 'perm' && args.length > 0 ?\n          <PermissionsEditor\n            tinode={this.props.tinode}\n            mode={this.state.editedPermissions}\n            compare={this.state.immutablePermissions}\n            skip={this.state.editedPermissionsSkipped}\n            modeTitle={this.state.editedPermissionsTitle}\n            compareTitle={this.state.immutablePermissionsTitle}\n            userTitle={this.state.userPermissionsTitle}\n            item={this.state.userPermissionsEdited}\n            userAvatar={this.state.userPermissionsAvatar}\n            onSubmit={(mode) => this.handlePermissionsChanged(args[0], mode)}\n            onCancel={this.handleBackNavigate} />\n          :\n        view == 'general' ?\n          <TopicCommon\n            tinode={this.props.tinode}\n            topic={this.props.topic}\n            onCredAdd={this.props.onCredAdd}\n            onTopicTagsUpdateRequest={this.props.onTopicTagsUpdateRequest}\n            onCredConfirm={this.props.onCredConfirm}\n            onCredDelete={this.props.onCredDelete}\n            onUpdateTopicDesc={this.props.onTopicDescUpdateRequest}\n            onError={this.props.onError} />\n          :\n        view == 'security' ?\n          <TopicSecurity\n            topic={this.props.topic}\n            owner={this.state.owner}\n            admin={this.state.admin}\n            sharer={this.state.sharer}\n            deleter={this.state.deleter}\n            muted={this.state.muted}\n\n            groupTopic={this.state.groupTopic}\n            channel={this.state.channel}\n            access={this.state.access}\n            modeGiven={this.state.modeGiven}\n            modeWant={this.state.modeWant}\n            modeGiven2={this.state.modeGiven2}\n            modeWant2={this.state.modeWant2}\n            auth={this.state.auth}\n            anon={this.state.anon}\n\n            onShowAlert={this.props.onShowAlert}\n            onDeleteMessages={this.props.onDeleteMessages}\n            onLeaveTopic={this.props.onLeaveTopic}\n            onBlockTopic={this.props.onBlockTopic}\n            onReportTopic={this.props.onReportTopic}\n            onLaunchPermissionsEditor={this.handleLaunchPermissionsEditor}\n            onNavigate={this.props.onNavigate} />\n          :\n          <div id=\"info-view-content\" className=\"scrollable-panel\">\n            <div className=\"panel-form-column\">\n              <a href=\"#\" className=\"flat-button float-right\" onClick={(e) => {e.preventDefault(); this.props.onNavigate('general');}}>\n                <i className=\"material-icons\">edit</i>&nbsp;\n                <FormattedMessage id=\"button_edit\" defaultMessage=\"Edit\" description=\"Call to action [Edit]\" />\n              </a>\n              <center>\n                <AvatarUpload\n                  tinode={this.props.tinode}\n                  avatar={this.state.avatar}\n                  readOnly={true}\n                  uid={this.props.topic}\n                  title={this.state.fullName} />\n              </center>\n              <div className=\"group\">\n                <div><label className=\"small\">\n                  <FormattedMessage id=\"label_topic_name\" defaultMessage=\"Name\"\n                    description=\"Label for editing topic name\" />\n                </label></div>\n                <div className=\"large ellipsized\">{this.state.fullName}\n                {this.state.channel ? <img src=\"/img/channel.png\" className=\"channel\" alt=\"channel\" /> : null}</div>\n              </div>\n              {this.state.private ?\n                <div className=\"group\">\n                  <div><label className=\"small\">\n                    <FormattedMessage id=\"label_private\" defaultMessage=\"Private comment\"\n                      description=\"Label for editing 'private'\" />\n                  </label></div>\n                  <div className=\"large ellipsized\">{this.state.private}</div>\n                </div>\n                : null\n              }\n              <div className=\"group\">\n                <label className=\"small\"><FormattedMessage id=\"label_user_id\" defaultMessage=\"ID:\"\n                  description=\"Label for user address (ID)\" /></label>&nbsp;\n                <tt>{this.state.address}</tt>\n              </div>\n              <div className=\"group\">\n                <BadgeList trustedBadges={this.state.trustedBadges} />\n              </div>\n              {this.state.description ?\n                <div className=\"group\">\n                  <label className=\"small\">\n                    <FormattedMessage id=\"label_description\" defaultMessage=\"Description\"\n                      description=\"Label for editing topic description\" />\n                  </label>\n                  <div>{this.state.description}</div>\n                </div> : null}\n            </div>\n            <div className=\"hr\" />\n            <div className=\"panel-form-row\">\n              <label>\n                <FormattedMessage id=\"label_muting_topic\" defaultMessage=\"Muted:\"\n                  description=\"Label for Muting/unmuting the topic\" />\n              </label>\n              <CheckBox name=\"P\" checked={this.state.muted} onChange={this.handleMuted} />\n            </div>\n            {this.state.archived ?\n              <div className=\"panel-form-row\">\n                <label>\n                  <FormattedMessage id=\"label_unarchive_topic\" defaultMessage=\"Archived:\"\n                    description=\"Label for unarchiving the topic\" />\n                </label>\n                <CheckBox name=\"archived\" checked={true} onChange={this.handleUnarchive} />\n              </div>\n              :\n              null\n            }\n            <div className=\"hr\" />\n            <div className=\"panel-form-row\">\n              <a href=\"#\" className=\"flat-button\" onClick={(e) => {e.preventDefault(); this.props.onNavigate('security');}}>\n                <i className=\"material-icons\">security</i>&nbsp;<FormattedMessage id=\"button_security\"\n                  defaultMessage=\"Security\" description=\"Navigaton button for security panel.\" />\n              </a>\n            </div>\n            {this.state.groupTopic && this.state.sharer ?\n              <>\n                <div className=\"hr\" />\n                <div className=\"panel-form-row\">\n                  <label className=\"small\">\n                    <FormattedMessage id=\"label_group_members\" defaultMessage=\"Group members:\"\n                      description=\"Section title or label\" />\n                  </label>\n                </div>\n                <div className=\"panel-form-row\">\n                  <a href=\"#\" className=\"flat-button\" onClick={this.handleShowAddMembers}>\n                    <i className=\"material-icons\">person_add</i> &nbsp;<FormattedMessage id=\"button_add_members\"\n                      defaultMessage=\"Add members\" description=\"Flat button [Add members] (to topic)\" />\n                  </a>\n                </div>\n                <FormattedMessage id=\"group_has_no_members\" defaultMessage=\"No members\"\n                  description=\"Shown in place of group members\">{\n                  (no_members) => <ContactList\n                    tinode={this.props.tinode}\n                    contacts={this.state.contactList}\n                    myUserId={this.props.myUserId}\n                    emptyListMessage={no_members}\n                    topicSelected={this.state.selectedContact}\n                    showOnline={false}\n                    showUnread={false}\n                    showMode={true}\n                    noScroll={true}\n                    onTopicSelected={this.handleMemberSelected}\n                    showContextMenu={this.state.admin ? this.handleContextMenu : false}\n                  />\n                }</FormattedMessage>\n              </>\n              :\n              null\n            }\n          </div>\n        }\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(InfoView);\n","// CallPanel displays call in progress: local and remote viewports and controls.\nimport React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nimport LetterTile from './letter-tile.jsx';\n\nimport { MAX_PEER_TITLE_LENGTH } from '../config.js';\nimport { CALL_STATE_OUTGOING_INITATED, CALL_STATE_IN_PROGRESS } from '../constants.js';\n\nimport { clipStr } from '../lib/utils.js'\n\nconst RING_SOUND = new Audio('audio/call-out.m4a');\nRING_SOUND.loop = true;\nconst CALL_ENDED_SOUND = new Audio('audio/call-end.m4a');\nCALL_ENDED_SOUND.loop = true;\nconst DIALING_SOUND = new Audio('audio/dialing.m4a');\n\nconst messages = defineMessages({\n  already_in_call: {\n    id: 'already_in_call',\n    defaultMessage: 'You already in an ongoing call!',\n    description: 'Error message when the user tried to accept a new call without finishing pervious one',\n  }\n});\n\nclass CallPanel extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      localStream: undefined,\n      pc: undefined,\n\n      previousOnInfo: undefined,\n      waitingForPeer: false,\n      // If true, the client has received a remote SDP from the peer and has sent a local SDP to the peer.\n      callInitialSetupComplete: false\n    };\n\n    this.localStreamConstraints = {\n      audio: true,\n      video: true\n    };\n    this.isOutgoingCall = props.callState == CALL_STATE_OUTGOING_INITATED;\n\n    this.localRef = React.createRef();\n    this.remoteRef = React.createRef();\n    // Cache for remote ice candidates until initial setup gets completed.\n    this.remoteIceCandidatesCache = [];\n\n    this.onInfo = this.onInfo.bind(this);\n    this.start = this.start.bind(this);\n    this.stop = this.stop.bind(this);\n\n    this.createPeerConnection = this.createPeerConnection.bind(this);\n    this.canSendOffer = this.canSendOffer.bind(this);\n    this.drainRemoteIceCandidatesCache = this.drainRemoteIceCandidatesCache.bind(this);\n\n    this.handleNegotiationNeededEvent = this.handleNegotiationNeededEvent.bind(this);\n    this.handleICECandidateEvent = this.handleICECandidateEvent.bind(this);\n    this.handleNewICECandidateMsg = this.handleNewICECandidateMsg.bind(this);\n    this.handleICEConnectionStateChangeEvent = this.handleICEConnectionStateChangeEvent.bind(this);\n    this.handleSignalingStateChangeEvent = this.handleSignalingStateChangeEvent.bind(this);\n    this.handleICEGatheringStateChangeEvent = this.handleICEGatheringStateChangeEvent.bind(this);\n    this.handleIceCandidateErrorEvent = this.handleIceCandidateErrorEvent.bind(this);\n    this.handleTrackEvent = this.handleTrackEvent.bind(this);\n\n    this.handleVideoOfferMsg = this.handleVideoOfferMsg.bind(this);\n    this.handleVideoAnswerMsg = this.handleVideoAnswerMsg.bind(this);\n    this.handleNewICECandidateMsg = this.handleNewICECandidateMsg.bind(this);\n\n    this.reportError = this.reportError.bind(this);\n    this.handleGetUserMediaError = this.handleGetUserMediaError.bind(this);\n\n    this.stopTracks = this.stopTracks.bind(this);\n\n    this.handleCloseClick = this.handleCloseClick.bind(this);\n    this.handleToggleCameraClick = this.handleToggleCameraClick.bind(this);\n    this.handleToggleMicClick = this.handleToggleMicClick.bind(this);\n    this.toggleMedia = this.toggleMedia.bind(this);\n\n    this.handleRemoteHangup = this.handleRemoteHangup.bind(this);\n    this.handleVideoCallAccepted = this.handleVideoCallAccepted.bind(this);\n  }\n\n  componentDidMount() {\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    this.previousOnInfo = topic.onInfo;\n    topic.onInfo = this.onInfo;\n    if ((this.props.callState == CALL_STATE_OUTGOING_INITATED ||\n         this.props.callState == CALL_STATE_IN_PROGRESS) && this.localRef.current) {\n      this.start();\n    }\n  }\n\n  componentWillUnmount() {\n    const topic = this.props.tinode.getTopic(this.props.topic);\n    topic.onInfo = this.previousOnInfo;\n    this.stop();\n  }\n\n  handleVideoCallAccepted(info) {\n    RING_SOUND.pause();\n    const pc = this.createPeerConnection();\n    const stream = this.state.localStream;\n    stream.getTracks().forEach(track => {\n      pc.addTrack(track, stream);\n    });\n  }\n\n  onInfo(info) {\n    if (info.what != 'call') {\n      return;\n    }\n    switch (info.event) {\n      case 'accept':\n        this.handleVideoCallAccepted(info);\n        break;\n      case 'answer':\n        this.handleVideoAnswerMsg(info);\n        break;\n      case 'ice-candidate':\n        this.handleNewICECandidateMsg(info);\n        break;\n      case 'hang-up':\n        this.handleRemoteHangup(info);\n        break;\n      case 'offer':\n        this.handleVideoOfferMsg(info);\n        break;\n      case 'ringing':\n        // play() throws if the user did not click the app first: https://goo.gl/xX8pDD.\n        RING_SOUND.play().catch(_ => {});\n        break;\n      default:\n        console.warn(\"Unknown call event\", info.event);\n        break;\n    }\n  }\n\n  start() {\n    if (this.state.localStream) {\n      this.props.onError(this.props.intl.formatMessage(messages.already_in_call));\n      return;\n    }\n\n    if (this.props.callState == CALL_STATE_IN_PROGRESS) {\n      // We apparently just accepted the call.\n      this.props.onInvite(this.props.topic, this.props.seq, this.props.callState);\n      return;\n    }\n\n    // This is an outgoing call waiting for the other side to pick up.\n    // Start local video.\n    navigator.mediaDevices.getUserMedia(this.localStreamConstraints)\n      .then(stream => {\n        this.setState({localStream: stream, waitingForPeer: true});\n        this.localRef.current.srcObject = stream;\n\n        DIALING_SOUND.play();\n\n        // Send call invitation.\n        this.props.onInvite(this.props.topic, this.props.seq, this.props.callState);\n      })\n      .catch(this.handleGetUserMediaError);\n  }\n\n  stop() {\n    CALL_ENDED_SOUND.pause();\n    CALL_ENDED_SOUND.currentTime = 0;\n    RING_SOUND.pause();\n    RING_SOUND.currentTime = 0;\n\n    this.stopTracks(this.localRef.current);\n    this.stopTracks(this.remoteRef.current);\n    if (this.state.pc) {\n      this.state.pc.ontrack = null;\n      this.state.pc.onremovetrack = null;\n      this.state.pc.onremovestream = null;\n      this.state.pc.onicecandidate = null;\n      this.state.pc.oniceconnectionstatechange = null;\n      this.state.pc.onsignalingstatechange = null;\n      this.state.pc.onicegatheringstatechange = null;\n      this.state.pc.onnegotiationneeded = null;\n      this.state.pc.onicecandidateerror = null;\n\n      this.state.pc.close();\n    }\n    this.setState({pc: null, waitingForPeer: false});\n  }\n\n  stopTracks(el) {\n    if (!el) {\n      return;\n    }\n    let stream = el.srcObject;\n    if (!stream) {\n      return;\n    }\n\n    let tracks = stream.getTracks();\n    if (tracks) {\n      tracks.forEach(track => {\n        track.stop();\n        track.enabled = false;\n      });\n    }\n    el.srcObject = null;\n    el.src = '';\n  }\n\n  createPeerConnection() {\n    const iceServers = this.props.tinode.getServerParam('iceServers', null);\n    const pc = iceServers ? new RTCPeerConnection({iceServers: iceServers}) : new RTCPeerConnection();\n\n    pc.onicecandidate = this.handleICECandidateEvent;\n    pc.oniceconnectionstatechange = this.handleICEConnectionStateChangeEvent;\n    pc.onicegatheringstatechange = this.handleICEGatheringStateChangeEvent;\n    pc.onsignalingstatechange = this.handleSignalingStateChangeEvent;\n    pc.onnegotiationneeded = this.handleNegotiationNeededEvent;\n    pc.onicecandidateerror = this.handleIceCandidateErrorEvent;\n    pc.ontrack = this.handleTrackEvent;\n\n    this.setState({pc: pc, waitingForPeer: false});\n    return pc;\n  }\n\n  handleVideoAnswerMsg(info) {\n    // Configure the remote description, which is the SDP payload\n    // in 'info' message.\n    const desc = new RTCSessionDescription(info.payload);\n    this.state.pc.setRemoteDescription(desc)\n      .then(_ => {\n        this.setState({ callInitialSetupComplete: true }, () => this.drainRemoteIceCandidatesCache());\n      })\n      .catch(this.reportError);\n  }\n\n  reportError(err) {\n    this.props.onError(err.message, 'err');\n  }\n\n  canSendOffer() {\n    return this.isOutgoingCall || this.state.callInitialSetupComplete;\n  }\n\n  handleNegotiationNeededEvent() {\n    if (!this.canSendOffer()) {\n      return;\n    }\n    this.state.pc.createOffer().then(offer => {\n      return this.state.pc.setLocalDescription(offer);\n    })\n    .then(_ => {\n      this.props.onSendOffer(this.props.topic, this.props.seq, this.state.pc.localDescription.toJSON());\n    })\n    .catch(this.reportError);\n  }\n\n  handleIceCandidateErrorEvent(event) {\n    console.warn(\"ICE candidate error:\", event);\n  }\n\n  handleICECandidateEvent(event) {\n    if (event.candidate) {\n      this.props.onIceCandidate(this.props.topic, this.props.seq, event.candidate.toJSON());\n    }\n  }\n\n  handleNewICECandidateMsg(info) {\n    const candidate = new RTCIceCandidate(info.payload);\n    if (this.state.callInitialSetupComplete) {\n      this.state.pc.addIceCandidate(candidate)\n        .catch(this.reportError);\n    } else {\n      this.remoteIceCandidatesCache.push(candidate);\n    }\n  }\n\n  drainRemoteIceCandidatesCache() {\n    this.remoteIceCandidatesCache.forEach(candidate => {\n      this.state.pc.addIceCandidate(candidate)\n        .catch(this.reportError);\n    });\n    this.remoteIceCandidatesCache = [];\n  }\n\n  handleICEConnectionStateChangeEvent(event) {\n    switch (this.state.pc.iceConnectionState) {\n      case 'closed':\n      case 'failed':\n        this.handleCloseClick();\n        break;\n    }\n  }\n\n  handleSignalingStateChangeEvent(event) {\n    if (this.state.pc.signalingState == 'closed') {\n      this.handleCloseClick();\n    }\n  }\n\n  handleICEGatheringStateChangeEvent(event) {\n    // ICE gathering change state\n  }\n\n  handleTrackEvent(event) {\n    // Remote video becomes available.\n    this.remoteRef.current.srcObject = event.streams[0];\n    // Make sure we display the title (peer's name) over the remote video.\n    this.forceUpdate();\n  }\n\n  handleGetUserMediaError(e) {\n    switch(e.name) {\n      case 'NotFoundError':\n        // Cannot start the call b/c no camera and/or microphone found.\n        this.reportError(e.message);\n        break;\n      case 'SecurityError':\n      case 'PermissionDeniedError':\n        // Do nothing; this is the same as the user canceling the call.\n        break;\n      default:\n        this.reportError(e.message);\n        console.error(\"Error opening your camera and/or microphone:\", e.message);\n        break;\n    }\n\n    // Make sure we shut down our end of the RTCPeerConnection so we're\n    // ready to try again.\n    this.handleCloseClick();\n  }\n\n  handleVideoOfferMsg(info) {\n    let localStream = null;\n    const pc = this.createPeerConnection();\n    const desc = new RTCSessionDescription(info.payload);\n\n    pc.setRemoteDescription(desc).then(_ => {\n      return navigator.mediaDevices.getUserMedia(this.localStreamConstraints);\n    })\n    .then(stream => {\n      localStream = stream;\n      this.localRef.current.srcObject = stream;\n      this.setState({localStream: stream});\n\n      localStream.getTracks().forEach(track => {\n        pc.addTrack(track, localStream);\n      });\n    })\n    .then(_ => {\n      return pc.createAnswer();\n    })\n    .then(answer => {\n      return pc.setLocalDescription(answer);\n    })\n    .then(_ => {\n      this.props.onSendAnswer(this.props.topic, this.props.seq, pc.localDescription.toJSON());\n      this.setState({ callInitialSetupComplete: true }, () => this.drainRemoteIceCandidatesCache());\n    })\n    .catch(this.handleGetUserMediaError);\n  }\n\n  // Call disconnected by remote.\n  handleRemoteHangup() {\n    if (!this.state.waitingForPeer) {\n      // This is live call, just hang up.\n      this.handleCloseClick();\n    } else {\n      // This is a call which is not yet connected.\n      // Stop pulse animation.\n      this.setState({waitingForPeer: false});\n      // Change sound and wait a bit before ending it.\n      RING_SOUND.pause();\n      RING_SOUND.currentTime = 0;\n      CALL_ENDED_SOUND.loop = true;\n      CALL_ENDED_SOUND.play().catch(_ => {});\n      setTimeout(_ => {\n        this.handleCloseClick();\n      }, 2000);\n    }\n  }\n\n  handleCloseClick() {\n    this.stop();\n    this.props.onHangup(this.props.topic, this.props.seq);\n  }\n\n  // Mute/unmute audio/video (specified by kind).\n  toggleMedia(kind) {\n    const stream = this.state.localStream;\n    stream.getTracks().forEach(track => {\n      if (track.kind != kind) {\n        return;\n      }\n      track.enabled = !track.enabled;\n    });\n    // Make sure we redraw the mute/unmute icons (e.g. mic -> mic_off).\n    this.forceUpdate();\n  }\n\n  handleToggleCameraClick() {\n    this.toggleMedia('video');\n  }\n\n  handleToggleMicClick() {\n    this.toggleMedia('audio');\n  }\n\n  render() {\n    const remoteActive = this.remoteRef.current && this.remoteRef.current.srcObject;\n    const disabled = !(this.state.localStream && this.state.localStream.getTracks());\n    const audioIcon = this.state.localStream && this.state.localStream.getAudioTracks()[0].enabled ? 'mic' : 'mic_off';\n    const videoIcon = this.state.localStream && this.state.localStream.getVideoTracks()[0].enabled ? 'videocam' : 'videocam_off';\n    const peerTitle = clipStr(this.props.title, MAX_PEER_TITLE_LENGTH);\n    const pulseAnimation = this.state.waitingForPeer ? ' pulse' : '';\n\n    return (\n      <>\n        <div id=\"video-container\">\n          <div id=\"video-container-panel\">\n            <div className=\"call-party self\">\n              <video ref={this.localRef} autoPlay muted playsInline></video>\n              <div className=\"caller-name inactive\">\n                <FormattedMessage id=\"calls_you_label\"\n                  defaultMessage=\"You\" description=\"Shown over the local video screen\" />\n              </div>\n            </div>\n            <div className=\"call-party peer\">\n              <video ref={this.remoteRef} autoPlay playsInline></video>\n              {remoteActive ?\n                <div className=\"caller-name inactive\">{peerTitle}</div> :\n                <div className={`caller-card${pulseAnimation}`}>\n                  <div className=\"avatar-box\">\n                    <LetterTile\n                      tinode={this.props.tinode}\n                      avatar={this.props.avatar}\n                      topic={this.props.topic}\n                      title={this.props.title} />\n                  </div>\n                  <div className=\"caller-name\">{peerTitle}</div>\n                </div>\n              }\n            </div>\n          </div>\n          <div className=\"controls\">\n            <button className=\"danger\" onClick={this.handleCloseClick}>\n              <i className=\"material-icons\">call_end</i>\n            </button>\n            <button className=\"secondary\" onClick={this.handleToggleCameraClick} disabled={disabled}>\n              <i className=\"material-icons\">{videoIcon}</i>\n            </button>\n            <button className=\"secondary\" onClick={this.handleToggleMicClick} disabled={disabled}>\n              <i className=\"material-icons\">{audioIcon}</i>\n            </button>\n          </div>\n        </div>\n      </>\n    );\n  }\n};\n\nexport default injectIntl(CallPanel);\n","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport FileProgress from './file-progress.jsx';\nimport { bytesToHumanSize } from '../lib/strformat.js';\nimport { isUrlRelative, sanitizeUrl } from '../lib/utils.js';\n\nexport default class Attachment extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      downloader: null,\n      progress: 0\n    };\n\n    this.downloadFile = this.downloadFile.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n  }\n\n  downloadFile(url, filename, mimetype) {\n    if (!url) {\n      this.props.onError(\"Invalid download URL '\" + url + \"'\");\n      return;\n    }\n\n    const downloader = this.props.tinode.getLargeFileHelper();\n    this.setState({downloader: downloader});\n    downloader.download(url, filename, mimetype,\n      (loaded) => {\n        this.setState({progress: loaded / this.props.size});\n      },\n      (err) => {\n        this.props.onError(err, 'err');\n      }\n    ).then(() => {\n      this.setState({downloader: null, progress: 0});\n    }).catch((err) => {\n      if (err) {\n        this.props.onError(\"Error downloading file: \" + err.message, 'err');\n      }\n      this.setState({downloader: null, progress: 0});\n    });\n  }\n\n  handleCancel() {\n    if (this.props.uploading) {\n      this.props.onCancelUpload();\n    } else if (this.state.downloader) {\n      this.state.downloader.cancel();\n    }\n  }\n\n  render() {\n    let filename = this.props.filename || 'file_attachment';\n    if (filename.length > 36) {\n      filename = filename.substr(0, 16) + '...' + filename.substr(-16);\n    }\n    let size = this.props.size > 0 ?\n      <span className=\"small gray\">({bytesToHumanSize(this.props.size)})</span> :\n      null;\n\n    // Detect if the download URL is relative or absolute.\n    // If the URL is relative use LargeFileHelper to attach authentication\n    // credentials to the request.\n    let url, helperFunc;\n    if (!this.props.uploading && !this.state.downloader && isUrlRelative(this.props.downloadUrl)) {\n      // Relative URL. Use download helper.\n      url = '#';\n      helperFunc = (e) => {\n        e.preventDefault();\n        this.downloadFile(this.props.downloadUrl, this.props.filename, this.props.mimetype);\n      };\n    } else {\n      url = sanitizeUrl(this.props.downloadUrl);\n      helperFunc = null;\n    }\n    const downloadWidget = <><i className=\"material-icons\">file_download</i> <FormattedMessage id=\"save_attachment\"\n      defaultMessage=\"save\" description=\"Call to save an attachment\" /></>;\n    return (\n      <div className=\"attachment\">\n        <div><i className=\"material-icons big gray\">insert_drive_file</i></div>\n        <div className=\"flex-column\">\n          <div>{filename} {size}</div>\n          {this.props.uploading || this.state.downloader ?\n            <FileProgress progress={this.props.uploading ? this.props.progress : this.state.progress}\n              onCancel={this.handleCancel} />\n            :\n            <div>{url ?\n              <a href={url} download={this.props.filename} onClick={helperFunc}>{downloadWidget}</a>\n              :\n              <span className=\"light-gray\">{downloadWidget}</span>\n            }</div>\n          }\n        </div>\n      </div>\n    );\n  }\n};\n","// Received/read indicator.\nimport React from 'react';\nimport { defineMessages, injectIntl } from 'react-intl';\n\nimport { Tinode } from 'tinode-sdk';\n\nimport { deliveryMarker } from '../lib/utils.js';\n\nconst messages = defineMessages({\n  message_sending: {\n    id: 'message_sending',\n    defaultMessage: 'sending...',\n    description: 'Message being sent, in place of time stamp'\n  },\n  message_sending_failed: {\n    id: 'message_sending_failed',\n    defaultMessage: 'failed',\n    description: 'Failed to send message, in place of time stamp'\n  }\n});\n\nclass ReceivedMarker extends React.PureComponent {\n  render() {\n    const {formatMessage} = this.props.intl;\n    let timestamp;\n    if (this.props.received <= Tinode.MESSAGE_STATUS_SENDING) {\n      timestamp = formatMessage(messages.message_sending);\n    } else if (this.props.received == Tinode.MESSAGE_STATUS_FAILED) {\n      timestamp = formatMessage(messages.message_sending_failed);\n    } else {\n      timestamp = this.props.timestamp.toLocaleTimeString(this.props.intl.locale, { timeStyle: 'short' });\n    }\n\n    const icon = deliveryMarker(this.props.received);\n    const marker = icon ? <i className={'material-icons small ' + icon.color}>{icon.name}</i> : null;\n\n    return (\n      <span className=\"timestamp\">\n        {timestamp}{'\\u00a0'}{marker}\n      </span>\n    );\n  }\n};\n\nexport default injectIntl(ReceivedMarker);\n","// Single chat message bubble, sent or received.\n\nimport React from 'react';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport { Drafty, Tinode } from 'tinode-sdk';\n\nimport Attachment from './attachment.jsx';\nimport LetterTile from './letter-tile.jsx';\nimport ReceivedMarker from './received-marker.jsx'\n\nimport { fullFormatter } from '../lib/formatters.js';\nimport { sanitizeUrl } from '../lib/utils.js';\n\nclass BaseChatMessage extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      progress: 0\n    };\n\n    if (props.uploader) {\n      props.uploader.onProgress = this.handleProgress.bind(this);\n    }\n\n    this.handleImagePreview = this.handleImagePreview.bind(this);\n    this.handleFormButtonClick = this.handleFormButtonClick.bind(this);\n    this.handleContextClick = this.handleContextClick.bind(this);\n    this.handleCancelUpload = this.handleCancelUpload.bind(this);\n    this.handleQuoteClick = this.handleQuoteClick.bind(this);\n\n    this.formatterContext = {\n      formatMessage: props.intl.formatMessage.bind(props.intl),\n      viewportWidth: props.viewportWidth,\n      authorizeURL: props.tinode.authorizeURL.bind(props.tinode),\n\n      onImagePreview: this.handleImagePreview,\n      onFormButtonClick: this.handleFormButtonClick,\n      onQuoteClick: this.handleQuoteClick\n    };\n  }\n\n  handleImagePreview(e) {\n    e.preventDefault();\n    this.props.onImagePreview({\n      url: e.target.src,\n      filename: e.target.title,\n      width: e.target.dataset.width,\n      height: e.target.dataset.height,\n      size: e.target.dataset.size,\n      type: e.target.dataset.mime\n    });\n  }\n\n  handleFormButtonClick(e) {\n    e.preventDefault();\n    const data = {\n      seq: this.props.seq\n    };\n    data.resp = {};\n    if (e.target.dataset.name) {\n      data.resp[e.target.dataset.name] = e.target.dataset.val ? e.target.dataset.val :\n        e.target.dataset.val === undefined ? 1 : '' + e.target.dataset.val;\n    }\n    if (e.target.dataset.act == 'url') {\n      data.ref = sanitizeUrl(e.target.dataset.ref) || 'about:blank';\n    }\n    const text = e.target.dataset.title || 'unknown';\n    this.props.onFormResponse(e.target.dataset.act, text, data);\n  }\n\n  handleContextClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    const menuItems = [];\n    if (this.props.received == Tinode.MESSAGE_STATUS_FAILED) {\n      menuItems.push('menu_item_send_retry');\n    }\n    if (this.props.userIsWriter &&\n        this.props.received > Tinode.MESSAGE_STATUS_FAILED &&\n        this.props.received < Tinode.MESSAGE_STATUS_DEL_RANGE) {\n      menuItems.push('menu_item_reply');\n    }\n    menuItems.push('menu_item_forward');\n\n    this.props.showContextMenu({\n      seq: this.props.seq,\n      content: this.props.content,\n      userFrom: this.props.userFrom,\n      userName: this.props.userName,\n      y: e.pageY,\n      x: e.pageX,\n      pickReply: this.props.pickReply\n    }, menuItems);\n  }\n\n  handleProgress(ratio) {\n    this.setState({progress: ratio});\n  }\n\n  handleCancelUpload() {\n    this.props.onCancelUpload(this.props.seq, this.props.uploader);\n  }\n\n  handleQuoteClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    const replyToSeq = this.props.replyToSeq;\n    if (replyToSeq) {\n      this.props.onQuoteClick(replyToSeq);\n    }\n  }\n\n  render() {\n    const sideClass = this.props.sequence + ' ' + (this.props.response ? 'left' : 'right');\n    const bubbleClass = (this.props.sequence == 'single' || this.props.sequence == 'last') ? 'bubble tip' : 'bubble';\n    const avatar = this.props.userAvatar || true;\n    const fullDisplay = (this.props.isGroup && this.props.response &&\n      (this.props.sequence == 'single' || this.props.sequence == 'last'));\n\n    let content = this.props.content;\n    const attachments = [];\n    if (this.props.mimeType == Drafty.getContentType() && Drafty.isValid(content)) {\n      Drafty.attachments(content, (att, i) => {\n        if (att.mime == 'application/json') {\n          // Don't show json objects as attachments.\n          // They are not meant for users.\n          return;\n        }\n        attachments.push(<Attachment\n          tinode={this.props.tinode}\n          downloadUrl={Drafty.getDownloadUrl(att)}\n          filename={att.name}\n          uploading={Drafty.isProcessing(att)}\n          mimetype={att.mime}\n          size={Drafty.getEntitySize(att)}\n          progress={this.state.progress}\n          onCancelUpload={this.handleCancelUpload}\n          onError={this.props.onError}\n          key={i} />);\n      }, this);\n      const tree = Drafty.format(content, fullFormatter, this.formatterContext);\n      content = React.createElement(React.Fragment, null, tree);\n    } else if (this.props.deleted) {\n      // Message represents a range of deleted messages.\n      content = <><i className=\"material-icons gray\">block</i> <i className=\"gray\">\n        <FormattedMessage id=\"deleted_content\"\n          defaultMessage=\"content deleted\" description=\"Shown when messages are deleted\" />\n      </i></>\n    } else if (typeof content != 'string') {\n      content = <><i className=\"material-icons gray\">warning_amber</i> <i className=\"gray\">\n        <FormattedMessage id=\"invalid_content\"\n          defaultMessage=\"invalid content\" description=\"Shown when the message is unreadable\" /></i></>\n    }\n\n    return (\n      <li ref={this.props.innerRef} className={sideClass}>\n        {this.props.isGroup && this.props.response ?\n          <div className=\"avatar-box\">\n            {fullDisplay ?\n              <LetterTile\n                tinode={this.props.tinode}\n                topic={this.props.userFrom}\n                title={this.props.userName}\n                avatar={avatar} /> :\n              null}\n          </div> :\n          null}\n        <div>\n          <div className={bubbleClass}>\n            <div className=\"content-meta\">\n              <div className=\"message-content\">\n                {content}\n                {attachments}\n              </div>\n              {this.props.timestamp ?\n                <ReceivedMarker\n                  timestamp={this.props.timestamp}\n                  received={this.props.received} />\n                : null}\n            </div>\n            {this.props.showContextMenu ?\n              <span className=\"menuTrigger\">\n                <a href=\"#\" onClick={this.handleContextClick}>\n                  <i className=\"material-icons\">expand_more</i>\n                </a>\n              </span> : null\n            }\n          </div>\n          {fullDisplay ?\n            <div className=\"author\">\n              {this.props.userName ||\n                <i><FormattedMessage id=\"user_not_found\" defaultMessage=\"Not found\"\n                description=\"In place of a user's full name when the user is not found.\" /></i>\n              }\n            </div>\n            : null\n          }\n        </div>\n      </li>\n    );\n  }\n};\n\nconst IntlChatMessage = injectIntl(BaseChatMessage);\nconst ChatMessage = React.forwardRef((props, ref) => <IntlChatMessage innerRef = {ref} {...props} />);\n\nexport default ChatMessage;\n","// Audio recorder widget.\n\nimport React from 'react';\n\nimport AudioPlayer from './audio-player.jsx';\n// Workaround for https://bugs.chromium.org/p/chromium/issues/detail?id=642012\n// import fixWebmDuration from 'fix-webm-duration';\nimport * as ebml from 'ts-ebml';\n\nimport { intArrayToBase64 } from '../lib/blob-helpers.js'\nimport { secondsToTime } from '../lib/strformat';\nimport { MAX_DURATION, MIN_DURATION } from '../config.js';\n\n// FFT resolution.\nconst BUFFER_SIZE = 256;\n// Make canvas bigger than the element size to reduce blurring.\nconst CANVAS_UPSCALING = 2.0;\n// Thickness of a visualization bar.\nconst LINE_WIDTH = 3 * CANVAS_UPSCALING;\n// Spacing between two visualization bars.\nconst SPACING = 2 * CANVAS_UPSCALING;\n// Duration represented by one visualization bar.\nconst MILLIS_PER_BAR = 100;\n// Color of histogram bars\nconst BAR_COLOR = '#BBBD';\n// Vertical scaling for visualization bars.\nconst BAR_SCALE = 64.0;\n// Number of bars in preview.\nconst VISUALIZATION_BARS = 96;\n// Maximum number of samples per bar.\nconst MAX_SAMPLES_PER_BAR = 10;\n\n// Recording format.\nconst AUDIO_MIME_TYPE = 'audio/webm';\n\nexport default class AudioRecorder extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      enabled: true,\n      audioRecord: null,\n      recording: true,\n      paused: false,\n      duration: '0:00',\n      blobUrl: null,\n      preview: null\n    };\n\n    this.visualize = this.visualize.bind(this);\n    this.initMediaRecording = this.initMediaRecording.bind(this);\n    this.initCanvas = this.initCanvas.bind(this);\n    this.getRecording = this.getRecording.bind(this);\n    this.cleanUp = this.cleanUp.bind(this);\n\n    this.handleResume = this.handleResume.bind(this);\n    this.handlePause = this.handlePause.bind(this);\n    this.handleDelete = this.handleDelete.bind(this);\n    this.handleDone = this.handleDone.bind(this);\n\n    this.durationMillis = 0;\n    this.startedOn = null;\n    this.viewBuffer = [];\n    this.canvasRef = React.createRef();\n  }\n\n  componentDidMount() {\n    this.stream = null;\n    this.mediaRecorder = null;\n    this.audioContext = null;\n    this.audioInput = null;\n    this.analyser = null;\n\n    this.audioChunks = [];\n\n    // Start recorder right away.\n    try {\n      navigator.mediaDevices.getUserMedia({audio: true, video: false}).then(this.initMediaRecording, this.props.onError);\n    } catch (err) {\n      this.props.onError(err);\n    }\n  }\n\n  componentWillUnmount() {\n    this.startedOn = null;\n    if (this.stream) {\n      this.cleanUp();\n    }\n  }\n\n  // Draw amplitude of sound.\n  visualize() {\n    this.initCanvas();\n\n    const pcmData = new Uint8Array(this.analyser.frequencyBinCount);\n    const width = this.canvasWidth;\n    const height = this.canvasHeight;\n    // Number of bars.\n    const viewLength = (width / (LINE_WIDTH + SPACING)) | 0;\n    // Duration of audio which fits onto the screen.\n    const viewDuration = MILLIS_PER_BAR * viewLength;\n\n    this.canvasContext.lineWidth = LINE_WIDTH;\n    this.canvasContext.strokeStyle = BAR_COLOR;\n\n    let prevBarCount = 0;\n    let volume = 0.0;\n    let countPerBar = 0;\n    const drawFrame = () => {\n      if (!this.startedOn) {\n        return;\n      }\n      window.requestAnimationFrame(drawFrame);\n\n      const duration = this.durationMillis + (Date.now() - this.startedOn);\n      // Update record length timer.\n      this.setState({duration: secondsToTime(duration / 1000)});\n\n      // Check if record is too long.\n      if (duration > MAX_DURATION) {\n        this.startedOn = null;\n        this.mediaRecorder.pause();\n        this.durationMillis += Date.now() - this.startedOn;\n        this.setState({enabled: false, recording: false, duration: secondsToTime(this.durationMillis / 1000)});\n      }\n\n      // Draw histogram.\n\n      // Get current waveform and calculate its amplitude.\n      this.analyser.getByteTimeDomainData(pcmData);\n      let amp = 0.0;\n      for (const amplitude of pcmData) {\n        amp += (amplitude - 127) ** 2;\n      }\n\n      // Sum the amplitude.\n      volume += Math.sqrt(amp/pcmData.length);\n      countPerBar ++;\n\n      let barCount = (duration / MILLIS_PER_BAR) | 0;\n      // Shift of the histogram along x-axis to make scrolling smooth. No need to shift if recording is too short.\n      const dx = viewDuration > duration ? 0 :\n        (duration - MILLIS_PER_BAR * barCount) / MILLIS_PER_BAR * (LINE_WIDTH + SPACING);\n\n      if (prevBarCount != barCount) {\n        prevBarCount = barCount;\n        // Add new amplitude visualization bar.\n        this.viewBuffer.push(volume/countPerBar);\n        volume = 0.0;\n        countPerBar = 0;\n        if (this.viewBuffer.length > viewLength) {\n          // Keep at most 'viewLength' amplitude bars.\n          this.viewBuffer.shift();\n        }\n      }\n\n      // Clear canvas.\n      this.canvasContext.clearRect(0, 0, width, height);\n\n      // Draw amplitude bars.\n      this.canvasContext.beginPath();\n      for (let i = 0; i < this.viewBuffer.length; i++) {\n        let x = i * (LINE_WIDTH + SPACING) - dx;\n        let y = Math.min(this.viewBuffer[i] / BAR_SCALE, 0.9) * height;\n\n        this.canvasContext.moveTo(x, (height - y) * 0.5);\n        this.canvasContext.lineTo(x, height * 0.5 + y * 0.5);\n      }\n      // Actually draw the bars on canvas.\n      this.canvasContext.stroke();\n    }\n\n    drawFrame();\n  }\n\n  handlePause(e) {\n    e.preventDefault();\n    this.mediaRecorder.pause();\n    this.mediaRecorder.requestData();\n    this.durationMillis += Date.now() - this.startedOn;\n    this.startedOn = null;\n    this.setState({recording: false});\n  }\n\n  handleResume(e) {\n    e.preventDefault();\n    if (this.state.enabled) {\n      this.startedOn = Date.now();\n      this.mediaRecorder.resume();\n      this.setState({recording: true}, this.visualize);\n    }\n  }\n\n  handleDelete(e) {\n    e.preventDefault();\n    this.durationMillis = 0;\n    this.startedOn = null;\n    this.mediaRecorder.stop();\n    this.cleanUp();\n    this.setState({recording: false});\n  }\n\n  handleDone(e) {\n    e.preventDefault();\n    this.setState({recording: false});\n    if (this.startedOn) {\n      this.durationMillis += Date.now() - this.startedOn;\n      this.startedOn = null;\n    }\n    // Stop recording and return data.\n    if (this.mediaRecorder) {\n      this.mediaRecorder.stop();\n    }\n  }\n\n  initCanvas() {\n    this.canvasRef.current.width = this.canvasRef.current.offsetWidth * CANVAS_UPSCALING;\n    this.canvasRef.current.height = this.canvasRef.current.offsetHeight * CANVAS_UPSCALING;\n\n    this.canvasContext = this.canvasRef.current.getContext('2d');\n    this.canvasContext.lineCap = 'round';\n    // To reduce line blurring.\n    this.canvasContext.translate(0.5, 0.5);\n    this.canvasWidth = this.canvasRef.current.width;\n    this.canvasHeight = this.canvasRef.current.height;\n  }\n\n  initMediaRecording(stream) {\n    this.stream = stream;\n    this.mediaRecorder = new MediaRecorder(stream, {mimeType: AUDIO_MIME_TYPE, audioBitsPerSecond: 24_000});\n\n    // The following code is needed for visualization.\n    this.audioContext = new AudioContext();\n    this.audioInput = this.audioContext.createMediaStreamSource(stream);\n    this.analyser = this.audioContext.createAnalyser();\n    this.analyser.fftSize = BUFFER_SIZE;\n    this.audioInput.connect(this.analyser);\n\n    this.mediaRecorder.onstop = _ => {\n      if (this.durationMillis > MIN_DURATION) {\n        this.getRecording(this.mediaRecorder.mimeType, this.durationMillis)\n          .then(result => this.props.onFinished(result.url, result.preview, this.durationMillis));\n      } else {\n        this.props.onDeleted();\n      }\n      this.cleanUp();\n    }\n\n    this.mediaRecorder.ondataavailable = (e) => {\n      if (e.data.size > 0) {\n        this.audioChunks.push(e.data);\n      }\n\n      if (this.mediaRecorder.state != 'inactive') {\n        this.getRecording(this.mediaRecorder.mimeType).then(result => {\n          this.setState({\n            blobUrl: result.url,\n            preview: result.preview\n          });\n        });\n      }\n    }\n\n    this.durationMillis = 0;\n    this.startedOn = Date.now();\n    this.mediaRecorder.start();\n    this.visualize();\n  }\n\n  // Obtain data in a form sutable for sending or playing back.\n  // If duration is valid, apply fix for Chrome's WebM duration bug.\n  getRecording(mimeType, duration) {\n    mimeType = mimeType || AUDIO_MIME_TYPE;\n    let blob = new Blob(this.audioChunks, {type: mimeType});\n    return this.tempFixMetadata(blob, mimeType)\n      .then(fixedBlob => { blob = fixedBlob; return fixedBlob.arrayBuffer(); })\n      .then(arrayBuff => this.audioContext.decodeAudioData(arrayBuff))\n      .then(decoded => this.createPreview(decoded))\n      .then(preview => ({url: window.URL.createObjectURL(blob), preview: intArrayToBase64(preview)}));\n    /*\n    return (duration > 0 ? ysFixWebmDuration(blob, duration, {logger: false}) : Promise.resolve(blob))\n      .then(fixedBlob => { blob = fixedBlob; return fixedBlob.arrayBuffer(); })\n      .then(arrayBuff => this.audioContext.decodeAudioData(arrayBuff))\n      .then(decoded => this.createPreview(decoded))\n      .then(preview => ({url: window.URL.createObjectURL(blob), preview: intArrayToBase64(preview)}));\n      */\n  }\n\n  tempFixMetadata(blob, mimeType) {\n    const decoder = new ebml.Decoder();\n    const reader = new ebml.Reader();\n    reader.logging = true;\n    reader.logGroup = \"Raw WebM file\";\n    reader.drop_default_duration = false;\n    let webmBuf;\n    blob.arrayBuffer()\n      .then(buf => { webmBuf = buf; return decoder.decode(buf); })\n      .then(elms => {\n        elms.forEach(elm => reader.read(elm))\n        reader.stop();\n        const fixedMetadataBuf = ebml.tools.makeMetadataSeekable(reader.metadatas, reader.duration, reader.cues);\n        const body = webmBuf.slice(reader.metadataSize);\n        return new Blob([fixedMetadataBuf, body], {type: mimeType});\n      });\n  }\n\n  // Preview must be calculated at the source: Chrome does not allow background AudioContext.\n  createPreview(audio) {\n    const data = audio.getChannelData(0);\n    // Number of amplitude bars in preview.\n    const viewLength = Math.min(data.length, VISUALIZATION_BARS);\n    // The number of samples in each bar.\n    const totalSPB = (data.length / viewLength) | 0;\n    // Distance between samples: we are going to take just a fracton of samples.\n    const samplingRate = Math.max(1, (totalSPB / MAX_SAMPLES_PER_BAR) | 0);\n\n    let buffer = [];\n    let max = -1;\n    for (let i = 0; i < viewLength; i++) {\n      let amplitude = 0;\n      let count = 0;\n      for (let j = 0; j < totalSPB; j += samplingRate) {\n        amplitude += data[totalSPB * i + j] ** 2;\n        count ++;\n      }\n      const val = Math.sqrt(amplitude / count);\n      buffer.push(val);\n      max = Math.max(max, val);\n    }\n    // Normalize amplitude to 0..100.\n    if (max > 0) {\n      buffer = buffer.map(a => (100 * a / max) | 0);\n    }\n    return buffer;\n  }\n\n  cleanUp() {\n    this.audioInput.disconnect();\n    this.stream.getTracks().forEach(track => track.stop());\n  }\n\n  render() {\n    const resumeClass = 'material-icons ' + (this.state.enabled ? 'red' : 'gray');\n    return (\n      <div className=\"audio\">\n        <a href=\"#\" onClick={this.handleDelete} title=\"Delete\">\n          <i className=\"material-icons gray\">delete_outline</i>\n        </a>\n        {this.state.recording ?\n          <canvas ref={this.canvasRef} />\n          :\n          <AudioPlayer\n            src={this.state.blobUrl}\n            preview={this.state.preview}\n            duration={this.durationMillis}\n            short={true} />\n        }\n        <div className=\"duration\">{this.state.duration}</div>\n        {this.state.recording ?\n          <a href=\"#\" onClick={this.handlePause} title=\"Pause\">\n            <i className=\"material-icons\">pause_circle_outline</i>\n          </a> :\n          <a href=\"#\" onClick={this.handleResume} title=\"Resume\">\n            <i className={resumeClass}>radio_button_checked</i>\n          </a>\n        }\n        <a href=\"#\" onClick={this.handleDone} title=\"Send\">\n          <i className=\"material-icons\">send</i>\n        </a>\n      </div>\n    );\n  }\n}\n","// Send message form.\nimport React from 'react';\nimport { defineMessages, injectIntl } from 'react-intl';\nimport { Drafty } from 'tinode-sdk';\n\nimport AudioRecorder from './audio-recorder.jsx';\n\nimport { KEYPRESS_DELAY } from '../config.js';\nimport { filePasted } from '../lib/blob-helpers.js';\nimport { replyFormatter } from '../lib/formatters.js';\n\nconst messages = defineMessages({\n  messaging_disabled: {\n    id: 'messaging_disabled_prompt',\n    defaultMessage: 'Messaging disabled',\n    description: 'Prompt in SendMessage in read-only topic'\n  },\n  type_new_message: {\n    id: 'new_message_prompt',\n    defaultMessage: 'New message',\n    description: 'Prompt in send message field'\n  },\n  add_image_caption: {\n    id: 'image_caption_prompt',\n    defaultMessage: 'Image caption',\n    description: 'Prompt in SendMessage for attached image'\n  },\n  file_attachment_too_large: {\n    id: 'file_attachment_too_large',\n    defaultMessage: 'The file size {size} exceeds the {limit} limit.',\n    description: 'Error message when attachment is too large'\n  },\n  cannot_initiate_upload: {\n    id: 'cannot_initiate_file_upload',\n    defaultMessage: 'Cannot initiate file upload.',\n    description: 'Generic error messagewhen attachment fails'\n  },\n});\n\nclass SendMessage extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      quote: null,\n      message: '',\n      audioRec: false,\n      audioAvailable: !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia),\n      // Make initial keypress time as if it happened 5001 milliseconds in the past.\n      keypressTimestamp: new Date().getTime() - KEYPRESS_DELAY - 1\n    };\n\n    this.handlePasteEvent = this.handlePasteEvent.bind(this);\n    this.handleAttachImage = this.handleAttachImage.bind(this);\n    this.handleAttachFile = this.handleAttachFile.bind(this);\n    this.handleAttachAudio = this.handleAttachAudio.bind(this);\n    this.handleSend = this.handleSend.bind(this);\n    this.handleKeyPress = this.handleKeyPress.bind(this);\n    this.handleMessageTyping = this.handleMessageTyping.bind(this);\n\n    this.handleQuoteClick = this.handleQuoteClick.bind(this);\n\n    this.formatReply = this.formatReply.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.messageEditArea) {\n      this.messageEditArea.addEventListener('paste', this.handlePasteEvent, false);\n    }\n\n    this.setState({quote: this.formatReply()});\n  }\n\n  componentWillUnmount() {\n    if (this.messageEditArea) {\n      this.messageEditArea.removeEventListener('paste', this.handlePasteEvent, false);\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.messageEditArea) {\n      this.messageEditArea.focus();\n    }\n\n    if (prevProps.topicName != this.props.topicName) {\n      this.setState({message: '', audioRec: false, quote: null});\n    }\n    if (prevProps.reply != this.props.reply) {\n      this.setState({quote: this.formatReply()});\n    }\n  }\n\n  formatReply() {\n    return this.props.reply ?\n      Drafty.format(this.props.reply.content, replyFormatter, {\n        formatMessage: this.props.intl.formatMessage.bind(this.props.intl),\n        authorizeURL: this.props.tinode.authorizeURL.bind(this.props.tinode)\n      }) : null;\n  }\n\n  handlePasteEvent(e) {\n    if (this.props.disabled) {\n      return;\n    }\n    // FIXME: handle large files too.\n    if (filePasted(e,\n      file => { this.props.onAttachImage(file); },\n      file => { this.props.onAttachFile(file); },\n      this.props.onError)) {\n\n      // If a file was pasted, don't paste base64 data into input field.\n      e.preventDefault();\n    }\n  }\n\n  handleAttachImage(e) {\n    if (e.target.files && e.target.files.length > 0) {\n      this.props.onAttachImage(e.target.files[0]);\n    }\n    // Clear the value so the same file can be uploaded again.\n    e.target.value = '';\n  }\n\n  handleAttachFile(e) {\n    if (e.target.files && e.target.files.length > 0) {\n      this.props.onAttachFile(e.target.files[0]);\n    }\n    // Clear the value so the same file can be uploaded again.\n    e.target.value = '';\n  }\n\n  handleAttachAudio(url, preview, duration) {\n    this.setState({audioRec: false});\n    this.props.onAttachAudio(url, preview, duration);\n  }\n\n  handleSend(e) {\n    e.preventDefault();\n    const message = this.state.message.trim();\n    if (message || this.props.acceptBlank || this.props.noInput) {\n      this.props.onSendMessage(message);\n      this.setState({message: ''});\n    }\n  }\n\n  /* Send on Enter key */\n  handleKeyPress(e) {\n    if (this.state.audioRec) {\n      // Ignore key presses while audio is being recorded.\n      e.preventDefault();\n      e.stopPropagation();\n      return;\n    }\n\n    // Remove this if you don't want Enter to trigger send\n    if (e.key === 'Enter') {\n      // Have Shift-Enter insert a line break instead\n      if (!e.shiftKey) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        this.handleSend(e);\n      }\n    }\n  }\n\n  handleMessageTyping(e) {\n    const newState = {message: e.target.value};\n    if (this.props.onKeyPress) {\n      const now = new Date().getTime();\n      if (now - this.state.keypressTimestamp > KEYPRESS_DELAY) {\n        this.props.onKeyPress();\n        newState.keypressTimestamp = now;\n      }\n    }\n    this.setState(newState);\n  }\n\n  handleQuoteClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (this.props.reply && this.props.onQuoteClick) {\n      const replyToSeq = this.props.reply.seq;\n      this.props.onQuoteClick(replyToSeq);\n    }\n  }\n\n  render() {\n    const { formatMessage } = this.props.intl;\n    const prompt = this.props.disabled ?\n      formatMessage(messages.messaging_disabled) :\n      (this.props.messagePrompt ?\n        formatMessage(messages[this.props.messagePrompt]) :\n        formatMessage(messages.type_new_message));\n\n    const quote = this.state.quote ?\n      (<div id=\"reply-quote-preview\">\n        <div className=\"cancel\">\n          <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onCancelReply();}}><i className=\"material-icons gray\">close</i></a>\n        </div>\n        {this.state.quote}\n      </div>) : null;\n    const audioEnabled = this.state.audioAvailable && this.props.onAttachAudio;\n    return (\n      <div id=\"send-message-wrapper\">\n        {!this.props.noInput ? quote : null}\n        <div id=\"send-message-panel\">\n          {!this.props.disabled ?\n            <>\n              {this.props.onAttachFile && !this.state.audioRec ?\n                <>\n                  <a href=\"#\" onClick={(e) => {e.preventDefault(); this.attachImage.click();}} title=\"Add image\">\n                    <i className=\"material-icons secondary\">photo</i>\n                  </a>\n                  <a href=\"#\" onClick={(e) => {e.preventDefault(); this.attachFile.click();}} title=\"Attach file\">\n                    <i className=\"material-icons secondary\">attach_file</i>\n                  </a>\n                </>\n                :\n                null}\n              {this.props.noInput ?\n                (quote || <div className=\"hr thin\" />) :\n                (this.state.audioRec ?\n                  <AudioRecorder\n                    onDeleted={_ => this.setState({audioRec: false})}\n                    onFinished={this.handleAttachAudio}/> :\n                  <textarea id=\"sendMessage\" placeholder={prompt}\n                    value={this.state.message} onChange={this.handleMessageTyping}\n                    onKeyPress={this.handleKeyPress}\n                    ref={(ref) => {this.messageEditArea = ref;}}\n                    autoFocus />)}\n              {this.state.message || !audioEnabled ?\n                <a href=\"#\" onClick={this.handleSend} title=\"Send\">\n                  <i className=\"material-icons\">send</i>\n                </a> :\n                !this.state.audioRec ?\n                  <a href=\"#\" onClick={e => {e.preventDefault(); this.setState({audioRec: true})}} title=\"Voice\">\n                    <i className=\"material-icons\">mic</i>\n                  </a> :\n                  null\n              }\n              <input type=\"file\" ref={(ref) => {this.attachFile = ref;}}\n                onChange={this.handleAttachFile} style={{display: 'none'}} />\n              <input type=\"file\" ref={(ref) => {this.attachImage = ref;}} accept=\"image/*\"\n                onChange={this.handleAttachImage} style={{display: 'none'}} />\n            </>\n            :\n            <div id=\"writing-disabled\">{prompt}</div>\n          }\n        </div>\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(SendMessage);\n","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport SendMessage from '../widgets/send-message.jsx';\n\nimport { bytesToHumanSize, shortenFileName } from '../lib/strformat.js';\n\n// Get material icon name from mime type.\nfunction iconFromMime(mime) {\n  // If more icons become available in material icons, add them to this mime-to-icon mapping.\n  const mimeToIcon = {default: 'insert_drive_file', image: 'image', text: 'description', video: 'theaters'};\n\n  return mimeToIcon[mime] || mimeToIcon[(mime || '').split('/')[0]] || mimeToIcon['default'];\n}\n\nexport default class DocPreview extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.handleSendDoc = this.handleSendDoc.bind(this);\n  }\n\n  handleSendDoc(caption) {\n    this.props.onClose();\n    this.props.onSendMessage(this.props.content.file);\n  }\n\n  render() {\n    if (!this.props.content) {\n      return null;\n    }\n    return (\n      <div id=\"image-preview\">\n        <div id=\"image-preview-caption-panel\">\n          <span>{this.props.content.name}</span>\n          <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onClose();}}><i className=\"material-icons gray\">close</i></a>\n        </div>\n        <div id=\"image-preview-container\">\n          <div className=\"flex-column narrow\">\n            <i className=\"material-icons gray\">{iconFromMime(this.props.content.type)}</i>\n            <div><b><FormattedMessage id=\"label_file_name\" defaultMessage=\"File name:\"\n              description=\"Label for a file name\" /></b> {shortenFileName(this.props.content.name, 24) || '-'}</div>\n            <div><b><FormattedMessage id=\"label_content_type\" defaultMessage=\"Content type:\"\n              description=\"Label for file content type (mime)\" /></b> {this.props.content.type || 'application/octet-stream'}</div>\n            <div><b><FormattedMessage id=\"label_size\" defaultMessage=\"Size:\"\n              description=\"Label for file size\" /></b> {bytesToHumanSize(this.props.content.size)}</div>\n          </div>\n        </div>\n        <SendMessage\n          noInput={true}\n          tinode={this.props.tinode}\n          reply={this.props.reply}\n          onCancelReply={this.props.onCancelReply}\n          onSendMessage={this.handleSendDoc}\n          onError={this.props.onError} />\n      </div>\n    );\n  }\n};\n","// GroupSubs: a list of group subscribers currently online.\n// Show in the topic title bar\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport { MAX_ONLINE_IN_TOPIC } from '../config.js'\n\nimport LetterTile from './letter-tile.jsx';\nimport { makeImageUrl } from '../lib/blob-helpers.js';\n\nexport default class GroupSubs extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const usersOnline = [];\n    const totalCount = (this.props.subscribers || []).length;\n    const countToShow = Math.min(MAX_ONLINE_IN_TOPIC, totalCount);\n\n    (this.props.subscribers || []).some((sub) => {\n      usersOnline.push(\n        <div className=\"avatar-box\" key={sub.user}>\n          <LetterTile\n            tinode={this.props.tinode}\n            topic={sub.user}\n            avatar={makeImageUrl(sub.public ? sub.public.photo : null) || true}\n            title={sub.public ? sub.public.fn : null} />\n        </div>\n      );\n      return usersOnline.length == countToShow;\n    });\n\n    return (\n      <div id=\"topic-users\">{usersOnline} {totalCount > countToShow ?\n        <span>\n          <FormattedMessage id=\"more_online_members\" defaultMessage=\"+{overflow} more\"\n              description=\"Shown in MessagesView title bar when the number of online subscribers exceeds MAX_ONLINE_IN_TOPIC\"\n              values={{ overflow: (totalCount - countToShow) }} />\n        </span> : null}\n      </div>\n    );\n  }\n};\n","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport SendMessage from '../widgets/send-message.jsx';\n\nimport { REM_SIZE } from '../config.js';\nimport { fitImageSize } from '../lib/blob-helpers.js';\nimport { bytesToHumanSize, shortenFileName } from '../lib/strformat.js';\n\nexport default class ImagePreview extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      width: 0,\n      height: 0\n    };\n\n    this.handleSendImage = this.handleSendImage.bind(this);\n  }\n\n  assignWidth(node) {\n    if (node && !this.state.width) {\n      const bounds = node.getBoundingClientRect();\n      this.setState({\n        width: bounds.width | 0,\n        height: bounds.height | 0\n      });\n    }\n  }\n\n  handleSendImage(caption) {\n    this.props.onClose();\n    this.props.onSendMessage(caption, this.props.content.blob);\n  }\n\n  render() {\n    if (!this.props.content) {\n      return null;\n    }\n\n    const dim = fitImageSize(this.props.content.width, this.props.content.height,\n      this.state.width, this.state.height, false);\n    const size = dim ? { width: dim.dstWidth + 'px', height: dim.dstHeight + 'px' } :\n      ((this.props.content.width > this.props.content.height) ? {width: '100%'} : {height: '100%'});\n    size.maxWidth = '100%';\n    size.maxHeight = '100%';\n\n    // Average font aspect ratio is ~0.5; File name takes 1/3 of the viewport width.\n    const maxlength = Math.max(((this.state.width / REM_SIZE / 1.5) | 0) - 2, 12);\n    const fname = shortenFileName(this.props.content.name, maxlength) || '-';\n\n    const width = this.props.content.width || '-';\n    const height = this.props.content.height || '-';\n    return (\n      <div id=\"image-preview\">\n        <div id=\"image-preview-caption-panel\">\n          {!this.props.onSendMessage ?\n            <a href={this.props.content.url} download={true}>\n              <i className=\"material-icons\">file_download</i> <FormattedMessage\n                id=\"download_action\" defaultMessage=\"download\" description=\"Call to action [download]\" />\n            </a>\n            :\n            <span>{fname}</span>\n          }\n          <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onClose();}}><i className=\"material-icons gray\">close</i></a>\n        </div>\n        <div id=\"image-preview-container\" ref={(node) => this.assignWidth(node)}>\n          <img src={this.props.content.url} style={size} className=\"image-preview\" alt={this.props.content.name} />\n        </div>\n        {this.props.onSendMessage ?\n          <SendMessage\n            messagePrompt=\"add_image_caption\"\n            acceptBlank={true}\n            tinode={this.props.tinode}\n            reply={this.props.reply}\n            onCancelReply={this.props.onCancelReply}\n            onSendMessage={this.handleSendImage}\n            onError={this.props.onError} />\n          :\n          <div id=\"image-preview-footer\">\n            <div>\n              <div><b><FormattedMessage id=\"label_file_name\" defaultMessage=\"File name:\"\n                description=\"Label for a file name\" /></b></div>\n              <div><span title={this.props.content.name}>{fname}</span></div>\n            </div>\n            <div>\n              <div><b><FormattedMessage id=\"label_content_type\" defaultMessage=\"Content type:\"\n                description=\"Label for file content type (mime)\" /></b></div>\n              <div>{this.props.content.type}</div>\n            </div>\n            <div>\n              <div><b><FormattedMessage id=\"label_size\" defaultMessage=\"Size:\"\n                description=\"Label for file size\" /></b></div>\n              <div>{width} &times; {height} px; {bytesToHumanSize(this.props.content.size)}</div>\n            </div>\n          </div>}\n      </div>\n    );\n  }\n};\n","// A single topic or user.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport default class Invitation extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.handleButtonAction = this.handleButtonAction.bind(this);\n  }\n\n  handleButtonAction(evt, data) {\n    evt.preventDefault();\n    this.props.onAction(data);\n  }\n\n  render() {\n    return (\n      <div className=\"accept-invite-panel\">\n        <div className=\"title\">\n          <FormattedMessage id=\"chat_invitation\"\n            defaultMessage=\"You are invited to start a new chat. What would you like to do?\"\n            description=\"New chat invitation message: [Accept] [Ignore] [Block].\" />\n        </div>\n        <div className=\"footer\">\n          <button className=\"primary\" onClick={event => { this.handleButtonAction(event, \"accept\"); }}>\n            <FormattedMessage id=\"chat_invitation_accept\"\n              defaultMessage=\"Accept\" description=\"Action [Accept] for chat invitation.\" />\n          </button>\n          <button className=\"secondary\" onClick={event => { this.handleButtonAction(event, \"delete\"); }}>\n            <FormattedMessage id=\"chat_invitation_ignore\"\n              defaultMessage=\"Ignore\" description=\"Action [Ignore] for chat invitation.\" />\n          </button>\n          <button className=\"secondary\" onClick={event => { this.handleButtonAction(event, \"block\"); }}>\n            <FormattedMessage id=\"chat_invitation_block\"\n              defaultMessage=\"Block\" description=\"Action [Block] for chat invitation.\" />\n          </button>\n        </div>\n      </div>\n    );\n  }\n};\n","/* This is just a static page to display when no conversation is selected. */\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport { Tinode } from 'tinode-sdk';\n\nimport { APP_NAME } from '../config.js';\n\nexport default class LogoView extends React.PureComponent {\n  render() {\n    const version = APP_NAME + ' (' + Tinode.getLibrary() + ')';\n    return (\n      <div id=\"dummy-view\">\n        <div>\n          <a href=\"https://github.com/tinode/chat/\">\n            <img id=\"logo\" alt=\"logo\" src=\"img/logo.svg\" />\n            <h2>Tinode Web</h2>\n          </a>\n          <p><FormattedMessage id=\"label_client\" defaultMessage=\"Client:\"\n            description=\"Label for a client version\" /> {version}</p>\n          <p><FormattedMessage id=\"label_server\" defaultMessage=\"Server:\"\n            description=\"Label for a server version\" /> {this.props.serverVersion} ({this.props.serverAddress})</p>\n        </div>\n      </div>\n    );\n  }\n};\n","// Message bubble with non-payload content, such as an indicator of deleted content or a date stamp.\n\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nexport default class MetaMessage extends React.PureComponent {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    let content = null;\n    let bubbleClass = 'bubble';\n    if (this.props.deleted) {\n      // Message represents a range of deleted messages.\n      content = <><i className=\"material-icons gray\">block</i> <i className=\"gray\">\n        <FormattedMessage id=\"deleted_content\"\n          defaultMessage=\"content deleted\" description=\"Shown when messages are deleted\" />\n      </i></>\n      bubbleClass += ' deleted';\n    } else if (this.props.date) {\n      // A date badge.\n      content = <>{this.props.date}</>\n      bubbleClass += ' date';\n    }\n\n    if (!content) {\n      return <>{null}</>\n    }\n\n    return (\n      <li className=\"meta\">\n        <div className={bubbleClass}>\n          <div className=\"message-content\">\n            {content}\n          </div>\n        </div>\n      </li>\n    );\n  }\n};\n","// Utility class for hash navigation.\n\nexport default class HashNavigation {\n  // Parse hash as in http://www.example.com/path#hash as if it were\n  // path and arguments.\n  static parseUrlHash(hash) {\n    // Split path from args, path -> parts[0], args->path[1]\n    const parts = hash.split('?', 2);\n    const params = {};\n    let path = [];\n    if (parts[0]) {\n      path = parts[0].replace('#', '').split('/');\n    }\n    if (parts[1]) {\n      parts[1].split('&').forEach((arg) => {\n        // Can't use split() because the value may contain '='.\n        const eq = arg.indexOf('=');\n        if (eq > 0) {\n          params[arg.slice(0, eq)] = decodeURIComponent(arg.slice(eq + 1));\n        }\n      });\n    }\n    return {path: path, params: params};\n  }\n\n  static navigateTo(url) {\n    window.location.hash = url;\n  }\n\n  static composeUrlHash(path, params) {\n    let url = path.join('/');\n    const args = [];\n    for (const key in params) {\n      if (params.hasOwnProperty(key)) {\n        args.push(key + '=' + encodeURIComponent(params[key]));\n      }\n    }\n    if (args.length > 0) {\n      url += '?' + args.join('&');\n    }\n    return url;\n  }\n\n  static addUrlParam(hash, key, value) {\n    const parsed = HashNavigation.parseUrlHash(hash);\n    parsed.params[key] = value;\n    return HashNavigation.composeUrlHash(parsed.path, parsed.params);\n  }\n\n  static removeUrlParam(hash, key) {\n    const parsed = HashNavigation.parseUrlHash(hash);\n    delete parsed.params[key];\n    return HashNavigation.composeUrlHash(parsed.path, parsed.params);\n  }\n\n  static setUrlSidePanel(hash, sidepanel) {\n    const parsed = HashNavigation.parseUrlHash(hash);\n    parsed.path[0] = sidepanel;\n    return HashNavigation.composeUrlHash(parsed.path, parsed.params);\n  }\n\n  static setUrlInfoPanel(hash, infopanel) {\n    const parsed = HashNavigation.parseUrlHash(hash);\n    if (infopanel) {\n      parsed.params.info = infopanel;\n    } else {\n      delete parsed.params.info;\n    }\n    return HashNavigation.composeUrlHash(parsed.path, parsed.params);\n  }\n\n  static setUrlTopic(hash, topic) {\n    const parsed = HashNavigation.parseUrlHash(hash);\n    parsed.path[1] = topic;\n    // Close InfoView on topic change.\n    delete parsed.params.info;\n    return HashNavigation.composeUrlHash(parsed.path, parsed.params);\n  }\n}\n","// Panel with a chat.\n\nimport React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nimport { Drafty, Tinode } from 'tinode-sdk';\n\nimport CallPanel from '../widgets/call-panel.jsx';\nimport ChatMessage from '../widgets/chat-message.jsx';\nimport ContactBadges from '../widgets/contact-badges.jsx';\nimport DocPreview from '../widgets/doc-preview.jsx';\nimport ErrorPanel from '../widgets/error-panel.jsx';\nimport GroupSubs from '../widgets/group-subs.jsx';\nimport ImagePreview from '../widgets/image-preview.jsx';\nimport Invitation from '../widgets/invitation.jsx';\nimport LetterTile from '../widgets/letter-tile.jsx';\nimport LoadSpinner from '../widgets/load-spinner.jsx';\nimport LogoView from './logo-view.jsx';\nimport MetaMessage from '../widgets/meta-message.jsx';\nimport SendMessage from '../widgets/send-message.jsx';\n\nimport { DEFAULT_P2P_ACCESS_MODE, IMAGE_PREVIEW_DIM, KEYPRESS_DELAY,\n  MESSAGES_PAGE, MAX_EXTERN_ATTACHMENT_SIZE, MAX_IMAGE_DIM, MAX_INBAND_ATTACHMENT_SIZE,\n  READ_DELAY, QUOTED_REPLY_LENGTH } from '../config.js';\nimport { CALL_STATE_OUTGOING_INITATED, CALL_STATE_IN_PROGRESS } from '../constants.js';\nimport { blobToBase64, fileToBase64, imageScaled, makeImageUrl } from '../lib/blob-helpers.js';\nimport HashNavigation from '../lib/navigation.js';\nimport { bytesToHumanSize, shortDateFormat } from '../lib/strformat.js';\n\n// Run timer with this frequency (ms) for checking notification queue.\nconst NOTIFICATION_EXEC_INTERVAL = 300;\n// Scroll distance before [go to latest message] button is shown.\nconst SHOW_GO_TO_LAST_DIST = 100;\n\nconst messages = defineMessages({\n  online_now: {\n    id: 'online_now',\n    defaultMessage: 'online now',\n    description: 'Indicator that the user or topic is currently online',\n  },\n  last_seen: {\n    id: 'last_seen_timestamp',\n    defaultMessage: 'Last seen',\n    description: 'Label for the timestamp of when the user or topic was last online'\n  },\n  not_found: {\n    id: 'title_not_found',\n    defaultMessage: 'Not found',\n    description: 'Title shown when topic is not found'\n  },\n  channel: {\n    id: 'channel',\n    defaultMessage: 'channel',\n    description: 'Subtitle shown for channels in MessagesView instead of last seen'\n  },\n  file_attachment_too_large: {\n    id: 'file_attachment_too_large',\n    defaultMessage: 'The file size {size} exceeds the {limit} limit.',\n    description: 'Error message when attachment is too large'\n  },\n  invalid_content: {\n    id: 'invalid_content',\n    defaultMessage: 'invalid content',\n    description: 'Shown when the message is unreadable'\n  },\n});\n\n// Checks if the access permissions are granted but not yet accepted.\nfunction isUnconfirmed(acs) {\n  if (acs) {\n    const ex = acs.getExcessive() || '';\n    return acs.isJoiner('given') && (ex.includes('R') || ex.includes('W'));\n  }\n  return false;\n}\n\nfunction isPeerRestricted(acs) {\n  if (acs) {\n    const ms = acs.getMissing() || '';\n    return acs.isJoiner('want') && (ms.includes('R') || ms.includes('W'));\n  }\n  return false;\n}\n\nfunction shouldPresentCallPanel(callState) {\n  // Show call panel if either:\n  // - call is outgoing (and the client is waiting for the other side to pick up) or,\n  // - call is already in progress.\n  return callState == CALL_STATE_OUTGOING_INITATED || callState == CALL_STATE_IN_PROGRESS;\n}\n\nclass MessagesView extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = MessagesView.getDerivedStateFromProps(props, {});\n\n    this.leave = this.leave.bind(this);\n    this.sendMessage = this.sendMessage.bind(this);\n    this.retrySend = this.retrySend.bind(this);\n    this.sendImageAttachment = this.sendImageAttachment.bind(this);\n    this.sendFileAttachment = this.sendFileAttachment.bind(this);\n    this.sendAudioAttachment = this.sendAudioAttachment.bind(this);\n    this.sendKeyPress = this.sendKeyPress.bind(this);\n    this.subscribe = this.subscribe.bind(this);\n    this.handleScrollReference = this.handleScrollReference.bind(this);\n    this.handleScrollEvent = this.handleScrollEvent.bind(this);\n    this.handleDescChange = this.handleDescChange.bind(this);\n    this.handleSubsUpdated = this.handleSubsUpdated.bind(this);\n    this.handleMessageUpdate = this.handleMessageUpdate.bind(this);\n    this.handleAllMessagesReceived = this.handleAllMessagesReceived.bind(this);\n    this.handleInfoReceipt = this.handleInfoReceipt.bind(this);\n    this.handleImagePostview = this.handleImagePostview.bind(this);\n    this.handleClosePreview = this.handleClosePreview.bind(this);\n    this.handleFormResponse = this.handleFormResponse.bind(this);\n    this.handleContextClick = this.handleContextClick.bind(this);\n    this.handleShowMessageContextMenu = this.handleShowMessageContextMenu.bind(this);\n    this.handleNewChatAcceptance = this.handleNewChatAcceptance.bind(this);\n    this.handleEnablePeer = this.handleEnablePeer.bind(this);\n    this.handleAttachFile = this.handleAttachFile.bind(this);\n    this.handleAttachImage = this.handleAttachImage.bind(this);\n    this.handleCancelUpload = this.handleCancelUpload.bind(this);\n    this.postReadNotification = this.postReadNotification.bind(this);\n    this.clearNotificationQueue = this.clearNotificationQueue.bind(this);\n    this.goToLatestMessage = this.goToLatestMessage.bind(this);\n\n    this.handlePickReply = this.handlePickReply.bind(this);\n    this.handleCancelReply = this.handleCancelReply.bind(this);\n    this.handleQuoteClick = this.handleQuoteClick.bind(this);\n    this.handleCallHangup = this.handleCallHangup.bind(this);\n\n    this.chatMessageRefs = {};\n    this.getOrCreateMessageRef = this.getOrCreateMessageRef.bind(this);\n\n    this.readNotificationQueue = [];\n    this.readNotificationTimer = null;\n\n    this.keyPressTimer = null;\n  }\n\n  getOrCreateMessageRef(seqId) {\n    if (this.chatMessageRefs.hasOwnProperty(seqId)) {\n      return this.chatMessageRefs[seqId];\n    }\n    const ref = React.createRef();\n    this.chatMessageRefs[seqId] = ref;\n    return ref;\n  }\n\n  componentDidMount() {\n    if (this.messagesScroller) {\n      this.messagesScroller.addEventListener('scroll', this.handleScrollEvent);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.messagesScroller) {\n      this.messagesScroller.removeEventListener('scroll', this.handleScrollEvent);\n    }\n\n    // Flush all notifications.\n    this.clearNotificationQueue();\n  }\n\n  // Scroll last message into view on component update e.g. on message received\n  // or vertical shrinking.\n  componentDidUpdate(prevProps, prevState) {\n    if (this.messagesScroller &&\n      (prevState.topic != this.state.topic || prevState.messageCount != this.state.messageCount)) {\n      // New message.\n      if (this.state.scrollPosition < SHOW_GO_TO_LAST_DIST) {\n        this.messagesScroller.scrollTop = this.messagesScroller.scrollHeight -\n          this.state.scrollPosition -\n          this.messagesScroller.offsetHeight;\n      }\n    }\n\n    const topic = this.props.tinode ? this.props.tinode.getTopic(this.state.topic) : undefined;\n    if (this.state.topic != prevState.topic) {\n      if (prevState.topic && !Tinode.isNewGroupTopicName(prevState.topic)) {\n        this.leave(prevState.topic);\n        if (prevState.rtcPanel) {\n          this.handleCallHangup(prevState.topic, prevProps.callSeq);\n        }\n      }\n\n      if (topic) {\n        topic.onData = this.handleMessageUpdate;\n        topic.onAllMessagesReceived = this.handleAllMessagesReceived;\n        topic.onInfo = this.handleInfoReceipt;\n        topic.onMetaDesc = this.handleDescChange;\n        topic.onSubsUpdated = this.handleSubsUpdated;\n        topic.onPres = this.handleSubsUpdated;\n      }\n    }\n\n    if (!this.props.applicationVisible) {\n      // If application is not visible, flush all unsent 'read' notifications.\n      this.clearNotificationQueue();\n    } else {\n      // Otherwise assume there are unread messages.\n      this.postReadNotification(0);\n    }\n\n    if (topic && ((this.state.topic != prevState.topic) || !prevProps.ready)) {\n      // Don't immediately subscribe to a new p2p topic, wait for the first message.\n      if (topic._new && topic.isP2PType()) {\n        topic.getMeta(topic.startMetaQuery().withDesc().build());\n      } else {\n        this.subscribe(topic);\n      }\n    }\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    let nextState = {};\n    if (!nextProps.topic) {\n      // Default state: no topic.\n      nextState = {\n        messageCount: 0,\n        latestClearId: -1,\n        onlineSubs: [],\n        topic: null,\n        title: '',\n        avatar: null,\n        isVerified: false,\n        isStaff: false,\n        isDangerous: false,\n        deleted: false,\n        docPreview: null,\n        imagePreview: null,\n        imagePostview: null,\n        rtcPanel: null,\n        typingIndicator: false,\n        scrollPosition: 0,\n        fetchingMessages: false,\n        peerMessagingDisabled: false,\n        channel: false,\n        reply: null,\n        showGoToLastButton: false\n      };\n    } else if (nextProps.topic != prevState.topic) {\n      const topic = nextProps.tinode.getTopic(nextProps.topic);\n\n      nextState = {\n        topic: nextProps.topic,\n        docPreview: null,\n        imagePreview: null,\n        imagePostview: null,\n        rtcPanel: null,\n        typingIndicator: false,\n        scrollPosition: 0,\n        fetchingMessages: false,\n        showGoToLastButton: false,\n        deleted: topic._deleted\n      };\n\n      if (nextProps.forwardMessage) {\n        // We are forwarding a message. Show preview.\n        nextState.reply = {\n          content: nextProps.forwardMessage.preview,\n          seq: null\n        };\n      }\n\n      if (topic) {\n        // Topic exists.\n        const subs = [];\n\n        if (nextProps.connected) {\n          topic.subscribers((sub) => {\n            if (sub.online && sub.user != nextProps.myUserId) {\n              subs.push(sub);\n            }\n          });\n        }\n\n        Object.assign(nextState, {\n          onlineSubs: subs\n        });\n\n        if (topic.public) {\n          Object.assign(nextState, {\n            title: topic.public.fn,\n            avatar: makeImageUrl(topic.public.photo)\n          });\n        } else {\n          Object.assign(nextState, {\n            title: '',\n            avatar: null\n          });\n        }\n\n        const peer = topic.p2pPeerDesc();\n        if (peer) {\n          Object.assign(nextState, {\n            peerMessagingDisabled: isPeerRestricted(peer.acs)\n          });\n        } else if (prevState.peerMessagingDisabled) {\n          Object.assign(nextState, {\n            peerMessagingDisabled: false\n          });\n        }\n        Object.assign(nextState, {\n          messageCount: topic.messageCount(),\n          latestClearId: topic.maxClearId(),\n          channel: topic.isChannelType()\n        });\n\n        if (nextProps.callTopic == topic.name && shouldPresentCallPanel(nextProps.callState)) {\n          nextState.rtcPanel = nextProps.callTopic;\n        }\n      } else {\n        // Invalid topic.\n        Object.assign(nextState, {\n          messageCount: 0,\n          latestClearId: -1,\n          onlineSubs: [],\n          title: '',\n          avatar: null,\n          peerMessagingDisabled: false,\n          channel: false\n        });\n      }\n    } else {\n      // We are still in same topic. Show the call panel if necessary.\n      if (nextProps.callTopic == prevState.topic && !prevState.rtcPanel &&\n          shouldPresentCallPanel(nextProps.callState)) {\n        nextState.rtcPanel = nextProps.callTopic;\n      }\n    }\n\n    if (nextProps.acs) {\n      if (nextProps.acs.isWriter() != prevState.isWriter) {\n        nextState.isWriter = !prevState.isWriter;\n      }\n      if (nextProps.acs.isReader() != prevState.isReader) {\n        nextState.isReader = !prevState.isReader;\n      }\n      if (!nextProps.acs.isReader('given') != prevState.readingBlocked) {\n        nextState.readingBlocked = !prevState.readingBlocked;\n      }\n      if (nextProps.acs.isSharer() != prevState.isSharer) {\n        nextState.isSharer = !prevState.isSharer;\n      }\n    } else {\n      if (prevState.isWriter) {\n        nextState.isWriter = false;\n      }\n      if (prevState.isReader) {\n        nextState.isReader = false;\n      }\n      if (!prevState.readingBlocked) {\n        prevState.readingBlocked = true;\n      }\n      if (prevState.isSharer) {\n        nextState.isSharer = false;\n      }\n    }\n\n    if (isUnconfirmed(nextProps.acs) == !prevState.unconformed) {\n      nextState.unconfirmed = !prevState.unconformed;\n    }\n\n    // Clear subscribers online when there is no connection.\n    if (!nextProps.connected && prevState.onlineSubs && prevState.onlineSubs.length > 0) {\n      nextState.onlineSubs = [];\n    }\n\n    return nextState;\n  }\n\n  subscribe(topic) {\n    if (topic.isSubscribed() || !this.props.ready) {\n      return;\n    }\n\n    // Is this a new topic?\n    const newTopic = (this.props.newTopicParams && this.props.newTopicParams._topicName == this.props.topic);\n\n    // Don't request the tags. They are useless unless the user\n    // is the owner and is editing the topic.\n    let getQuery = topic.startMetaQuery().withLaterDesc().withLaterSub();\n    if (this.state.isReader || newTopic) {\n      // Reading is either permitted or we don't know because it's a new topic. Ask for messages.\n      getQuery = getQuery.withLaterData(MESSAGES_PAGE);\n      if (this.state.isReader) {\n        getQuery = getQuery.withLaterDel();\n      }\n      // And show \"loading\" spinner.\n      this.setState({ fetchingMessages: true });\n    }\n\n    const setQuery = newTopic ? this.props.newTopicParams : undefined;\n    topic.subscribe(getQuery.build(), setQuery)\n      .then((ctrl) => {\n        if (ctrl.code == 303) {\n          // Redirect to another topic requested.\n          HashNavigation.navigateTo(HashNavigation.setUrlTopic('', ctrl.params.topic));\n          return;\n        }\n        if (this.state.topic != ctrl.topic) {\n          this.setState({topic: ctrl.topic});\n        }\n        this.props.onNewTopicCreated(this.props.topic, ctrl.topic);\n        // If there are unsent messages (except video call messages),\n        // try sending them now. Unsent video call messages will be dropped.\n        let calls = [];\n        topic.queuedMessages((pub) => {\n          if (pub._sending) {\n            return;\n          }\n          if (pub.head && pub.head.webrtc) {\n            // Filter out unsent video call messages.\n            calls.push(pub.seq);\n            return;\n          }\n          if (topic.isSubscribed()) {\n            this.retrySend(pub);\n          }\n        });\n        if (calls.length > 0) {\n          topic.delMessagesList(calls, true);\n        }\n      })\n      .catch((err) => {\n        console.error(\"Failed subscription to\", this.state.topic, err);\n        this.props.onError(err.message, 'err');\n        const blankState = MessagesView.getDerivedStateFromProps({}, {});\n        blankState.title = this.props.intl.formatMessage(messages.not_found);\n        this.setState(blankState);\n      });\n  }\n\n  leave(oldTopicName) {\n    if (!oldTopicName || !this.props.tinode.isTopicCached(oldTopicName)) {\n      return;\n    }\n\n    const oldTopic = this.props.tinode.getTopic(oldTopicName);\n    if (oldTopic && oldTopic.isSubscribed()) {\n      oldTopic.leave(false)\n        .catch(() => { /* do nothing here */ })\n        .finally(() => {\n          // We don't care if the request succeeded or failed.\n          // The topic is dead regardless.\n          this.setState({fetchingMessages: false});\n          oldTopic.onData = undefined;\n          oldTopic.onAllMessagesReceived = undefined;\n          oldTopic.onInfo = undefined;\n          oldTopic.onMetaDesc = undefined;\n          oldTopic.onSubsUpdated = undefined;\n          oldTopic.onPres = undefined;\n        });\n    }\n  }\n\n  // Don't use React.createRef as the ref.current is not available in componentDidMount in this component.\n  handleScrollReference(node) {\n    if (node) {\n      node.addEventListener('scroll', this.handleScrollEvent);\n      this.messagesScroller = node;\n      this.messagesScroller.scrollTop = this.messagesScroller.scrollHeight - this.state.scrollPosition;\n    }\n  }\n\n  // Get older messages and show/hide [go to latest message] button.\n  handleScrollEvent(event) {\n    const pos = event.target.scrollHeight - event.target.scrollTop - event.target.offsetHeight;\n    this.setState({\n      scrollPosition: pos,\n      // Show [go to latest message] if far enough from bottom and scrolling down.\n      showGoToLastButton: (pos > SHOW_GO_TO_LAST_DIST) && (pos < this.state.scrollPosition),\n    });\n\n    if (this.state.fetchingMessages) {\n      return;\n    }\n\n    if (event.target.scrollTop <= 0) {\n      const topic = this.props.tinode.getTopic(this.state.topic);\n      if (topic && topic.isSubscribed() && topic.msgHasMoreMessages()) {\n        this.setState({fetchingMessages: true}, () => {\n          topic.getMessagesPage(MESSAGES_PAGE)\n            .catch((err) => this.props.onError(err.message, 'err'))\n            .finally(() => this.setState({fetchingMessages: false}));\n          });\n      }\n    }\n  }\n\n  goToLatestMessage() {\n    this.setState({scrollPosition: 0});\n    if (this.messagesScroller) {\n      this.messagesScroller.scrollTop = this.messagesScroller.scrollHeight;\n    }\n  }\n\n  handleDescChange(desc) {\n    if (desc.public) {\n      this.setState({\n        title: desc.public.fn,\n        avatar: makeImageUrl(desc.public.photo)\n      });\n    } else {\n      this.setState({\n        title: '',\n        avatar: null\n      });\n    }\n\n    if (desc.acs) {\n      this.setState({\n        isWriter: desc.acs.isWriter(),\n        isReader: desc.acs.isReader(),\n        readingBlocked: !desc.acs.isReader('given'),\n        unconfirmed: isUnconfirmed(desc.acs),\n      });\n    }\n  }\n\n  postReadNotification(seq) {\n    // Ignore notifications if the app is invisible.\n    if (!this.props.applicationVisible) {\n      return;\n    }\n\n    // Set up the timer if it's not running already.\n    if (!this.readNotificationTimer) {\n      this.readNotificationTimer = setInterval(_ => {\n        if (this.readNotificationQueue.length == 0) {\n          // Shut down the timer if the queue is empty.\n          clearInterval(this.readNotificationTimer);\n          this.readNotificationTimer = null;\n          return;\n        }\n\n        let seq = -1;\n        while (this.readNotificationQueue.length > 0) {\n          const n = this.readNotificationQueue[0];\n          if (n.topicName != this.state.topic) {\n            // Topic has changed. Drop the notification.\n            this.readNotificationQueue.shift();\n            continue;\n          }\n\n          const now = new Date();\n          if (n.sendAt <= now) {\n            // Remove expired notification from queue.\n            this.readNotificationQueue.shift();\n            seq = Math.max(seq, n.seq);\n          } else {\n            break;\n          }\n        }\n\n        // Send only one notification for the whole batch of messages.\n        if (seq >= 0) {\n          const topic = this.props.tinode.getTopic(this.state.topic);\n          if (topic) {\n            topic.noteRead(seq);\n          }\n        }\n      }, NOTIFICATION_EXEC_INTERVAL);\n    }\n\n    const now = new Date();\n    this.readNotificationQueue.push({\n      topicName: this.state.topic,\n      seq: seq,\n      sendAt: now.setMilliseconds(now.getMilliseconds() + READ_DELAY)\n    });\n  }\n\n  // Clear notification queue and timer.\n  clearNotificationQueue() {\n    this.readNotificationQueue = [];\n    if (this.readNotificationTimer) {\n      clearInterval(this.readNotificationTimer);\n      this.readNotificationTimer = null;\n    }\n  }\n\n  handleSubsUpdated() {\n    if (this.state.topic) {\n      const subs = [];\n      const topic = this.props.tinode.getTopic(this.state.topic);\n      topic.subscribers((sub) => {\n        if (sub.online && sub.user != this.props.myUserId) {\n          subs.push(sub);\n        }\n      });\n      const newState = {onlineSubs: subs};\n      const peer = topic.p2pPeerDesc();\n      if (peer) {\n        Object.assign(newState, {\n          peerMessagingDisabled: isPeerRestricted(peer.acs)\n        });\n      } else if (this.state.peerMessagingDisabled) {\n        Object.assign(newState, {\n          peerMessagingDisabled: false\n        });\n      }\n      this.setState(newState);\n    }\n  }\n\n  // The 'msg' could be false-ish if some message ranges were deleted.\n  handleMessageUpdate(msg) {\n    const topic = this.props.tinode.getTopic(this.state.topic);\n    if (!msg) {\n      // msg could be null if one or more messages were deleted.\n      // Updating state to force redraw.\n      this.setState({latestClearId: topic.maxClearId()});\n      return;\n    }\n\n    clearTimeout(this.keyPressTimer)\n    this.setState({messageCount: topic.messageCount(), typingIndicator: false}, _ => {\n      // Scroll to the bottom if the message is added to the end of the message\n      // list if already at the bottom, otherwise show [go to latest] button.\n      // Implemented as a callback to be sure the scroll height has been updated.\n      if (topic.isNewMessage(msg.seq)) {\n        if (this.state.scrollPosition > SHOW_GO_TO_LAST_DIST) {\n          this.setState({showGoToLastButton: true});\n        } else {\n          this.goToLatestMessage();\n        }\n      }\n    });\n\n    // Aknowledge messages except own messages. They are\n    // automatically assumed to be read and recived.\n    const status = topic.msgStatus(msg, true);\n    if (status >= Tinode.MESSAGE_STATUS_SENT && msg.from != this.props.myUserId) {\n      this.postReadNotification(msg.seq);\n    }\n  }\n\n  handleAllMessagesReceived(count) {\n    this.setState({fetchingMessages: false});\n    if (count > 0) {\n      // 0 means \"latest\".\n      this.postReadNotification(0);\n    }\n  }\n\n  handleInfoReceipt(info) {\n    switch (info.what) {\n      case 'kp': {\n        clearTimeout(this.keyPressTimer);\n        this.keyPressTimer = setTimeout(() => {\n          this.setState({typingIndicator: false});\n        }, KEYPRESS_DELAY + 1000);\n        if (!this.state.typingIndicator) {\n          this.setState({typingIndicator: true});\n        }\n        break;\n      }\n      case 'read':\n      case 'recv':\n        // Redraw due to changed recv/read status.\n        this.forceUpdate();\n        break;\n      default:\n        console.info(\"Other change in topic: \", info.what);\n    }\n  }\n\n  handleImagePostview(content) {\n    this.setState({ imagePostview: content });\n  }\n\n  handleClosePreview() {\n    if (this.state.imagePreview && this.state.imagePreview.url) {\n      URL.revokeObjectURL(this.state.imagePreview.url);\n    }\n    this.setState({ imagePostview: null, imagePreview: null, docPreview: null });\n  }\n\n  handleFormResponse(action, text, data) {\n    if (action == 'pub') {\n      this.sendMessage(Drafty.attachJSON(Drafty.parse(text), data));\n    } else if (action == 'url') {\n      const url = new URL(data.ref);\n      const params = url.searchParams;\n      for (let key in data.resp) {\n        if (data.resp.hasOwnProperty(key)) {\n          params.set(key, data.resp[key]);\n        }\n      }\n      ['name', 'seq'].map((key) => {\n        if (data[key]) {\n          params.set(key, data[key]);\n        }\n      });\n      params.set('uid', this.props.myUserId);\n      params.set('topic', this.state.topic);\n      url.search = params;\n      window.open(url, '_blank');\n    } else {\n      console.info(\"Unknown action in form\", action);\n    }\n  }\n\n  handleContextClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.showContextMenu({ topicName: this.state.topic, y: e.pageY, x: e.pageX });\n  }\n\n  handleShowMessageContextMenu(params, messageSpecificMenuItems) {\n    if (params.userFrom == 'chan') {\n      params.userFrom = this.state.topic;\n      params.userName = this.state.title;\n    }\n    params.topicName = this.state.topic;\n    const menuItems = messageSpecificMenuItems || [];\n    const topic = this.props.tinode.getTopic(params.topicName);\n    if (topic) {\n      if (!topic.isChannelType()) {\n        menuItems.push('message_delete');\n      }\n      const acs = topic.getAccessMode();\n      if (acs && acs.isDeleter()) {\n        menuItems.push('message_delete_hard');\n      }\n    }\n    this.props.showContextMenu(params, menuItems);\n  }\n\n  handleNewChatAcceptance(action) {\n    this.props.onNewChat(this.state.topic, action);\n  }\n\n  handleEnablePeer(e) {\n    e.preventDefault();\n    this.props.onChangePermissions(this.state.topic, DEFAULT_P2P_ACCESS_MODE, this.state.topic);\n  }\n\n  sendKeyPress() {\n    const topic = this.props.tinode.getTopic(this.state.topic);\n    if (topic.isSubscribed()) {\n      topic.noteKeyPress();\n    }\n  }\n\n  // sendMessage sends the message with an optional subscription to topic first.\n  sendMessage(msg, uploadCompletionPromise, uploader) {\n    let head;\n    if (this.props.forwardMessage) {\n      // We are forwarding a message.\n      msg = this.props.forwardMessage.msg;\n      head = this.props.forwardMessage.head;\n      this.handleCancelReply();\n    } else if (this.state.reply && this.state.reply.content) {\n      // We are replying to a message in this topic.\n      head = {reply: '' + this.state.reply.seq};\n      // Turn it into Drafty so we can make a quoted Drafty object later.\n      if (typeof msg == 'string') {\n        msg = Drafty.parse(msg);\n      }\n      msg = Drafty.append(Drafty.sanitizeEntities(this.state.reply.content), msg);\n      this.handleCancelReply();\n    }\n    this.props.sendMessage(msg, uploadCompletionPromise, uploader, head);\n  }\n\n  // Retry sending a message.\n  retrySend(pub) {\n    this.props.sendMessage(pub.content, undefined, undefined, pub.head)\n      .then(() => {\n        // All good. Remove the original message draft from the cache.\n        const topic = this.props.tinode.getTopic(this.state.topic);\n        topic.delMessagesList([pub.seq], true);\n      });\n  }\n\n  // Send attachment as Drafty message:\n  // - if file is too large, upload it and send a s link.\n  // - if file is small enough, just send it in-band.\n  sendFileAttachment(file) {\n    // Server-provided limit reduced for base64 encoding and overhead.\n    const maxInbandAttachmentSize = (this.props.tinode.getServerParam('maxMessageSize',\n      MAX_INBAND_ATTACHMENT_SIZE) * 0.75 - 1024) | 0;\n\n    if (file.size > maxInbandAttachmentSize) {\n      // Too large to send inband - uploading out of band and sending as a link.\n      const uploader = this.props.tinode.getLargeFileHelper();\n      if (!uploader) {\n        this.props.onError(this.props.intl.formatMessage(messages.cannot_initiate_upload));\n        return;\n      }\n      const uploadCompletionPromise = uploader.upload(file);\n      const msg = Drafty.attachFile(null, {\n        mime: file.type,\n        filename: file.name,\n        size: file.size,\n        urlPromise: uploadCompletionPromise\n      });\n      // Pass data and the uploader to the TinodeWeb.\n      this.sendMessage(msg, uploadCompletionPromise, uploader);\n    } else {\n      // Small enough to send inband.\n      fileToBase64(file)\n        .then(b64 => this.sendMessage(Drafty.attachFile(null, {mime: b64.mime, data: b64.bits, filename: b64.name})))\n        .catch(err => this.props.onError(err));\n    }\n  }\n\n  // handleAttachFile method is called when [Attach file] button is clicked: launch attachment preview.\n  handleAttachFile(file) {\n    const maxExternAttachmentSize = this.props.tinode.getServerParam('maxFileUploadSize', MAX_EXTERN_ATTACHMENT_SIZE);\n\n    if (file.size > maxExternAttachmentSize) {\n      // Too large.\n      this.props.onError(this.props.intl.formatMessage(messages.file_attachment_too_large,\n        {size: bytesToHumanSize(file.size), limit: bytesToHumanSize(maxExternAttachmentSize)}), 'err');\n    } else {\n      this.setState({\n        docPreview: {\n          file: file,\n          name: file.name,\n          size: file.size,\n          type: file.type\n        }\n      });\n    }\n  }\n\n  handleCallHangup(topic, seq) {\n    this.props.onVideoCallClosed();\n    this.setState({\n      rtcPanel: null\n    });\n    this.props.onCallHangup(topic, seq);\n  }\n\n  // sendImageAttachment sends the image bits inband as Drafty message.\n  sendImageAttachment(caption, blob) {\n    const mime = this.state.imagePreview.mime;\n    const width = this.state.imagePreview.width;\n    const height = this.state.imagePreview.height;\n    const fname = this.state.imagePreview.name;\n\n    // Server-provided limit reduced for base64 encoding and overhead.\n    const maxInbandAttachmentSize = (this.props.tinode.getServerParam('maxMessageSize',\n      MAX_INBAND_ATTACHMENT_SIZE) * 0.75 - 1024) | 0;\n\n    if (blob.size > maxInbandAttachmentSize) {\n      // Too large to send inband - uploading out of band and sending as a link.\n      const uploader = this.props.tinode.getLargeFileHelper();\n      if (!uploader) {\n        this.props.onError(this.props.intl.formatMessage(messages.cannot_initiate_upload));\n        return;\n      }\n      const uploadCompletionPromise = uploader.upload(blob);\n\n      // Make small preview to show while uploading.\n      imageScaled(blob, IMAGE_PREVIEW_DIM, IMAGE_PREVIEW_DIM, -1, false)\n        // Convert tiny image into base64 for serialization and previewing.\n        .then(scaled => blobToBase64(scaled.blob))\n        .then(b64 => {\n            let msg = Drafty.insertImage(null, 0, {\n              mime: mime,\n              _tempPreview: b64.bits, // This preview will not be serialized.\n              width: width,\n              height: height,\n              filename: fname,\n              size: blob.size,\n              urlPromise: uploadCompletionPromise\n            });\n            if (caption) {\n              msg = Drafty.appendLineBreak(msg);\n              msg = Drafty.append(msg, Drafty.parse(caption));\n            }\n            // Pass data and the uploader to the TinodeWeb.\n            this.sendMessage(msg, uploadCompletionPromise, uploader);\n        }).catch((err) => {\n          this.props.onError(err, 'err');\n        });\n        return;\n    }\n\n    // Upload the image if it's too big to be send inband.\n    blobToBase64(blob)\n      .then(b64 => {\n        let msg = Drafty.insertImage(null, 0, {\n          mime: b64.mime,\n          preview: b64.bits, // Serializable preview\n          width: width,\n          height: height,\n          filename: fname,\n          size: blob.size\n        });\n        if (caption) {\n          msg = Drafty.appendLineBreak(msg);\n          msg = Drafty.append(msg, Drafty.parse(caption));\n        }\n        this.sendMessage(msg);\n      });\n  }\n\n  // handleAttachImage method is called when [Attach image] button is clicked: launch image preview.\n  handleAttachImage(file) {\n    const maxExternAttachmentSize = this.props.tinode.getServerParam('maxFileUploadSize', MAX_EXTERN_ATTACHMENT_SIZE);\n\n    // Get image dimensions and size, optionally scale it down.\n    imageScaled(file, MAX_IMAGE_DIM, MAX_IMAGE_DIM, maxExternAttachmentSize, false)\n      .then(scaled => {\n        this.setState({imagePreview: {\n          url: URL.createObjectURL(scaled.blob),\n          blob: scaled.blob,\n          name: scaled.name,\n          width: scaled.width,\n          height: scaled.height,\n          size: scaled.blob.size,\n          mime: scaled.mime\n        }});\n      }).catch(err => {\n        this.props.onError(err, 'err');\n      });\n  }\n\n  // sendAudioAttachment sends audio bits inband as Drafty message (no preview).\n  sendAudioAttachment(url, preview, duration) {\n    fetch(url)\n      .then(result => result.blob())\n      .then(blob => {\n        // Server-provided limit reduced for base64 encoding and overhead.\n        const maxInbandAttachmentSize = this.props.tinode.getServerParam('maxMessageSize', MAX_INBAND_ATTACHMENT_SIZE) * 0.75 - 1024;\n        if (blob.size > maxInbandAttachmentSize) {\n          // Too large to send inband - uploading out of band and sending as a link.\n          const uploader = this.props.tinode.getLargeFileHelper();\n          if (!uploader) {\n            this.props.onError(this.props.intl.formatMessage(messages.cannot_initiate_upload));\n            return;\n          }\n          const uploadCompletionPromise = uploader.upload(blob);\n          const msg = Drafty.appendAudio(null, {\n            mime: blob.type,\n            size: blob.size,\n            duration: duration,\n            preview: preview,\n            urlPromise: uploadCompletionPromise\n          });\n          // Pass data and the uploader to the TinodeWeb.\n          this.sendMessage(msg, uploadCompletionPromise, uploader);\n        } else {\n          // Small enough to send inband.\n          blobToBase64(blob)\n            .then(b64 => {\n              this.sendMessage(Drafty.appendAudio(null, {\n                mime: b64.mime,\n                size: blob.size,\n                data: b64.bits,\n                duration: duration,\n                preview: preview,\n              }))\n            })\n        }\n      })\n      .catch(err => {this.props.onError(err)});;\n  }\n\n  handleCancelUpload(seq, uploader) {\n    const topic = this.props.tinode.getTopic(this.state.topic);\n    const found = topic.findMessage(seq);\n    if (found) {\n      found._cancelled = true;\n    }\n    uploader.cancel();\n  }\n\n  // seq: seq ID of the source message\n  // context: message content.\n  // senderId: UID of the sender of the source message.\n  // senderName: full name of the sender of the original message.\n  handlePickReply(seq, content, senderId, senderName) {\n    this.setState({reply: null});\n\n    if (!seq || !content) {\n      return;\n    }\n\n    content = typeof content == 'string' ? Drafty.init(content) : content;\n    if (Drafty.isValid(content)) {\n      content = Drafty.replyContent(content, QUOTED_REPLY_LENGTH);\n    } else {\n      // /!\\ invalid content.\n      content = Drafty.append(Drafty.init('\\u26A0 '),\n        Drafty.wrapInto(this.props.intl.formatMessage(messages.invalid_content), 'EM'));\n    }\n\n    this.setState({\n      reply: {\n        content: Drafty.quote(senderName, senderId, content),\n        seq: seq\n      }\n    });\n    this.props.onCancelForwardMessage();\n  }\n\n  handleCancelReply() {\n    this.setState({reply: null});\n    this.props.onCancelForwardMessage();\n  }\n\n  handleQuoteClick(replyToSeq) {\n    const ref = this.getOrCreateMessageRef(replyToSeq);\n    if (ref && ref.current) {\n      ref.current.scrollIntoView({block: \"center\", behavior: \"smooth\"});\n      ref.current.classList.add('flash');\n      setTimeout(() => { ref.current.classList.remove('flash') } , 1000);\n    } else {\n      console.error(\"Unresolved message ref\", replyToSeq);\n    }\n  }\n\n  render() {\n    const {formatMessage} = this.props.intl;\n\n    let component;\n    if (this.props.hideSelf) {\n      component = null;\n    } else if (!this.state.topic) {\n      component = (\n        <LogoView\n          serverVersion={this.props.serverVersion}\n          serverAddress={this.props.serverAddress} />\n      );\n    } else {\n      let component2;\n      if (this.state.imagePreview) {\n        // Preview image before sending.\n        component2 = (\n          <ImagePreview\n            content={this.state.imagePreview}\n            tinode={this.props.tinode}\n            reply={this.state.reply}\n            onCancelReply={this.handleCancelReply}\n            onClose={this.handleClosePreview}\n            onSendMessage={this.sendImageAttachment} />\n        );\n      } else if (this.state.imagePostview) {\n        // Expand received image.\n        component2 = (\n          <ImagePreview\n            content={this.state.imagePostview}\n            onClose={this.handleClosePreview} />\n        );\n      } else if (this.state.docPreview) {\n        // Preview attachment before sending.\n        component2 = (\n          <DocPreview\n            content={this.state.docPreview}\n            tinode={this.props.tinode}\n            reply={this.state.reply}\n            onCancelReply={this.handleCancelReply}\n            onClose={this.handleClosePreview}\n            onSendMessage={this.sendFileAttachment} />\n        );\n      } else if (this.state.rtcPanel) {\n        component2 = (\n          <CallPanel\n            topic={this.state.topic}\n            seq={this.props.callSeq}\n            callState={this.props.callState}\n            tinode={this.props.tinode}\n            title={this.state.title}\n            avatar={this.state.avatar || true}\n\n            onError={this.props.onError}\n            onHangup={this.handleCallHangup}\n            onInvite={this.props.onCallInvite}\n            onSendOffer={this.props.onCallSendOffer}\n            onIceCandidate={this.props.onCallIceCandidate}\n            onSendAnswer={this.props.onCallSendAnswer} />\n        );\n      } else {\n        const topic = this.props.tinode.getTopic(this.state.topic);\n        const isChannel = topic.isChannelType();\n        const groupTopic = topic.isGroupType() && !isChannel;\n        const icon_badges = [];\n        if (topic.trusted) {\n          if (topic.trusted.verified) {\n            icon_badges.push({icon: 'verified', color: 'badge-inv'});\n          }\n          if (topic.trusted.staff) {\n            icon_badges.push({icon: 'staff', color: 'badge-inv'});\n          }\n          if (topic.trusted.danger) {\n            icon_badges.push({icon: 'dangerous', color: 'badge-inv'});\n          }\n        }\n\n        const messageNodes = [];\n        let previousFrom = null;\n        let prevDate = null;\n        let chatBoxClass = null;\n        const dateFmt = new Intl.DateTimeFormat(this.props.intl.locale);\n        topic.messages((msg, prev, next, i) => {\n          let nextFrom = next ? (next.from || 'chan') : null;\n\n          let sequence = 'single';\n          let thisFrom = msg.from || 'chan';\n          if (thisFrom == previousFrom) {\n            if (thisFrom == nextFrom) {\n              sequence = 'middle';\n            } else {\n              sequence = 'last';\n            }\n          } else if (thisFrom == nextFrom) {\n            sequence = 'first';\n          }\n          previousFrom = thisFrom;\n\n          const isReply = !(thisFrom == this.props.myUserId);\n          const deliveryStatus = topic.msgStatus(msg, true);\n\n          let userFrom = thisFrom, userName, userAvatar;\n          const user = topic.userDesc(thisFrom);\n          if (user && user.public) {\n            userName = user.public.fn;\n            userAvatar = makeImageUrl(user.public.photo);\n          }\n          chatBoxClass = groupTopic ? 'chat-box group' : 'chat-box';\n\n          // Ref for this chat message.\n          const ref = this.getOrCreateMessageRef(msg.seq);\n          let replyToSeq = msg.head ? parseInt(msg.head.reply) : null;\n          if (!replyToSeq || isNaN(replyToSeq)) {\n            replyToSeq = null;\n          }\n\n          if (msg.hi) {\n            // Deleted message.\n            messageNodes.push(\n              <MetaMessage\n                deleted={true}\n                key={msg.seq} />\n              );\n          } else {\n            const thisDate = new Date(msg.ts);\n            // This message was sent on a different date than the previous.\n            if (!prevDate || prevDate.toDateString() != thisDate.toDateString()) {\n              messageNodes.push(\n                <MetaMessage\n                  date={dateFmt.format(msg.ts)}\n                  locale={this.props.intl.locale}\n                  key={'date-' + msg.seq} />\n              );\n              prevDate = thisDate;\n            }\n            messageNodes.push(\n              <ChatMessage\n                tinode={this.props.tinode}\n                content={msg.content}\n                mimeType={msg.head && msg.head.mime}\n                timestamp={msg.ts}\n                response={isReply}\n                seq={msg.seq}\n                isGroup={groupTopic}\n                isChan={this.state.channel}\n                userFrom={userFrom}\n                userName={userName}\n                userAvatar={userAvatar}\n                sequence={sequence}\n                received={deliveryStatus}\n                uploader={msg._uploader}\n                viewportWidth={this.props.viewportWidth}  // Used by `formatter`.\n                showContextMenu={this.handleShowMessageContextMenu}\n                onImagePreview={this.handleImagePostview}\n                onFormResponse={this.handleFormResponse}\n                onError={this.props.onError}\n                onCancelUpload={this.handleCancelUpload}\n                pickReply={this.handlePickReply}\n                replyToSeq={replyToSeq}\n                onQuoteClick={this.handleQuoteClick}\n                ref={ref}\n                userIsWriter={this.state.isWriter}\n                key={msg.seq} />\n            );\n          }\n        });\n\n        let lastSeen = null;\n        if (isChannel) {\n          lastSeen = formatMessage(messages.channel);\n        } else {\n          const cont = this.props.tinode.getMeTopic().getContact(this.state.topic);\n          if (cont && Tinode.isP2PTopicName(cont.topic)) {\n            if (cont.online) {\n              lastSeen = formatMessage(messages.online_now);\n            } else if (cont.seen) {\n              lastSeen = formatMessage(messages.last_seen) + \": \" +\n                shortDateFormat(cont.seen.when, this.props.intl.locale);\n              // TODO: also handle user agent in c.seen.ua\n            }\n          }\n        }\n        const avatar = this.state.avatar || true;\n        const online = this.state.deleted ? null :\n          this.props.online ? 'online' + (this.state.typingIndicator ? ' typing' : '') : 'offline';\n\n        const titleClass = 'panel-title' + (this.state.deleted ? ' deleted' : '');\n\n        component2 = (\n          <>\n            <div id=\"topic-caption-panel\" className=\"caption-panel\">\n              {this.props.displayMobile ?\n                <a href=\"#\" id=\"hide-message-view\" onClick={(e) => {e.preventDefault(); this.props.onHideMessagesView();}}>\n                  <i className=\"material-icons\">arrow_back</i>\n                </a>\n                :\n                null}\n              <div className=\"avatar-box\">\n                <LetterTile\n                  tinode={this.props.tinode}\n                  avatar={avatar}\n                  topic={this.state.topic}\n                  title={this.state.title}\n                  deleted={this.state.deleted} />\n                {!isChannel ? <span className={online} /> : null}\n              </div>\n              <div id=\"topic-title-group\">\n                <div id=\"topic-title\" className={titleClass}>{\n                  this.state.title ||\n                  <i><FormattedMessage id=\"unnamed_topic\" defaultMessage=\"Unnamed\"\n                    description=\"Title shown when the topic has no name\" /></i>\n                }<ContactBadges badges={icon_badges} /></div>\n                <div id=\"topic-last-seen\">{lastSeen}</div>\n              </div>\n              {groupTopic ?\n                <GroupSubs\n                  tinode={this.props.tinode}\n                  subscribers={this.state.onlineSubs} /> :\n                <div id=\"topic-users\" />\n              }\n              <div>\n                <a href=\"#\" onClick={this.handleContextClick}>\n                  <i className=\"material-icons\">more_vert</i>\n                </a>\n              </div>\n            </div>\n            {this.props.displayMobile ?\n              <ErrorPanel\n                level={this.props.errorLevel}\n                text={this.props.errorText}\n                onClearError={this.props.onError} />\n              : null}\n            <LoadSpinner show={this.state.fetchingMessages} />\n            <div id=\"messages-container\">\n              <button className={'action-button' + (this.state.showGoToLastButton ? '' : ' hidden')}\n                onClick={this.goToLatestMessage}>\n                <i className=\"material-icons\">arrow_downward</i>\n              </button>\n              <div id=\"messages-panel\" ref={this.handleScrollReference}>\n                <ul id=\"scroller\" className={chatBoxClass}>\n                  {messageNodes}\n                </ul>\n              </div>\n              {!this.state.isReader ?\n              <div id=\"write-only-background\">\n                {this.state.readingBlocked ?\n                <div id=\"write-only-note\">\n                  <FormattedMessage id=\"messages_not_readable\" defaultMessage=\"no access to messages\"\n                    description=\"Message shown in topic without the read access\" />\n                </div>\n                : null }\n              </div>\n              : null }\n            </div>\n            {this.state.peerMessagingDisabled && !this.state.unconfirmed ?\n              <div id=\"peer-messaging-disabled-note\">\n                <i className=\"material-icons secondary\">block</i> <FormattedMessage\n                  id=\"peers_messaging_disabled\" defaultMessage=\"Peer's messaging is disabled.\"\n                  description=\"Shown when the p2p peer's messaging is disabled\" /> <a href=\"#\"\n                    onClick={this.handleEnablePeer}><FormattedMessage id=\"enable_peers_messaging\"\n                    defaultMessage=\"Enable\" description=\"Call to action to enable peer's messaging\" /></a>.\n              </div> : null}\n            {this.state.unconfirmed ?\n              <Invitation onAction={this.handleNewChatAcceptance} />\n              :\n              <SendMessage\n                tinode={this.props.tinode}\n                topicName={this.state.topic}\n                noInput={!!this.props.forwardMessage}\n                disabled={!this.state.isWriter || this.state.deleted}\n                onKeyPress={this.sendKeyPress}\n                onSendMessage={this.sendMessage}\n                onAttachFile={this.props.forwardMessage ? null : this.handleAttachFile}\n                onAttachImage={this.props.forwardMessage ? null : this.handleAttachImage}\n                onAttachAudio={this.props.forwardMessage ? null : this.sendAudioAttachment}\n                onError={this.props.onError}\n                reply={this.state.reply}\n                onQuoteClick={this.handleQuoteClick}\n                onCancelReply={this.handleCancelReply} />}\n          </>\n        );\n      }\n      component = <div id=\"topic-view\">{component2}</div>\n    }\n    return component;\n  }\n};\n\nexport default injectIntl(MessagesView);\n","// The <- button to be displayed in title bars.\nimport React from 'react';\n\nexport default class ButtonBack extends React.PureComponent {\n  render() {\n    return (\n      <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onBack();}}>\n        <i className=\"material-icons\">arrow_back</i>\n      </a>\n    );\n  }\n}\n","import React from 'react';\n\nexport default class MenuContacts extends React.PureComponent {\n  render() {\n    return (\n      <div>\n        <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onNewTopic();}}><i className=\"material-icons\">chat</i></a>\n        &nbsp;\n        <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onSettings();}}><i className=\"material-icons\">settings</i></a>\n      </div>\n    );\n  }\n};\n","import React from 'react';\n\nexport default class MenuStart extends React.PureComponent {\n  render() {\n    return (\n        <div>\n          <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onSignUp();}}><i className=\"material-icons\">person_add</i></a>\n          &nbsp;\n          <a href=\"#\" onClick={(e) => {e.preventDefault(); this.props.onSettings();}}><i className=\"material-icons\">settings</i></a>\n        </div>\n    );\n  }\n};\n","import React from 'react';\n\nimport LetterTile from './letter-tile.jsx';\nimport ButtonBack from './button-back.jsx';\nimport ContactBadges from './contact-badges.jsx';\nimport MenuContacts from './menu-contacts.jsx';\nimport MenuStart from './menu-start.jsx';\n\nimport { sanitizeUrlForMime } from '../lib/utils.js';\n\nexport default class SideNavbar extends React.PureComponent {\n  render() {\n    const icon_badges = [];\n    if (this.props.trustedBadges) {\n      this.props.trustedBadges.map((b) => {\n        icon_badges.push({icon: b, color: 'badge-inv'});\n      });\n    }\n    let avatar = null;\n    if (this.props.tinode) {\n      avatar = this.props.tinode.authorizeURL(sanitizeUrlForMime(this.props.avatar, 'image'));\n    }\n    return (\n      <div id=\"side-caption-panel\" className=\"caption-panel\">\n        {this.props.onCancel ? <ButtonBack onBack={this.props.onCancel} /> : null}\n        {avatar ?\n          <div id=\"self-avatar\" className=\"avatar-box\">\n            <LetterTile\n              tinode={this.props.tinode}\n              avatar={avatar}\n              topic={this.props.myUserId}\n              title={this.props.title} />\n          </div>\n          :\n          null}\n        <div id=\"sidepanel-title\" className=\"panel-title\">{this.props.title}<ContactBadges badges={icon_badges}/></div>\n        {this.props.state === 'login' ?\n            <MenuStart onSignUp={this.props.onSignUp} onSettings={this.props.onSettings} /> :\n          this.props.state === 'contacts' ?\n            <MenuContacts onNewTopic={this.props.onNewTopic} onSettings={this.props.onSettings} /> :\n          null}\n      </div>\n    );\n  }\n};\n","// Edit account parameters.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport AvatarUpload from '../widgets/avatar-upload.jsx';\nimport BadgeList from '../widgets/badge-list.jsx';\n\nimport { makeImageUrl } from '../lib/blob-helpers.js';\nimport { MAX_TITLE_LENGTH, MAX_TOPIC_DESCRIPTION_LENGTH } from '../config.js';\n\nfunction _clip(str, length) {\n  return str && str.substring(0, length);\n}\n\nexport default class AccountSettingsView extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const me = this.props.tinode.getMeTopic();\n    this.state = {\n      fullName: _clip(me.public ? me.public.fn : undefined, MAX_TITLE_LENGTH),\n      description: _clip(me.public ? me.public.note : undefined, MAX_TOPIC_DESCRIPTION_LENGTH),\n      avatar: makeImageUrl(me.public ? me.public.photo : null)\n    };\n  }\n\n  render() {\n    return (\n      <div className=\"scrollable-panel\">\n        <div className=\"panel-form-column\">\n          <a href=\"#\" className=\"flat-button float-right\" onClick={(e) => {e.preventDefault(); this.props.onNavigate('general');}}>\n            <i className=\"material-icons\">edit</i>&nbsp;\n            <FormattedMessage id=\"button_edit\" defaultMessage=\"Edit\" description=\"Call to action [Edit]\" />\n          </a>\n          <center>\n            <AvatarUpload\n              tinode={this.props.tinode}\n              avatar={this.state.avatar}\n              readOnly={true}\n              uid={this.props.myUserId}\n              title={this.state.fullName} />\n          </center>\n          <div className=\"group\">\n            <label className=\"small\">\n              <FormattedMessage id=\"label_your_name\" defaultMessage=\"Your name\"\n                description=\"Label for full name editing\" />\n            </label>\n            <div className=\"large ellipsized\">{this.state.fullName}</div>\n          </div>\n          <div className=\"group\">\n            <label className=\"small\"><FormattedMessage id=\"label_user_id\" defaultMessage=\"ID:\"\n              description=\"Label for user address (ID)\" /></label>&nbsp;\n            <tt>{this.props.myUserId}</tt>\n          </div>\n          <div className=\"group\">\n            <BadgeList trustedBadges={this.props.trustedBadges} />\n          </div>\n          {this.state.description ?\n            <div className=\"group\">\n              <label className=\"small\">\n                <FormattedMessage id=\"label_description\" defaultMessage=\"Description\"\n                  description=\"Label for editing topic description\" />\n              </label>\n              <div>{this.state.description}</div>\n            </div> : null}\n        </div>\n        <div className=\"hr\" />\n        <div className=\"panel-form-column\">\n          <a href=\"#\" className=\"flat-button\" onClick={(e) => {e.preventDefault(); this.props.onNavigate('notif');}}>\n            <i className=\"material-icons\">notifications</i>&nbsp;<FormattedMessage id=\"sidepanel_title_acc_notifications\"\n              defaultMessage=\"Notifications\" description=\"Sidepanel title for AccNotificationsView.\" />\n          </a>\n          <a href=\"#\" className=\"flat-button\" onClick={(e) => {e.preventDefault(); this.props.onNavigate('security');}}>\n            <i className=\"material-icons\">security</i>&nbsp;<FormattedMessage id=\"button_security\"\n              defaultMessage=\"Security\" description=\"Navigaton button for security panel.\" />\n          </a>\n          <a href=\"#\" className=\"flat-button\" onClick={(e) => {e.preventDefault(); this.props.onNavigate('support');}}>\n            <i className=\"material-icons\">contact_support</i>&nbsp;<FormattedMessage id=\"sidepanel_title_acc_support\"\n              defaultMessage=\"Support\" description=\"Sidepanel title for AccSupportView.\" />\n          </a>\n        </div>\n      </div>\n    );\n  }\n};\n","/* ContactsView holds all contacts-related stuff */\nimport React from 'react';\nimport { FormattedMessage, defineMessages } from 'react-intl';\n\nimport ContactList from '../widgets/contact-list.jsx';\n\nimport { updateFavicon } from '../lib/utils.js';\n\nconst messages = defineMessages({\n  archived_contacts_title: {\n    id: \"archived_contacts\",\n    defaultMessage: \"Archived contacts ({count})\",\n    description: \"Label for archived chats\"\n  }\n});\n\nexport default class ContactsView extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleAction = this.handleAction.bind(this);\n\n    this.state = ContactsView.deriveStateFromProps(props);\n  }\n\n  static deriveStateFromProps(props) {\n    const contacts = [];\n    let unreadThreads = 0;\n    let archivedCount = 0;\n    props.chatList.map((c) => {\n      const blocked = c.acs && !c.acs.isJoiner();\n      // Show only blocked contacts only when props.blocked == true.\n      if (blocked && props.blocked) {\n        contacts.push(c);\n      }\n      if (blocked || props.blocked) {\n        return;\n      }\n\n      if (c.private && c.private.arch) {\n        if (props.archive) {\n          contacts.push(c);\n        } else {\n          archivedCount ++;\n        }\n      } else if (!props.archive) {\n        contacts.push(c);\n        unreadThreads += c.unread > 0 ? 1 : 0;\n      }\n    });\n\n    contacts.sort((a, b) => {\n      return (b.touched || 0) - (a.touched || 0);\n    });\n\n    if (archivedCount > 0) {\n      contacts.push({\n        action: 'archive',\n        title: messages.archived_contacts_title,\n        values: {count: archivedCount}\n      });\n    }\n\n    return {\n      contactList: contacts,\n      unreadThreads: unreadThreads\n    };\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.chatList != this.props.chatList ||\n        prevProps.archive != this.props.archive ||\n        prevProps.blocked != this.props.blocked) {\n      const newState = ContactsView.deriveStateFromProps(this.props);\n      this.setState(newState);\n      if (newState.unreadThreads != prevState.unreadThreads) {\n        updateFavicon(newState.unreadThreads);\n      }\n    }\n  }\n\n  handleAction(action_ignored) {\n    this.props.onShowArchive();\n  }\n\n  render() {\n    return (\n      <FormattedMessage id=\"contacts_not_found\"\n        defaultMessage=\"You have no chats<br />¯∖_(ツ)_/¯\"\n        description=\"HTML message shown in ContactList when no contacts are found\">{\n        (no_contacts) => <ContactList\n          tinode={this.props.tinode}\n          connected={this.props.connected}\n          contacts={this.state.contactList}\n          emptyListMessage={no_contacts}\n          topicSelected={this.props.topicSelected}\n          myUserId={this.props.myUserId}\n          showOnline={true}\n          showUnread={true}\n          onTopicSelected={this.props.onTopicSelected}\n          showContextMenu={this.props.showContextMenu}\n          onAction={this.handleAction} />\n      }</FormattedMessage>\n    );\n  }\n};\n","// Helper functions for storing values in localStorage.\n// By default localStorage can store only strings, not objects or other types.\n\nexport default class LocalStorageUtil {\n  // Replace old object with the new one.\n  static setObject(key, value) {\n    localStorage.setItem(key, JSON.stringify(value));\n  }\n\n  // Get stored object.\n  static getObject(key) {\n    const value = localStorage.getItem(key);\n    return value && JSON.parse(value);\n  }\n\n  // Partially or wholly update stored object.\n  static updateObject(key, value) {\n    const oldVal = this.getObject(key);\n    this.setObject(key, Object.assign(oldVal || {}, value));\n  }\n\n  // Just a wrapper.\n  static removeItem(key) {\n    localStorage.removeItem(key);\n  }\n}\n","// Account registration.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport AvatarCrop from '../widgets/avatar-crop.jsx';\nimport AvatarUpload from '../widgets/avatar-upload.jsx';\nimport CheckBox from '../widgets/checkbox.jsx';\nimport VisiblePassword from '../widgets/visible-password.jsx';\n\nimport LocalStorageUtil from '../lib/local-storage.js';\nimport { imageScaled, blobToBase64, makeImageUrl } from '../lib/blob-helpers.js';\nimport { theCard } from '../lib/utils.js';\n\nimport { AVATAR_SIZE, MAX_AVATAR_BYTES, MAX_EXTERN_ATTACHMENT_SIZE,\n  MAX_TITLE_LENGTH } from '../config.js';\n\nexport default class CreateAccountView extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      login: '',\n      password: '',\n      email: '',\n      fn: '', // full/formatted name\n      imageUrl: null,\n      uploadUrl: null,\n      newAvatar: null,\n      newAvatarMime: null,\n      errorCleared: false,\n      buttonDisabled: false,\n      saveToken: LocalStorageUtil.getObject('keep-logged-in')\n    };\n\n    this.handleLoginChange = this.handleLoginChange.bind(this);\n    this.handlePasswordChange = this.handlePasswordChange.bind(this);\n    this.handleEmailChange = this.handleEmailChange.bind(this);\n    this.handleFnChange = this.handleFnChange.bind(this);\n    this.handleImageChanged = this.handleImageChanged.bind(this);\n    this.handleToggleSaveToken = this.handleToggleSaveToken.bind(this);\n    this.handleAvatarCropped = this.handleAvatarCropped.bind(this);\n    this.handleAvatarCropCancel = this.handleAvatarCropCancel.bind(this);\n    this.uploadAvatar = this.uploadAvatar.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleLoginChange(e) {\n    this.setState({login: e.target.value});\n  }\n\n  handlePasswordChange(password) {\n    this.setState({password: password});\n  }\n\n  handleEmailChange(e) {\n    this.setState({email: e.target.value})\n  }\n\n  handleFnChange(e) {\n    this.setState({fn: e.target.value});\n  }\n\n  handleImageChanged(mime, img) {\n    this.setState({newAvatar: img, newAvatarMime: mime});\n  }\n\n  handleToggleSaveToken() {\n    LocalStorageUtil.setObject('keep-logged-in', !this.state.saveToken);\n    this.setState({saveToken: !this.state.saveToken});\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    this.setState({errorCleared: false});\n    this.props.onCreateAccount(\n      this.state.login.trim(),\n      this.state.password.trim(),\n      theCard(this.state.fn.trim().substring(0, MAX_TITLE_LENGTH), this.state.uploadUrl),\n      {'meth': 'email', 'val': this.state.email});\n  }\n\n  // AvatarCropView calls this method when the user has cropped the image.\n  handleAvatarCropped(mime, blob, width, height) {\n    const url = blob ? URL.createObjectURL(blob) : null;\n    this.setState({avatar: url, newAvatar: null, newAvatarMime: null});\n    if (blob) {\n      this.uploadAvatar(mime, blob, width, height);\n    }\n  }\n\n  handleAvatarCropCancel() {\n    this.setState({newAvatar: null, newAvatarMime: null});\n  }\n\n    // Utility method for converting cropped avatar blob to bytes for sending inband or\n  // for uploading it to the server out of band.\n  uploadAvatar(mime, blob, width, height) {\n    const readyToUpload = image => {\n      let {mime, blob} = image;\n      this.setState({imageUrl: URL.createObjectURL(blob), buttonDisabled: true});\n      if (blob.size > MAX_AVATAR_BYTES) {\n        // Too large to send inband - uploading out of band and sending as a link.\n        const uploader = this.props.tinode.getLargeFileHelper();\n        uploader.upload(blob, 'newacc')\n          .then(url => this.setState({uploadUrl: url}))\n          .catch(err => this.props.onError(err.message, 'err'))\n          .finally(_ => this.setState({buttonDisabled: false}));\n      } else {\n        // Convert blob to base64-encoded bits.\n        blobToBase64(blob)\n          .then(b64 => this.setState({uploadUrl: makeImageUrl({data: b64.bits, type: mime})}))\n          .finally(_ => this.setState({buttonDisabled: false}));\n      }\n    };\n\n    if (width > AVATAR_SIZE || height > AVATAR_SIZE || width != height) {\n      // Avatar is not square or too large even after cropping. Shrink it and make square.\n      imageScaled(blob, AVATAR_SIZE, AVATAR_SIZE, MAX_EXTERN_ATTACHMENT_SIZE, true)\n        .then(scaled => readyToUpload(scaled))\n        .catch(err => this.props.onError(err.message, 'err'));\n    } else {\n      readyToUpload({mime: mime, blob: blob, width: width, height: height});\n    }\n  }\n\n  render() {\n    if (this.state.newAvatar) {\n      return (\n        <AvatarCrop\n          avatar={this.state.newAvatar}\n          mime={this.state.newAvatarMime}\n          onSubmit={this.handleAvatarCropped}\n          onCancel={this.handleAvatarCropCancel}\n          onError={this.props.onError} />\n      );\n    }\n\n    let submitClasses = 'primary';\n    if (this.props.disabled) {\n      submitClasses += ' disabled';\n    }\n\n    return (\n      <form className=\"panel-form-column\" onSubmit={this.handleSubmit}>\n        <div className=\"panel-form-row\">\n          <div className=\"panel-form-column\">\n            <FormattedMessage id=\"login_prompt\" defaultMessage=\"Login\"\n              description=\"Placeholer for username/login\">{\n              (login_prompt) => <input type=\"text\" placeholder={login_prompt} autoComplete=\"user-name\"\n                value={this.state.login} onChange={this.handleLoginChange} required autoFocus />\n            }</FormattedMessage>\n            <FormattedMessage id=\"password_prompt\" defaultMessage=\"Password\"\n              description=\"Placeholder/prompt for entering password\">{\n              (password_prompt) => <VisiblePassword placeholder={password_prompt} autoComplete=\"new-password\"\n                value={this.state.password} onFinished={this.handlePasswordChange}\n                required={true} />\n            }</FormattedMessage>\n          </div>\n          <AvatarUpload\n            tinode={this.props.tinode}\n            avatar={this.state.imageUrl}\n            onImageUpdated={this.handleImageChanged}\n            onError={this.props.onError} />\n        </div>\n        <div  className=\"panel-form-row\">\n          <FormattedMessage id=\"full_name_prompt\" defaultMessage=\"Full name, e.g. John Doe\"\n            description=\"Input placeholder for person's full name\">{\n            (full_name_prompt) => <input type=\"text\" placeholder={full_name_prompt} autoComplete=\"name\"\n              value={this.state.fn} onChange={this.handleFnChange} required/>\n          }</FormattedMessage>\n        </div>\n        <div className=\"panel-form-row\">\n          <FormattedMessage id=\"email_prompt\" defaultMessage=\"Email, e.g. jdoe@example.com\"\n            description=\"Input placeholder for email entry\">{\n            (email_prompt) => <input type=\"email\" placeholder={email_prompt} autoComplete=\"email\"\n              value={this.state.email} onChange={this.handleEmailChange} required/>\n          }</FormattedMessage>\n        </div>\n        <div className=\"panel-form-row\">\n          <CheckBox id=\"save-token\" name=\"save-token\" checked={this.state.saveToken}\n            onChange={this.handleToggleSaveToken} />\n          <FormattedMessage id=\"stay_logged_in\" defaultMessage=\"Stay logged in\"\n            description=\"Label for a checkbox\">{\n            (stay_logged_in) => <label htmlFor=\"save-token\">&nbsp;{stay_logged_in}</label>\n          }</FormattedMessage>\n        </div>\n        <div className=\"dialog-buttons\">\n          <button className={submitClasses} type=\"submit\" disabled={this.state.buttonDisabled}>\n            <FormattedMessage id=\"button_sign_up\" defaultMessage=\"Sign up\"\n              description=\"Create account button [Sign Up]\" />\n          </button>\n        </div>\n      </form>\n    );\n  }\n};\n","// Edit account parameters.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport CheckBox from '../widgets/checkbox.jsx';\n\nexport default class EditAccountView extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.handleCheckboxClick = this.handleCheckboxClick.bind(this);\n  }\n\n  handleCheckboxClick(what, checked) {\n    if (what == 'sound') {\n      this.props.onToggleMessageSounds(checked);\n    } else if (what == 'alert') {\n      this.props.onTogglePushNotifications(checked);\n    } else if (what == 'incognito') {\n      this.props.onToggleIncognitoMode(checked);\n    }\n  }\n\n  render() {\n    return (\n        <div className=\"scrollable-panel\">\n          <div className=\"panel-form-row\">\n            <label htmlFor=\"message-sound\">\n              <FormattedMessage id=\"label_message_sound\" defaultMessage=\"Message sound:\"\n                description=\"Label for message sounds toggle\" />\n            </label>\n            <CheckBox name=\"sound\" id=\"message-sound\"\n              checked={this.props.messageSounds} onChange={this.handleCheckboxClick} />\n          </div>\n          <div className=\"panel-form-row\">\n            <label htmlFor=\"desktop-alerts\">\n            {this.props.desktopAlertsEnabled ?\n              <FormattedMessage id=\"label_push_notifications\" defaultMessage=\"Notification alerts:\"\n                description=\"Label for push notifications switch\" />\n              :\n              <FormattedMessage id=\"label_push_notifications_disabled\"\n                defaultMessage=\"Notification alerts (requires HTTPS):\"\n                description=\"Label for push notifications switch\" />\n            }\n            </label>\n            <CheckBox name=\"alert\" id=\"desktop-alerts\"\n              checked={this.props.desktopAlerts}\n              onChange={this.props.desktopAlertsEnabled ? this.handleCheckboxClick : null} />\n          </div>\n          <div className=\"panel-form-row\">\n            <label htmlFor=\"incognito-mode\">\n              <FormattedMessage id=\"label_incognito_mode\" defaultMessage=\"Incognito mode:\"\n                description=\"Label for incognito mode toggle\" />\n            </label>\n            <CheckBox name=\"incognito\" id=\"incognito-mode\"\n              checked={this.props.incognitoMode} onChange={this.handleCheckboxClick} />\n          </div>\n        </div>\n    );\n  }\n};\n","// Edit account parameters.\nimport React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nimport InPlaceEdit from '../widgets/in-place-edit.jsx';\nimport PermissionsEditor from '../widgets/permissions-editor.jsx';\n\nconst messages = defineMessages({\n  delete_account: {\n    id: 'delete_account',\n    defaultMessage: 'Delete account',\n    description: 'Title for delete account warning'\n  },\n  delete_account_warning: {\n    id: 'delete_account_warning',\n    defaultMessage: 'Are you sure you want to delete your account? It cannot be undone.',\n    description: 'Warning message when deleting an account'\n  }\n});\n\nclass AccSecurityView extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const me = this.props.tinode.getMeTopic();\n    let blockedCount = 0;\n    me.contacts((c) => {\n      if (c.acs && !c.acs.isJoiner()) {\n        blockedCount ++;\n      }\n    });\n    const defacs = me.getDefaultAccess();\n    this.state = {\n      auth: defacs ? defacs.auth : null,\n      anon: defacs ? defacs.anon : null,\n      showPermissionEditorFor: undefined,\n      blockedCount: blockedCount,\n    };\n\n    this.handlePasswordUpdate = this.handlePasswordUpdate.bind(this);\n    this.handleLaunchPermissionsEditor = this.handleLaunchPermissionsEditor.bind(this);\n    this.handleHidePermissionsEditor = this.handleHidePermissionsEditor.bind(this);\n    this.handlePermissionsChanged = this.handlePermissionsChanged.bind(this);\n    this.handleDeleteAccount = this.handleDeleteAccount.bind(this);\n  }\n\n  handlePasswordUpdate(pwd) {\n    this.setState({password: pwd});\n    this.props.onUpdatePassword(pwd);\n  }\n\n  handleLaunchPermissionsEditor(which) {\n    this.setState({\n      showPermissionEditorFor: which,\n      editedPermissions: this.state[which]\n    });\n  }\n\n  handleHidePermissionsEditor() {\n    this.setState({showPermissionEditorFor: undefined});\n  }\n\n  handlePermissionsChanged(perm) {\n    let defacs = {};\n    defacs[this.state.showPermissionEditorFor] = perm;\n    this.props.onUpdateAccountDesc('me', undefined, undefined, defacs);\n\n    let newState = {showPermissionEditorFor: undefined};\n    newState[this.state.showPermissionEditorFor] = perm;\n    this.setState(newState);\n  }\n\n  handleDeleteAccount(e) {\n    e.preventDefault();\n    const {formatMessage} = this.props.intl;\n    this.props.onShowAlert(\n      formatMessage(messages.delete_account), // title\n      formatMessage(messages.delete_account_warning), // content\n      (() => { this.props.onDeleteAccount(); }), // onConfirm\n      null, // use default text \"OK\"\n      true, // Show Reject button\n      null  // use default text \"Cancel\"\n    );\n  }\n\n  render() {\n    return (\n      <>{this.state.showPermissionEditorFor ?\n        <PermissionsEditor\n          mode={this.state.editedPermissions}\n          skip=\"O\"\n          onSubmit={this.handlePermissionsChanged}\n          onCancel={this.handleHidePermissionsEditor} />\n        :\n        <div className=\"scrollable-panel\">\n          <div className=\"panel-form-column\">\n            <label className=\"small\">\n              <FormattedMessage id=\"label_password\" defaultMessage=\"Password\"\n                  description=\"Label for password editing\" />\n            </label>\n            <div>\n              <FormattedMessage id=\"password_unchanged_prompt\" defaultMessage=\"Unchanged\"\n                description=\"Message in editor while password is unchanged\">{\n                (password_unchanged) => <InPlaceEdit\n                  placeholder={password_unchanged}\n                  type=\"password\"\n                  onFinished={this.handlePasswordUpdate} />\n              }</FormattedMessage>\n            </div>\n          </div>\n          <div className=\"hr\" />\n          <div className=\"panel-form-column\">\n            <a href=\"#\" className=\"danger flat-button\" onClick={(e) => {e.preventDefault(); this.props.onLogout();}}>\n              <i className=\"material-icons\">exit_to_app</i> &nbsp;<FormattedMessage id=\"button_logout\"\n                defaultMessage=\"Logout\" description=\"Button [Logout]\" />\n            </a>\n            <a href=\"#\" className=\"danger flat-button\" onClick={(e) => {this.handleDeleteAccount(e);}}>\n              <i className=\"material-icons\">delete</i> &nbsp;<FormattedMessage id=\"button_delete_account\"\n                defaultMessage=\"Delete account\" description=\"Button [Delete account]\" />\n            </a>\n          </div>\n          <div className=\"hr\" />\n          <div className=\"panel-form-column\">\n            <div>\n              <label className=\"small\">\n                <FormattedMessage id=\"label_default_access_mode\" defaultMessage=\"Default access mode:\"\n                  description=\"Label for default access mode\" />\n              </label>\n            </div>\n            <div className=\"quoted\">\n              <div>Auth: <tt className=\"clickable\"\n                onClick={this.handleLaunchPermissionsEditor.bind(this, 'auth')}>{this.state.auth}</tt></div>\n              <div>Anon: <tt className=\"clickable\"\n                onClick={this.handleLaunchPermissionsEditor.bind(this, 'anon')}>{this.state.anon}</tt></div>\n            </div>\n          </div>\n          {this.state.blockedCount > 0 ?\n            <>\n              <div className=\"hr\" />\n              <div className=\"panel-form-row\">\n                <i className=\"material-icons\">block</i>&nbsp;\n                <a href=\"#\" className=\"gray\" onClick={(e) => {e.preventDefault(); this.props.onShowBlocked();}}>\n                  <FormattedMessage id=\"blocked_contacts_link\" defaultMessage=\"Blocked contacts ({count})\"\n                    values={{ count: this.state.blockedCount }} description=\"Blocked contacts link\" />\n                </a>\n              </div>\n            </>\n            : null }\n        </div>\n      }</>\n    );\n  }\n};\n\nexport default injectIntl(AccSecurityView);\n","// Edit account parameters.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport { Tinode } from 'tinode-sdk';\n\nimport { APP_NAME, LINK_CONTACT_US, LINK_PRIVACY_POLICY, LINK_TERMS_OF_SERVICE } from '../config.js';\n\nexport default class AccSupportView extends React.PureComponent {\n  render() {\n    return (\n      <div className=\"scrollable-panel\">\n        <div className=\"panel-form-column\">\n          <a href={LINK_CONTACT_US} className=\"flat-button\" target=\"_blank\">\n            <i className=\"material-icons\">email</i> &nbsp;<FormattedMessage id=\"link_contact_us\"\n              defaultMessage=\"Contact Us\" description=\"Ancor text for contacting us by email\" />\n          </a>\n          <a href={LINK_TERMS_OF_SERVICE} className=\"flat-button\" target=\"_blank\">\n            <i className=\"material-icons\">description</i> &nbsp;<FormattedMessage id=\"link_terms_of_service\"\n              defaultMessage=\"Terms of Service\" description=\"Ancor text for terms of service link\" />\n          </a>\n          <a href={LINK_PRIVACY_POLICY} className=\"flat-button\" target=\"_blank\">\n            <i className=\"material-icons\">policy</i> &nbsp;<FormattedMessage id=\"link_privacy_policy\"\n              defaultMessage=\"Privacy Policy\" description=\"Ancor text for privacy policy link\" />\n          </a>\n        </div>\n        <div className=\"hr\" />\n        <div className=\"panel-form-column\">\n          <div className=\"panel-form-row\">\n            <label className=\"small\"><FormattedMessage id=\"label_client\" defaultMessage=\"Client:\"\n              description=\"Label for a client version\" /></label>\n            {APP_NAME}\n          </div>\n          <div className=\"panel-form-row\">\n            <label className=\"small\"><FormattedMessage id=\"label_sdk\" defaultMessage=\"SDK:\" /></label>\n            {Tinode.getLibrary()}\n          </div>\n          <div className=\"panel-form-row\">\n            <label className=\"small\"><FormattedMessage id=\"label_server\" defaultMessage=\"Server:\"\n              description=\"Label for a server version\" /></label>\n            {this.props.serverVersion}\n          </div>\n          <div className=\"panel-form-row\">\n            <label className=\"small\"><FormattedMessage id=\"label_server_address\" defaultMessage=\"Server address:\" /></label>\n            {this.props.serverAddress}\n          </div>\n        </div>\n      </div>\n    );\n  }\n};\n","// Login form.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport CheckBox from '../widgets/checkbox.jsx';\nimport VisiblePassword from '../widgets/visible-password.jsx';\n\nexport default class LoginView extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      login: props.login,\n      password: '',\n      hostName: props.serverAddress,\n      saveToken: props.persist\n    };\n    this.handleLoginChange = this.handleLoginChange.bind(this);\n    this.handlePasswordChange = this.handlePasswordChange.bind(this);\n    this.handleToggleSaveToken = this.handleToggleSaveToken.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleLoginChange(e) {\n    this.setState({login: e.target.value});\n  }\n\n  handlePasswordChange(e) {\n    this.setState({password: e.target.value});\n  }\n\n  handleToggleSaveToken() {\n    this.props.onPersistenceChange(!this.state.saveToken);\n    this.setState({saveToken: !this.state.saveToken});\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    this.props.onLogin(this.state.login.trim(), this.state.password.trim());\n  }\n\n  render() {\n    let submitClasses = 'primary';\n    if (this.props.disabled) {\n      submitClasses += ' disabled';\n    }\n\n    return (\n      <form id=\"login-form\" onSubmit={this.handleSubmit}>\n        <FormattedMessage id=\"login_prompt\" defaultMessage=\"Login\"\n          description=\"Placeholer for username/login\">\n        {\n          (login_prompt) => <input type=\"text\" id=\"inputLogin\"\n            placeholder={login_prompt}\n            autoComplete=\"username\"\n            autoCorrect=\"off\"\n            autoCapitalize=\"none\"\n            value={this.state.login}\n            onChange={this.handleLoginChange}\n            required autoFocus />\n        }\n        </FormattedMessage>\n        <FormattedMessage id=\"password_prompt\" defaultMessage=\"Password\"\n          description=\"Placeholder/prompt for entering password\">\n        {\n          (password_prompt) => <VisiblePassword type=\"password\" id=\"inputPassword\"\n            placeholder={password_prompt}\n            autoComplete=\"current-password\"\n            value={this.state.password}\n            onChange={this.handlePasswordChange}\n            required={true} />\n        }\n        </FormattedMessage>\n        <div className=\"panel-form-row\">\n          <CheckBox id=\"save-token\" name=\"save-token\" checked={this.state.saveToken}\n            onChange={this.handleToggleSaveToken} />\n          <label htmlFor=\"save-token\">&nbsp;\n            <FormattedMessage id=\"stay_logged_in\" defaultMessage=\"Stay logged in\"\n              description=\"Label for a checkbox\" />\n          </label>\n          <a href=\"#reset\">\n            <FormattedMessage id=\"forgot_password_link\" defaultMessage=\"Forgot password?\"\n              description=\"Link to Reset password form\" />\n          </a>\n        </div>\n        <div className=\"dialog-buttons\">\n          <button className={submitClasses} type=\"submit\">\n            <FormattedMessage id=\"button_sign_in\" defaultMessage=\"Sign in\"\n              description=\"Button [Sign In]\" />\n          </button>\n        </div>\n      </form>\n    );\n  }\n};\n/* END Login */\n","import React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nconst messages = defineMessages({\n  invalid_id: {\n    id: 'error_invalid_id',\n    defaultMessage: 'Invalid ID',\n    description: 'Error message'\n  }\n});\n\nclass NewTopicById extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      groupId: '',\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleKeyPress = this.handleKeyPress.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  handleChange(e) {\n    this.setState({groupId: e.target.value});\n  }\n\n  handleKeyPress(e) {\n    if (e.key === 'Enter') {\n      this.handleSubmit(e);\n    }\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    if (this.state.groupId) {\n      const name = this.state.groupId.trim();\n      const prefix = name.substr(0, 3);\n      if (name.length > 3 && ['usr', 'grp', 'chn'].includes(prefix)) {\n        this.props.onSubmit(name);\n      } else {\n        this.props.onError(this.props.intl.formatMessage(messages.invalid_id), 'err');\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"panel-form\">\n        <div className=\"panel-form-row\">\n        <FormattedMessage id=\"group_user_id_prompt\" defaultMessage=\"Group or User ID\"\n          description=\"Prompt for entering user or group ID\">{\n          (prompt) => <input type=\"text\" placeholder={prompt}\n            value={this.state.groupId} onChange={this.handleChange}\n            onKeyPress={this.handleKeyPress} required autoFocus />\n        }</FormattedMessage>\n        </div>\n        <div className=\"dialog-buttons\">\n          <button className=\"primary\" onClick={this.handleSubmit}>\n            <FormattedMessage id=\"button_subscribe\" defaultMessage=\"Subscribe\"\n              description=\"Button [Subscribe]\" />\n          </button>\n        </div>\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(NewTopicById);\n","import React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport AvatarCrop from './avatar-crop.jsx';\nimport AvatarUpload from './avatar-upload.jsx';\nimport CheckBox from './checkbox.jsx';\nimport TagManager from './tag-manager.jsx';\n\nimport { AVATAR_SIZE, MAX_AVATAR_BYTES, MAX_EXTERN_ATTACHMENT_SIZE, MAX_TITLE_LENGTH,\n  MAX_TOPIC_DESCRIPTION_LENGTH } from '../config.js';\nimport { imageScaled, blobToBase64, makeImageUrl } from '../lib/blob-helpers.js';\n\nexport default class NewTopicGroup extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.fullName = React.createRef();\n\n    this.state = {\n      fullName: '', // full/formatted name\n      private: '',\n      description: '',\n      imageUrl: null,\n      tags: [],\n      isChannel: false,\n      newAvatar: null,\n      newAvatarMime: null\n    };\n\n    this.handleFieldEdit = this.handleFieldEdit.bind(this);\n    this.handleImageChanged = this.handleImageChanged.bind(this);\n    this.handleAvatarCropped = this.handleAvatarCropped.bind(this);\n    this.handleAvatarCropCancel = this.handleAvatarCropCancel.bind(this);\n    this.uploadAvatar = this.uploadAvatar.bind(this);\n    this.handleTagsChanged = this.handleTagsChanged.bind(this);\n    this.handleChannelToggle = this.handleChannelToggle.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  componentDidMount() {\n    // this.fullName.current.focus();\n  }\n\n  handleFieldEdit(name, e) {\n    this.setState({[name]: e.target.value || ''});\n  }\n\n  handleImageChanged(mime, img) {\n    this.setState({newAvatar: img, newAvatarMime: mime});\n  }\n\n  handleAvatarCropped(mime, blob, width, height) {\n    const url = blob ? URL.createObjectURL(blob) : null;\n    this.setState({imageUrl: url, newAvatar: null, newAvatarMime: null});\n    if (blob) {\n      this.uploadAvatar(mime, blob, width, height);\n    }\n  }\n\n  handleAvatarCropCancel() {\n    this.setState({newAvatar: null, newAvatarMime: null});\n  }\n\n  // Utility method for converting cropped avatar blob to bytes for sending inband or\n  // for uploading it to the server out of band.\n  uploadAvatar(mime, blob, width, height) {\n    const readyToUpload = image => {\n      let {mime, blob} = image;\n      if (blob.size > MAX_AVATAR_BYTES) {\n        // Too large to send inband - uploading out of band and sending as a link.\n        const uploader = this.props.tinode.getLargeFileHelper();\n        uploader.upload(blob)\n          .then(url => this.setState({imageUrl: url}))\n          .catch(err => this.props.onError(err.message, 'err'));\n      } else {\n        // Convert blob to base64-encoded bits.\n        blobToBase64(blob)\n          .then(b64 => this.setState({imageUrl: makeImageUrl({data: b64.bits, type: mime})}));\n      }\n    };\n\n    if (width > AVATAR_SIZE || height > AVATAR_SIZE || width != height) {\n      // Avatar is not square or too large even after cropping. Shrink it and make square.\n      imageScaled(blob, AVATAR_SIZE, AVATAR_SIZE, MAX_EXTERN_ATTACHMENT_SIZE, true)\n        .then(scaled => readyToUpload(scaled))\n        .catch(err => this.props.onError(err.message, 'err'));\n    } else {\n      readyToUpload({mime: mime, blob: blob, width: width, height: height});\n    }\n  }\n\n  handleTagsChanged(tags) {\n    this.setState({tags: tags});\n  }\n\n  handleChannelToggle() {\n    this.setState({isChannel: !this.state.isChannel});\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n\n    const fn = this.state.fullName.trim().substring(0, MAX_TITLE_LENGTH);\n    const comment = this.state.private.trim().substring(0, MAX_TITLE_LENGTH);\n    const description = this.state.description.trim().substring(0, MAX_TOPIC_DESCRIPTION_LENGTH);\n    if (fn) {\n      this.props.onSubmit(fn, description, this.state.imageUrl, comment, this.state.tags, this.state.isChannel);\n    }\n  }\n\n  render() {\n    if (this.state.newAvatar) {\n      return (\n        <AvatarCrop\n          avatar={this.state.newAvatar}\n          mime={this.state.newAvatarMime}\n          onSubmit={this.handleAvatarCropped}\n          onCancel={this.handleAvatarCropCancel}\n          onError={this.props.onError} />\n      );\n    }\n\n    let submitClasses = 'primary';\n    if (this.props.disabled) {\n      submitClasses += ' disabled';\n    }\n    return (\n      <form className=\"panel-form\" onSubmit={this.handleSubmit}>\n        <div className=\"panel-form-column\">\n          <center>\n            <AvatarUpload\n              tinode={this.props.tinode}\n              avatar={this.state.imageUrl}\n              onError={this.props.onError}\n              onImageUpdated={this.handleImageChanged} />\n          </center>\n          <div className=\"group\">\n            <label className=\"small\" htmlFor=\"new-topic-fn\">\n              <FormattedMessage id=\"label_topic_name\" defaultMessage=\"Name\"\n                description=\"Label for editing topic name\" />\n            </label>\n            <FormattedMessage id=\"topic_name_editing_placeholder\" defaultMessage=\"Freeform name of the group\"\n              description=\"Prompt for entering topic name\">{\n              (placeholder) => <input type=\"text\" id=\"new-topic-fn\" placeholder={placeholder}\n                ref={this.fullName} value={this.state.fullName} onChange={this.handleFieldEdit.bind(this, 'fullName')}\n                autoFocus required tabIndex={0} />\n            }</FormattedMessage>\n          </div>\n          <div className=\"group\">\n            <label className=\"small\" htmlFor=\"new-topic-priv\">\n              <FormattedMessage id=\"label_private\" defaultMessage=\"Private comment\"\n                description=\"Label for editing 'private'\" />\n            </label>\n            <FormattedMessage id=\"private_editing_placeholder\" defaultMessage=\"Visible to you only\"\n              description=\"Placeholder for editing 'private'\">{\n              (placeholder) => <input type=\"text\" id=\"new-topic-priv\" placeholder={placeholder}\n                value={this.state.private} onChange={this.handleFieldEdit.bind(this, 'private')} tabIndex={1} />\n            }</FormattedMessage>\n          </div>\n          <div className=\"group\">\n            <label className=\"small\" htmlFor=\"new-topic-desc\">\n              <FormattedMessage id=\"label_description\" defaultMessage=\"Description\"\n                description=\"Label for editing topic description\" />\n            </label>\n            <FormattedMessage id=\"description_editing_placeholder\" defaultMessage=\"Description (optional)\"\n              description=\"Placeholder for editing topic description\">{\n              (placeholder) => <input type=\"text\" id=\"new-topic-desc\" placeholder={placeholder}\n                value={this.state.description} onChange={this.handleFieldEdit.bind(this, 'description')} tabIndex={2} />\n            }</FormattedMessage>\n          </div>\n        </div>\n        <div className=\"panel-form-row\">\n          <CheckBox checked={this.state.isChannel} tabIndex={3} onChange={this.handleChannelToggle} />&nbsp;\n          <label onClick={this.handleChannelToggle}><FormattedMessage id=\"channel_prompt\"\n            defaultMessage=\"This is a channel\"\n            description=\"Checkbox label when creating a channel\" /></label>\n        </div>\n        <FormattedMessage id=\"title_tag_manager\" defaultMessage=\"Tags (search & discovery)\"\n          description=\"Section title for TagManager\">{\n          (title) => <TagManager\n            tinode={this.props.tinode}\n            tags={this.state.tags}\n            activated={true}\n            onTagsChanged={this.handleTagsChanged}\n            tabIndex={4}\n            title={title} />\n        }</FormattedMessage>\n        <div className=\"dialog-buttons\">\n          <button className={submitClasses}>\n            <FormattedMessage id=\"button_create\" defaultMessage=\"Create\"\n              description=\"Button [Create]\" />\n          </button>\n        </div>\n      </form>\n    );\n  }\n};\n","// Create new topic and invite users or send an invite.\nimport React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nimport { Tinode } from 'tinode-sdk';\n\nimport ContactList from '../widgets/contact-list.jsx';\nimport NewTopicById from '../widgets/new-topic-by-id.jsx';\nimport NewTopicGroup from '../widgets/new-topic-group.jsx';\nimport SearchContacts from '../widgets/search-contacts.jsx';\n\nimport HashNavigation from '../lib/navigation.js';\nimport { theCard } from '../lib/utils.js';\n\nconst messages = defineMessages({\n  search_for_contacts: {\n    id: \"search_for_contacts\",\n    defaultMessage: \"Use search to find contacts\",\n    description: \"Text shown in contacts view when user entered no search query.\"\n  },\n  search_no_results: {\n    id: \"search_no_results\",\n    defaultMessage: \"Search returned no results\",\n    description: \"Text shown in contacts view when query returned no results.\"\n  },\n  search_placeholder: {\n    id: \"search_placeholder\",\n    defaultMessage: \"List like email:alice@example.com, tel:17025550003...\",\n    description: \"Placeholder in contacts search field\"\n  },\n});\n\nclass NewTopicView extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      tabSelected: 'find',\n      searchQuery: null\n    };\n\n    this.handleTabClick = this.handleTabClick.bind(this);\n    this.handleSearchContacts = this.handleSearchContacts.bind(this);\n    this.handleSearchResultSelected = this.handleSearchResultSelected.bind(this);\n    this.handleNewGroupSubmit = this.handleNewGroupSubmit.bind(this);\n    this.handleGroupByID = this.handleGroupByID.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.onInitFind();\n  }\n\n  handleTabClick(e) {\n    e.preventDefault();\n    HashNavigation.navigateTo(HashNavigation.addUrlParam(window.location.hash, 'tab', e.currentTarget.dataset.id));\n    this.setState({tabSelected: e.currentTarget.dataset.id});\n  }\n\n  handleSearchContacts(query) {\n    this.props.onSearchContacts(query);\n    this.setState({searchQuery: Tinode.isNullValue(query) ? null : query});\n  }\n\n  handleSearchResultSelected(name) {\n    if (this.state.tabSelected == 'find') {\n      HashNavigation.navigateTo(HashNavigation.removeUrlParam(window.location.hash, 'tab'));\n      this.props.onCreateTopic(name);\n    }\n  }\n\n  handleNewGroupSubmit(name, description, dataUrl, priv, tags, isChannel) {\n    HashNavigation.navigateTo(HashNavigation.removeUrlParam(window.location.hash, 'tab'));\n    this.props.onCreateTopic(undefined,\n      {public: theCard(name, dataUrl, null, description), private: priv, tags: tags}, isChannel);\n  }\n\n  handleGroupByID(topicName) {\n    HashNavigation.navigateTo(HashNavigation.removeUrlParam(window.location.hash, 'tab'));\n    this.props.onCreateTopic(topicName);\n  }\n\n  render() {\n    const {formatMessage} = this.props.intl;\n    const no_contacts_placeholder = formatMessage(this.state.searchQuery ?\n      messages.search_no_results : messages.search_for_contacts);\n    const search_placeholder = formatMessage(messages.search_placeholder);\n    return (\n      <div className=\"flex-column\">\n        <ul className=\"tabbar\">\n          <li className={this.state.tabSelected === \"find\" ? \"active\" : null}>\n            <a href=\"#\" data-id=\"find\" onClick={this.handleTabClick}>\n              <FormattedMessage id=\"tabtitle_find_user\" defaultMessage=\"find\"\n                description=\"Tab title Find\" />\n            </a>\n          </li>\n          <li className={this.state.tabSelected === \"grp\" ? \"active\" : null}>\n            <a href=\"#\" data-id=\"grp\" onClick={this.handleTabClick}>\n              <FormattedMessage id=\"tabtitle_new_group\" defaultMessage=\"new group\"\n                description=\"Tab title New Group\" />\n            </a>\n          </li>\n          <li className={this.state.tabSelected === \"byid\" ? \"active\" : null}>\n            <a href=\"#\" data-id=\"byid\" onClick={this.handleTabClick}>\n              <FormattedMessage id=\"tabtitle_group_by_id\" defaultMessage=\"by id\"\n                description=\"Tab title Find topic by ID\" />\n            </a>\n          </li>\n        </ul>\n        {this.state.tabSelected === 'grp' ?\n          <NewTopicGroup\n            tinode={this.props.tinode}\n            onSubmit={this.handleNewGroupSubmit}\n            onError={this.props.onError} /> :\n          this.state.tabSelected === 'byid' ?\n            <NewTopicById\n              onSubmit={this.handleGroupByID}\n              onError={this.props.onError} /> :\n            <div className=\"flex-column\">\n              <SearchContacts\n                placeholder={search_placeholder}\n                onSearchContacts={this.handleSearchContacts} />\n              <ContactList\n                tinode={this.props.tinode}\n                contacts={this.props.searchResults}\n                myUserId={this.props.myUserId}\n                emptyListMessage={no_contacts_placeholder}\n                showOnline={false}\n                showUnread={false}\n                showContextMenu={false}\n                onTopicSelected={this.handleSearchResultSelected} />\n            </div>}\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(NewTopicView);\n","// A password reset form.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport VisiblePassword from '../widgets/visible-password.jsx';\n\nimport HashNavigation from '../lib/navigation.js';\n\nexport default class PasswordResetView extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      email: '',\n      password: '',\n      sent: false\n    };\n\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleEmailChange = this.handleEmailChange.bind(this);\n    this.handlePasswordChange = this.handlePasswordChange.bind(this);\n  }\n\n  componentDidMount() {\n    const parsed = HashNavigation.parseUrlHash(window.location.hash);\n    this.setState({token: parsed.params.token, scheme: parsed.params.scheme});\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    if (this.state.token) {\n      this.props.onReset(this.state.scheme, this.state.password.trim(), this.state.token);\n    } else if (this.state.sent) {\n      this.props.onCancel();\n    } else {\n      const email = this.state.email.trim();\n      this.setState({email: email});\n      this.props.onRequest('email', email).then(() => {\n        this.setState({sent: true});\n      });\n    }\n  }\n\n  handleEmailChange(e) {\n    this.setState({email: e.target.value});\n  }\n\n  handlePasswordChange(e) {\n    this.setState({password: e.target.value});\n  }\n\n  render() {\n    return (\n      <form id=\"password-reset-form\" onSubmit={this.handleSubmit}>\n        {(this.state.token && this.state.scheme) ?\n          <><label htmlFor=\"new-password\">\n            <FormattedMessage id=\"label_new_password\"\n              defaultMessage=\"New password\"\n              description=\"Label for entering a new password\" />\n          </label>\n          <FormattedMessage id=\"new_password_placeholder\" defaultMessage=\"Enter new password\"\n            description=\"Placeholder for entering new password\">{\n            (placeholder) => <VisiblePassword\n              id=\"new-password\"\n              placeholder={placeholder}\n              autoComplete=\"new-password\"\n              value={this.state.password}\n              required={true} autoFocus={true}\n              onChange={this.handlePasswordChange} />\n          }</FormattedMessage></>\n        : this.state.sent ?\n          <>\n            <br/>\n            <center><i className=\"material-icons huge green\">task_alt</i></center>\n            <br/>\n            <center><FormattedMessage id=\"password_reset_email_sent\"\n              defaultMessage=\"An email has been sent to {email}. Follow the directions in the email to reset your password.\"\n              values={{ email: <tt>{this.state.email}</tt> }}\n              description=\"Notification that the email with password reset instructions has been sent\" /></center>\n          </>\n        :\n          <>\n            <label htmlFor=\"inputEmail\">\n              <FormattedMessage id=\"label_reset_password\"\n                defaultMessage=\"Send a password reset email:\"\n                description=\"Label for password reset field\" />\n            </label>\n            <FormattedMessage id=\"credential_email_prompt\" defaultMessage=\"Your registration email\"\n              description=\"Placeholder for entering email\">{\n              (placeholder) => <input type=\"email\" id=\"inputEmail\"\n                placeholder={placeholder}\n                autoComplete=\"email\"\n                value={this.state.email}\n                onChange={this.handleEmailChange}\n                required autoFocus />\n            }</FormattedMessage>\n          </>\n        }\n        <div className=\"dialog-buttons\">\n          <button className=\"primary\" type=\"submit\">{\n            (this.state.token && this.state.scheme) ?\n            <FormattedMessage id=\"button_reset\" defaultMessage=\"Reset\" description=\"Button [Reset]\" />\n            : this.state.sent ?\n            <FormattedMessage id=\"button_ok\" defaultMessage=\"OK\"\n              description=\"Button [OK]\" />\n            :\n            <FormattedMessage id=\"button_send_request\" defaultMessage=\"Send request\"\n              description=\"Button [Send request]\" />\n          }</button>\n        </div>\n      </form>\n    );\n  }\n}\n","import React from 'react';\n\nimport { KNOWN_HOSTS } from '../config.js';\n\n/* Combobox for selecting host name */\n\nexport default class HostSelector extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      hostName: props.serverAddress,\n      changed: false\n    };\n\n    this.handleHostNameChange = this.handleHostNameChange.bind(this);\n    this.handleEditingFinished = this.handleEditingFinished.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n  }\n\n  handleHostNameChange(e) {\n    this.setState({hostName: e.target.value, changed: true});\n  }\n\n  handleEditingFinished() {\n    if (this.state.changed) {\n      this.setState({changed: false});\n      this.props.onServerAddressChange(this.state.hostName.trim());\n    }\n  }\n\n  handleKeyDown(e) {\n    if (e.key == 'Enter') {\n      this.handleEditingFinished();\n    }\n  }\n\n  render() {\n    var hostOptions = [];\n    for (let key in KNOWN_HOSTS) {\n      let item = KNOWN_HOSTS[key];\n      hostOptions.push(\n        <option key={item} value={item} />\n      );\n    }\n    return (\n      <div className=\"panel-form-row\">\n        <input type=\"search\" id=\"host-name\" placeholder={this.props.hostName} list=\"known-hosts\"\n          className=\"quoted\" value={this.state.hostName} onChange={this.handleHostNameChange}\n          onBlur={this.handleEditingFinished}\n          onKeyDown={this.handleKeyDown} required />\n        <datalist id=\"known-hosts\">\n          {hostOptions}\n        </datalist>\n      </div>\n    );\n  }\n}\n","// Tinode config panel.\nimport React from 'react';\nimport { FormattedMessage } from 'react-intl';\n\nimport CheckBox from '../widgets/checkbox.jsx';\n\nimport HostSelector from '../widgets/host-selector.jsx';\n\nexport default class SettingsView extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      transport: props.transport || 'def',\n      serverAddress: props.serverAddress,\n      secureConnection: props.secureConnection,\n    };\n\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleTransportSelected = this.handleTransportSelected.bind(this);\n    this.handleServerAddressChange = this.handleServerAddressChange.bind(this);\n    this.handleToggleSecure = this.handleToggleSecure.bind(this);\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    this.props.onUpdate({\n      transport: this.state.transport,\n      serverAddress: this.state.serverAddress,\n      secureConnection: this.state.secureConnection,\n    });\n  }\n\n  handleTransportSelected(e) {\n    this.setState({transport: e.currentTarget.value});\n  }\n\n  handleServerAddressChange(name) {\n    this.setState({serverAddress: name});\n  }\n\n  handleToggleSecure(e) {\n    this.setState({secureConnection: !this.state.secureConnection});\n  }\n\n  render() {\n    const names = {def: \"default\", ws: \"websocket\", lp: \"long polling\"};\n    const transportOptions = [];\n    ['def', 'ws', 'lp'].map((item) => {\n      const id = 'transport-' + item;\n      const name = names[item];\n      transportOptions.push(\n        <li key={item}>\n          <input type=\"radio\" id={id} name=\"transport-select\" value={item}\n            checked={this.state.transport === item}\n            onChange={this.handleTransportSelected} />\n          <label htmlFor={id}>{name}</label>\n        </li>\n      );\n    });\n\n    return (\n      <form id=\"settings-form\" className=\"panel-form\" onSubmit={this.handleSubmit}>\n        <div className=\"panel-form-row\">\n          <label className=\"small\">\n            <FormattedMessage id=\"label_server_to_use\" defaultMessage=\"Server to use:\"\n              description=\"Label for server selector in SettingsView\" />\n          </label>\n        </div>\n        <HostSelector serverAddress={this.state.serverAddress} onServerAddressChange={this.handleServerAddressChange} />\n        <div className=\"panel-form-row\">\n          <CheckBox id=\"secure-connection\" name=\"secure-connection\" checked={this.state.secureConnection}\n            className=\"quoted\" onChange={this.handleToggleSecure} /><label htmlFor=\"secure-connection\">\n            <FormattedMessage id=\"label_use_secure_connection\" defaultMessage=\"Use secure connection\"\n              description=\"Label for WS/WSS connection type in SettingsView\" />\n          </label>\n        </div>\n        <div className=\"panel-form-row\">\n          <label className=\"small\">\n            <FormattedMessage id=\"label_wire_transport\" defaultMessage=\"Wire transport:\"\n              description=\"Label for wire transport selection in SettingsView\" />\n          </label>\n        </div>\n        <div className=\"panel-form-row\">\n          <ul className=\"quoted\">\n            {transportOptions}\n          </ul>\n        </div>\n        <div className=\"dialog-buttons\">\n          <button type=\"submit\" className=\"primary\">\n            <FormattedMessage id=\"button_update\" defaultMessage=\"Update\"\n              description=\"Button [Update]\" />\n          </button>\n        </div>\n      </form>\n    );\n  }\n};\n","// ValidationView: panel for confirming credentials, like email or phone.\nimport React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nconst messages = defineMessages({\n  phone: {\n    id: 'phone_dative',\n    defaultMessage: 'phone',\n    description: \"Dative case of 'phone', i.e. 'phone' in 'by phone'\",\n  },\n  email: {\n    id: 'email_dative',\n    defaultMessage: 'email',\n    description: \"Dative case of 'email', i.e. 'email' in 'by email'\",\n  }\n});\n\nclass ValidationView extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      code: props.credCode || '',\n      codeReceived: props.credCode\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleKeyPress = this.handleKeyPress.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    if (nextProps.credCode != prevState.codeReceived) {\n      return {\n        code: nextProps.credCode || '',\n        codeReceived: nextProps.credCode\n      };\n    }\n\n    return prevState;\n  }\n\n  componentDidMount() {\n    // Submit code automatically if it's received from the parent.\n    if (this.props.credCode) {\n      this.props.onSubmit(this.props.credMethod, this.props.credCode, this.props.credToken);\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    // Submit code automatically if it's received from the parent.\n    if (this.state.codeReceived && this.state.code && this.state.code != prevState.code) {\n      this.props.onSubmit(this.props.credMethod, this.state.code, this.props.credToken);\n    }\n  }\n\n\n  handleChange(e) {\n    this.setState({code: e.target.value.trim()});\n  }\n\n  handleKeyPress(e) {\n    if (e.key === 'Enter') {\n      this.handleSubmit(e);\n    } else if (e.key == 'Escape') {\n      this.handleCancel(e);\n    }\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    if (this.state.code && this.state.code.trim()) {\n      this.props.onSubmit(this.props.credMethod, this.state.code.trim(), this.props.credToken);\n    }\n  }\n\n  handleCancel(e) {\n    e.preventDefault();\n    this.props.onCancel();\n  }\n\n  render() {\n    const { formatMessage } = this.props.intl;\n    const methods = {'email': formatMessage(messages.email), 'tel': formatMessage(messages.phone)};\n    const method = methods[this.props.credMethod] || this.props.credMethod;\n    return (\n      <div className=\"panel-form\">\n        <div className=\"panel-form-row\">\n          <label className=\"small\" htmlFor=\"enter-confirmation-code\">\n            <FormattedMessage id=\"enter_confirmation_code_prompt\"\n              defaultMessage=\"Enter confirmation code sent to you by {method}:\"\n              description=\"Request to enter confirmation code\"\n              values={{method: method}} />\n          </label>\n        </div>\n        <div className=\"panel-form-row\">\n        <FormattedMessage id=\"numeric_confirmation_code_prompt\"\n          defaultMessage=\"Numbers only\" description=\"Prompt for numeric conformation code\">{\n          (numbers_only) => <input type=\"text\" id=\"enter-confirmation-code\"\n            placeholder={numbers_only}\n            value={this.state.code} onChange={this.handleChange}\n            onKeyPress={this.handleKeyPress} required />\n        }</FormattedMessage>\n        </div>\n        <div className=\"dialog-buttons\">\n          <button className=\"secondary\" onClick={this.handleCancel}>\n            <FormattedMessage id=\"button_cancel\" defaultMessage=\"Cancel\" description=\"Button [Cancel]\" />\n          </button>\n          <button className=\"primary\" onClick={this.handleSubmit}>\n            <FormattedMessage id=\"button_confirm\" defaultMessage=\"Confirm\" description=\"Button [Confirm]\" />\n          </button>\n        </div>\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(ValidationView);\n","import React from 'react';\nimport { defineMessages, injectIntl } from 'react-intl';\n\nimport ErrorPanel from '../widgets/error-panel.jsx';\nimport LoadSpinner from '../widgets/load-spinner.jsx';\nimport SideNavbar from '../widgets/side-navbar.jsx';\nimport TopicCommon from '../widgets/topic-common.jsx';\n\nimport AccountSettingsView from './account-settings-view.jsx';\nimport ContactsView from './contacts-view.jsx';\nimport CreateAccountView from './create-account-view.jsx';\nimport AccNotificationsView from './acc-notifications-view.jsx';\nimport AccSecurityView from './acc-security-view.jsx';\nimport AccSupportView from './acc-support-view.jsx';\nimport LoginView from './login-view.jsx';\nimport NewTopicView from './new-topic-view.jsx';\nimport PasswordResetView from './password-reset-view.jsx';\nimport SettingsView from './settings-view.jsx';\nimport ValidationView from './validation-view.jsx';\n\n// Panel titles for translation.\nconst messages = defineMessages({\n  login: {\n    id: 'sidepanel_title_login',\n    description: 'Sidepanel title for LoginView.',\n    defaultMessage: 'Sign In'\n  },\n  register: {\n    id: 'sidepanel_title_register',\n    description: 'Sidepanel title for CreateAccountView.',\n    defaultMessage: 'Create Account'\n  },\n  settings: {\n    id: 'sidepanel_title_settings',\n    description: 'Sidepanel title for SettingsView.',\n    defaultMessage: 'Settings'\n  },\n  edit: {\n    id: 'sidepanel_title_account_settings',\n    description: 'Sidepanel title for AccountSettingsView.',\n    defaultMessage: 'Account Settings'\n  },\n  general: {\n    id: 'panel_title_general',\n    description: 'Title for TopicCommon.',\n    defaultMessage: 'General'\n  },\n  security: {\n    id: 'panel_title_security',\n    description: 'Title for TopicSecirity and AccSecurity.',\n    defaultMessage: 'Security'\n  },\n  crop: {\n    id: 'panel_title_crop',\n    description: 'Title for AvatarCropView.',\n    defaultMessage: 'Drag to Adjust'\n  },\n  notif: {\n    id: 'sidepanel_title_acc_notifications',\n    description: 'Sidepanel title for AccNotificationsView.',\n    defaultMessage: 'Notifications'\n  },\n  support: {\n    id: 'sidepanel_title_acc_support',\n    description: 'Sidepanel title for AccSupportView.',\n    defaultMessage: 'Support'\n  },\n  newtpk: {\n    id: 'sidepanel_title_newtpk',\n    description: 'Sidepanel title for NewTopicView.',\n    defaultMessage: 'Start New Chat'\n  },\n  cred: {\n    id: 'sidepanel_title_cred',\n    description: 'Sidepanel title for ValidationView.',\n    defaultMessage: 'Confirm Credentials'\n  },\n  reset: {\n    id: 'sidepanel_title_reset',\n    description: 'Sidepanel title for PasswordResetView.',\n    defaultMessage: 'Reset Password'\n  },\n  archive: {\n    id: 'sidepanel_title_archive',\n    description: 'Sidepanel title for ContactsView-Archive.',\n    defaultMessage: 'Archived Chats'\n  },\n  blocked: {\n    id: 'sidepanel_title_blocked',\n    description: 'Sidepanel title for ContactsView-Blocked.',\n    defaultMessage: 'Blocked Chats'\n  }\n});\n\nclass SidepanelView extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.handleNewTopic = this.handleNewTopic.bind(this);\n  }\n\n  handleNewTopic() {\n    this.props.onNavigate('newtpk');\n  }\n\n  render() {\n    const {formatMessage} = this.props.intl;\n    const view = this.props.state || (this.props.myUserId ? 'contacts' : 'login');\n\n    let title, avatar, badges;\n    if (view == 'contacts') {\n      title = this.props.title;\n      avatar = this.props.avatar ? this.props.avatar : true;\n      badges = this.props.trustedBadges;\n    } else {\n      title = formatMessage(messages[view]);\n      avatar = false;\n      badges = null;\n    }\n\n    let onCancel;\n    if (['login', 'contacts'].indexOf(view) == -1) {\n      onCancel = this.props.onCancel;\n    }\n\n    return (\n      <div id=\"sidepanel\" className={this.props.hideSelf ? 'nodisplay' : null}>\n        <SideNavbar\n          state={view}\n          title={title}\n          avatar={avatar}\n          tinode={this.props.tinode}\n          trustedBadges={badges}\n          myUserId={this.props.myUserId}\n          onSignUp={this.props.onSignUp}\n          onSettings={this.props.onSettings}\n          onNewTopic={this.handleNewTopic}\n          onCancel={onCancel} />\n\n        <ErrorPanel\n          level={this.props.errorLevel}\n          text={this.props.errorText}\n          action={this.props.errorAction}\n          actionText={this.props.errorActionText}\n          onClearError={this.props.onError} />\n\n        <LoadSpinner show={this.props.loadSpinnerVisible} />\n\n        {view === 'login' ?\n          <LoginView\n            login={this.props.login}\n            disabled={this.props.loginDisabled}\n            persist={this.props.persist}\n            onLogin={this.props.onLoginRequest}\n            onPersistenceChange={this.props.onPersistenceChange} /> :\n\n          view === 'register' ?\n          <CreateAccountView\n            tinode={this.props.tinode}\n            onCreateAccount={this.props.onCreateAccount}\n            onCancel={this.props.onCancel}\n            onError={this.props.onError} /> :\n\n          view === 'settings' ?\n          <SettingsView\n            transport={this.props.transport}\n            serverAddress={this.props.serverAddress}\n            secureConnection={this.props.secureConnection}\n            onCancel={this.props.onCancel}\n            onUpdate={this.props.onGlobalSettings} /> :\n\n          view === 'edit' ?\n          <AccountSettingsView\n            tinode={this.props.tinode}\n            myUserId={this.props.myUserId}\n            trustedBadges={this.props.trustedBadges}\n            onNavigate={this.props.onNavigate} /> :\n\n          (view === 'general' || view === 'crop') ?\n          <TopicCommon\n            topic=\"me\"\n            tinode={this.props.tinode}\n            myUserId={this.props.myUserId}\n            onUpdateTopicDesc={this.props.onUpdateAccountDesc}\n            onUpdateTags={this.props.onUpdateAccountTags}\n            onCredAdd={this.props.onCredAdd}\n            onCredDelete={this.props.onCredDelete}\n            onCredConfirm={this.props.onCredConfirm}\n            onError={this.props.onError} /> :\n\n          view === 'notif' ?\n          <AccNotificationsView\n            messageSounds={this.props.messageSounds}\n            desktopAlerts={this.props.desktopAlerts}\n            desktopAlertsEnabled={this.props.desktopAlertsEnabled}\n            incognitoMode={this.props.incognitoMode}\n            onTogglePushNotifications={this.props.onTogglePushNotifications}\n            onToggleMessageSounds={this.props.onToggleMessageSounds}\n            onToggleIncognitoMode={this.props.onToggleIncognitoMode} /> :\n\n          view === 'security' ?\n          <AccSecurityView\n            tinode={this.props.tinode}\n            onUpdateAccountDesc={this.props.onUpdateAccountDesc}\n            onUpdatePassword={this.props.onUpdatePassword}\n            onLogout={this.props.onLogout}\n            onDeleteAccount={this.props.onDeleteAccount}\n            onShowAlert={this.props.onShowAlert}\n            onShowBlocked={this.props.onShowBlocked} /> :\n\n          view === 'support' ?\n          <AccSupportView\n            serverAddress={this.props.serverAddress}\n            serverVersion={this.props.serverVersion} /> :\n\n          (view === 'contacts' || view == 'archive' || view == 'blocked') ?\n          <ContactsView\n            tinode={this.props.tinode}\n            myUserId={this.props.myUserId}\n            connected={this.props.connected}\n            topicSelected={this.props.topicSelected}\n            archive={view == 'archive'}\n            blocked={view == 'blocked'}\n            chatList={this.props.chatList}\n            showContextMenu={this.props.showContextMenu}\n            onTopicSelected={this.props.onTopicSelected}\n            onShowArchive={this.props.onShowArchive} /> :\n\n          view === 'newtpk' ?\n          <NewTopicView\n            tinode={this.props.tinode}\n            searchResults={this.props.searchResults}\n            onInitFind={this.props.onInitFind}\n            onSearchContacts={this.props.onSearchContacts}\n            onCreateTopic={this.props.onCreateTopic}\n            onError={this.props.onError} /> :\n\n          view === 'cred' ?\n          <ValidationView\n            credCode={this.props.credCode}\n            credMethod={this.props.credMethod}\n            credToken={this.props.credToken}\n            onSubmit={this.props.onValidateCredentials}\n            onCancel={this.props.onCancel} /> :\n\n          view === 'reset' ?\n          <PasswordResetView\n            onRequest={this.props.onPasswordResetRequest}\n            onReset={this.props.onResetPassword}\n            onCancel={this.props.onCancel} /> :\n          null}\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(SidepanelView);\n","import { KNOWN_HOSTS, DEFAULT_HOST } from '../config.js';\n\n// Detect server address from the URL\nexport function detectServerAddress() {\n  let host = DEFAULT_HOST;\n  if (typeof window.location == 'object') {\n    if (window.location.protocol == 'file:' || window.location.hostname == 'localhost') {\n      host = KNOWN_HOSTS.local;\n    } else if (window.location.hostname) {\n      host = window.location.hostname + (window.location.port ? ':' + window.location.port : '');\n    }\n  }\n  return host;\n}\n\n// Detect if the page is served over HTTPS.\nexport function isSecureConnection() {\n  if (typeof window.location == 'object') {\n    return window.location.protocol == 'https:';\n  }\n  return false;\n}\n\nexport function isLocalHost() {\n  if (typeof window.location == 'object') {\n    return window.location.hostname == 'localhost';\n  }\n  return false;\n}\n","// The top-level class to hold all functionality together.\nimport React from 'react';\nimport { FormattedMessage, defineMessages, injectIntl } from 'react-intl';\n\nimport { initializeApp as firebaseInitApp } from 'firebase/app';\nimport { getMessaging as firebaseGetMessaging, getToken as firebaseGetToken,\n  deleteToken as firebaseDelToken, onMessage as firebaseOnMessage } from 'firebase/messaging';\n\nimport { Drafty, Tinode } from 'tinode-sdk';\n\nimport Alert from '../widgets/alert.jsx';\nimport ContextMenu from '../widgets/context-menu.jsx';\nimport ForwardDialog from '../widgets/forward-dialog.jsx';\nimport CallIncoming from '../widgets/call-incoming.jsx';\n\nimport InfoView from './info-view.jsx';\nimport MessagesView from './messages-view.jsx';\nimport SidepanelView from './sidepanel-view.jsx';\n\nimport { API_KEY, APP_NAME, DEFAULT_P2P_ACCESS_MODE, FORWARDED_PREVIEW_LENGTH, LOGGING_ENABLED,\n  MEDIA_BREAKPOINT } from '../config.js';\nimport { CALL_STATE_NONE, CALL_STATE_OUTGOING_INITATED,\n         CALL_STATE_INCOMING_RECEIVED, CALL_STATE_IN_PROGRESS,\n         CALL_HEAD_STARTED }  from '../constants.js';\nimport { PACKAGE_VERSION } from '../version.js';\nimport { base64ReEncode, makeImageUrl } from '../lib/blob-helpers.js';\nimport { detectServerAddress, isLocalHost, isSecureConnection } from '../lib/host-name.js';\nimport LocalStorageUtil from '../lib/local-storage.js';\nimport HashNavigation from '../lib/navigation.js';\nimport { secondsToTime } from '../lib/strformat.js'\nimport { updateFavicon } from '../lib/utils.js';\n\n// Sound to play on message received.\nconst POP_SOUND = new Audio('audio/msg.m4a');\n\nconst messages = defineMessages({\n  reconnect_countdown: {\n    id: 'reconnect_countdown',\n    defaultMessage: 'Disconnected. Reconnecting in {seconds}…',\n    description: 'Message shown when an app update is available.'\n  },\n  reconnect_now: {\n    id: 'reconnect_now',\n    defaultMessage: 'Try now',\n    description: 'Prompt for reconnecting now'\n  },\n  push_init_failed: {\n    id: 'push_init_failed',\n    defaultMessage: 'Failed to initialize push notifications',\n    description: 'Error message when push notifications have failed to initialize.'\n  },\n  invalid_security_token: {\n    id: 'invalid_security_token',\n    defaultMessage: 'Invalid security token',\n    description: 'Error message when resetting password.'\n  },\n  no_connection: {\n    id: 'no_connection',\n    defaultMessage: 'No connection',\n    description: 'Warning that the user is offline.'\n  },\n  code_doesnot_match: {\n    id: 'code_doesnot_match',\n    defaultMessage: 'Code does not match',\n    description: 'Error message when the credential validation code is incorrect.'\n  },\n  menu_item_info: {\n    id: 'menu_item_info',\n    defaultMessage: 'Info',\n    description: 'Show extended topic information'\n  },\n  menu_item_video_call: {\n    id: 'menu_item_video_call',\n    defaultMessage: 'Video call',\n    description: 'Start video call'\n  },\n  cred_confirmed_successfully: {\n    id: 'cred_confirmed_successfully',\n    defaultMessage: 'Confirmed successfully',\n    description: 'Message explaining that the credential was successfully validated.'\n  }\n});\n\nclass TinodeWeb extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.selfRef = React.createRef();\n\n    this.state = this.getBlankState();\n\n    this.handleResize = this.handleResize.bind(this);\n    this.handleHashRoute = this.handleHashRoute.bind(this);\n    this.handleOnline = this.handleOnline.bind(this);\n    this.checkForAppUpdate = this.checkForAppUpdate.bind(this);\n    this.handleVisibilityEvent = this.handleVisibilityEvent.bind(this);\n    this.handleError = this.handleError.bind(this);\n    this.handleLoginRequest = this.handleLoginRequest.bind(this);\n    this.handlePersistenceChange = this.handlePersistenceChange.bind(this);\n    this.handleConnected = this.handleConnected.bind(this);\n    this.handleAutoreconnectIteration = this.handleAutoreconnectIteration.bind(this);\n    this.doLogin = this.doLogin.bind(this);\n    this.handleLoginSuccessful = this.handleLoginSuccessful.bind(this);\n    this.handleDisconnect = this.handleDisconnect.bind(this);\n    this.tnMeMetaDesc = this.tnMeMetaDesc.bind(this);\n    this.tnMeContactUpdate = this.tnMeContactUpdate.bind(this);\n    this.tnMeSubsUpdated = this.tnMeSubsUpdated.bind(this);\n    this.resetContactList = this.resetContactList.bind(this);\n    this.tnInitFind = this.tnInitFind.bind(this);\n    this.tnFndSubsUpdated = this.tnFndSubsUpdated.bind(this);\n    this.handleSearchContacts = this.handleSearchContacts.bind(this);\n    this.handleTopicSelected = this.handleTopicSelected.bind(this);\n    this.handleHideMessagesView = this.handleHideMessagesView.bind(this);\n    this.handleSendMessage = this.handleSendMessage.bind(this);\n    this.handleNewChatInvitation = this.handleNewChatInvitation.bind(this);\n    this.handleNewAccount = this.handleNewAccount.bind(this);\n    this.handleNewAccountRequest = this.handleNewAccountRequest.bind(this);\n    this.handleUpdatePasswordRequest = this.handleUpdatePasswordRequest.bind(this);\n    this.handleUpdateAccountTagsRequest = this.handleUpdateAccountTagsRequest.bind(this);\n    this.handleToggleIncognitoMode = this.handleToggleIncognitoMode.bind(this);\n    this.handleSettings = this.handleSettings.bind(this);\n    this.handleGlobalSettings = this.handleGlobalSettings.bind(this);\n    this.handleShowArchive = this.handleShowArchive.bind(this);\n    this.handleShowBlocked = this.handleShowBlocked.bind(this);\n    this.handleToggleMessageSounds = this.handleToggleMessageSounds.bind(this);\n    this.handleCredAdd = this.handleCredAdd.bind(this);\n    this.handleCredDelete = this.handleCredDelete.bind(this);\n    this.handleCredConfirm = this.handleCredConfirm.bind(this);\n    this.initFCMessaging = this.initFCMessaging.bind(this);\n    this.toggleFCMToken = this.toggleFCMToken.bind(this);\n    this.handlePushMessage = this.handlePushMessage.bind(this);\n    this.handleSidepanelCancel = this.handleSidepanelCancel.bind(this);\n    this.handleStartTopicRequest = this.handleStartTopicRequest.bind(this);\n    this.handleNewTopicCreated = this.handleNewTopicCreated.bind(this);\n    this.handleTopicUpdateRequest = this.handleTopicUpdateRequest.bind(this);\n    this.handleUnarchive = this.handleUnarchive.bind(this);\n    this.handleChangePermissions = this.handleChangePermissions.bind(this);\n    this.handleTagsUpdateRequest = this.handleTagsUpdateRequest.bind(this);\n    this.handleLogout = this.handleLogout.bind(this);\n    this.handleDeleteAccount = this.handleDeleteAccount.bind(this);\n    this.handleDeleteTopicRequest = this.handleDeleteTopicRequest.bind(this);\n    this.handleDeleteMessagesRequest = this.handleDeleteMessagesRequest.bind(this);\n    this.handleLeaveUnsubRequest = this.handleLeaveUnsubRequest.bind(this);\n    this.handleBlockTopicRequest = this.handleBlockTopicRequest.bind(this);\n    this.handleReportTopic = this.handleReportTopic.bind(this);\n    this.handleShowContextMenu = this.handleShowContextMenu.bind(this);\n    this.defaultTopicContextMenu = this.defaultTopicContextMenu.bind(this);\n    this.handleHideContextMenu = this.handleHideContextMenu.bind(this);\n    this.handleShowAlert = this.handleShowAlert.bind(this);\n    this.handleShowInfoView = this.handleShowInfoView.bind(this);\n    this.handleMemberUpdateRequest = this.handleMemberUpdateRequest.bind(this);\n    this.handleValidateCredentialsRequest = this.handleValidateCredentialsRequest.bind(this);\n    this.handlePasswordResetRequest = this.handlePasswordResetRequest.bind(this);\n    this.handleResetPassword = this.handleResetPassword.bind(this);\n    this.handleContextMenuAction = this.handleContextMenuAction.bind(this);\n\n    this.handleShowForwardDialog = this.handleShowForwardDialog.bind(this);\n    this.handleHideForwardDialog = this.handleHideForwardDialog.bind(this);\n\n    this.handleStartVideoCall = this.handleStartVideoCall.bind(this);\n    this.handleInfoMessage = this.handleInfoMessage.bind(this);\n    this.handleDataMessage = this.handleDataMessage.bind(this);\n    this.handleCallClose = this.handleCallClose.bind(this);\n\n    this.handleCallInvite = this.handleCallInvite.bind(this);\n    this.handleCallRinging = this.handleCallRinging.bind(this);\n    this.handleCallHangup = this.handleCallHangup.bind(this);\n    this.handleCallSendOffer = this.handleCallSendOffer.bind(this);\n    this.handleCallIceCandidate = this.handleCallIceCandidate.bind(this);\n    this.handleCallSendAnswer = this.handleCallSendAnswer.bind(this);\n\n    this.handleCallAcceptCall = this.handleCallAcceptCall.bind(this);\n\n    this.sendMessageToTopic = this.sendMessageToTopic.bind(this);\n\n    // FIXME: this is unused.\n    this.callTimeoutTimer = null;\n  }\n\n  getBlankState() {\n    const settings = LocalStorageUtil.getObject('settings') || {};\n    const persist = !!LocalStorageUtil.getObject('keep-logged-in');\n\n    return {\n      connected: false,\n      // Connected and subscribed to 'me'\n      ready: false,\n      // Try to re-login on new connection.\n      autoLogin: false,\n      transport: settings.transport || null,\n      serverAddress: settings.serverAddress || detectServerAddress(),\n      secureConnection: settings.secureConnection === undefined ?\n        isSecureConnection() : settings.secureConnection,\n      serverVersion: \"no connection\",\n      // \"On\" is the default, so saving the \"off\" state.\n      messageSounds: !settings.messageSoundsOff,\n      incognitoMode: false,\n      // Persistent request to enable alerts.\n      desktopAlerts: persist && !!settings.desktopAlerts,\n      // Enable / disable checkbox.\n      desktopAlertsEnabled: (isSecureConnection() || isLocalHost()) &&\n        (typeof firebaseInitApp != 'undefined') && (typeof navigator != 'undefined') &&\n        (typeof FIREBASE_INIT != 'undefined'),\n      firebaseToken: persist ? LocalStorageUtil.getObject('firebase-token') : null,\n\n      applicationVisible: !document.hidden,\n\n      errorText: '',\n      errorLevel: null,\n      errorAction: undefined,\n      errorActionText: null,\n\n      sidePanelSelected: 'login',\n      sidePanelTitle: null,\n      sidePanelAvatar: null,\n      myTrustedBadges: [],\n      loadSpinnerVisible: false,\n\n      login: '',\n      password: '',\n      persist: persist,\n      myUserId: null,\n      liveConnection: navigator.onLine,\n      topicSelected: '',\n      topicSelectedOnline: false,\n      topicSelectedAcs: null,\n      newTopicParams: null,\n      loginDisabled: false,\n      displayMobile: (window.innerWidth <= MEDIA_BREAKPOINT),\n      infoPanel: undefined,\n      mobilePanel: 'sidepanel',\n\n      // Video calls.\n      callTopic: undefined,\n      callState: CALL_STATE_NONE,\n      // If true, call state should be transitioned to CALL_STATE_IN_PROGRESS upon\n      // switching to the call topic.\n      callShouldStart: false,\n\n      contextMenuVisible: false,\n      contextMenuBounds: null,\n      contextMenuClickAt: null,\n      contextMenuParams: null,\n      contextMenuItems: [],\n\n      forwardDialogVisible: false,\n      forwardMessage: null,\n\n      // Modal alert dialog.\n      alertVisible: false,\n      alertParams: {},\n\n      // Chats as shown in the ContactsView\n      chatList: [],\n      // Contacts returned by a search query.\n      searchResults: [],\n      // Merged results of a search query and p2p chats.\n      searchableContacts: [],\n      // Credential validation.\n      credMethod: undefined,\n      credCode: undefined,\n      credToken: undefined,\n      // Topic to go to after login.\n      requestedTopic: undefined\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener('resize', this.handleResize);\n    window.addEventListener('online', (e) => { this.handleOnline(true); });\n    window.addEventListener('offline', (e) => { this.handleOnline(false); });\n    window.addEventListener('hashchange', this.handleHashRoute);\n\n    // Process background notifications from the service worker.\n    if (typeof BroadcastChannel == 'function') {\n      const serviceWorkerChannel = new BroadcastChannel('tinode-sw');\n      serviceWorkerChannel.addEventListener('message', this.handlePushMessage);\n    } else {\n      // Safari is broken by design.\n      console.warn(\"Your browser does not support BroadcastChannel. Some features will not be available\");\n    }\n\n    // Window/tab visible or invisible for pausing timers.\n    document.addEventListener('visibilitychange', this.handleVisibilityEvent);\n\n    this.setState({\n      viewportWidth: document.documentElement.clientWidth,\n      viewportHeight: document.documentElement.clientHeight\n    });\n\n    new Promise((resolve, reject) => {\n      this.tinode = TinodeWeb.tnSetup(this.state.serverAddress, isSecureConnection(), this.state.transport,\n        this.props.intl.locale, this.state.persist, resolve);\n      this.tinode.onConnect = this.handleConnected;\n      this.tinode.onDisconnect = this.handleDisconnect;\n      this.tinode.onAutoreconnectIteration = this.handleAutoreconnectIteration;\n      this.tinode.onInfoMessage = this.handleInfoMessage;\n      this.tinode.onDataMessage = this.handleDataMessage;\n    }).then(_ => {\n      // Initialize desktop alerts.\n      if (this.state.desktopAlertsEnabled) {\n        this.initFCMessaging().then(_ => {\n          if (this.state.desktopAlerts) {\n            this.tinode.setDeviceToken(this.state.firebaseToken);\n          }\n        }).catch(() => {\n          // do nothing: handled earlier.\n          // catch needed to pervent unnecessary logging of error.\n        });\n      }\n\n      // Parse and save the hash navigation params.\n      const parsedNav = HashNavigation.parseUrlHash(window.location.hash);\n\n      // Read contacts from cache.\n      this.resetContactList();\n\n      const token = this.state.persist ? LocalStorageUtil.getObject('auth-token') : undefined;\n      if (token) {\n        this.setState({autoLogin: true});\n\n        // When reading from storage, date is returned as string.\n        token.expires = new Date(token.expires);\n        this.tinode.setAuthToken(token);\n        this.tinode.connect().catch((err) => {\n          // Socket error\n          this.handleError(err.message, 'err');\n        });\n      }\n\n      this.readTimer = null;\n      this.readTimerCallback = null;\n\n      // Maybe navigate to home screen.\n      if (!['cred', 'reset', 'register'].includes(parsedNav.path[0])) {\n        // Save possible topic name.\n        this.setState({requestedTopic: parsedNav.path[1]});\n        const path = parsedNav.params && parsedNav.params.cred_done ?\n          HashNavigation.addUrlParam('', 'cred_done', parsedNav.params.cred_done):\n          '';\n        HashNavigation.navigateTo(path);\n      } else {\n        this.handleHashRoute();\n      }\n    });\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.handleResize);\n    window.removeEventListener('hashchange', this.handleHashRoute);\n    document.removeEventListener('visibilitychange', this.handleVisibilityEvent);\n  }\n\n  // Setup transport (usually websocket) and server address. This will terminate connection with the server.\n  static tnSetup(serverAddress, secureConnection, transport, locale, persistentCache, onSetupCompleted) {\n    const tinode = new Tinode({appName: APP_NAME, host: serverAddress, apiKey: API_KEY, transport: transport,\n      secure: secureConnection, persist: persistentCache}, onSetupCompleted);\n    tinode.setHumanLanguage(locale);\n    tinode.enableLogging(LOGGING_ENABLED, true);\n    return tinode;\n  }\n\n  // Tinode received a push notification from the server.\n  handlePushMessage(payload) {\n    this.tinode.oobNotification(payload.data || {});\n  }\n\n  initFCMessaging() {\n    const {formatMessage, locale} = this.props.intl;\n    const onError = (msg, err) => {\n      console.error(msg, err);\n      this.handleError(formatMessage(messages.push_init_failed), 'err');\n      this.setState({desktopAlertsEnabled: false, firebaseToken: null});\n      LocalStorageUtil.updateObject('settings', {desktopAlerts: false});\n    }\n\n    try {\n      this.fcm = firebaseGetMessaging(firebaseInitApp(FIREBASE_INIT, APP_NAME));\n      return navigator.serviceWorker.register('/service-worker.js').then((reg) => {\n        this.checkForAppUpdate(reg);\n        reg.active.postMessage(JSON.stringify({locale: locale, version: PACKAGE_VERSION}));\n        return reg;\n      }).then((reg) => {\n        // Request token.\n        return TinodeWeb.requestFCMToken(this.fcm, reg);\n      }).then((token) => {\n        const persist = LocalStorageUtil.getObject('keep-logged-in');\n        if (token != this.state.firebaseToken) {\n          this.tinode.setDeviceToken(token);\n          if (persist) {\n            LocalStorageUtil.setObject('firebase-token', token);\n          }\n        }\n        this.setState({firebaseToken: token, desktopAlerts: true});\n        if (persist) {\n          LocalStorageUtil.updateObject('settings', {desktopAlerts: true});\n        }\n\n        // Handhe FCM pushes\n        // (a) for channels always,\n        // (b) pushes when the app is in foreground but has no focus.\n        firebaseOnMessage(this.fcm, (payload) => { this.handlePushMessage(payload); });\n      }).catch((err) => {\n        // SW registration or FCM has failed :(\n        onError(err);\n        throw err;\n      });\n    } catch (err) {\n      onError(err);\n      return Promise.reject(err);\n    }\n  }\n\n  // Google's FCM API is idiotic.\n  static requestFCMToken(fcm, sw) {\n    return firebaseGetToken(fcm, {\n      serviceWorkerRegistration: sw,\n      vapidKey: FIREBASE_INIT.messagingVapidKey\n    }).then((token) => {\n      if (token) {\n        return token;\n      } else {\n        // Try to request permissions.\n        return Notification.requestPermission().then((permission) => {\n          if (permission === 'granted') {\n            return firebaseGetToken(fcm, {\n              serviceWorkerRegistration: reg,\n              vapidKey: FIREBASE_INIT.messagingVapidKey\n            }).then((token) => {\n              if (token) {\n                return token;\n              } else {\n                throw new Error(\"Failed to initialize notifications\");\n              }\n            });\n          } else {\n            throw new Error(\"No permission to send notifications: \" + permission);\n          }\n        });\n      }\n    });\n  }\n\n  handleResize() {\n    const mobile = document.documentElement.clientWidth <= MEDIA_BREAKPOINT;\n    this.setState({\n      viewportWidth: document.documentElement.clientWidth,\n      viewportHeight: document.documentElement.clientHeight\n    });\n    if (this.state.displayMobile != mobile) {\n      this.setState({displayMobile: mobile});\n    }\n  }\n\n  // Check if a newer version of TinodeWeb app is available at the server.\n  checkForAppUpdate(reg) {\n    reg.onupdatefound = () => {\n      const installingWorker = reg.installing;\n      installingWorker.onstatechange = () => {\n        if (installingWorker.state == 'installed' && navigator.serviceWorker.controller) {\n          const msg = <>\n            <FormattedMessage id=\"update_available\"\n              defaultMessage=\"Update available.\"\n              description=\"Message shown when an app update is available.\" /> <a href=\"\">\n              <FormattedMessage id=\"reload_update\"\n                defaultMessage=\"Reload\"\n                description=\"Call to action to reload application when update is available.\" />\n            </a>.</>;\n          this.handleError(msg, 'info');\n        }\n      }\n    }\n  }\n\n  // Handle for hash navigation (hashchange) event: update state.\n  handleHashRoute() {\n    const hash = HashNavigation.parseUrlHash(window.location.hash);\n    // Start with panel parameters.\n    const newState = {\n      infoPanel: hash.params.info,\n      newTopicTabSelected: hash.params.tab\n    };\n\n    if (hash.path && hash.path.length > 0) {\n      // Left-side panel selector.\n      if (['register','settings','edit','notif','security','support','general','crop',\n          'cred','reset','newtpk','archive','blocked','contacts',''].includes(hash.path[0])) {\n        newState.sidePanelSelected = hash.path[0];\n      } else {\n        console.warn(\"Unknown sidepanel view\", hash.path[0]);\n      }\n\n      // Topic for MessagesView selector.\n      let topicName = hash.path[1] || null;\n      if (topicName != this.state.topicSelected) {\n        if (!Tinode.topicType(topicName)) {\n          // Clear invalid topic name.\n          topicName = null;\n        }\n        Object.assign(newState, {\n          topicSelected: topicName,\n          topicSelectedAcs: this.tinode.getTopicAccessMode(topicName)\n        });\n      }\n    } else {\n      // Empty hashpath\n      Object.assign(newState, {sidePanelSelected: '', topicSelected: null});\n    }\n\n    // Save credential validation parameters, if available.\n    if (hash.params.method) {\n      newState.credMethod = hash.params.method;\n    }\n    if (hash.params.code) {\n      newState.credCode = hash.params.code;\n    }\n    if (hash.params.token) {\n      newState.credToken = hash.params.token;\n    }\n\n    // Show a message if validation was successful.\n    if (hash.params.cred_done) {\n      Object.assign(newState,\n        TinodeWeb.stateForError(this.props.intl.formatMessage(messages.cred_confirmed_successfully), 'info'));\n    }\n\n    this.setState(newState);\n  }\n\n  handleOnline(online) {\n    if (online) {\n      this.handleError();\n      clearInterval(this.reconnectCountdown);\n      this.tinode.reconnect();\n    } else {\n      this.handleError(this.props.intl.formatMessage(messages.no_connection), 'warn');\n    }\n    this.setState({liveConnection: online});\n  }\n\n  handleVisibilityEvent() {\n    this.setState({applicationVisible: !document.hidden});\n  }\n\n  static stateForError(err, level, action, actionText) {\n    return {\n      errorText: err,\n      errorLevel: level,\n      errorAction: action,\n      errorActionText: actionText,\n      callShouldStart: false,\n    };\n  }\n\n  handleError(err, level, action, actionText) {\n    this.setState(TinodeWeb.stateForError(err, level, action, actionText));\n  }\n\n  // User clicked Login button in the side panel.\n  handleLoginRequest(login, password) {\n    this.setState({\n      loginDisabled: true,\n      login: login,\n      password: password,\n      loadSpinnerVisible: true,\n      autoLogin: true\n    });\n    this.handleError('', null);\n\n    if (this.tinode.isConnected()) {\n      this.doLogin(login, password, null, {meth: this.state.credMethod, resp: this.state.credCode});\n    } else {\n      this.tinode.connect().catch((err) => {\n        // Socket error\n        this.setState({loginDisabled: false, autoLogin: false, loadSpinnerVisible: false});\n        this.handleError(err.message, 'err');\n      });\n    }\n  }\n\n  // Enable or disable saving the password and IndexedDB.\n  handlePersistenceChange(persist) {\n    if (persist) {\n      this.tinode.initStorage().then(() => {\n        LocalStorageUtil.setObject('keep-logged-in', true);\n        this.setState({persist: true});\n      });\n    } else {\n      this.tinode.clearStorage().then(() => {\n        LocalStorageUtil.setObject('keep-logged-in', false);\n        this.setState({persist: false});\n      });\n    }\n  }\n\n  // Connection succeeded.\n  handleConnected() {\n    // Just to be sure.\n    clearInterval(this.reconnectCountdown);\n    this.handleError();\n\n    const params = this.tinode.getServerInfo();\n    this.setState({\n      serverVersion: params.ver + ' ' + (params.build ? params.build : 'none')\n    });\n\n    if (this.state.autoLogin) {\n      this.doLogin(this.state.login, this.state.password, null,\n        {meth: this.state.credMethod, resp: this.state.credCode});\n    }\n  }\n\n  // Called for each auto-reconnect iteration.\n  handleAutoreconnectIteration(sec, prom) {\n    clearInterval(this.reconnectCountdown);\n\n    if (sec < 0) {\n      // Clear error\n      this.handleError();\n      return;\n    }\n\n    if (prom) {\n      // Reconnecting now\n      prom.then(_ => {\n        // Reconnected: clear error\n        this.handleError();\n      }).catch((err) => {\n        this.handleError(err.message, 'err');\n      });\n      return;\n    }\n\n    const {formatMessage} = this.props.intl;\n    let count = sec / 1000;\n    count = count | count;\n    this.reconnectCountdown = setInterval(_ => {\n      if (count < -10) {\n        // Count could go to negative if computer woke up from sleep.\n        clearInterval(this.reconnectCountdown);\n        this.tinode.reconnect();\n        return;\n      }\n\n      const fmtTime = (count > 99) ? secondsToTime(count) : count;\n      this.handleError(\n        formatMessage(messages.reconnect_countdown, {seconds: fmtTime}),\n        'warn',\n        _ => {\n          clearInterval(this.reconnectCountdown);\n          this.tinode.reconnect();\n        },\n        formatMessage(messages.reconnect_now)\n      );\n      count -= 1;\n    }, 1000);\n  }\n\n  // Connection lost\n  handleDisconnect(err) {\n    this.setState({\n      connected: false,\n      ready: false,\n      topicSelectedOnline: false,\n      errorText: err && err.message ? err.message : \"Disconnected\",\n      errorLevel: err && err.message ? 'err' : 'warn',\n      loginDisabled: false,\n      contextMenuVisible: false,\n      forwardDialogVisible: false,\n      serverVersion: \"no connection\"\n    });\n  }\n\n  doLogin(login, password, tmpToken, cred) {\n    if (this.tinode.isAuthenticated()) {\n      // Already logged in. Go to default screen.\n      HashNavigation.navigateTo('');\n      return;\n    }\n\n    let token = tmpToken || (this.tinode.getAuthToken() || {}).token;\n    if (!(login && password) && !token) {\n      // No login credentials provided.\n      // Make sure we are on the login page.\n      HashNavigation.navigateTo('');\n      this.setState({loginDisabled: false});\n      return;\n    }\n\n    // Sanitize and package credentail.\n    cred = Tinode.credential(cred);\n    // May be disconnected.\n    let connectionPromise = this.tinode.isConnected() ? Promise.resolve() : this.tinode.connect();\n    // Try to login with login/password. If they are not available, try token; if no token, ask for login/password.\n    let loginPromise;\n    if (login && password) {\n      token = null;\n      this.setState({password: null});\n      loginPromise = connectionPromise.then(_ => this.tinode.loginBasic(login, password, cred));\n    } else {\n      loginPromise = connectionPromise.then(_ => this.tinode.loginToken(token, cred));\n    }\n\n    loginPromise.then((ctrl) => {\n      if (ctrl.code >= 300 && ctrl.text === 'validate credentials') {\n        this.setState({loadSpinnerVisible: false});\n        if (cred) {\n          this.handleError(this.props.intl.formatMessage(messages.code_doesnot_match), 'warn');\n        }\n        TinodeWeb.navigateToCredentialsView(ctrl.params);\n      } else {\n        this.handleLoginSuccessful();\n      }\n    }).catch((err) => {\n      // Connection or login failed, report error.\n      this.setState({\n        loginDisabled: false,\n        credMethod: undefined,\n        credCode: undefined,\n        loadSpinnerVisible: false,\n        autoLogin: false\n      });\n      this.handleError(err.message, 'err');\n      console.warn(\"Login failed\", err);\n      if (token) {\n        this.handleLogout();\n      }\n      HashNavigation.navigateTo('');\n    });\n  }\n\n  static navigateToCredentialsView(params) {\n    const parsed = HashNavigation.parseUrlHash(window.location.hash);\n    parsed.path[0] = 'cred';\n    parsed.params['method'] = params.cred[0];\n    parsed.params['token'] = params.token;\n    HashNavigation.navigateTo(HashNavigation.composeUrlHash(parsed.path, parsed.params));\n  }\n\n  handleLoginSuccessful() {\n    this.handleError();\n\n    // Refresh authentication token.\n    if (LocalStorageUtil.getObject('keep-logged-in')) {\n      LocalStorageUtil.setObject('auth-token', this.tinode.getAuthToken());\n    }\n\n    const goToTopic = this.state.requestedTopic;\n    // Logged in fine, subscribe to 'me' attaching callbacks from the contacts view.\n    const me = this.tinode.getMeTopic();\n    me.onMetaDesc = this.tnMeMetaDesc;\n    me.onContactUpdate = this.tnMeContactUpdate;\n    me.onSubsUpdated = this.tnMeSubsUpdated;\n    this.setState({\n      connected: true,\n      credMethod: undefined,\n      credCode: undefined,\n      credToken: undefined,\n      myUserId: this.tinode.getCurrentUserID(),\n      autoLogin: true,\n      requestedTopic: undefined,\n    });\n    // Subscribe, fetch topic desc, the list of subscriptions. Messages are not fetched.\n    me.subscribe(\n      me.startMetaQuery().\n        withLaterSub().\n        withDesc().\n        withTags().\n        withCred().\n        build()\n      ).catch((err) => {\n        this.tinode.disconnect();\n        localStorage.removeItem('auth-token');\n        this.handleError(err.message, 'err');\n        HashNavigation.navigateTo('');\n      }).finally(() => {\n        this.setState({loadSpinnerVisible: false});\n      });\n    let urlHash = HashNavigation.setUrlSidePanel(window.location.hash, 'contacts');\n    if (goToTopic) {\n      urlHash = HashNavigation.setUrlTopic(urlHash, goToTopic);\n    }\n    HashNavigation.navigateTo(urlHash);\n  }\n\n  tnMeMetaDesc(desc) {\n    if (desc) {\n      if (desc.public) {\n        this.setState({\n          sidePanelTitle: desc.public.fn,\n          sidePanelAvatar: makeImageUrl(desc.public.photo)\n        });\n      }\n      if (desc.trusted) {\n        const badges = [];\n        for (const [key, val] of Object.entries(desc.trusted)) {\n          if (val) {\n            badges.push(key);\n          }\n        }\n        this.setState({\n          myTrustedBadges: badges,\n        });\n      }\n      if (desc.acs) {\n        this.setState({\n          incognitoMode: !desc.acs.isPresencer()\n        });\n      }\n    }\n  }\n\n  // Reactions to updates to the contact list.\n  tnMeContactUpdate(what, cont) {\n    if (what == 'on' || what == 'off') {\n      this.resetContactList();\n      if (this.state.topicSelected == cont.topic) {\n        this.setState({topicSelectedOnline: (what == 'on')});\n      }\n    } else if (what == 'read') {\n      this.resetContactList();\n    } else if (what == 'msg') {\n      // Check if the topic is archived. If so, don't play a sound.\n      const topic = this.tinode.getTopic(cont.topic);\n      const archived = topic && topic.isArchived();\n\n      // New message received. Maybe the message is from the current user, then unread is 0.\n      if (cont.unread > 0 && this.state.messageSounds && !archived) {\n        // Skip update if the topic is currently open, otherwise the badge will annoyingly flash.\n        if (document.hidden || this.state.topicSelected != cont.topic) {\n          POP_SOUND.play().catch(_ => {\n            // play() throws if the user did not click the app first: https://goo.gl/xX8pDD.\n          });\n        }\n      }\n      // Reorder contact list to use possibly updated 'touched'.\n      this.resetContactList();\n    } else if (what == 'recv') {\n      // Explicitly ignoring \"recv\" -- it causes no visible updates to contact list.\n    } else if (what == 'gone' || what == 'unsub') {\n      // Topic deleted or user unsubscribed. Remove topic from view.\n      // If the currently selected topic is gone, clear the selection.\n      if (this.state.topicSelected == cont.topic) {\n        this.handleTopicSelected(null);\n      }\n      // Redraw without the deleted topic.\n      this.resetContactList();\n    } else if (what == 'acs') {\n      // Permissions changed. If it's for the currently selected topic,\n      // update the views.\n      if (this.state.topicSelected == cont.topic) {\n        this.setState({topicSelectedAcs: cont.acs});\n      }\n    } else if (what == 'del') {\n      // TODO: messages deleted (hard or soft) -- update pill counter.\n    } else if (what == 'upd' || what == 'call') {\n      // upd, call - handled by the SDK. Explicitly ignoring here.\n    } else {\n      // TODO(gene): handle other types of notifications:\n      // * ua -- user agent changes (maybe display a pictogram for mobile/desktop).\n      console.info(\"Unsupported (yet) presence update:\", what, \"in\", cont.topic);\n    }\n  }\n\n  tnMeSubsUpdated(unused) {\n    this.resetContactList();\n  }\n\n  // Merge search results and contact list to create a single flat\n  // list of known contacts for GroupManager to use.\n  static prepareSearchableContacts(chatList, foundContacts) {\n    const merged = {};\n\n    // For chatList topics merge only p2p topics and convert them to the\n    // same format as foundContacts.\n    for (const c of chatList) {\n      if (Tinode.isP2PTopicName(c.topic)) {\n          merged[c.topic] = {\n            user: c.topic,\n            updated: c.updated,\n            public: c.public,\n            private: c.private,\n            acs: c.acs\n          };\n      }\n    }\n\n    // Add all foundCountacts if they have not been added already.\n    for (const c of foundContacts) {\n      if (!merged[c.user]) {\n        merged[c.user] = c;\n      }\n    }\n\n    return Object.values(merged);\n  }\n\n  resetContactList() {\n    const newState = {\n      chatList: []\n    };\n\n    if (!this.state.ready) {\n      newState.ready = true;\n    }\n\n    this.tinode.getMeTopic().contacts((c) => {\n      if (!c.topic && !c.user) {\n        // Contacts expect c.topic to be set.\n        c.topic = c.name;\n      }\n\n      newState.chatList.push(c);\n      if (this.state.topicSelected == c.topic) {\n        newState.topicSelectedOnline = c.online;\n        newState.topicSelectedAcs = c.acs;\n      }\n    });\n\n    const past = new Date(0);\n    newState.chatList.sort((a, b) => {\n      return (a.touched || past).getTime() - (b.touched || past).getTime();\n    });\n\n    // Merge search results and chat list.\n    newState.searchableContacts = TinodeWeb.prepareSearchableContacts(newState.chatList, this.state.searchResults);\n    this.setState(newState);\n  }\n\n  /* Fnd topic: find contacts by tokens */\n  tnInitFind() {\n    const fnd = this.tinode.getFndTopic();\n    fnd.onSubsUpdated = this.tnFndSubsUpdated;\n    if (fnd.isSubscribed()) {\n      this.tnFndSubsUpdated();\n    } else {\n      fnd.subscribe(fnd.startMetaQuery().withSub().build()).catch((err) => {\n        this.handleError(err.message, 'err');\n      });\n    }\n  }\n\n  tnFndSubsUpdated() {\n    const foundContacts = [];\n    // Don't attempt to create P2P topics which already exist. Server will reject the duplicates.\n    this.tinode.getFndTopic().contacts((s) => {\n      foundContacts.push(s);\n    });\n    this.setState({\n      searchResults: foundContacts,\n      searchableContacts: TinodeWeb.prepareSearchableContacts(this.state.chatList, foundContacts)\n    });\n  }\n\n  /** Called when the user enters a contact into the contact search field in the NewAccount panel\n    @param query {Array} is an array of contacts to search for\n   */\n  handleSearchContacts(query) {\n    const fnd = this.tinode.getFndTopic();\n    fnd.setMeta({desc: {public: query}}).then((ctrl) => {\n      return fnd.getMeta(fnd.startMetaQuery().withSub().build());\n    }).catch((err) => {\n      this.handleError(err.message, 'err');\n    });\n  }\n\n  // User clicked on a topic in the side panel or deleted a topic.\n  handleTopicSelected(topicName) {\n    // Clear newTopicParams after use.\n    if (this.state.newTopicParams && this.state.newTopicParams._topicName != topicName) {\n      this.setState({\n        newTopicParams: null\n      });\n    }\n\n    if (topicName) {\n      this.setState({\n        errorText: '',\n        errorLevel: null,\n        mobilePanel: 'topic-view',\n        infoPanel: undefined\n      });\n      // Different topic selected.\n      if (this.state.topicSelected != topicName) {\n        this.setState({\n          topicSelectedOnline: this.tinode.isTopicOnline(topicName),\n          topicSelectedAcs: this.tinode.getTopicAccessMode(topicName),\n          forwardMessage: null\n        });\n        HashNavigation.navigateTo(HashNavigation.setUrlTopic('', topicName));\n      }\n    } else {\n      // Currently selected contact deleted\n      this.setState({\n        errorText: '',\n        errorLevel: null,\n        mobilePanel: 'sidepanel',\n        topicSelectedOnline: false,\n        topicSelectedAcs: null,\n        infoPanel: undefined,\n        forwardMessage: null\n      });\n\n      HashNavigation.navigateTo(HashNavigation.setUrlTopic('', null));\n    }\n  }\n\n  // In mobile view user requested to show sidepanel\n  handleHideMessagesView() {\n    this.setState({\n      mobilePanel: 'sidepanel'\n    });\n    HashNavigation.navigateTo(HashNavigation.setUrlTopic(window.location.hash, null));\n  }\n\n  // User is sending a message, either plain text or a drafty object, possibly\n  // with attachments.\n  //  - msg - Drafty message with content\n  //  - promise - Promise to be resolved when the upload is completed\n  //  - uploadCompletionPromise - for tracking progress\n  //  - head - head dictionary to be attached to the message\n  handleSendMessage(msg, uploadCompletionPromise, uploader, head) {\n    const topic = this.tinode.getTopic(this.state.topicSelected);\n    /* TODO: check if return is required */\n    return this.sendMessageToTopic(topic, msg, uploadCompletionPromise, uploader, head);\n  }\n\n  sendMessageToTopic(topic, msg, uploadCompletionPromise, uploader, head) {\n    msg = topic.createMessage(msg, false);\n    // The uploader is used to show progress.\n    msg._uploader = uploader;\n\n    if (head) {\n      msg.head = Object.assign(msg.head || {}, head);\n    }\n\n    const completion = [];\n    if (uploadCompletionPromise) {\n      completion.push(uploadCompletionPromise);\n    }\n\n    if (!topic.isSubscribed()) {\n      // Topic is not subscribed yet. Subscribe.\n      const subscribePromise =\n        topic.subscribe()\n          .then(() => {\n            // If there are unsent messages (except video call messages),\n            // try sending them now. Unsent video call messages will be dropped.\n            let calls = [];\n            topic.queuedMessages(pub => {\n              if (pub._sending || pub.seq == msg.seq) {\n                return;\n              }\n              if (pub.head && pub.head.webrtc) {\n                // Filter out unsent video call messages.\n                calls.push(pub.seq);\n                return;\n              }\n              if (topic.isSubscribed()) {\n                topic.publishMessage(pub);\n              }\n            });\n            if (calls.length > 0) {\n              topic.delMessagesList(calls, true);\n            }\n          });\n      completion.push(subscribePromise);\n    }\n\n    // TODO: check if return is required.\n    return topic.publishDraft(msg, Promise.all(completion))\n      .then((ctrl) => {\n        if (topic.isArchived()) {\n          topic.archive(false);\n        }\n        return ctrl;\n      })\n      .catch((err) => {\n        this.handleError(err.message, 'err');\n      });\n  }\n\n  handleNewChatInvitation(topicName, action) {\n    const topic = this.tinode.getTopic(topicName);\n    let response = null;\n    switch (action) {\n      case 'accept':\n        // Accept given permissions.\n        const mode = topic.getAccessMode().getGiven();\n        response = topic.setMeta({sub: {mode: mode}});\n        if (topic.isP2PType()) {\n          // For P2P topics change 'given' permission of the peer too.\n          // In p2p topics the other user has the same name as the topic.\n          response = response.then((ctrl) => {\n            topic.setMeta({sub: {user: topicName, mode: mode}});\n          });\n        }\n        break;\n      case 'delete':\n        // Ignore invitation by deleting it.\n        response = topic.delTopic(true);\n        break;\n      case 'block':\n        // Ban the topic making futher invites impossible.\n        // Just self-ban.\n        const am = topic.getAccessMode().updateWant('-JP').getWant();\n        response = topic.setMeta({sub: {mode: am}}).then((ctrl) => {\n          return this.handleTopicSelected(null);\n        });\n        break;\n      default:\n        console.warn(\"Unknown invitation action\", '\"' + action + '\"\"');\n    }\n\n    if (response != null) {\n      response.catch((err) => {\n        this.handleError(err.message, 'err');\n      });\n    }\n  }\n\n  // User chose a Sign Up menu item.\n  handleNewAccount() {\n    this.handleError();\n\n    HashNavigation.navigateTo(HashNavigation.setUrlSidePanel(window.location.hash, 'register'));\n  }\n\n  // Actual registration of a new account.\n  handleNewAccountRequest(login_, password_, public_, cred_, tags_) {\n    // Clear old error, if any.\n    this.handleError();\n\n    this.tinode.connect(this.state.serverAddress)\n      .then(_ => {\n        let attachments;\n        if (public_ && public_.photo && public_.photo.ref) {\n          attachments = [public_.photo.ref];\n        }\n        return this.tinode.createAccountBasic(login_, password_,\n          {public: public_, tags: tags_, cred: Tinode.credential(cred_), attachments: attachments});\n      }).then(ctrl => {\n        if (ctrl.code >= 300 && ctrl.text == 'validate credentials') {\n          TinodeWeb.navigateToCredentialsView(ctrl.params);\n        } else {\n          this.handleLoginSuccessful(this);\n        }\n      }).catch(err => {\n        this.handleError(err.message, 'err');\n      });\n  }\n\n  handleToggleIncognitoMode(on) {\n    // Make state undefined.\n    this.setState({incognitoMode: null});\n\n    const me = this.tinode.getMeTopic();\n    const am = me.getAccessMode().updateWant(on ? '-P' : '+P').getWant();\n    me.setMeta({sub: {mode: am}}).catch((err) => {\n      // Request failed, keep existing state.\n      this.setState({incognitoMode: !on});\n      this.handleError(err.message, 'err');\n    });\n  }\n\n  handleUpdateAccountTagsRequest(tags) {\n    this.tinode.getMeTopic().setMeta({tags: tags})\n      .catch((err) => {\n        this.handleError(err.message, 'err');\n      });\n  }\n\n  // User chose Settings menu item.\n  handleSettings() {\n    this.handleError();\n\n    HashNavigation.navigateTo(HashNavigation.setUrlSidePanel(window.location.hash,\n      this.state.myUserId ? 'edit' : 'settings'));\n  }\n\n  // User updated global parameters.\n  handleGlobalSettings(settings) {\n    const serverAddress = settings.serverAddress || this.state.serverAddress;\n    const transport = settings.transport || this.state.transport;\n    const secureConnection = settings.secureConnection === undefined ?\n      this.state.secureConnection : settings.secureConnection;\n    if (this.tinode) {\n      this.tinode.clearStorage();\n      this.tinode.onDisconnect = undefined;\n      this.tinode.disconnect();\n    }\n    this.tinode = TinodeWeb.tnSetup(serverAddress, secureConnection, transport,\n      this.props.intl.locale, LocalStorageUtil.getObject('keep-logged-in'));\n    this.tinode.onConnect = this.handleConnected;\n    this.tinode.onDisconnect = this.handleDisconnect;\n    this.tinode.onAutoreconnectIteration = this.handleAutoreconnectIteration;\n    this.tinode.onInfoMessage = this.handleInfoMessage;\n    this.tinode.onDataMessage = this.handleDataMessage;\n\n    this.setState({\n      serverAddress: serverAddress,\n      transport: transport,\n      secureConnection: secureConnection,\n    });\n    LocalStorageUtil.setObject('settings', {\n      serverAddress: serverAddress,\n      transport: transport,\n      secureConnection: secureConnection,\n    });\n\n    HashNavigation.navigateTo(HashNavigation.setUrlSidePanel(window.location.hash, ''));\n  }\n\n  // User chose 'Archived chats'.\n  handleShowArchive() {\n    HashNavigation.navigateTo(HashNavigation.setUrlSidePanel(window.location.hash,\n      this.state.myUserId ? 'archive' : ''));\n  }\n\n  // User viewes 'Blocked chats'.\n  handleShowBlocked() {\n    HashNavigation.navigateTo(HashNavigation.setUrlSidePanel(window.location.hash,\n      this.state.myUserId ? 'blocked' : ''));\n  }\n\n  toggleFCMToken(enabled) {\n    if (enabled) {\n      this.setState({desktopAlerts: null});\n      if (!this.state.firebaseToken) {\n        this.initFCMessaging();\n      } else {\n        this.setState({desktopAlerts: true});\n        if (LocalStorageUtil.getObject('keep-logged-in')) {\n          LocalStorageUtil.updateObject('settings', {desktopAlerts: true});\n        }\n      }\n    } else if (this.state.firebaseToken && this.fcm) {\n      firebaseDelToken(this.fcm).catch((err) => {\n        console.error(\"Unable to delete token.\", err);\n      }).finally(() => {\n        LocalStorageUtil.updateObject('settings', {desktopAlerts: false});\n        localStorage.removeItem('firebase-token');\n        this.setState({desktopAlerts: false, firebaseToken: null});\n        // Inform the server that the token was deleted.\n        this.tinode.setDeviceToken(null);\n      });\n    } else {\n      this.setState({desktopAlerts: false, firebaseToken: null});\n      LocalStorageUtil.updateObject('settings', {desktopAlerts: false});\n    }\n  }\n\n  handleToggleMessageSounds(enabled) {\n    this.setState({messageSounds: enabled});\n    LocalStorageUtil.updateObject('settings', {\n      messageSoundsOff: !enabled\n    });\n  }\n\n  handleCredAdd(method, value) {\n    const me = this.tinode.getMeTopic();\n    me.setMeta({cred: {meth: method, val: value}}).catch((err) => {\n      this.handleError(err.message, 'err');\n    });\n  }\n\n  handleCredDelete(method, value) {\n    const me = this.tinode.getMeTopic();\n    me.delCredential(method, value).catch((err) => {\n      this.handleError(err.message, 'err');\n    });\n  }\n\n  handleCredConfirm(method, response) {\n    TinodeWeb.navigateToCredentialsView({cred: [method]});\n  }\n\n  // User clicked Cancel button in Setting or Sign Up panel.\n  handleSidepanelCancel() {\n    const parsed = HashNavigation.parseUrlHash(window.location.hash);\n    let path = '';\n    if (['security','support','general','notif'].includes(parsed.path[0])) {\n      path = 'edit';\n    } else if ('crop' == parsed.path[0]) {\n      path = 'general';\n    } else if ('blocked' == parsed.path[0]) {\n      path = 'security';\n    } else if (this.state.myUserId) {\n      path = 'contacts';\n    }\n    parsed.path[0] = path;\n    if (parsed.params) {\n      delete parsed.params.code;\n      delete parsed.params.method;\n      delete parsed.params.tab;\n      delete parsed.params.scheme;\n      delete parsed.params.token;\n    }\n    HashNavigation.navigateTo(HashNavigation.composeUrlHash(parsed.path, parsed.params));\n    this.setState({errorText: '', errorLevel: null});\n  }\n\n  // Sidepanel navigator. No need to bind to 'this'.\n  basicNavigator(hash) {\n    HashNavigation.navigateTo(HashNavigation.setUrlSidePanel(window.location.hash, hash));\n  }\n\n  // Topic info navigator. No need to bind to 'this'.\n  infoNavigator(hash) {\n    HashNavigation.navigateTo(HashNavigation.setUrlInfoPanel(window.location.hash, hash));\n  }\n\n  // Request to start a topic, new or selected from search results, or \"by ID\".\n  handleStartTopicRequest(topicName, newTopicParams, isChannel) {\n    // Check if topic is indeed new. If not, launch it.\n    if (topicName && this.tinode.isTopicCached(topicName)) {\n      this.handleTopicSelected(topicName);\n      return;\n    }\n\n    const params = {};\n    if (Tinode.isP2PTopicName(topicName)) {\n      // Because we are initialing the subscription, set 'want' to all permissions.\n      params.sub = {mode: DEFAULT_P2P_ACCESS_MODE};\n      // Give the other user all permissions too.\n      params.desc = {defacs: {auth: DEFAULT_P2P_ACCESS_MODE}};\n    } else {\n      topicName = topicName || this.tinode.newGroupTopicName(isChannel);\n      if (newTopicParams) {\n        params.desc = {public: newTopicParams.public, private: {comment: newTopicParams.private}};\n        params.tags = newTopicParams.tags;\n      }\n    }\n    params._topicName = topicName;\n    this.setState({newTopicParams: params}, () => {this.handleTopicSelected(topicName)});\n  }\n\n  // New topic was created, here is the new topic name.\n  handleNewTopicCreated(oldName, newName) {\n    let nextState = {};\n    if (this.state.callShouldStart) {\n      nextState = {callState: CALL_STATE_IN_PROGRESS, callShouldStart: false};\n    }\n    if (this.state.topicSelected == oldName && oldName != newName) {\n      // If the current URl contains the old topic name, replace it with new.\n      // Update the name of the selected topic first so the navigator doen't clear\n      // the state.\n      nextState.topicSelected = newName;\n    }\n    this.setState(nextState, _ => {\n      HashNavigation.navigateTo(HashNavigation.setUrlTopic('', newName));\n    });\n  }\n\n  handleTopicUpdateRequest(topicName, pub, priv, defacs) {\n    this.handleError();\n\n    const topic = this.tinode.getTopic(topicName);\n    if (topic) {\n      const params = {};\n      let attachments;\n      if (pub) {\n        if (pub.photo) {\n          if (pub.photo.ref && pub.photo.ref != Tinode.DEL_CHAR) {\n            attachments = [pub.photo.ref];\n          } else if (!pub.photo.data || pub.photo.data == Tinode.DEL_CHAR) {\n            pub.photo = Tinode.DEL_CHAR;\n          }\n        }\n        params.public = pub;\n      }\n\n      if (typeof priv == 'string') {\n        params.private = (priv === Tinode.DEL_CHAR) ?\n          Tinode.DEL_CHAR : {comment: priv};\n      }\n      if (defacs) {\n        params.defacs = defacs;\n      }\n      topic.setMeta({desc: params, attachments: attachments}).catch((err) => {\n        this.handleError(err.message, 'err');\n      });\n    }\n  }\n\n  handleUnarchive(topicName) {\n    const topic = this.tinode.getTopic(topicName);\n    if (topic) {\n      topic.archive(false).catch((err) => {\n        this.handleError(err.message, 'err');\n      });\n    }\n  }\n\n  handleUpdatePasswordRequest(password)  {\n    this.handleError();\n\n    if (password) {\n      this.tinode.updateAccountBasic(null, this.tinode.getCurrentLogin(), password).catch((err) => {\n        this.handleError(err.message, 'err');\n      });\n    }\n  }\n\n  handleChangePermissions(topicName, mode, uid) {\n    const topic = this.tinode.getTopic(topicName);\n    if (topic) {\n      const am = topic.getAccessMode();\n      if (uid) {\n        am.updateGiven(mode);\n        mode = am.getGiven();\n      } else {\n        am.updateWant(mode);\n        mode = am.getWant();\n      }\n      topic.setMeta({sub: {user: uid, mode: mode}}).catch((err) => {\n        this.handleError(err.message, 'err');\n      });\n    }\n  }\n\n  handleTagsUpdateRequest(topicName, tags) {\n    const topic = this.tinode.getTopic(topicName);\n    if (topic) {\n      topic.setMeta({tags: tags}).catch((err) => {\n        this.handleError(err.message, 'err');\n      });\n    }\n  }\n\n  handleLogout() {\n    updateFavicon(0);\n\n    // Remove stored data.\n    localStorage.removeItem('auth-token');\n    localStorage.removeItem('firebase-token');\n    localStorage.removeItem('settings');\n    if (this.state.firebaseToken) {\n      firebaseDelToken(this.fcm);\n    }\n\n    clearInterval(this.reconnectCountdown);\n\n    let cleared;\n    if (this.tinode) {\n      cleared = this.tinode.clearStorage();\n      this.tinode.onDisconnect = undefined;\n      this.tinode.disconnect();\n    } else {\n      cleared = Promose.resolve();\n    }\n    this.setState(this.getBlankState());\n\n    cleared.then(() => {\n      this.tinode = TinodeWeb.tnSetup(this.state.serverAddress, isSecureConnection(),\n        this.state.transport, this.props.intl.locale, LocalStorageUtil.getObject('keep-logged-in'), () => {\n          this.tinode.onConnect = this.handleConnected;\n          this.tinode.onDisconnect = this.handleDisconnect;\n          this.tinode.onAutoreconnectIteration = this.handleAutoreconnectIteration;\n          this.tinode.onInfoMessage = this.handleInfoMessage;\n          this.tinode.onDataMessage = this.handleDataMessage;\n          HashNavigation.navigateTo('');\n        })\n    });\n  }\n\n  handleDeleteAccount() {\n    this.tinode.delCurrentUser(true).then(_ => {\n      this.handleLogout();\n    });\n  }\n\n  handleDeleteTopicRequest(topicName) {\n    const topic = this.tinode.getTopic(topicName);\n    if (!topic) {\n      return;\n    }\n\n    // Request to hard-delete topic.\n    topic.delTopic(true).then((ctrl) => {\n      // Hide MessagesView and InfoView panels.\n      HashNavigation.navigateTo(HashNavigation.setUrlTopic(window.location.hash, ''));\n    }).catch((err) => {\n      this.handleError(err.message, 'err');\n    });\n  }\n\n  handleDeleteMessagesRequest(topicName) {\n    const topic = this.tinode.getTopic(topicName);\n    if (!topic) {\n      return;\n    }\n\n    // Request hard-delete all messages.\n    topic.delMessagesAll(true).catch((err) => {\n      this.handleError(err.message, 'err');\n    });\n  }\n\n  handleLeaveUnsubRequest(topicName) {\n    const topic = this.tinode.getTopic(topicName);\n    if (!topic) {\n      return;\n    }\n\n    topic.leave(true).then((ctrl) => {\n      // Hide MessagesView and InfoView panels.\n      HashNavigation.navigateTo(HashNavigation.setUrlTopic(window.location.hash, ''));\n    }).catch((err) => {\n      this.handleError(err.message, 'err');\n    });\n  }\n\n  handleBlockTopicRequest(topicName) {\n    const topic = this.tinode.getTopic(topicName);\n    if (!topic) {\n      return;\n    }\n\n    topic.updateMode(null, '-JP').then(_ => {\n      // Hide MessagesView and InfoView panels.\n      HashNavigation.navigateTo(HashNavigation.setUrlTopic(window.location.hash, ''));\n    }).catch((err) => {\n      this.handleError(err.message, 'err');\n    });\n  }\n\n  handleReportTopic(topicName) {\n    const topic = this.tinode.getTopic(topicName);\n    if (!topic) {\n      return;\n    }\n\n    // Publish spam report.\n    this.tinode.report('report', topicName);\n\n    // Remove J and P permissions.\n    topic.updateMode(null, '-JP').then((ctrl) => {\n      // Hide MessagesView and InfoView panels.\n      HashNavigation.navigateTo(HashNavigation.setUrlTopic(window.location.hash, ''));\n    }).catch((err) => {\n      this.handleError(err.message, 'err');\n    });\n  }\n\n  handleShowContextMenu(params, menuItems) {\n    this.setState({\n      contextMenuVisible: true,\n      contextMenuClickAt: {x: params.x, y: params.y},\n      contextMenuParams: params,\n      contextMenuItems: menuItems || this.defaultTopicContextMenu(params.topicName),\n      contextMenuBounds: this.selfRef.current.getBoundingClientRect()\n    });\n  }\n\n  //\n  handleShowForwardDialog(params) {\n    if (this.state.sidePanelSelected == 'newtpk') {\n      // If the Find panel is active, close it.\n      this.handleSidepanelCancel();\n    }\n    const header = '➦ ' + params.userName;\n    const content = typeof params.content == 'string' ? Drafty.init(params.content) : Drafty.forwardedContent(params.content);\n    const preview = Drafty.preview(content, FORWARDED_PREVIEW_LENGTH, true);\n    const msg = Drafty.append(Drafty.appendLineBreak(Drafty.mention(header, params.userFrom)), content);\n    const msgPreview = Drafty.quote(header, params.userFrom, preview);\n\n    const head = {\n      forwarded: params.topicName + ':' + params.seq\n    };\n    this.setState({\n      forwardDialogVisible: true,\n      forwardMessage: { head: head, msg: msg, preview: msgPreview }\n    });\n  }\n\n  defaultTopicContextMenu(topicName) {\n    const topic = this.tinode.getTopic(topicName);\n\n    if (topic._deleted) {\n      return [\n        'topic_delete'\n      ];\n    }\n\n    let muted = false, blocked = false, self_blocked = false, subscribed = false, deleter = false,\n      archived = false, webrtc = false;\n    if (topic) {\n      subscribed = topic.isSubscribed();\n      archived = topic.isArchived();\n\n      const acs = topic.getAccessMode();\n      if (acs) {\n        muted = acs.isMuted();\n        blocked = !acs.isJoiner();\n        self_blocked = !acs.isJoiner('want');\n        deleter = acs.isDeleter();\n      }\n    }\n\n    webrtc = !!this.tinode.getServerParam('iceServers');\n\n    return [\n      subscribed ? {\n        title: this.props.intl.formatMessage(messages.menu_item_info),\n        handler: this.handleShowInfoView\n      } : null,\n      subscribed && Tinode.isP2PTopicName(topicName) && webrtc ? {\n        title: this.props.intl.formatMessage(messages.menu_item_video_call),\n        handler: this.handleStartVideoCall\n      } : null,\n      subscribed ? 'messages_clear' : null,\n      subscribed && deleter ? 'messages_clear_hard' : null,\n      muted ? (blocked ? null : 'topic_unmute') : 'topic_mute',\n      self_blocked ? 'topic_unblock' : 'topic_block',\n      archived ? 'topic_restore' : 'topic_archive',\n      'topic_delete'\n    ];\n  }\n\n  handleHideContextMenu() {\n    this.setState({\n      contextMenuVisible: false,\n      contextMenuClickAt: null,\n      contextMenuParams: null,\n      contextMenuBounds: null\n    });\n  }\n\n  handleHideForwardDialog(keepForwardedMessage) {\n    this.setState({\n      forwardDialogVisible: false,\n      forwardMessage: keepForwardedMessage ? this.state.forwardMessage : null\n    });\n  }\n\n  handleContextMenuAction(action, promise, params) {\n    if (action == 'topic_archive') {\n      if (promise && params.topicName && params.topicName == this.state.topicSelected) {\n        promise.then(() => {\n          this.handleTopicSelected(null);\n        });\n      }\n    } else if (action == 'menu_item_forward') {\n      this.handleShowForwardDialog(params);\n    }\n  }\n\n  handleShowAlert(title, content, onConfirm, confirmText, onReject, rejectText) {\n    this.setState({\n      alertVisible: true,\n      alertParams: {\n        title: title,\n        content: content,\n        onConfirm: onConfirm,\n        confirm: confirmText,\n        onReject: onReject,\n        reject: rejectText\n      }\n    });\n  }\n\n  handleShowInfoView() {\n    HashNavigation.navigateTo(HashNavigation.addUrlParam(window.location.hash, 'info', 'info'));\n    this.setState({infoPanel: 'info'});\n  }\n\n  handleMemberUpdateRequest(topicName, added, removed) {\n    if (!topicName) {\n      return;\n    }\n\n    const topic = this.tinode.getTopic(topicName);\n    if (!topic) {\n      return;\n    }\n\n    if (added && added.length > 0) {\n      added.map((uid) => {\n        topic.invite(uid, null).catch((err) => {\n          this.handleError(err.message, 'err');\n        });\n      });\n    }\n\n    if (removed && removed.length > 0) {\n      removed.map((uid) => {\n        topic.delSubscription(uid).catch((err) => {\n          this.handleError(err.message, 'err');\n        });\n      });\n    }\n  }\n\n  handleValidateCredentialsRequest(cred, code, token) {\n    if (this.tinode.isAuthenticated()) {\n      // Adding new email or phone number in account setting.\n      this.tinode.getMeTopic().setMeta({cred: {meth: cred, resp: code}})\n        .catch((err) => {\n          this.handleError(err.message, 'err');\n        });\n    } else {\n      // Credential validation on signup.\n      this.setState({credMethod: cred, credCode: code, credToken: token});\n      this.doLogin(null, null, token, {meth: cred, resp: code});\n    }\n  }\n\n  handlePasswordResetRequest(method, value) {\n    // If already connected, connnect() will return a resolved promise.\n    return this.tinode.connect()\n      .then(() => {\n        return this.tinode.requestResetAuthSecret('basic', method, value);\n      })\n      .catch((err) => {\n        // Socket error\n        this.handleError(err.message, 'err');\n      });\n  }\n\n  handleResetPassword(scheme, newPassword, token) {\n    token = base64ReEncode(token);\n    if (!token) {\n      this.handleError(this.props.intl.formatMessage(messages.invalid_security_token), 'err');\n    } else {\n      this.tinode.connect()\n        .then(() => {\n          return this.tinode.updateAccountBasic(null, null, newPassword, {token: token});\n        })\n        .then(() => {\n          HashNavigation.navigateTo('');\n        })\n        .catch((err) => {\n          // Socket error\n          this.handleError(err.message, 'err');\n        });\n    }\n  }\n\n  handleStartVideoCall() {\n    this.setState({\n      callTopic: this.state.topicSelected,\n      callState: CALL_STATE_OUTGOING_INITATED\n    });\n  }\n\n  handleCallInvite(callTopic, callSeq, callState) {\n    switch (callState) {\n      case CALL_STATE_OUTGOING_INITATED:\n        let head = { webrtc: CALL_HEAD_STARTED };\n        this.handleSendMessage(Drafty.videoCall(), undefined, undefined, head)\n          .then((ctrl) => {\n            if (ctrl.code < 200 || ctrl.code >= 300 || !ctrl.params || !ctrl.params.seq) {\n              this.handleCallClose();\n              return;\n            }\n            this.setState({callSeq: ctrl.params['seq']});\n          });\n        break;\n      case CALL_STATE_IN_PROGRESS:\n        const topic = this.tinode.getTopic(callTopic);\n        if (!topic) {\n          return;\n        }\n        // We've accepted the call. Let the other side know.\n        topic.videoCall('accept', callSeq);\n        break;\n    }\n  }\n\n  handleCallRinging(callTopic, callSeq) {\n    const topic = this.tinode.getTopic(callTopic);\n    if (!topic) {\n      return;\n    }\n\n    topic.videoCall('ringing', callSeq);\n  }\n\n  handleCallHangup(callTopic, callSeq) {\n    const topic = this.tinode.getTopic(callTopic);\n    if (!topic) {\n      return;\n    }\n\n    topic.videoCall('hang-up', callSeq);\n  }\n\n  handleCallSendOffer(callTopic, callSeq, sdp) {\n    const topic = this.tinode.getTopic(callTopic);\n    if (!topic) {\n      return;\n    }\n\n    topic.videoCall('offer', callSeq, sdp);\n  }\n\n  handleCallIceCandidate(callTopic, callSeq, candidate) {\n    const topic = this.tinode.getTopic(callTopic);\n    if (!topic) {\n      return;\n    }\n\n    topic.videoCall('ice-candidate', callSeq, candidate);\n  }\n  handleCallSendAnswer(callTopic, callSeq, sdp) {\n    const topic = this.tinode.getTopic(callTopic);\n    if (!topic) {\n      return;\n    }\n\n    topic.videoCall('answer', callSeq, sdp);\n  }\n\n  handleCallClose() {\n    if (this.callTimeoutTimer) {\n      clearTimeout(this.callTimeoutTimer);\n    }\n    this.setState({\n      callTopic: undefined,\n      callState: CALL_STATE_NONE\n    });\n  }\n\n  handleCallAcceptCall(topicName) {\n    const topic = this.tinode.getTopic(topicName);\n    if (!topic) {\n      return;\n    }\n    if (topic.isSubscribed()) {\n      this.handleTopicSelected(this.state.callTopic);\n      this.setState({\n        callState: CALL_STATE_IN_PROGRESS\n      });\n    } else {\n      // We need to switch and subscribe to callTopic first.\n      this.setState({\n        callShouldStart: true,\n      }, () => this.handleTopicSelected(this.state.callTopic));\n    }\n  }\n\n  handleInfoMessage(info) {\n    if (info.what != 'call') {\n      return;\n    }\n    switch (info.event) {\n      case 'accept':\n        // If another my session has accepted the call.\n        if (Tinode.isMeTopicName(info.topic) && this.tinode.isMe(info.from)) {\n          this.setState({\n            callTopic: null,\n            callState: CALL_STATE_NONE,\n            callSeq: null\n          });\n          return;\n        }\n        if (info.topic == this.state.callTopic) {\n          // Update state.\n          this.setState({callState: CALL_STATE_IN_PROGRESS});\n        }\n        break;\n      case 'hang-up':\n        // Remote hangup.\n        this.handleCallClose();\n        break;\n    }\n  }\n\n  handleDataMessage(data) {\n    if (data.head && data.head.webrtc && data.head.webrtc == CALL_HEAD_STARTED) {\n      // If it's a video call invite message.\n      // See if we need to display incoming call UI.\n      const topic = this.tinode.getTopic(data.topic);\n      if (topic) {\n        // Check if a later version of the message exists (which means the call\n        // has been either accepted or finished already).\n        const msg = topic.latestMsgVersion(data.seq) || data;\n        if (msg.head && msg.head.webrtc && msg.head.webrtc == CALL_HEAD_STARTED) {\n          // This is a legit new call.\n          if (data.from != this.state.myUserId) {\n            if (this.state.callState == CALL_STATE_NONE) {\n              // Incoming call.\n              this.setState({\n                callTopic: data.topic,\n                callState: CALL_STATE_INCOMING_RECEIVED,\n                callSeq: data.seq\n              });\n            } else {\n              // Another call is either in progress or being established.\n              // Reject the incoming call.\n              this.handleCallHangup(data.topic, data.seq);\n            }\n          }\n        }\n      } else {\n        console.warn(\"Received vc data message from unknown topic\", data.topic);\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div id=\"app-container\" ref={this.selfRef}>\n        {this.state.contextMenuVisible ?\n          <ContextMenu\n            tinode={this.tinode}\n            bounds={this.state.contextMenuBounds}\n            clickAt={this.state.contextMenuClickAt}\n            params={this.state.contextMenuParams}\n            items={this.state.contextMenuItems}\n            hide={this.handleHideContextMenu}\n            onShowAlert={this.handleShowAlert}\n            onAction={this.handleContextMenuAction}\n            onTopicRemoved={(topicName) => {\n              if (topicName == this.state.topicSelected) {\n                this.handleTopicSelected(null);\n              }\n            }}\n            onError={this.handleError} />\n          :\n          null\n        }\n        {this.state.forwardDialogVisible ?\n          <ForwardDialog\n            tinode={this.tinode}\n            contacts={this.state.chatList}\n            topicSelected={this.state.topicSelected}\n            myUserId={this.state.myUserId}\n\n            hide={this.handleHideForwardDialog}\n            onInitFind={this.tnInitFind}\n            searchResults={this.state.searchResults}\n            onSearchContacts={this.handleSearchContacts}\n            onTopicSelected={this.handleStartTopicRequest}\n          />\n          :\n          null\n        }\n        {this.state.callTopic && this.state.callState == CALL_STATE_INCOMING_RECEIVED ?\n          <CallIncoming\n            tinode={this.tinode}\n            onClose={this.handleCallClose}\n            topic={this.state.callTopic}\n            seq={this.state.callSeq}\n            callState={this.state.callState}\n            onRinging={this.handleCallRinging}\n            onAcceptCall={this.handleCallAcceptCall}\n            onReject={this.handleCallHangup}\n            />\n          :\n          null\n        }\n        <Alert\n          visible={this.state.alertVisible}\n          title={this.state.alertParams.title}\n          content={this.state.alertParams.content}\n          onReject={this.state.alertParams.onReject ? (() => { this.setState({alertVisible: false}); }) : null}\n          reject={this.state.alertParams.reject}\n          onConfirm={() => { this.setState({alertVisible: false}); this.state.alertParams.onConfirm(); }}\n          confirm={this.state.alertParams.confirm}\n          />\n        <SidepanelView\n          tinode={this.tinode}\n          connected={this.state.connected}\n          displayMobile={this.state.displayMobile}\n          hideSelf={this.state.displayMobile && this.state.mobilePanel !== 'sidepanel'}\n          state={this.state.sidePanelSelected}\n          title={this.state.sidePanelTitle}\n          avatar={this.state.sidePanelAvatar}\n          trustedBadges={this.state.myTrustedBadges}\n          login={this.state.login}\n          persist={this.state.persist}\n          myUserId={this.state.myUserId}\n          loginDisabled={this.state.loginDisabled}\n          loadSpinnerVisible={this.state.loadSpinnerVisible}\n\n          errorText={this.state.errorText}\n          errorLevel={this.state.errorLevel}\n          errorAction={this.state.errorAction}\n          errorActionText={this.state.errorActionText}\n\n          topicSelected={this.state.topicSelected}\n          chatList={this.state.chatList}\n          credMethod={this.state.credMethod}\n          credCode={this.state.credCode}\n          credToken={this.state.credToken}\n\n          transport={this.state.transport}\n          messageSounds={this.state.messageSounds}\n          desktopAlerts={this.state.desktopAlerts}\n          desktopAlertsEnabled={this.state.desktopAlertsEnabled}\n          incognitoMode={this.state.incognitoMode}\n          serverAddress={this.state.serverAddress}\n          secureConnection={this.state.secureConnection}\n          serverVersion={this.state.serverVersion}\n\n          onGlobalSettings={this.handleGlobalSettings}\n          onSignUp={this.handleNewAccount}\n          onSettings={this.handleSettings}\n          onNavigate={this.basicNavigator}\n          onLoginRequest={this.handleLoginRequest}\n          onPersistenceChange={this.handlePersistenceChange}\n          onCreateAccount={this.handleNewAccountRequest}\n          onUpdateAccountDesc={this.handleTopicUpdateRequest}\n          onUpdatePassword={this.handleUpdatePasswordRequest}\n          onUpdateAccountTags={this.handleUpdateAccountTagsRequest}\n          onTogglePushNotifications={this.toggleFCMToken}\n          onToggleMessageSounds={this.handleToggleMessageSounds}\n          onToggleIncognitoMode={this.handleToggleIncognitoMode}\n          onCredAdd={this.handleCredAdd}\n          onCredDelete={this.handleCredDelete}\n          onCredConfirm={this.handleCredConfirm}\n          onTopicSelected={this.handleTopicSelected}\n          onCreateTopic={this.handleStartTopicRequest}\n          onLogout={this.handleLogout}\n          onDeleteAccount={this.handleDeleteAccount}\n          onShowAlert={this.handleShowAlert}\n          onCancel={this.handleSidepanelCancel}\n          onError={this.handleError}\n          onValidateCredentials={this.handleValidateCredentialsRequest}\n          onPasswordResetRequest={this.handlePasswordResetRequest}\n          onResetPassword={this.handleResetPassword}\n          onShowArchive={this.handleShowArchive}\n          onShowBlocked={this.handleShowBlocked}\n\n          onInitFind={this.tnInitFind}\n          searchResults={this.state.searchResults}\n          onSearchContacts={this.handleSearchContacts}\n\n          showContextMenu={this.handleShowContextMenu} />\n\n        <MessagesView\n          tinode={this.tinode}\n          connected={this.state.connected}\n          ready={this.state.ready}\n          online={this.state.topicSelectedOnline}\n          acs={this.state.topicSelectedAcs}\n          displayMobile={this.state.displayMobile}\n          viewportWidth={this.state.viewportWidth}\n          viewportHeight={this.state.viewportHeight}\n          hideSelf={this.state.displayMobile &&\n            (this.state.mobilePanel !== 'topic-view' || this.state.infoPanel)}\n          topic={this.state.topicSelected}\n          myUserId={this.state.myUserId}\n          // User public.fn.\n          myUserName={this.state.sidePanelTitle}\n          serverVersion={this.state.serverVersion}\n          serverAddress={this.state.serverAddress}\n          applicationVisible={this.state.applicationVisible}\n\n          forwardMessage={this.state.forwardMessage}\n          onCancelForwardMessage={this.handleHideForwardDialog}\n\n          callTopic={this.state.callTopic}\n          callSeq={this.state.callSeq}\n          callState={this.state.callState}\n          onCallHangup={this.handleCallHangup}\n\n          onCallInvite={this.handleCallInvite}\n          onCallSendOffer={this.handleCallSendOffer}\n          onCallIceCandidate={this.handleCallIceCandidate}\n          onCallSendAnswer={this.handleCallSendAnswer}\n\n          errorText={this.state.errorText}\n          errorLevel={this.state.errorLevel}\n          errorAction={this.state.errorAction}\n          errorActionText={this.state.errorActionText}\n\n          newTopicParams={this.state.newTopicParams}\n\n          onHideMessagesView={this.handleHideMessagesView}\n          onError={this.handleError}\n          onNewTopicCreated={this.handleNewTopicCreated}\n          showContextMenu={this.handleShowContextMenu}\n          onChangePermissions={this.handleChangePermissions}\n          onNewChat={this.handleNewChatInvitation}\n          sendMessage={this.handleSendMessage}\n          onVideoCallClosed={this.handleCallClose} />\n\n        {this.state.infoPanel ?\n          <InfoView\n            tinode={this.tinode}\n            connected={this.state.connected}\n            displayMobile={this.state.displayMobile}\n            topic={this.state.topicSelected}\n            searchableContacts={this.state.searchableContacts}\n            myUserId={this.state.myUserId}\n            panel={this.state.infoPanel}\n\n            errorText={this.state.errorText}\n            errorLevel={this.state.errorLevel}\n            errorAction={this.state.errorAction}\n            errorActionText={this.state.errorActionText}\n\n            onNavigate={this.infoNavigator}\n            onTopicDescUpdateRequest={this.handleTopicUpdateRequest}\n            onShowAlert={this.handleShowAlert}\n            onChangePermissions={this.handleChangePermissions}\n            onMemberUpdateRequest={this.handleMemberUpdateRequest}\n            onDeleteTopic={this.handleDeleteTopicRequest}\n            onDeleteMessages={this.handleDeleteMessagesRequest}\n            onLeaveTopic={this.handleLeaveUnsubRequest}\n            onBlockTopic={this.handleBlockTopicRequest}\n            onReportTopic={this.handleReportTopic}\n            onAddMember={this.handleManageGroupMembers}\n            onTopicTagsUpdateRequest={this.handleTagsUpdateRequest}\n            onTopicUnArchive={this.handleUnarchive}\n            onInitFind={this.tnInitFind}\n            onError={this.handleError}\n\n            showContextMenu={this.handleShowContextMenu}\n            />\n          :\n          null\n        }\n      </div>\n    );\n  }\n};\n\nexport default injectIntl(TinodeWeb);\n","// Put all packages together.\n// Used to generate umd/index.prod.js\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { IntlProvider } from 'react-intl';\n\nimport allMessages from './messages.json';\nimport TinodeWeb from './views/tinode-web.jsx';\nimport HashNavigation from './lib/navigation.js';\n\n// Detect human language to use in the UI:\n//  Check parameters from URL hash #?hl=ru, then browser, then use 'en' as a fallback.\nconst { params } = HashNavigation.parseUrlHash(window.location.hash);\nconst language = (params && params.hl) ||\n  (navigator.languages && navigator.languages[0]) ||\n  navigator.language ||\n  navigator.userLanguage ||\n  'en';\n\n// Get the base language 'en' from a more specific 'en_GB' or 'en-US' as a partial fallback.\nconst baseLanguage = language.toLowerCase().split(/[-_]/)[0];\n\n// Try the full locale first, then the locale without the region code, fallback to 'en'.\nconst htmlLang = allMessages[language] ? language : allMessages[baseLanguage] ? baseLanguage : 'en';\nconst messages = allMessages[htmlLang];\n\n// Set lang attribute of the HTML element: <html lang=\"XX\">\ndocument.getElementsByTagName('html')[0].setAttribute('lang', htmlLang);\n\nReactDOM.render(\n  <React.StrictMode>\n    <IntlProvider locale={language} messages={messages} textComponent={React.Fragment}>\n      <TinodeWeb />\n    </IntlProvider>\n  </React.StrictMode>,\n  document.getElementById('mountPoint')\n);\n"],"names":["exports","byteLength","b64","lens","getLens","validLen","placeHoldersLen","toByteArray","tmp","i","arr","Arr","_byteLength","curByte","len","revLookup","charCodeAt","fromByteArray","uint8","length","extraBytes","parts","maxChunkLength","len2","push","encodeChunk","lookup","join","Uint8Array","Array","code","Error","indexOf","start","end","num","output","base64","ieee754","customInspectSymbol","Symbol","Buffer","SlowBuffer","alloc","INSPECT_MAX_BYTES","K_MAX_LENGTH","createBuffer","RangeError","buf","Object","setPrototypeOf","prototype","arg","encodingOrOffset","TypeError","allocUnsafe","from","value","string","encoding","isEncoding","actual","write","slice","fromString","ArrayBuffer","isView","arrayView","isInstance","copy","fromArrayBuffer","buffer","byteOffset","fromArrayLike","fromArrayView","SharedArrayBuffer","valueOf","b","obj","isBuffer","checked","undefined","numberIsNaN","type","isArray","data","fromObject","toPrimitive","assertSize","size","array","toString","mustMatch","arguments","loweredCase","utf8ToBytes","base64ToBytes","toLowerCase","slowToString","this","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","n","m","bidirectionalIndexOf","val","dir","arrayIndexOf","call","lastIndexOf","indexSize","arrLength","valLength","String","read","readUInt16BE","foundIndex","found","j","hexWrite","offset","Number","remaining","strLen","parsed","parseInt","substr","utf8Write","blitBuffer","asciiWrite","str","byteArray","asciiToBytes","base64Write","ucs2Write","units","c","hi","lo","utf16leToBytes","Math","min","res","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","apply","decodeCodePointsArray","kMaxLength","TYPED_ARRAY_SUPPORT","proto","foo","e","typedArraySupport","console","error","defineProperty","enumerable","get","poolSize","fill","allocUnsafeSlow","_isBuffer","compare","a","x","y","concat","list","pos","set","swap16","swap32","swap64","toLocaleString","equals","inspect","max","replace","trim","target","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","ret","out","hexSliceLookupTable","bytes","checkOffset","ext","checkInt","checkIEEE754","writeFloat","littleEndian","noAssert","writeDouble","newBuf","subarray","readUintLE","readUIntLE","mul","readUintBE","readUIntBE","readUint8","readUInt8","readUint16LE","readUInt16LE","readUint16BE","readUint32LE","readUInt32LE","readUint32BE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUintLE","writeUIntLE","writeUintBE","writeUIntBE","writeUint8","writeUInt8","writeUint16LE","writeUInt16LE","writeUint16BE","writeUInt16BE","writeUint32LE","writeUInt32LE","writeUint32BE","writeUInt32BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","copyWithin","INVALID_BASE64_RE","Infinity","leadSurrogate","split","base64clean","src","dst","constructor","name","alphabet","table","i16","BufferReader","module","block","reader","trackNumber","nextUIntV","timecode","nextInt16BE","flags","nextUInt8","invisible","keyframe","discardable","lacing","frames","nextBuffer","frameSize","framesNum","frameSizes","nextIntV","readLacedData","vint","v","signed","tools","readVint","writeVint","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","d","s","NaN","rt","abs","isNaN","floor","log","LN2","storage","UNDEFINED","BUFFER","UINT8ARRAY","ARRAYBUFFER","ZERO","BIT32","factory","bigendian","unsigned","posH","posL","pos0","pos1","pos2","pos3","fromPositive","fromPositiveBE","fromPositiveLE","fromNegative","fromNegativeBE","fromNegativeLE","Int64","isName","_isInt64","toNumber","radix","high","readInt32","low","sign","mod","toArray","toBuffer","toArrayBuffer","raddix","that","newArray","isValidBuffer","chr","writeInt32","fromArray","init","raw","dest","arrbuf","destbuf","destoff","srcbuf","srcoff","nodeName","byEbmlID","level","multiple","webm","description","mandatory","cppname","range","maxver","minver","divx","crc","byName","schema","ebmlID","State","tools_1","int64_buffer_1","EBMLDecoder","_buffer","_tag_stack","_state","STATE_TAG","_cursor","_total","_schema","_result","decode","chunk","readChunk","diff","readTag","STATE_SIZE","readSize","STATE_CONTENT","readContent","getSchemaInfo","tagNum","tag","reduce","o","tagObj","EBML_ID","tagStart","tagEnd","sizeStart","sizeEnd","dataStart","dataEnd","dataSize","unknownSize","isEnd","elm","assign","pop","warn","convertEBMLDateToJSDate","Int64BE","topEle","EBMLEncoder","_buffers","_stack","encode","elms","_this","lst","endTag","startTag","writeTag","flush","tagName","tagNums","keys","map","tagId","tagData","encodeTag","children","childTagDataBuffers","child","childTagDataBuffer","extendStatics","__extends","__proto__","p","hasOwnProperty","__","create","events_1","EBMLReader","_super","logGroup","hasLoggingStarted","metadataloaded","chunks","stack","segmentOffset","last2SimpleBlockVideoTrackTimecode","last2SimpleBlockAudioTrackTimecode","lastClusterTimecode","lastClusterPosition","timecodeScale","metadataSize","metadatas","cues","firstVideoBlockRead","firstAudioBlockRead","currentTrack","TrackNumber","TrackType","DefaultDuration","CodecDelay","trackTypes","trackDefaultDuration","trackCodecDelay","trackInfo","ended","logging","use_duration_every_simpleblock","use_webp","use_segment_info","drop_default_duration","stop","emit_segment_info","groupEnd","duration","emit","videoTrackNum","audioTrackNum","drop","parent_1","_a","ebmlBlock","frames_1","CueTime","CueTrack","CueClusterPosition","forEach","frame","webpBuf","VP8BitStreamToRiffWebPBuffer","webp","Blob","currentTime","put","defaultDuration","codecDelay","lastTimecode","_defaultDuration","delay","configurable","addListener","event","listener","groupCollapsed","group","EventEmitter","EBMLDecoder_1","default","EBMLReader_1","EBMLEncoder_1","_Buffer","_tools","_block","WebPBlockFilter","some","VP8Chunk","createRIFFChunk","FourCC","chunkSize","removeElement","idName","metadata","element","splice","extractElement","result","encodedSizeOfEbml","refinedMetaData","encorder","refineMetadata","mesetadata","sizeDiff","info","clusterPtrs","_metadata","overwrited_1","createFloatBuffer","insertTag","cueInfos","createUIntBuffer","create_cue","seekhead_children","seeks","create_seek_from_clusters","insertHead","idx","reverse","unshift","Uint64BE","createIntBuffer","readBlock","WebPFrameFilter","makeMetadataSeekable","originalMetadata","cuesInfo","header","segmentContentStartPos","originalMetadataSize","infoSize","tracks","tracksSize","seekHeadSize","seekHead","cuesSize","lastSizeDifference","_loop_1","infoStart","tracksStart","cuesStart","sizeDifference","maxIterations","finalMetadata","putRefinedMetaData","ebml","payload","i_1","shift","originalPayloadOffsetEnd","ebmlSize","offsetDiff","payloadSize","segmentTagBuf","segmentSizeBuf","_segmentSize","newPayloadSize","refined","newNewRefinedSize","encodeValueToBuffer","getTime","int64str","Date","_events","_maxListeners","isFunction","isObject","isUndefined","defaultMaxListeners","setMaxListeners","er","handler","args","listeners","err","context","newListener","warned","trace","on","once","fired","g","removeListener","position","removeAllListeners","key","listenerCount","evlistener","emitter","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","definition","globalThis","Function","window","prop","React","ReactDOM","ReactIntl","stringToByteArray$1","byteToCharMap_","charToByteMap_","byteToCharMapWebSafe_","charToByteMapWebSafe_","ENCODED_VALS_BASE","ENCODED_VALS","ENCODED_VALS_WEBSAFE","HAS_NATIVE_SUPPORT","atob","encodeByteArray","input","webSafe","init_","byteToCharMap","byte1","haveByte2","byte2","haveByte3","byte3","outByte1","outByte2","outByte3","outByte4","encodeString","btoa","decodeString","c1","c2","u","c3","byteArrayToString","decodeStringToByteArray","charToByteMap","charAt","byte4","base64urlEncodeWithoutPadding","utf8Bytes","base64Encode","base64Decode","isIndexedDBAvailable","indexedDB","validateIndexedDBOpenable","Promise","resolve","reject","preExist","DB_CHECK_NAME","request","self","open","onsuccess","close","deleteDatabase","onupgradeneeded","onerror","message","getDefaultsFromGlobal","getGlobal","__FIREBASE_DEFAULTS__","getDefaults","process","env","defaultsJsonString","JSON","parse","getDefaultsFromEnvVariable","document","match","cookie","decoded","getDefaultsFromCookie","Deferred","promise","wrapCallback","callback","catch","FirebaseError","customData","super","captureStackTrace","ErrorFactory","service","serviceName","errors","fullCode","template","PATTERN","_","replaceTemplate","fullMessage","deepEqual","aKeys","bKeys","k","aProp","bProp","thing","getModularInstance","_delegate","Component","instanceFactory","multipleInstances","serviceProps","instantiationMode","onInstanceCreated","setInstantiationMode","mode","setMultipleInstances","setServiceProps","props","setInstanceCreatedCallback","DEFAULT_ENTRY_NAME","Provider","container","component","instances","Map","instancesDeferred","instancesOptions","onInitCallbacks","identifier","normalizedIdentifier","normalizeInstanceIdentifier","has","deferred","isInitialized","shouldAutoInitialize","instance","getOrInitializeService","instanceIdentifier","getImmediate","options","optional","getComponent","setComponent","isComponentEager","instanceDeferred","entries","clearInstance","delete","async","services","values","all","filter","INTERNAL","_delete","isComponentSet","getOptions","initialize","opts","onInit","existingCallbacks","Set","add","existingInstance","invokeOnInitCallbacks","callbacks","ComponentContainer","providers","addComponent","provider","getProvider","addOrOverwriteComponent","getProviders","LogLevel","levelStringToEnum","DEBUG","VERBOSE","INFO","WARN","ERROR","SILENT","defaultLogLevel","ConsoleMethod","defaultLogHandler","logType","logLevel","now","toISOString","method","idbProxyableTypes","cursorAdvanceMethods","cursorRequestMap","WeakMap","transactionDoneMap","transactionStoreNamesMap","transformCache","reverseTransformCache","idbProxyTraps","receiver","IDBTransaction","objectStoreNames","objectStore","wrap","wrapFunction","func","IDBDatabase","transaction","IDBCursor","advance","continue","continuePrimaryKey","unwrap","storeNames","tx","sort","transformCachableValue","done","unlisten","removeEventListener","complete","DOMException","addEventListener","cacheDonePromiseForTransaction","object","IDBObjectStore","IDBIndex","Proxy","IDBRequest","success","then","promisifyRequest","newValue","openDB","version","blocked","upgrade","blocking","terminated","openPromise","oldVersion","newVersion","db","deleteDB","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","storeName","store","index","oldTraps","PlatformLoggerServiceImpl","getPlatformInfoString","isVersionServiceProvider","library","logString","name$o","version$1","logger","_logLevel","_logHandler","_userLogHandler","setLogLevel","logHandler","userLogHandler","debug","PLATFORM_LOG_STRING","_apps","_components","_addComponent","app","_registerComponent","componentName","heartbeatController","triggerHeartbeat","ERROR_FACTORY","FirebaseAppImpl","config","_isDeleted","_options","_config","_name","_automaticDataCollectionEnabled","automaticDataCollectionEnabled","_container","checkDestroyed","isDeleted","appName","initializeApp","rawConfig","existingApp","newApp","registerVersion","libraryKeyOrName","variant","libraryMismatch","versionMismatch","warning","STORE_NAME","dbPromise","getDbPromise","createObjectStore","originalErrorMessage","writeHeartbeatsToIndexedDB","heartbeatObject","computeKey","idbGetError","appId","HeartbeatServiceImpl","_heartbeatsCache","_storage","HeartbeatStorageImpl","_heartbeatsCachePromise","agent","date","getUTCDateString","lastSentHeartbeatDate","heartbeats","singleDateHeartbeat","hbTimestamp","overwrite","heartbeatsToSend","unsentEntries","heartbeatsCache","maxSize","heartbeatEntry","find","hb","dates","countBytes","extractHeartbeatsForHeader","headerString","stringify","substring","_canUseIndexedDBPromise","runIndexedDBEnvironmentCheck","readHeartbeatsFromIndexedDB","heartbeatsObject","existingHeartbeatsObject","PENDING_TIMEOUT_MS","PACKAGE_VERSION","INTERNAL_AUTH_VERSION","TOKEN_EXPIRATION_BUFFER","isServerError","getInstallationsEndpoint","projectId","extractAuthTokenInfoFromResponse","response","token","requestStatus","expiresIn","responseExpiresIn","creationTime","getErrorFromResponse","requestName","errorData","json","serverCode","serverMessage","serverStatus","status","getHeaders","apiKey","Headers","Accept","getHeadersWithAuth","appConfig","refreshToken","headers","append","getAuthorizationHeader","retryIfServerError","fn","sleep","ms","setTimeout","VALID_FID_PATTERN","generateFid","fidByteArray","crypto","msCrypto","getRandomValues","fid","test","getKey","fidChangeCallbacks","fidChanged","callFidChangeCallbacks","channel","getBroadcastChannel","postMessage","closeBroadcastChannel","broadcastFidChange","broadcastChannel","BroadcastChannel","onmessage","OBJECT_STORE_NAME","oldValue","remove","update","updateFn","getInstallationEntry","installations","registrationPromise","installationEntry","oldEntry","clearTimedOutRequest","registrationStatus","updateOrCreateInstallationEntry","entryWithPromise","navigator","onLine","inProgressEntry","registrationTime","registeredInstallationEntry","heartbeatServiceProvider","endpoint","heartbeatService","heartbeatsHeader","getHeartbeatsHeader","body","authVersion","sdkVersion","fetch","ok","responseValue","authToken","createInstallationRequest","registerInstallation","waitUntilFidRegistration","triggerRegistrationIfNecessary","entry","updateInstallationRequest","generateAuthTokenRequest","getGenerateAuthTokenEndpoint","installation","refreshAuthToken","forceRefresh","tokenPromise","isEntryRegistered","oldAuthToken","isAuthTokenExpired","isAuthTokenValid","updateAuthTokenRequest","waitUntilAuthTokenRequest","inProgressAuthToken","requestTime","makeAuthTokenRequestInProgressEntry","updatedInstallationEntry","fetchAuthTokenFromServer","getToken","installationsImpl","completeInstallationRegistration","getMissingValueError","valueName","INSTALLATIONS_NAME","internalFactory","getId","configKeys","keyName","extractAppConfig","DEFAULT_VAPID_KEY","CONSOLE_CAMPAIGN_ID","MessageType$1","MessageType","arrayToBase64","uint8Array","base64ToArray","base64String","repeat","rawData","outputArray","OLD_DB_NAME","OLD_OBJECT_STORE_NAME","upgradeDb","dbGet","firebaseDependencies","tokenDetails","oldTokenDetails","senderId","dbNames","databases","upgradeTransaction","contains","clear","oldDetails","auth","p256dh","fcmToken","createTime","subscriptionOptions","swScope","vapidKey","checkTokenDetails","migrateOldDatabase","dbSet","requestDeleteToken","unsubscribeOptions","getEndpoint","responseData","errorInfo","getBody","web","applicationPubKey","getTokenInternal","messaging","pushSubscription","swRegistration","subscription","pushManager","getSubscription","subscribe","userVisibleOnly","applicationServerKey","getPushSubscription","scope","dbOptions","currentOptions","isVapidKeyEqual","isEndpointEqual","isAuthEqual","isP256dhEqual","isTokenValid","updatedToken","updateOptions","requestUpdateToken","updatedTokenDetails","deleteTokenInternal","updateToken","getNewToken","dbRemove","unsubscribe","subscribeOptions","requestGetToken","externalizePayload","internalPayload","collapseKey","collapse_key","messageId","fcmMessageId","messagePayloadInternal","notification","title","image","icon","propagateNotificationPayload","propagateDataPayload","_b","_c","_d","_e","fcmOptions","click_action","link","analyticsLabel","analytics_label","propagateFcmOptions","_mergeStrings","s1","s2","resultArray","MessagingService","analyticsProvider","deliveryMetricsExportedToBigQueryEnabled","onBackgroundMessageHandler","onMessageHandler","logEvents","isLogServiceStarted","messagingSenderId","registerDefaultSw","serviceWorker","register","browserErrorMessage","getToken$1","Notification","permission","requestPermission","updateVapidKey","ServiceWorkerRegistration","updateSwReg","serviceWorkerRegistration","logToScion","messageType","eventType","NOTIFICATION_CLICKED","PUSH_RECEIVED","getEventType","logEvent","message_id","message_name","message_time","message_device_time","messageEventListener","isFirebaseMessaging","next","dataPayload","WindowMessagingInternalFactory","isWindowSupported","cookieEnabled","PushSubscription","getMessagingInWindow","isSupported","deleteToken","deleteToken$1","onMessage","nextOrObserver","onMessage$1","Tinode","Alert","render","visible","className","content","onReject","onClick","FormattedMessage","id","defaultMessage","onConfirm","confirm","APP_NAME","KNOWN_HOSTS","hosted","local","DEFAULT_HOST","KEYPRESS_DELAY","DEFAULT_P2P_ACCESS_MODE","REM_SIZE","AVATAR_SIZE","MAX_AVATAR_BYTES","MAX_INBAND_ATTACHMENT_SIZE","MAX_EXTERN_ATTACHMENT_SIZE","IMAGE_THUMBNAIL_DIM","MAX_TITLE_LENGTH","MAX_TOPIC_DESCRIPTION_LENGTH","messages","defineMessages","clear_messages","clear_for_all","delete_for_all","send_retry","mute","unmute","reply","forward","topic_delete","topic_delete_warning","delete_messages_warning","unblock","topic_block_warning","member_delete","archive","unarchive","edit_permissions","clear_messages_warning","ContextMenu","selfRef","formatMessage","intl","handlePageClick","bind","handleEscapeKey","handleClick","MenuItems","params","errorHandler","onShowAlert","deleteMessages","retryMessage","replyToMessage","topicPermissionSetter","ctrl","onTopicRemoved","topicName","topic","tinode","getTopic","delTopic","user","delSubscription","componentDidMount","componentWillUnmount","current","preventDefault","stopPropagation","hide","keyCode","item","items","currentTarget","dataset","onAction","onError","hard","cancelSend","seq","delMessagesAll","delMessagesList","flushMessage","msg","createMessage","publishDraft","updateMode","pickReply","userFrom","userName","menu","count","vSize","left","bounds","right","clickAt","top","bottom","style","ref","injectIntl","icon_mapping","ContactBadges","badges","color","secondsToTime","seconds","fixedMin","hours","sec","bytesToHumanSize","sizes","bucket","log2","round","toFixed","shortenFileName","filename","maxLength","idToColorClass","light","fg","userId","hash","stringToColorHash","updateFavicon","oldIcon","getElementById","head","getElementsByTagName","newIcon","createElement","rel","href","removeChild","appendChild","theCard","imageUrl","imageMimeType","note","card","mimeType","matches","exec","photo","arrayEqual","l","sanitizeUrl","url","allowedSchemes","schemes","RegExp","sanitizeUrlForMime","mimeMajor","sanitizedUrl","deliveryMarker","received","cancelablePromise","hasCanceled","isCanceled","cancel","clipStr","LetterTile","avatar","isGroup","iconColor","letter","deleted","authorizeURL","alt","UnreadBadge","SUPPORTED_IMAGE_FORMATS","MIME_EXTENSIONS","makeImageUrl","startsWith","fitImageSize","width","height","maxWidth","maxHeight","forceSquare","scale","dstWidth","dstHeight","srcWidth","srcHeight","xoffset","yoffset","fileNameForMime","fname","mime","at","imageScaled","fileOrBlob","img","Image","crossOrigin","onload","URL","revokeObjectURL","dim","canvas","ctx","getContext","imageSmoothingEnabled","drawImage","blob","toBlob","clearRect","createObjectURL","blobToBase64","FileReader","bits","readAsDataURL","intArrayToBase64","bin","base64ToIntArray","BAR_COLOR_DARK","AudioPlayer","preview","state","canPlay","playing","longMin","initAudio","initCanvas","resampleBars","visualize","handlePlay","handleSeek","handleError","audioPlayer","viewBuffer","canvasRef","oncanplay","ontimeupdate","onended","pause","componentDidUpdate","prevProps","setState","Audio","offsetWidth","offsetHeight","canvasContext","lineCap","effectiveWidth","lineWidth","drawFrame","requestAnimationFrame","thumbAt","LINE_WIDTH","beginPath","strokeStyle","stroke","moveTo","lineTo","arc","PI","fillStyle","original","dstCount","factor","amps","maxAmp","amp","play","rect","getBoundingClientRect","clientX","playClass","short","CallMessage","isCallDropped","callState","successClass","callIcon","incoming","CallStatus","icon2","LazyImage","padding","whenDone","FileProgress","progress","onCancel","UploadingImage","onCancelUpload","drafty_form","drafty_attachment","drafty_image","drafty_unknown","handleImageData","el","attr","viewportWidth","minWidth","minHeight","Drafty","onImagePreview","loading","fullFormatter","quoteFormatter","onFormButtonClick","inner","onQuoteClick","previewFormatter","inlineImageAttr","quoteImage","base64ToBlob","evt","statusText","scaled","replyFormatter","loadedPromise","Contact","handleContextClick","onSelected","showContextMenu","pageY","pageX","online","icon_badges","isVerified","isStaff","isDangerous","acs","showMode","getMode","isMuted","isJoiner","previewIsResponse","marker","titleClass","showCheckmark","selected","showOnline","isChannel","unread","small","comment","ContactAction","action","badge_you","badge_owner","ContactList","topicSelected","contactNodes","contactsCount","contacts","filterFunc","filterOn","private","public","myUserId","isOwner","forwarded","deliveryStatus","latestMessage","_status","msgStatus","showUnread","connected","trusted","verified","staff","danger","_deleted","onTopicSelected","noScroll","dangerouslySetInnerHTML","__html","emptyListMessage","SearchContacts","edited","search","handleSearchChange","handleSearch","handleClear","handleKeyDown","onSearchContacts","query","placeholder","onChange","onKeyDown","required","autoFocus","ForwardDialog","handleClose","handleSearchContacts","handleContactSelected","onInitFind","uid","searchResults","isWriter","desription","search_placeholder","not_found_placeholder","badge_verified","badge_staff","badge_danger","BadgeList","trustedBadges","CALL_HEAD_STARTED","RING_SOUND","CallIncoming","fullName","previousMetaDesc","resetDesc","onMetaDesc","handleRejectCall","handleAcceptCall","ringTimer","setInterval","onRinging","clearInterval","getDefaultAccess","getAccessMode","desc","onAcceptCall","onClose","LoadSpinner","large","centered","show","AvatarUpload","source","handleFileReceived","files","onImageUpdated","randId","random","readOnly","accept","htmlFor","uploading","CheckBox","handleChange","iconName","classList","attrs","MenuCancel","ErrorPanel","onClearError","text","whiteSpace","actionText","Chip","handleCancel","invalid","noAvatar","ChipInput","deriveStateFromProps","focused","handleTextInput","removeChipAt","handleChipCancel","handleFocusGained","handleFocusLost","static","chips","prompt","sortedChips","sortChips","staticMembers","chipIndex","indexChips","prevState","keep","normal","removed","onChipRemoved","onFocusLost","onEnter","avatarDisabled","tabIndex","onFocus","onBlur","no_contacts","contacts_not_found_short","GroupManager","members","indexMembers","keepInitialMembers","requiredMember","contactFilter","noContactsMessage","selectedContacts","handleMemberRemoved","handleContactFilter","handleSubmit","delta","present","keepInitial","stat","sel","added","onSubmit","doContactFiltering","joiner","writer","preser","approver","sharer","deleter","owner","PermissionsEditor","names","skip","userTitle","userAvatar","modeTitle","compareTitle","Cropper","panX","panY","originX","originY","zoom","minZoom","maxZoom","overlay","cutout","boundingBox","imageWidth","imageHeight","mouseX","mouseY","prevDistance","cutoutRect","bBoxRect","initScaling","onZoom","handleZoom","mouseDown","mouseUp","mouseMove","mouseTouch","positionAll","translate","passive","currPan","nextDiff","imgRect","imgLeft","imgRight","coLeft","coRight","imgTop","imgBottom","coTop","coBottom","touches","dX","dY","checkBound","touch0","touch1","distance","sqrt","t3d","orig","transform","transformOrigin","onLoad","step","AvatarCrop","objURL","VisiblePassword","inputRef","handleVisibility","handeTextChange","handleEditingFinished","focus","onFinished","activeElement","autoComplete","InPlaceEdit","active","initialValue","handleStartEditing","handlePasswordFinished","checkValidity","spanText","spanClass","multiline","rows","TagManager","tags","tagInput","activated","handleTagInput","handleAddTag","handleRemoveTag","nextProps","last","maxTagCount","getServerParam","onTagsChanged","minTagLength","maxTagLength","add_tags_prompt","TopicDescEdit","isMe","newAvatar","newAvatarMime","previousOnTags","tnNewTags","handleFullNameUpdate","handleImageUpdated","handleAvatarCropped","handleAvatarCropCancel","uploadAvatar","handlePrivateUpdate","handleDescriptionUpdate","handleTagsUpdated","onTagsUpdated","onUpdateTopicDesc","readyToUpload","getLargeFileHelper","upload","du","onUpdateTags","editable","full_name_placeholder","group_name_placeholder","private_placeholder","title_tag_manager","TopicCommon","credentials","getCredentials","addCredActive","addCredInvalid","newCred","previousTagsUpdated","tnCredsUpdated","handleCredChange","handleCredKeyDown","handleCredEntered","onCredsUpdated","getType","creds","asPhone","asEmail","onCredAdd","onTopicTagsUpdateRequest","cred","meth","onCredConfirm","onCredDelete","phone_or_email_prompt","delete_messages","leave_chat","leave_chat_warning","block_contact","block_contact_warning","report_chat","report_chat_warning","other_user","TopicSecurity","handleDeleteTopic","handleDeleteMessages","handleLeave","handleBlock","handleReport","onDeleteTopic","onDeleteMessages","onLeaveTopic","onBlockTopic","onReportTopic","groupTopic","onLaunchPermissionsEditor","access","anon","modeGiven2","general","security","crop","perm_want","perm_given","perm_auth","perm_anon","perm_user","InfoView","admin","muted","address","selectedContact","modeGiven","modeWant","modeWant2","contactList","previousSubsUpdated","resetSubs","resetTags","onSubsUpdated","handleImageChanged","handleMuted","handleUnarchive","handlePermissionsChanged","handleLaunchPermissionsEditor","handleShowAddMembers","handleMemberUpdateRequest","handleMemberSelected","handleContextMenu","handleBackNavigate","newState","user2","subscriber","getGiven","getWant","subscribers","defacs","isAdmin","isSharer","isDeleter","archived","isArchived","isGroupType","isChannelType","chan","getMeta","startMetaQuery","withTags","build","subs","onTopicDescUpdate","ignored","onChangePermissions","ignored2","onTopicUnArchive","which","perm","onTopicDescUpdateRequest","userPermissionsEdited","toEdit","toCompare","toSkip","titleEdit","titleCompare","AccessMode","userPermissionsTitle","userPermissionsAvatar","editedPermissions","immutablePermissions","editedPermissionsTitle","immutablePermissionsTitle","editedPermissionsSkipped","onNavigate","onMemberUpdateRequest","panel","menuItems","view","panelTitle","displayMobile","errorLevel","errorText","searchableContacts","no_members","loop","CALL_ENDED_SOUND","DIALING_SOUND","already_in_call","CallPanel","localStream","pc","previousOnInfo","waitingForPeer","callInitialSetupComplete","localStreamConstraints","audio","video","isOutgoingCall","localRef","remoteRef","remoteIceCandidatesCache","onInfo","createPeerConnection","canSendOffer","drainRemoteIceCandidatesCache","handleNegotiationNeededEvent","handleICECandidateEvent","handleNewICECandidateMsg","handleICEConnectionStateChangeEvent","handleSignalingStateChangeEvent","handleICEGatheringStateChangeEvent","handleIceCandidateErrorEvent","handleTrackEvent","handleVideoOfferMsg","handleVideoAnswerMsg","reportError","handleGetUserMediaError","stopTracks","handleCloseClick","handleToggleCameraClick","handleToggleMicClick","toggleMedia","handleRemoteHangup","handleVideoCallAccepted","stream","getTracks","track","addTrack","what","mediaDevices","getUserMedia","srcObject","onInvite","ontrack","onremovetrack","onremovestream","onicecandidate","oniceconnectionstatechange","onsignalingstatechange","onicegatheringstatechange","onnegotiationneeded","onicecandidateerror","enabled","iceServers","RTCPeerConnection","RTCSessionDescription","setRemoteDescription","createOffer","offer","setLocalDescription","onSendOffer","localDescription","candidate","onIceCandidate","RTCIceCandidate","addIceCandidate","iceConnectionState","signalingState","streams","forceUpdate","createAnswer","answer","onSendAnswer","onHangup","kind","remoteActive","disabled","audioIcon","getAudioTracks","videoIcon","getVideoTracks","peerTitle","pulseAnimation","autoPlay","playsInline","Attachment","downloader","downloadFile","mimetype","download","loaded","helperFunc","isUrlRelative","downloadUrl","downloadWidget","message_sending","message_sending_failed","ReceivedMarker","timestamp","toLocaleTimeString","locale","timeStyle","BaseChatMessage","uploader","onProgress","handleProgress","handleImagePreview","handleFormButtonClick","handleCancelUpload","handleQuoteClick","formatterContext","resp","act","onFormResponse","userIsWriter","ratio","replyToSeq","sideClass","sequence","bubbleClass","fullDisplay","attachments","att","tree","innerRef","IntlChatMessage","MILLIS_PER_BAR","AUDIO_MIME_TYPE","AudioRecorder","audioRecord","recording","paused","blobUrl","initMediaRecording","getRecording","cleanUp","handleResume","handlePause","handleDelete","handleDone","durationMillis","startedOn","mediaRecorder","audioContext","audioInput","analyser","audioChunks","pcmData","frequencyBinCount","canvasWidth","canvasHeight","viewLength","viewDuration","prevBarCount","volume","countPerBar","getByteTimeDomainData","amplitude","barCount","dx","requestData","resume","MediaRecorder","audioBitsPerSecond","AudioContext","createMediaStreamSource","createAnalyser","fftSize","connect","onstop","onDeleted","ondataavailable","tempFixMetadata","fixedBlob","arrayBuffer","arrayBuff","decodeAudioData","createPreview","decoder","webmBuf","fixedMetadataBuf","getChannelData","totalSPB","samplingRate","disconnect","resumeClass","messaging_disabled","type_new_message","add_image_caption","file_attachment_too_large","cannot_initiate_upload","SendMessage","quote","audioRec","audioAvailable","keypressTimestamp","handlePasteEvent","handleAttachImage","handleAttachFile","handleAttachAudio","handleSend","handleKeyPress","handleMessageTyping","formatReply","messageEditArea","onImageSuccess","onAttachmentSuccess","clipboardData","originalEvent","file","getAsFile","filePasted","onAttachImage","onAttachFile","onAttachAudio","acceptBlank","noInput","onSendMessage","shiftKey","onKeyPress","messagePrompt","onCancelReply","audioEnabled","attachImage","click","attachFile","display","DocPreview","handleSendDoc","caption","mimeToIcon","iconFromMime","GroupSubs","usersOnline","totalCount","countToShow","overflow","ImagePreview","handleSendImage","assignWidth","node","maxlength","Invitation","handleButtonAction","LogoView","serverVersion","serverAddress","MetaMessage","HashNavigation","path","eq","decodeURIComponent","location","encodeURIComponent","parseUrlHash","composeUrlHash","sidepanel","infopanel","online_now","last_seen","not_found","invalid_content","isUnconfirmed","ex","getExcessive","isPeerRestricted","getMissing","shouldPresentCallPanel","MessagesView","getDerivedStateFromProps","leave","sendMessage","retrySend","sendImageAttachment","sendFileAttachment","sendAudioAttachment","sendKeyPress","handleScrollReference","handleScrollEvent","handleDescChange","handleSubsUpdated","handleMessageUpdate","handleAllMessagesReceived","handleInfoReceipt","handleImagePostview","handleClosePreview","handleFormResponse","handleShowMessageContextMenu","handleNewChatAcceptance","handleEnablePeer","postReadNotification","clearNotificationQueue","goToLatestMessage","handlePickReply","handleCancelReply","handleCallHangup","chatMessageRefs","getOrCreateMessageRef","readNotificationQueue","readNotificationTimer","keyPressTimer","seqId","messagesScroller","messageCount","scrollPosition","scrollTop","scrollHeight","rtcPanel","callSeq","onData","onAllMessagesReceived","onPres","applicationVisible","ready","_new","isP2PType","withDesc","nextState","docPreview","imagePreview","imagePostview","typingIndicator","fetchingMessages","showGoToLastButton","forwardMessage","onlineSubs","peer","p2pPeerDesc","peerMessagingDisabled","latestClearId","maxClearId","callTopic","isReader","readingBlocked","unconformed","unconfirmed","isSubscribed","newTopic","newTopicParams","_topicName","getQuery","withLaterDesc","withLaterSub","withLaterData","withLaterDel","setQuery","navigateTo","setUrlTopic","onNewTopicCreated","calls","queuedMessages","pub","_sending","webrtc","blankState","oldTopicName","isTopicCached","oldTopic","finally","msgHasMoreMessages","getMessagesPage","sendAt","noteRead","setMilliseconds","getMilliseconds","clearTimeout","isNewMessage","searchParams","messageSpecificMenuItems","onNewChat","noteKeyPress","uploadCompletionPromise","maxInbandAttachmentSize","urlPromise","fileToBase64","maxExternAttachmentSize","onVideoCallClosed","onCallHangup","_tempPreview","findMessage","_cancelled","senderName","onCancelForwardMessage","scrollIntoView","behavior","hideSelf","component2","onCallInvite","onCallSendOffer","onCallIceCandidate","onCallSendAnswer","messageNodes","previousFrom","prevDate","chatBoxClass","dateFmt","Intl","DateTimeFormat","prev","nextFrom","thisFrom","isReply","userDesc","thisDate","ts","toDateString","format","isChan","_uploader","lastSeen","cont","getMeTopic","getContact","seen","userLanguage","language","getFullYear","getMonth","getDate","hour12","hour","minute","toLocaleDateString","month","day","year","shortDateFormat","when","onHideMessagesView","ButtonBack","onBack","MenuContacts","onNewTopic","onSettings","MenuStart","onSignUp","SideNavbar","_clip","AccountSettingsView","me","archived_contacts_title","ContactsView","handleAction","unreadThreads","archivedCount","chatList","arch","touched","action_ignored","onShowArchive","LocalStorageUtil","localStorage","setItem","getItem","oldVal","getObject","setObject","removeItem","CreateAccountView","login","password","email","uploadUrl","errorCleared","buttonDisabled","saveToken","handleLoginChange","handlePasswordChange","handleEmailChange","handleFnChange","handleToggleSaveToken","onCreateAccount","submitClasses","login_prompt","password_prompt","full_name_prompt","email_prompt","stay_logged_in","EditAccountView","handleCheckboxClick","onToggleMessageSounds","onTogglePushNotifications","onToggleIncognitoMode","messageSounds","desktopAlertsEnabled","desktopAlerts","incognitoMode","delete_account","delete_account_warning","AccSecurityView","blockedCount","showPermissionEditorFor","handlePasswordUpdate","handleHidePermissionsEditor","handleDeleteAccount","pwd","onUpdatePassword","onUpdateAccountDesc","onDeleteAccount","password_unchanged","onLogout","onShowBlocked","AccSupportView","LoginView","hostName","persist","onPersistenceChange","onLogin","autoCorrect","autoCapitalize","invalid_id","NewTopicById","groupId","prefix","NewTopicGroup","handleFieldEdit","handleTagsChanged","handleChannelToggle","search_for_contacts","search_no_results","NewTopicView","tabSelected","searchQuery","handleTabClick","handleSearchResultSelected","handleNewGroupSubmit","handleGroupByID","addUrlParam","removeUrlParam","onCreateTopic","dataUrl","priv","no_contacts_placeholder","PasswordResetView","sent","scheme","onReset","onRequest","HostSelector","changed","handleHostNameChange","onServerAddressChange","hostOptions","SettingsView","transport","secureConnection","handleTransportSelected","handleServerAddressChange","handleToggleSecure","onUpdate","def","ws","lp","transportOptions","phone","ValidationView","credCode","codeReceived","credMethod","credToken","numbers_only","settings","edit","notif","support","newtpk","reset","SidepanelView","handleNewTopic","errorAction","errorActionText","loadSpinnerVisible","loginDisabled","onLoginRequest","onGlobalSettings","onUpdateAccountTags","onValidateCredentials","onPasswordResetRequest","onResetPassword","detectServerAddress","host","protocol","hostname","port","isSecureConnection","POP_SOUND","reconnect_countdown","reconnect_now","push_init_failed","invalid_security_token","no_connection","code_doesnot_match","menu_item_info","menu_item_video_call","cred_confirmed_successfully","TinodeWeb","getBlankState","handleResize","handleHashRoute","handleOnline","checkForAppUpdate","handleVisibilityEvent","handleLoginRequest","handlePersistenceChange","handleConnected","handleAutoreconnectIteration","doLogin","handleLoginSuccessful","handleDisconnect","tnMeMetaDesc","tnMeContactUpdate","tnMeSubsUpdated","resetContactList","tnInitFind","tnFndSubsUpdated","handleTopicSelected","handleHideMessagesView","handleSendMessage","handleNewChatInvitation","handleNewAccount","handleNewAccountRequest","handleUpdatePasswordRequest","handleUpdateAccountTagsRequest","handleToggleIncognitoMode","handleSettings","handleGlobalSettings","handleShowArchive","handleShowBlocked","handleToggleMessageSounds","handleCredAdd","handleCredDelete","handleCredConfirm","initFCMessaging","toggleFCMToken","handlePushMessage","handleSidepanelCancel","handleStartTopicRequest","handleNewTopicCreated","handleTopicUpdateRequest","handleChangePermissions","handleTagsUpdateRequest","handleLogout","handleDeleteTopicRequest","handleDeleteMessagesRequest","handleLeaveUnsubRequest","handleBlockTopicRequest","handleReportTopic","handleShowContextMenu","defaultTopicContextMenu","handleHideContextMenu","handleShowAlert","handleShowInfoView","handleValidateCredentialsRequest","handlePasswordResetRequest","handleResetPassword","handleContextMenuAction","handleShowForwardDialog","handleHideForwardDialog","handleStartVideoCall","handleInfoMessage","handleDataMessage","handleCallClose","handleCallInvite","handleCallRinging","handleCallSendOffer","handleCallIceCandidate","handleCallSendAnswer","handleCallAcceptCall","sendMessageToTopic","callTimeoutTimer","autoLogin","messageSoundsOff","FIREBASE_INIT","firebaseToken","hidden","sidePanelSelected","sidePanelTitle","sidePanelAvatar","myTrustedBadges","liveConnection","topicSelectedOnline","topicSelectedAcs","innerWidth","infoPanel","mobilePanel","callShouldStart","contextMenuVisible","contextMenuBounds","contextMenuClickAt","contextMenuParams","contextMenuItems","forwardDialogVisible","alertVisible","alertParams","requestedTopic","documentElement","clientWidth","viewportHeight","clientHeight","tnSetup","onConnect","onDisconnect","onAutoreconnectIteration","onInfoMessage","onDataMessage","setDeviceToken","parsedNav","expires","setAuthToken","readTimer","readTimerCallback","cred_done","persistentCache","onSetupCompleted","secure","setHumanLanguage","enableLogging","oobNotification","updateObject","fcm","firebaseGetMessaging","firebaseInitApp","reg","requestFCMToken","firebaseOnMessage","sw","firebaseGetToken","messagingVapidKey","mobile","onupdatefound","installingWorker","installing","onstatechange","controller","newTopicTabSelected","tab","getTopicAccessMode","stateForError","reconnectCountdown","reconnect","isConnected","initStorage","clearStorage","getServerInfo","ver","prom","fmtTime","tmpToken","isAuthenticated","getAuthToken","loginPromise","connectionPromise","loginBasic","loginToken","navigateToCredentialsView","goToTopic","onContactUpdate","getCurrentUserID","withCred","urlHash","setUrlSidePanel","isPresencer","unused","foundContacts","merged","updated","past","prepareSearchableContacts","fnd","getFndTopic","withSub","setMeta","isTopicOnline","completion","subscribePromise","publishMessage","am","updateWant","login_","password_","public_","cred_","tags_","createAccountBasic","firebaseDelToken","delCredential","basicNavigator","infoNavigator","setUrlInfoPanel","newGroupTopicName","oldName","newName","updateAccountBasic","getCurrentLogin","updateGiven","cleared","Promose","delCurrentUser","report","msgPreview","self_blocked","subscribed","keepForwardedMessage","confirmText","rejectText","invite","requestResetAuthSecret","newPassword","base64ReEncode","videoCall","sdp","latestMsgVersion","myUserName","onAddMember","handleManageGroupMembers","hl","languages","baseLanguage","htmlLang","allMessages","setAttribute","IntlProvider","textComponent"],"sourceRoot":""}